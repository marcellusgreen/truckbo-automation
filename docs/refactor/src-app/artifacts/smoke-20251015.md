# Smoke Test Checklist (2025-10-15)

> **Note:** These steps require the interactive browser flows and API services running together. They cannot be completed entirely inside the Codex CLI, so use these instructions during a local session and record the outputs listed in the _Artifacts_ section once finished.

## Environment Preparation
- Node: confirm `node -v` matches project baseline (>= v22.17.1).
- NPM: confirm `npm -v` (>= 11.4.2).
- Env: ensure `VITE_REFACTOR_DEBUG=true` and `VITE_USE_FLEET_HOOK=true` (already set in `.env`).
- Start services in two terminals:
  1. `npm run api:dev`
  2. `npm run dev`
- Sign in with the seeded demo account (see `docs/auth/seed-users.md` if you need credentials).

## Checklist

### 1. Fleet Dashboard Load
- [ ] Navigate to **Dashboard** after login.
- Expected: centralized stats render with no console errors or fallback warnings.
- Capture: console screenshot or log snippet showing successful fetch + component render.

### 2. Manual Add Vehicle
- [ ] Go to **Fleet → + New Vehicle**.
- [ ] Submit a sample vehicle (use fake VIN if needed).
- Expected: success toast; vehicle appears without duplicate rows after refresh.
- Capture: network log showing adapter request + screenshot of new row.

### 3. Bulk CSV Upload
- [ ] Open **Bulk Upload** and import the sample CSV (`mock-fleet-documents/sample-fleet-upload.csv`).
- Expected: success toast; new records persist after a manual refresh (`refresh fleet` control).
- Capture: network log + hook debug line indicating centralized refresh.

### 4. Document Ingestion Pipeline
- [ ] Use **Document Upload** or **Multi-Batch Upload** to submit `mock-fleet-documents/sample-registration.pdf`.
- [ ] Watch `/api/v1/documents/process-status/:jobId` polling until status is `succeeded`.
- Expected: job metadata populated, Neon payload saved (check devtools > Network).
- Capture: status response JSON + refactor debug log snippet.

### 5. Compliance Dashboard Refresh
- [ ] Navigate to **Comprehensive Compliance** view.
- Expected: cards and charts reflect the updated fleet counts; no reliance on `fleetDataManager` fallback.
- Capture: console screenshot or exported JSON of compliance stats.

## Artifacts to Update
- `docs/refactor/src-app/artifacts/logs-20251007.md` → append 2025-10-15 run with timestamped notes.
- `docs/refactor/src-app/artifacts/data-shapes/` → store updated JSON snapshots (`centralized-fleet-20251015.json`, etc.).
- `docs/refactor/src-app/artifacts/smoke-20251015.md` (this file) → mark checkboxes and append observations/screenshots references.

## Follow-Up
- Once all steps are green, remove the event-bus refresh fallback noted in `docs/refactor/src-app/dependency-map.md`.
- Notify the team in the progress log entry (`progress-20250926.md`) that Phase 0 smoke validation is complete with artifact locations.
