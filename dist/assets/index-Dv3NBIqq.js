var Kp=Object.defineProperty;var Zp=(f,a,s)=>a in f?Kp(f,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):f[a]=s;var ce=(f,a,s)=>Zp(f,typeof a!="symbol"?a+"":a,s);(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))i(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const m of u.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&i(m)}).observe(document,{childList:!0,subtree:!0});function s(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(c){if(c.ep)return;c.ep=!0;const u=s(c);fetch(c.href,u)}})();function Au(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}function Qp(f){if(Object.prototype.hasOwnProperty.call(f,"__esModule"))return f;var a=f.default;if(typeof a=="function"){var s=function i(){return this instanceof i?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};s.prototype=a.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(f).forEach(function(i){var c=Object.getOwnPropertyDescriptor(f,i);Object.defineProperty(s,i,c.get?c:{enumerable:!0,get:function(){return f[i]}})}),s}var Uo={exports:{}},mr={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M0;function Jp(){if(M0)return mr;M0=1;var f=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(i,c,u){var m=null;if(u!==void 0&&(m=""+u),c.key!==void 0&&(m=""+c.key),"key"in c){u={};for(var h in c)h!=="key"&&(u[h]=c[h])}else u=c;return c=u.ref,{$$typeof:f,type:i,key:m,ref:c!==void 0?c:null,props:u}}return mr.Fragment=a,mr.jsx=s,mr.jsxs=s,mr}var I0;function Wp(){return I0||(I0=1,Uo.exports=Jp()),Uo.exports}var r=Wp(),Lo={exports:{}},ve={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O0;function eb(){if(O0)return ve;O0=1;var f=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),m=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),w=Symbol.iterator;function D(N){return N===null||typeof N!="object"?null:(N=w&&N[w]||N["@@iterator"],typeof N=="function"?N:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,E={};function A(N,T,z){this.props=N,this.context=T,this.refs=E,this.updater=z||b}A.prototype.isReactComponent={},A.prototype.setState=function(N,T){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,T,"setState")},A.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function X(){}X.prototype=A.prototype;function C(N,T,z){this.props=N,this.context=T,this.refs=E,this.updater=z||b}var W=C.prototype=new X;W.constructor=C,v(W,A.prototype),W.isPureReactComponent=!0;var k=Array.isArray,Z={H:null,A:null,T:null,S:null,V:null},le=Object.prototype.hasOwnProperty;function q(N,T,z,B,J,re){return z=re.ref,{$$typeof:f,type:N,key:T,ref:z!==void 0?z:null,props:re}}function se(N,T){return q(N.type,T,void 0,void 0,void 0,N.props)}function te(N){return typeof N=="object"&&N!==null&&N.$$typeof===f}function Ce(N){var T={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(z){return T[z]})}var ee=/\/+/g;function be(N,T){return typeof N=="object"&&N!==null&&N.key!=null?Ce(""+N.key):T.toString(36)}function ae(){}function de(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(ae,ae):(N.status="pending",N.then(function(T){N.status==="pending"&&(N.status="fulfilled",N.value=T)},function(T){N.status==="pending"&&(N.status="rejected",N.reason=T)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function V(N,T,z,B,J){var re=typeof N;(re==="undefined"||re==="boolean")&&(N=null);var ne=!1;if(N===null)ne=!0;else switch(re){case"bigint":case"string":case"number":ne=!0;break;case"object":switch(N.$$typeof){case f:case a:ne=!0;break;case y:return ne=N._init,V(ne(N._payload),T,z,B,J)}}if(ne)return J=J(N),ne=B===""?"."+be(N,0):B,k(J)?(z="",ne!=null&&(z=ne.replace(ee,"$&/")+"/"),V(J,T,z,"",function(ue){return ue})):J!=null&&(te(J)&&(J=se(J,z+(J.key==null||N&&N.key===J.key?"":(""+J.key).replace(ee,"$&/")+"/")+ne)),T.push(J)),1;ne=0;var Re=B===""?".":B+":";if(k(N))for(var ge=0;ge<N.length;ge++)B=N[ge],re=Re+be(B,ge),ne+=V(B,T,z,re,J);else if(ge=D(N),typeof ge=="function")for(N=ge.call(N),ge=0;!(B=N.next()).done;)B=B.value,re=Re+be(B,ge++),ne+=V(B,T,z,re,J);else if(re==="object"){if(typeof N.then=="function")return V(de(N),T,z,B,J);throw T=String(N),Error("Objects are not valid as a React child (found: "+(T==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":T)+"). If you meant to render a collection of children, use an array instead.")}return ne}function M(N,T,z){if(N==null)return N;var B=[],J=0;return V(N,B,"","",function(re){return T.call(z,re,J++)}),B}function j(N){if(N._status===-1){var T=N._result;T=T(),T.then(function(z){(N._status===0||N._status===-1)&&(N._status=1,N._result=z)},function(z){(N._status===0||N._status===-1)&&(N._status=2,N._result=z)}),N._status===-1&&(N._status=0,N._result=T)}if(N._status===1)return N._result.default;throw N._result}var P=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var T=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(T))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)};function I(){}return ve.Children={map:M,forEach:function(N,T,z){M(N,function(){T.apply(this,arguments)},z)},count:function(N){var T=0;return M(N,function(){T++}),T},toArray:function(N){return M(N,function(T){return T})||[]},only:function(N){if(!te(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},ve.Component=A,ve.Fragment=s,ve.Profiler=c,ve.PureComponent=C,ve.StrictMode=i,ve.Suspense=g,ve.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Z,ve.__COMPILER_RUNTIME={__proto__:null,c:function(N){return Z.H.useMemoCache(N)}},ve.cache=function(N){return function(){return N.apply(null,arguments)}},ve.cloneElement=function(N,T,z){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var B=v({},N.props),J=N.key,re=void 0;if(T!=null)for(ne in T.ref!==void 0&&(re=void 0),T.key!==void 0&&(J=""+T.key),T)!le.call(T,ne)||ne==="key"||ne==="__self"||ne==="__source"||ne==="ref"&&T.ref===void 0||(B[ne]=T[ne]);var ne=arguments.length-2;if(ne===1)B.children=z;else if(1<ne){for(var Re=Array(ne),ge=0;ge<ne;ge++)Re[ge]=arguments[ge+2];B.children=Re}return q(N.type,J,void 0,void 0,re,B)},ve.createContext=function(N){return N={$$typeof:m,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:u,_context:N},N},ve.createElement=function(N,T,z){var B,J={},re=null;if(T!=null)for(B in T.key!==void 0&&(re=""+T.key),T)le.call(T,B)&&B!=="key"&&B!=="__self"&&B!=="__source"&&(J[B]=T[B]);var ne=arguments.length-2;if(ne===1)J.children=z;else if(1<ne){for(var Re=Array(ne),ge=0;ge<ne;ge++)Re[ge]=arguments[ge+2];J.children=Re}if(N&&N.defaultProps)for(B in ne=N.defaultProps,ne)J[B]===void 0&&(J[B]=ne[B]);return q(N,re,void 0,void 0,null,J)},ve.createRef=function(){return{current:null}},ve.forwardRef=function(N){return{$$typeof:h,render:N}},ve.isValidElement=te,ve.lazy=function(N){return{$$typeof:y,_payload:{_status:-1,_result:N},_init:j}},ve.memo=function(N,T){return{$$typeof:x,type:N,compare:T===void 0?null:T}},ve.startTransition=function(N){var T=Z.T,z={};Z.T=z;try{var B=N(),J=Z.S;J!==null&&J(z,B),typeof B=="object"&&B!==null&&typeof B.then=="function"&&B.then(I,P)}catch(re){P(re)}finally{Z.T=T}},ve.unstable_useCacheRefresh=function(){return Z.H.useCacheRefresh()},ve.use=function(N){return Z.H.use(N)},ve.useActionState=function(N,T,z){return Z.H.useActionState(N,T,z)},ve.useCallback=function(N,T){return Z.H.useCallback(N,T)},ve.useContext=function(N){return Z.H.useContext(N)},ve.useDebugValue=function(){},ve.useDeferredValue=function(N,T){return Z.H.useDeferredValue(N,T)},ve.useEffect=function(N,T,z){var B=Z.H;if(typeof z=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return B.useEffect(N,T)},ve.useId=function(){return Z.H.useId()},ve.useImperativeHandle=function(N,T,z){return Z.H.useImperativeHandle(N,T,z)},ve.useInsertionEffect=function(N,T){return Z.H.useInsertionEffect(N,T)},ve.useLayoutEffect=function(N,T){return Z.H.useLayoutEffect(N,T)},ve.useMemo=function(N,T){return Z.H.useMemo(N,T)},ve.useOptimistic=function(N,T){return Z.H.useOptimistic(N,T)},ve.useReducer=function(N,T,z){return Z.H.useReducer(N,T,z)},ve.useRef=function(N){return Z.H.useRef(N)},ve.useState=function(N){return Z.H.useState(N)},ve.useSyncExternalStore=function(N,T,z){return Z.H.useSyncExternalStore(N,T,z)},ve.useTransition=function(){return Z.H.useTransition()},ve.version="19.1.0",ve}var V0;function Cu(){return V0||(V0=1,Lo.exports=eb()),Lo.exports}var K=Cu();const zh=Au(K);var ko={exports:{}},hr={},$o={exports:{}},Fo={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U0;function tb(){return U0||(U0=1,function(f){function a(M,j){var P=M.length;M.push(j);e:for(;0<P;){var I=P-1>>>1,N=M[I];if(0<c(N,j))M[I]=j,M[P]=N,P=I;else break e}}function s(M){return M.length===0?null:M[0]}function i(M){if(M.length===0)return null;var j=M[0],P=M.pop();if(P!==j){M[0]=P;e:for(var I=0,N=M.length,T=N>>>1;I<T;){var z=2*(I+1)-1,B=M[z],J=z+1,re=M[J];if(0>c(B,P))J<N&&0>c(re,B)?(M[I]=re,M[J]=P,I=J):(M[I]=B,M[z]=P,I=z);else if(J<N&&0>c(re,P))M[I]=re,M[J]=P,I=J;else break e}}return j}function c(M,j){var P=M.sortIndex-j.sortIndex;return P!==0?P:M.id-j.id}if(f.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;f.unstable_now=function(){return u.now()}}else{var m=Date,h=m.now();f.unstable_now=function(){return m.now()-h}}var g=[],x=[],y=1,w=null,D=3,b=!1,v=!1,E=!1,A=!1,X=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,W=typeof setImmediate<"u"?setImmediate:null;function k(M){for(var j=s(x);j!==null;){if(j.callback===null)i(x);else if(j.startTime<=M)i(x),j.sortIndex=j.expirationTime,a(g,j);else break;j=s(x)}}function Z(M){if(E=!1,k(M),!v)if(s(g)!==null)v=!0,le||(le=!0,be());else{var j=s(x);j!==null&&V(Z,j.startTime-M)}}var le=!1,q=-1,se=5,te=-1;function Ce(){return A?!0:!(f.unstable_now()-te<se)}function ee(){if(A=!1,le){var M=f.unstable_now();te=M;var j=!0;try{e:{v=!1,E&&(E=!1,C(q),q=-1),b=!0;var P=D;try{t:{for(k(M),w=s(g);w!==null&&!(w.expirationTime>M&&Ce());){var I=w.callback;if(typeof I=="function"){w.callback=null,D=w.priorityLevel;var N=I(w.expirationTime<=M);if(M=f.unstable_now(),typeof N=="function"){w.callback=N,k(M),j=!0;break t}w===s(g)&&i(g),k(M)}else i(g);w=s(g)}if(w!==null)j=!0;else{var T=s(x);T!==null&&V(Z,T.startTime-M),j=!1}}break e}finally{w=null,D=P,b=!1}j=void 0}}finally{j?be():le=!1}}}var be;if(typeof W=="function")be=function(){W(ee)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,de=ae.port2;ae.port1.onmessage=ee,be=function(){de.postMessage(null)}}else be=function(){X(ee,0)};function V(M,j){q=X(function(){M(f.unstable_now())},j)}f.unstable_IdlePriority=5,f.unstable_ImmediatePriority=1,f.unstable_LowPriority=4,f.unstable_NormalPriority=3,f.unstable_Profiling=null,f.unstable_UserBlockingPriority=2,f.unstable_cancelCallback=function(M){M.callback=null},f.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):se=0<M?Math.floor(1e3/M):5},f.unstable_getCurrentPriorityLevel=function(){return D},f.unstable_next=function(M){switch(D){case 1:case 2:case 3:var j=3;break;default:j=D}var P=D;D=j;try{return M()}finally{D=P}},f.unstable_requestPaint=function(){A=!0},f.unstable_runWithPriority=function(M,j){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var P=D;D=M;try{return j()}finally{D=P}},f.unstable_scheduleCallback=function(M,j,P){var I=f.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?I+P:I):P=I,M){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=P+N,M={id:y++,callback:j,priorityLevel:M,startTime:P,expirationTime:N,sortIndex:-1},P>I?(M.sortIndex=P,a(x,M),s(g)===null&&M===s(x)&&(E?(C(q),q=-1):E=!0,V(Z,P-I))):(M.sortIndex=N,a(g,M),v||b||(v=!0,le||(le=!0,be()))),M},f.unstable_shouldYield=Ce,f.unstable_wrapCallback=function(M){var j=D;return function(){var P=D;D=j;try{return M.apply(this,arguments)}finally{D=P}}}}(Fo)),Fo}var L0;function ab(){return L0||(L0=1,$o.exports=tb()),$o.exports}var Bo={exports:{}},ft={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k0;function sb(){if(k0)return ft;k0=1;var f=Cu();function a(g){var x="https://react.dev/errors/"+g;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)x+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+g+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var i={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},c=Symbol.for("react.portal");function u(g,x,y){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:w==null?null:""+w,children:g,containerInfo:x,implementation:y}}var m=f.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(g,x){if(g==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return ft.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ft.createPortal=function(g,x){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(a(299));return u(g,x,null,y)},ft.flushSync=function(g){var x=m.T,y=i.p;try{if(m.T=null,i.p=2,g)return g()}finally{m.T=x,i.p=y,i.d.f()}},ft.preconnect=function(g,x){typeof g=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,i.d.C(g,x))},ft.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},ft.preinit=function(g,x){if(typeof g=="string"&&x&&typeof x.as=="string"){var y=x.as,w=h(y,x.crossOrigin),D=typeof x.integrity=="string"?x.integrity:void 0,b=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;y==="style"?i.d.S(g,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:w,integrity:D,fetchPriority:b}):y==="script"&&i.d.X(g,{crossOrigin:w,integrity:D,fetchPriority:b,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},ft.preinitModule=function(g,x){if(typeof g=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var y=h(x.as,x.crossOrigin);i.d.M(g,{crossOrigin:y,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&i.d.M(g)},ft.preload=function(g,x){if(typeof g=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var y=x.as,w=h(y,x.crossOrigin);i.d.L(g,y,{crossOrigin:w,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},ft.preloadModule=function(g,x){if(typeof g=="string")if(x){var y=h(x.as,x.crossOrigin);i.d.m(g,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:y,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else i.d.m(g)},ft.requestFormReset=function(g){i.d.r(g)},ft.unstable_batchedUpdates=function(g,x){return g(x)},ft.useFormState=function(g,x,y){return m.H.useFormState(g,x,y)},ft.useFormStatus=function(){return m.H.useHostTransitionStatus()},ft.version="19.1.0",ft}var $0;function nb(){if($0)return Bo.exports;$0=1;function f(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(f)}catch(a){console.error(a)}}return f(),Bo.exports=sb(),Bo.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F0;function rb(){if(F0)return hr;F0=1;var f=ab(),a=Cu(),s=nb();function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function m(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function h(e){if(u(e)!==e)throw Error(i(188))}function g(e){var t=e.alternate;if(!t){if(t=u(e),t===null)throw Error(i(188));return t!==e?null:e}for(var n=e,l=t;;){var o=n.return;if(o===null)break;var d=o.alternate;if(d===null){if(l=o.return,l!==null){n=l;continue}break}if(o.child===d.child){for(d=o.child;d;){if(d===n)return h(o),e;if(d===l)return h(o),t;d=d.sibling}throw Error(i(188))}if(n.return!==l.return)n=o,l=d;else{for(var p=!1,S=o.child;S;){if(S===n){p=!0,n=o,l=d;break}if(S===l){p=!0,l=o,n=d;break}S=S.sibling}if(!p){for(S=d.child;S;){if(S===n){p=!0,n=d,l=o;break}if(S===l){p=!0,l=d,n=o;break}S=S.sibling}if(!p)throw Error(i(189))}}if(n.alternate!==l)throw Error(i(190))}if(n.tag!==3)throw Error(i(188));return n.stateNode.current===n?e:t}function x(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=x(e),t!==null)return t;e=e.sibling}return null}var y=Object.assign,w=Symbol.for("react.element"),D=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),X=Symbol.for("react.provider"),C=Symbol.for("react.consumer"),W=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),q=Symbol.for("react.memo"),se=Symbol.for("react.lazy"),te=Symbol.for("react.activity"),Ce=Symbol.for("react.memo_cache_sentinel"),ee=Symbol.iterator;function be(e){return e===null||typeof e!="object"?null:(e=ee&&e[ee]||e["@@iterator"],typeof e=="function"?e:null)}var ae=Symbol.for("react.client.reference");function de(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ae?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case v:return"Fragment";case A:return"Profiler";case E:return"StrictMode";case Z:return"Suspense";case le:return"SuspenseList";case te:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case b:return"Portal";case W:return(e.displayName||"Context")+".Provider";case C:return(e._context.displayName||"Context")+".Consumer";case k:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case q:return t=e.displayName||null,t!==null?t:de(e.type)||"Memo";case se:t=e._payload,e=e._init;try{return de(e(t))}catch{}}return null}var V=Array.isArray,M=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P={pending:!1,data:null,method:null,action:null},I=[],N=-1;function T(e){return{current:e}}function z(e){0>N||(e.current=I[N],I[N]=null,N--)}function B(e,t){N++,I[N]=e.current,e.current=t}var J=T(null),re=T(null),ne=T(null),Re=T(null);function ge(e,t){switch(B(ne,t),B(re,e),B(J,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?i0(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=i0(t),e=l0(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}z(J),B(J,e)}function ue(){z(J),z(re),z(ne)}function xe(e){e.memoizedState!==null&&B(Re,e);var t=J.current,n=l0(t,e.type);t!==n&&(B(re,e),B(J,n))}function _e(e){re.current===e&&(z(J),z(re)),Re.current===e&&(z(Re),cr._currentValue=P)}var Qe=Object.prototype.hasOwnProperty,ye=f.unstable_scheduleCallback,et=f.unstable_cancelCallback,ku=f.unstable_shouldYield,gn=f.unstable_requestPaint,Ot=f.unstable_now,Cg=f.unstable_getCurrentPriorityLevel,$u=f.unstable_ImmediatePriority,Fu=f.unstable_UserBlockingPriority,Lr=f.unstable_NormalPriority,Tg=f.unstable_LowPriority,Bu=f.unstable_IdlePriority,_g=f.log,Mg=f.unstable_setDisableYieldValue,xn=null,Nt=null;function ja(e){if(typeof _g=="function"&&Mg(e),Nt&&typeof Nt.setStrictMode=="function")try{Nt.setStrictMode(xn,e)}catch{}}var St=Math.clz32?Math.clz32:Vg,Ig=Math.log,Og=Math.LN2;function Vg(e){return e>>>=0,e===0?32:31-(Ig(e)/Og|0)|0}var kr=256,$r=4194304;function Wa(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Fr(e,t,n){var l=e.pendingLanes;if(l===0)return 0;var o=0,d=e.suspendedLanes,p=e.pingedLanes;e=e.warmLanes;var S=l&134217727;return S!==0?(l=S&~d,l!==0?o=Wa(l):(p&=S,p!==0?o=Wa(p):n||(n=S&~e,n!==0&&(o=Wa(n))))):(S=l&~d,S!==0?o=Wa(S):p!==0?o=Wa(p):n||(n=l&~e,n!==0&&(o=Wa(n)))),o===0?0:t!==0&&t!==o&&(t&d)===0&&(d=o&-o,n=t&-t,d>=n||d===32&&(n&4194048)!==0)?t:o}function pn(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Ug(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pu(){var e=kr;return kr<<=1,(kr&4194048)===0&&(kr=256),e}function zu(){var e=$r;return $r<<=1,($r&62914560)===0&&($r=4194304),e}function El(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function bn(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Lg(e,t,n,l,o,d){var p=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var S=e.entanglements,R=e.expirationTimes,L=e.hiddenUpdates;for(n=p&~n;0<n;){var H=31-St(n),G=1<<H;S[H]=0,R[H]=-1;var $=L[H];if($!==null)for(L[H]=null,H=0;H<$.length;H++){var F=$[H];F!==null&&(F.lane&=-536870913)}n&=~G}l!==0&&qu(e,l,0),d!==0&&o===0&&e.tag!==0&&(e.suspendedLanes|=d&~(p&~t))}function qu(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var l=31-St(t);e.entangledLanes|=t,e.entanglements[l]=e.entanglements[l]|1073741824|n&4194090}function Hu(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var l=31-St(n),o=1<<l;o&t|e[l]&t&&(e[l]|=t),n&=~o}}function jl(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Dl(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Yu(){var e=j.p;return e!==0?e:(e=window.event,e===void 0?32:D0(e.type))}function kg(e,t){var n=j.p;try{return j.p=e,t()}finally{j.p=n}}var Da=Math.random().toString(36).slice(2),ut="__reactFiber$"+Da,xt="__reactProps$"+Da,vs="__reactContainer$"+Da,Rl="__reactEvents$"+Da,$g="__reactListeners$"+Da,Fg="__reactHandles$"+Da,Gu="__reactResources$"+Da,yn="__reactMarker$"+Da;function Al(e){delete e[ut],delete e[xt],delete e[Rl],delete e[$g],delete e[Fg]}function Ns(e){var t=e[ut];if(t)return t;for(var n=e.parentNode;n;){if(t=n[vs]||n[ut]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=d0(e);e!==null;){if(n=e[ut])return n;e=d0(e)}return t}e=n,n=e.parentNode}return null}function Ss(e){if(e=e[ut]||e[vs]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function vn(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(i(33))}function ws(e){var t=e[Gu];return t||(t=e[Gu]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function tt(e){e[yn]=!0}var Xu=new Set,Ku={};function es(e,t){Es(e,t),Es(e+"Capture",t)}function Es(e,t){for(Ku[e]=t,e=0;e<t.length;e++)Xu.add(t[e])}var Bg=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Zu={},Qu={};function Pg(e){return Qe.call(Qu,e)?!0:Qe.call(Zu,e)?!1:Bg.test(e)?Qu[e]=!0:(Zu[e]=!0,!1)}function Br(e,t,n){if(Pg(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var l=t.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function Pr(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function la(e,t,n,l){if(l===null)e.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+l)}}var Cl,Ju;function js(e){if(Cl===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Cl=t&&t[1]||"",Ju=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Cl+e+Ju}var Tl=!1;function _l(e,t){if(!e||Tl)return"";Tl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(t){var G=function(){throw Error()};if(Object.defineProperty(G.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(G,[])}catch(F){var $=F}Reflect.construct(e,[],G)}else{try{G.call()}catch(F){$=F}e.call(G.prototype)}}else{try{throw Error()}catch(F){$=F}(G=e())&&typeof G.catch=="function"&&G.catch(function(){})}}catch(F){if(F&&$&&typeof F.stack=="string")return[F.stack,$.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var o=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");o&&o.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var d=l.DetermineComponentFrameRoot(),p=d[0],S=d[1];if(p&&S){var R=p.split(`
`),L=S.split(`
`);for(o=l=0;l<R.length&&!R[l].includes("DetermineComponentFrameRoot");)l++;for(;o<L.length&&!L[o].includes("DetermineComponentFrameRoot");)o++;if(l===R.length||o===L.length)for(l=R.length-1,o=L.length-1;1<=l&&0<=o&&R[l]!==L[o];)o--;for(;1<=l&&0<=o;l--,o--)if(R[l]!==L[o]){if(l!==1||o!==1)do if(l--,o--,0>o||R[l]!==L[o]){var H=`
`+R[l].replace(" at new "," at ");return e.displayName&&H.includes("<anonymous>")&&(H=H.replace("<anonymous>",e.displayName)),H}while(1<=l&&0<=o);break}}}finally{Tl=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?js(n):""}function zg(e){switch(e.tag){case 26:case 27:case 5:return js(e.type);case 16:return js("Lazy");case 13:return js("Suspense");case 19:return js("SuspenseList");case 0:case 15:return _l(e.type,!1);case 11:return _l(e.type.render,!1);case 1:return _l(e.type,!0);case 31:return js("Activity");default:return""}}function Wu(e){try{var t="";do t+=zg(e),e=e.return;while(e);return t}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function Vt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ed(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function qg(e){var t=ed(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),l=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,d=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(p){l=""+p,d.call(this,p)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return l},setValue:function(p){l=""+p},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function zr(e){e._valueTracker||(e._valueTracker=qg(e))}function td(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),l="";return e&&(l=ed(e)?e.checked?"true":"false":e.value),e=l,e!==n?(t.setValue(e),!0):!1}function qr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Hg=/[\n"\\]/g;function Ut(e){return e.replace(Hg,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Ml(e,t,n,l,o,d,p,S){e.name="",p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"?e.type=p:e.removeAttribute("type"),t!=null?p==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Vt(t)):e.value!==""+Vt(t)&&(e.value=""+Vt(t)):p!=="submit"&&p!=="reset"||e.removeAttribute("value"),t!=null?Il(e,p,Vt(t)):n!=null?Il(e,p,Vt(n)):l!=null&&e.removeAttribute("value"),o==null&&d!=null&&(e.defaultChecked=!!d),o!=null&&(e.checked=o&&typeof o!="function"&&typeof o!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?e.name=""+Vt(S):e.removeAttribute("name")}function ad(e,t,n,l,o,d,p,S){if(d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"&&(e.type=d),t!=null||n!=null){if(!(d!=="submit"&&d!=="reset"||t!=null))return;n=n!=null?""+Vt(n):"",t=t!=null?""+Vt(t):n,S||t===e.value||(e.value=t),e.defaultValue=t}l=l??o,l=typeof l!="function"&&typeof l!="symbol"&&!!l,e.checked=S?e.checked:!!l,e.defaultChecked=!!l,p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(e.name=p)}function Il(e,t,n){t==="number"&&qr(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function Ds(e,t,n,l){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&l&&(e[n].defaultSelected=!0)}else{for(n=""+Vt(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,l&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function sd(e,t,n){if(t!=null&&(t=""+Vt(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+Vt(n):""}function nd(e,t,n,l){if(t==null){if(l!=null){if(n!=null)throw Error(i(92));if(V(l)){if(1<l.length)throw Error(i(93));l=l[0]}n=l}n==null&&(n=""),t=n}n=Vt(t),e.defaultValue=n,l=e.textContent,l===n&&l!==""&&l!==null&&(e.value=l)}function Rs(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Yg=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function rd(e,t,n){var l=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?l?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":l?e.setProperty(t,n):typeof n!="number"||n===0||Yg.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function id(e,t,n){if(t!=null&&typeof t!="object")throw Error(i(62));if(e=e.style,n!=null){for(var l in n)!n.hasOwnProperty(l)||t!=null&&t.hasOwnProperty(l)||(l.indexOf("--")===0?e.setProperty(l,""):l==="float"?e.cssFloat="":e[l]="");for(var o in t)l=t[o],t.hasOwnProperty(o)&&n[o]!==l&&rd(e,o,l)}else for(var d in t)t.hasOwnProperty(d)&&rd(e,d,t[d])}function Ol(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gg=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Xg=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Hr(e){return Xg.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Vl=null;function Ul(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var As=null,Cs=null;function ld(e){var t=Ss(e);if(t&&(e=t.stateNode)){var n=e[xt]||null;e:switch(e=t.stateNode,t.type){case"input":if(Ml(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Ut(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var l=n[t];if(l!==e&&l.form===e.form){var o=l[xt]||null;if(!o)throw Error(i(90));Ml(l,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name)}}for(t=0;t<n.length;t++)l=n[t],l.form===e.form&&td(l)}break e;case"textarea":sd(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&Ds(e,!!n.multiple,t,!1)}}}var Ll=!1;function cd(e,t,n){if(Ll)return e(t,n);Ll=!0;try{var l=e(t);return l}finally{if(Ll=!1,(As!==null||Cs!==null)&&(Ti(),As&&(t=As,e=Cs,Cs=As=null,ld(t),e)))for(t=0;t<e.length;t++)ld(e[t])}}function Nn(e,t){var n=e.stateNode;if(n===null)return null;var l=n[xt]||null;if(l===null)return null;n=l[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(i(231,t,typeof n));return n}var ca=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kl=!1;if(ca)try{var Sn={};Object.defineProperty(Sn,"passive",{get:function(){kl=!0}}),window.addEventListener("test",Sn,Sn),window.removeEventListener("test",Sn,Sn)}catch{kl=!1}var Ra=null,$l=null,Yr=null;function od(){if(Yr)return Yr;var e,t=$l,n=t.length,l,o="value"in Ra?Ra.value:Ra.textContent,d=o.length;for(e=0;e<n&&t[e]===o[e];e++);var p=n-e;for(l=1;l<=p&&t[n-l]===o[d-l];l++);return Yr=o.slice(e,1<l?1-l:void 0)}function Gr(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Xr(){return!0}function ud(){return!1}function pt(e){function t(n,l,o,d,p){this._reactName=n,this._targetInst=o,this.type=l,this.nativeEvent=d,this.target=p,this.currentTarget=null;for(var S in e)e.hasOwnProperty(S)&&(n=e[S],this[S]=n?n(d):d[S]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?Xr:ud,this.isPropagationStopped=ud,this}return y(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Xr)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Xr)},persist:function(){},isPersistent:Xr}),t}var ts={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kr=pt(ts),wn=y({},ts,{view:0,detail:0}),Kg=pt(wn),Fl,Bl,En,Zr=y({},wn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==En&&(En&&e.type==="mousemove"?(Fl=e.screenX-En.screenX,Bl=e.screenY-En.screenY):Bl=Fl=0,En=e),Fl)},movementY:function(e){return"movementY"in e?e.movementY:Bl}}),dd=pt(Zr),Zg=y({},Zr,{dataTransfer:0}),Qg=pt(Zg),Jg=y({},wn,{relatedTarget:0}),Pl=pt(Jg),Wg=y({},ts,{animationName:0,elapsedTime:0,pseudoElement:0}),ex=pt(Wg),tx=y({},ts,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ax=pt(tx),sx=y({},ts,{data:0}),fd=pt(sx),nx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ix={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lx(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ix[e])?!!t[e]:!1}function zl(){return lx}var cx=y({},wn,{key:function(e){if(e.key){var t=nx[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Gr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?rx[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zl,charCode:function(e){return e.type==="keypress"?Gr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Gr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ox=pt(cx),ux=y({},Zr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),md=pt(ux),dx=y({},wn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zl}),fx=pt(dx),mx=y({},ts,{propertyName:0,elapsedTime:0,pseudoElement:0}),hx=pt(mx),gx=y({},Zr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),xx=pt(gx),px=y({},ts,{newState:0,oldState:0}),bx=pt(px),yx=[9,13,27,32],ql=ca&&"CompositionEvent"in window,jn=null;ca&&"documentMode"in document&&(jn=document.documentMode);var vx=ca&&"TextEvent"in window&&!jn,hd=ca&&(!ql||jn&&8<jn&&11>=jn),gd=" ",xd=!1;function pd(e,t){switch(e){case"keyup":return yx.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ts=!1;function Nx(e,t){switch(e){case"compositionend":return bd(t);case"keypress":return t.which!==32?null:(xd=!0,gd);case"textInput":return e=t.data,e===gd&&xd?null:e;default:return null}}function Sx(e,t){if(Ts)return e==="compositionend"||!ql&&pd(e,t)?(e=od(),Yr=$l=Ra=null,Ts=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return hd&&t.locale!=="ko"?null:t.data;default:return null}}var wx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!wx[e.type]:t==="textarea"}function vd(e,t,n,l){As?Cs?Cs.push(l):Cs=[l]:As=l,t=Ui(t,"onChange"),0<t.length&&(n=new Kr("onChange","change",null,n,l),e.push({event:n,listeners:t}))}var Dn=null,Rn=null;function Ex(e){t0(e,0)}function Qr(e){var t=vn(e);if(td(t))return e}function Nd(e,t){if(e==="change")return t}var Sd=!1;if(ca){var Hl;if(ca){var Yl="oninput"in document;if(!Yl){var wd=document.createElement("div");wd.setAttribute("oninput","return;"),Yl=typeof wd.oninput=="function"}Hl=Yl}else Hl=!1;Sd=Hl&&(!document.documentMode||9<document.documentMode)}function Ed(){Dn&&(Dn.detachEvent("onpropertychange",jd),Rn=Dn=null)}function jd(e){if(e.propertyName==="value"&&Qr(Rn)){var t=[];vd(t,Rn,e,Ul(e)),cd(Ex,t)}}function jx(e,t,n){e==="focusin"?(Ed(),Dn=t,Rn=n,Dn.attachEvent("onpropertychange",jd)):e==="focusout"&&Ed()}function Dx(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Qr(Rn)}function Rx(e,t){if(e==="click")return Qr(t)}function Ax(e,t){if(e==="input"||e==="change")return Qr(t)}function Cx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var wt=typeof Object.is=="function"?Object.is:Cx;function An(e,t){if(wt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),l=Object.keys(t);if(n.length!==l.length)return!1;for(l=0;l<n.length;l++){var o=n[l];if(!Qe.call(t,o)||!wt(e[o],t[o]))return!1}return!0}function Dd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Rd(e,t){var n=Dd(e);e=0;for(var l;n;){if(n.nodeType===3){if(l=e+n.textContent.length,e<=t&&l>=t)return{node:n,offset:t-e};e=l}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Dd(n)}}function Ad(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ad(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Cd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=qr(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=qr(e.document)}return t}function Gl(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Tx=ca&&"documentMode"in document&&11>=document.documentMode,_s=null,Xl=null,Cn=null,Kl=!1;function Td(e,t,n){var l=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Kl||_s==null||_s!==qr(l)||(l=_s,"selectionStart"in l&&Gl(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Cn&&An(Cn,l)||(Cn=l,l=Ui(Xl,"onSelect"),0<l.length&&(t=new Kr("onSelect","select",null,t,n),e.push({event:t,listeners:l}),t.target=_s)))}function as(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ms={animationend:as("Animation","AnimationEnd"),animationiteration:as("Animation","AnimationIteration"),animationstart:as("Animation","AnimationStart"),transitionrun:as("Transition","TransitionRun"),transitionstart:as("Transition","TransitionStart"),transitioncancel:as("Transition","TransitionCancel"),transitionend:as("Transition","TransitionEnd")},Zl={},_d={};ca&&(_d=document.createElement("div").style,"AnimationEvent"in window||(delete Ms.animationend.animation,delete Ms.animationiteration.animation,delete Ms.animationstart.animation),"TransitionEvent"in window||delete Ms.transitionend.transition);function ss(e){if(Zl[e])return Zl[e];if(!Ms[e])return e;var t=Ms[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in _d)return Zl[e]=t[n];return e}var Md=ss("animationend"),Id=ss("animationiteration"),Od=ss("animationstart"),_x=ss("transitionrun"),Mx=ss("transitionstart"),Ix=ss("transitioncancel"),Vd=ss("transitionend"),Ud=new Map,Ql="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ql.push("scrollEnd");function Gt(e,t){Ud.set(e,t),es(t,[e])}var Ld=new WeakMap;function Lt(e,t){if(typeof e=="object"&&e!==null){var n=Ld.get(e);return n!==void 0?n:(t={value:e,source:t,stack:Wu(t)},Ld.set(e,t),t)}return{value:e,source:t,stack:Wu(t)}}var kt=[],Is=0,Jl=0;function Jr(){for(var e=Is,t=Jl=Is=0;t<e;){var n=kt[t];kt[t++]=null;var l=kt[t];kt[t++]=null;var o=kt[t];kt[t++]=null;var d=kt[t];if(kt[t++]=null,l!==null&&o!==null){var p=l.pending;p===null?o.next=o:(o.next=p.next,p.next=o),l.pending=o}d!==0&&kd(n,o,d)}}function Wr(e,t,n,l){kt[Is++]=e,kt[Is++]=t,kt[Is++]=n,kt[Is++]=l,Jl|=l,e.lanes|=l,e=e.alternate,e!==null&&(e.lanes|=l)}function Wl(e,t,n,l){return Wr(e,t,n,l),ei(e)}function Os(e,t){return Wr(e,null,null,t),ei(e)}function kd(e,t,n){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n);for(var o=!1,d=e.return;d!==null;)d.childLanes|=n,l=d.alternate,l!==null&&(l.childLanes|=n),d.tag===22&&(e=d.stateNode,e===null||e._visibility&1||(o=!0)),e=d,d=d.return;return e.tag===3?(d=e.stateNode,o&&t!==null&&(o=31-St(n),e=d.hiddenUpdates,l=e[o],l===null?e[o]=[t]:l.push(t),t.lane=n|536870912),d):null}function ei(e){if(50<er)throw er=0,ro=null,Error(i(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Vs={};function Ox(e,t,n,l){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Et(e,t,n,l){return new Ox(e,t,n,l)}function ec(e){return e=e.prototype,!(!e||!e.isReactComponent)}function oa(e,t){var n=e.alternate;return n===null?(n=Et(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function $d(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function ti(e,t,n,l,o,d){var p=0;if(l=e,typeof e=="function")ec(e)&&(p=1);else if(typeof e=="string")p=Up(e,n,J.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case te:return e=Et(31,n,t,o),e.elementType=te,e.lanes=d,e;case v:return ns(n.children,o,d,t);case E:p=8,o|=24;break;case A:return e=Et(12,n,t,o|2),e.elementType=A,e.lanes=d,e;case Z:return e=Et(13,n,t,o),e.elementType=Z,e.lanes=d,e;case le:return e=Et(19,n,t,o),e.elementType=le,e.lanes=d,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case X:case W:p=10;break e;case C:p=9;break e;case k:p=11;break e;case q:p=14;break e;case se:p=16,l=null;break e}p=29,n=Error(i(130,e===null?"null":typeof e,"")),l=null}return t=Et(p,n,t,o),t.elementType=e,t.type=l,t.lanes=d,t}function ns(e,t,n,l){return e=Et(7,e,l,t),e.lanes=n,e}function tc(e,t,n){return e=Et(6,e,null,t),e.lanes=n,e}function ac(e,t,n){return t=Et(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Us=[],Ls=0,ai=null,si=0,$t=[],Ft=0,rs=null,ua=1,da="";function is(e,t){Us[Ls++]=si,Us[Ls++]=ai,ai=e,si=t}function Fd(e,t,n){$t[Ft++]=ua,$t[Ft++]=da,$t[Ft++]=rs,rs=e;var l=ua;e=da;var o=32-St(l)-1;l&=~(1<<o),n+=1;var d=32-St(t)+o;if(30<d){var p=o-o%5;d=(l&(1<<p)-1).toString(32),l>>=p,o-=p,ua=1<<32-St(t)+o|n<<o|l,da=d+e}else ua=1<<d|n<<o|l,da=e}function sc(e){e.return!==null&&(is(e,1),Fd(e,1,0))}function nc(e){for(;e===ai;)ai=Us[--Ls],Us[Ls]=null,si=Us[--Ls],Us[Ls]=null;for(;e===rs;)rs=$t[--Ft],$t[Ft]=null,da=$t[--Ft],$t[Ft]=null,ua=$t[--Ft],$t[Ft]=null}var ht=null,qe=null,Me=!1,ls=null,ea=!1,rc=Error(i(519));function cs(e){var t=Error(i(418,""));throw Mn(Lt(t,e)),rc}function Bd(e){var t=e.stateNode,n=e.type,l=e.memoizedProps;switch(t[ut]=e,t[xt]=l,n){case"dialog":je("cancel",t),je("close",t);break;case"iframe":case"object":case"embed":je("load",t);break;case"video":case"audio":for(n=0;n<ar.length;n++)je(ar[n],t);break;case"source":je("error",t);break;case"img":case"image":case"link":je("error",t),je("load",t);break;case"details":je("toggle",t);break;case"input":je("invalid",t),ad(t,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0),zr(t);break;case"select":je("invalid",t);break;case"textarea":je("invalid",t),nd(t,l.value,l.defaultValue,l.children),zr(t)}n=l.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||l.suppressHydrationWarning===!0||r0(t.textContent,n)?(l.popover!=null&&(je("beforetoggle",t),je("toggle",t)),l.onScroll!=null&&je("scroll",t),l.onScrollEnd!=null&&je("scrollend",t),l.onClick!=null&&(t.onclick=Li),t=!0):t=!1,t||cs(e)}function Pd(e){for(ht=e.return;ht;)switch(ht.tag){case 5:case 13:ea=!1;return;case 27:case 3:ea=!0;return;default:ht=ht.return}}function Tn(e){if(e!==ht)return!1;if(!Me)return Pd(e),Me=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||So(e.type,e.memoizedProps)),n=!n),n&&qe&&cs(e),Pd(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(n=e.data,n==="/$"){if(t===0){qe=Kt(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++;e=e.nextSibling}qe=null}}else t===27?(t=qe,za(e.type)?(e=Do,Do=null,qe=e):qe=t):qe=ht?Kt(e.stateNode.nextSibling):null;return!0}function _n(){qe=ht=null,Me=!1}function zd(){var e=ls;return e!==null&&(vt===null?vt=e:vt.push.apply(vt,e),ls=null),e}function Mn(e){ls===null?ls=[e]:ls.push(e)}var ic=T(null),os=null,fa=null;function Aa(e,t,n){B(ic,t._currentValue),t._currentValue=n}function ma(e){e._currentValue=ic.current,z(ic)}function lc(e,t,n){for(;e!==null;){var l=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,l!==null&&(l.childLanes|=t)):l!==null&&(l.childLanes&t)!==t&&(l.childLanes|=t),e===n)break;e=e.return}}function cc(e,t,n,l){var o=e.child;for(o!==null&&(o.return=e);o!==null;){var d=o.dependencies;if(d!==null){var p=o.child;d=d.firstContext;e:for(;d!==null;){var S=d;d=o;for(var R=0;R<t.length;R++)if(S.context===t[R]){d.lanes|=n,S=d.alternate,S!==null&&(S.lanes|=n),lc(d.return,n,e),l||(p=null);break e}d=S.next}}else if(o.tag===18){if(p=o.return,p===null)throw Error(i(341));p.lanes|=n,d=p.alternate,d!==null&&(d.lanes|=n),lc(p,n,e),p=null}else p=o.child;if(p!==null)p.return=o;else for(p=o;p!==null;){if(p===e){p=null;break}if(o=p.sibling,o!==null){o.return=p.return,p=o;break}p=p.return}o=p}}function In(e,t,n,l){e=null;for(var o=t,d=!1;o!==null;){if(!d){if((o.flags&524288)!==0)d=!0;else if((o.flags&262144)!==0)break}if(o.tag===10){var p=o.alternate;if(p===null)throw Error(i(387));if(p=p.memoizedProps,p!==null){var S=o.type;wt(o.pendingProps.value,p.value)||(e!==null?e.push(S):e=[S])}}else if(o===Re.current){if(p=o.alternate,p===null)throw Error(i(387));p.memoizedState.memoizedState!==o.memoizedState.memoizedState&&(e!==null?e.push(cr):e=[cr])}o=o.return}e!==null&&cc(t,e,n,l),t.flags|=262144}function ni(e){for(e=e.firstContext;e!==null;){if(!wt(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function us(e){os=e,fa=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function dt(e){return qd(os,e)}function ri(e,t){return os===null&&us(e),qd(e,t)}function qd(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},fa===null){if(e===null)throw Error(i(308));fa=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else fa=fa.next=t;return n}var Vx=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,l){e.push(l)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Ux=f.unstable_scheduleCallback,Lx=f.unstable_NormalPriority,Je={$$typeof:W,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function oc(){return{controller:new Vx,data:new Map,refCount:0}}function On(e){e.refCount--,e.refCount===0&&Ux(Lx,function(){e.controller.abort()})}var Vn=null,uc=0,ks=0,$s=null;function kx(e,t){if(Vn===null){var n=Vn=[];uc=0,ks=mo(),$s={status:"pending",value:void 0,then:function(l){n.push(l)}}}return uc++,t.then(Hd,Hd),t}function Hd(){if(--uc===0&&Vn!==null){$s!==null&&($s.status="fulfilled");var e=Vn;Vn=null,ks=0,$s=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function $x(e,t){var n=[],l={status:"pending",value:null,reason:null,then:function(o){n.push(o)}};return e.then(function(){l.status="fulfilled",l.value=t;for(var o=0;o<n.length;o++)(0,n[o])(t)},function(o){for(l.status="rejected",l.reason=o,o=0;o<n.length;o++)(0,n[o])(void 0)}),l}var Yd=M.S;M.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&kx(e,t),Yd!==null&&Yd(e,t)};var ds=T(null);function dc(){var e=ds.current;return e!==null?e:$e.pooledCache}function ii(e,t){t===null?B(ds,ds.current):B(ds,t.pool)}function Gd(){var e=dc();return e===null?null:{parent:Je._currentValue,pool:e}}var Un=Error(i(460)),Xd=Error(i(474)),li=Error(i(542)),fc={then:function(){}};function Kd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function ci(){}function Zd(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(ci,ci),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Jd(e),e;default:if(typeof t.status=="string")t.then(ci,ci);else{if(e=$e,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=t,e.status="pending",e.then(function(l){if(t.status==="pending"){var o=t;o.status="fulfilled",o.value=l}},function(l){if(t.status==="pending"){var o=t;o.status="rejected",o.reason=l}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Jd(e),e}throw Ln=t,Un}}var Ln=null;function Qd(){if(Ln===null)throw Error(i(459));var e=Ln;return Ln=null,e}function Jd(e){if(e===Un||e===li)throw Error(i(483))}var Ca=!1;function mc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function hc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Ta(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function _a(e,t,n){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(Ie&2)!==0){var o=l.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),l.pending=t,t=ei(e),kd(e,null,n),t}return Wr(e,l,t,n),ei(e)}function kn(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var l=t.lanes;l&=e.pendingLanes,n|=l,t.lanes=n,Hu(e,n)}}function gc(e,t){var n=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,n===l)){var o=null,d=null;if(n=n.firstBaseUpdate,n!==null){do{var p={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};d===null?o=d=p:d=d.next=p,n=n.next}while(n!==null);d===null?o=d=t:d=d.next=t}else o=d=t;n={baseState:l.baseState,firstBaseUpdate:o,lastBaseUpdate:d,shared:l.shared,callbacks:l.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var xc=!1;function $n(){if(xc){var e=$s;if(e!==null)throw e}}function Fn(e,t,n,l){xc=!1;var o=e.updateQueue;Ca=!1;var d=o.firstBaseUpdate,p=o.lastBaseUpdate,S=o.shared.pending;if(S!==null){o.shared.pending=null;var R=S,L=R.next;R.next=null,p===null?d=L:p.next=L,p=R;var H=e.alternate;H!==null&&(H=H.updateQueue,S=H.lastBaseUpdate,S!==p&&(S===null?H.firstBaseUpdate=L:S.next=L,H.lastBaseUpdate=R))}if(d!==null){var G=o.baseState;p=0,H=L=R=null,S=d;do{var $=S.lane&-536870913,F=$!==S.lane;if(F?(Ae&$)===$:(l&$)===$){$!==0&&$===ks&&(xc=!0),H!==null&&(H=H.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var he=e,fe=S;$=t;var Le=n;switch(fe.tag){case 1:if(he=fe.payload,typeof he=="function"){G=he.call(Le,G,$);break e}G=he;break e;case 3:he.flags=he.flags&-65537|128;case 0:if(he=fe.payload,$=typeof he=="function"?he.call(Le,G,$):he,$==null)break e;G=y({},G,$);break e;case 2:Ca=!0}}$=S.callback,$!==null&&(e.flags|=64,F&&(e.flags|=8192),F=o.callbacks,F===null?o.callbacks=[$]:F.push($))}else F={lane:$,tag:S.tag,payload:S.payload,callback:S.callback,next:null},H===null?(L=H=F,R=G):H=H.next=F,p|=$;if(S=S.next,S===null){if(S=o.shared.pending,S===null)break;F=S,S=F.next,F.next=null,o.lastBaseUpdate=F,o.shared.pending=null}}while(!0);H===null&&(R=G),o.baseState=R,o.firstBaseUpdate=L,o.lastBaseUpdate=H,d===null&&(o.shared.lanes=0),$a|=p,e.lanes=p,e.memoizedState=G}}function Wd(e,t){if(typeof e!="function")throw Error(i(191,e));e.call(t)}function ef(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Wd(n[e],t)}var Fs=T(null),oi=T(0);function tf(e,t){e=va,B(oi,e),B(Fs,t),va=e|t.baseLanes}function pc(){B(oi,va),B(Fs,Fs.current)}function bc(){va=oi.current,z(Fs),z(oi)}var Ma=0,Ne=null,Ve=null,Xe=null,ui=!1,Bs=!1,fs=!1,di=0,Bn=0,Ps=null,Fx=0;function Ye(){throw Error(i(321))}function yc(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!wt(e[n],t[n]))return!1;return!0}function vc(e,t,n,l,o,d){return Ma=d,Ne=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,M.H=e===null||e.memoizedState===null?$f:Ff,fs=!1,d=n(l,o),fs=!1,Bs&&(d=sf(t,n,l,o)),af(e),d}function af(e){M.H=pi;var t=Ve!==null&&Ve.next!==null;if(Ma=0,Xe=Ve=Ne=null,ui=!1,Bn=0,Ps=null,t)throw Error(i(300));e===null||at||(e=e.dependencies,e!==null&&ni(e)&&(at=!0))}function sf(e,t,n,l){Ne=e;var o=0;do{if(Bs&&(Ps=null),Bn=0,Bs=!1,25<=o)throw Error(i(301));if(o+=1,Xe=Ve=null,e.updateQueue!=null){var d=e.updateQueue;d.lastEffect=null,d.events=null,d.stores=null,d.memoCache!=null&&(d.memoCache.index=0)}M.H=Gx,d=t(n,l)}while(Bs);return d}function Bx(){var e=M.H,t=e.useState()[0];return t=typeof t.then=="function"?Pn(t):t,e=e.useState()[0],(Ve!==null?Ve.memoizedState:null)!==e&&(Ne.flags|=1024),t}function Nc(){var e=di!==0;return di=0,e}function Sc(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function wc(e){if(ui){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}ui=!1}Ma=0,Xe=Ve=Ne=null,Bs=!1,Bn=di=0,Ps=null}function bt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xe===null?Ne.memoizedState=Xe=e:Xe=Xe.next=e,Xe}function Ke(){if(Ve===null){var e=Ne.alternate;e=e!==null?e.memoizedState:null}else e=Ve.next;var t=Xe===null?Ne.memoizedState:Xe.next;if(t!==null)Xe=t,Ve=e;else{if(e===null)throw Ne.alternate===null?Error(i(467)):Error(i(310));Ve=e,e={memoizedState:Ve.memoizedState,baseState:Ve.baseState,baseQueue:Ve.baseQueue,queue:Ve.queue,next:null},Xe===null?Ne.memoizedState=Xe=e:Xe=Xe.next=e}return Xe}function Ec(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Pn(e){var t=Bn;return Bn+=1,Ps===null&&(Ps=[]),e=Zd(Ps,e,t),t=Ne,(Xe===null?t.memoizedState:Xe.next)===null&&(t=t.alternate,M.H=t===null||t.memoizedState===null?$f:Ff),e}function fi(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Pn(e);if(e.$$typeof===W)return dt(e)}throw Error(i(438,String(e)))}function jc(e){var t=null,n=Ne.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var l=Ne.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(t={data:l.data.map(function(o){return o.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Ec(),Ne.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),l=0;l<e;l++)n[l]=Ce;return t.index++,n}function ha(e,t){return typeof t=="function"?t(e):t}function mi(e){var t=Ke();return Dc(t,Ve,e)}function Dc(e,t,n){var l=e.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=n;var o=e.baseQueue,d=l.pending;if(d!==null){if(o!==null){var p=o.next;o.next=d.next,d.next=p}t.baseQueue=o=d,l.pending=null}if(d=e.baseState,o===null)e.memoizedState=d;else{t=o.next;var S=p=null,R=null,L=t,H=!1;do{var G=L.lane&-536870913;if(G!==L.lane?(Ae&G)===G:(Ma&G)===G){var $=L.revertLane;if($===0)R!==null&&(R=R.next={lane:0,revertLane:0,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null}),G===ks&&(H=!0);else if((Ma&$)===$){L=L.next,$===ks&&(H=!0);continue}else G={lane:0,revertLane:L.revertLane,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null},R===null?(S=R=G,p=d):R=R.next=G,Ne.lanes|=$,$a|=$;G=L.action,fs&&n(d,G),d=L.hasEagerState?L.eagerState:n(d,G)}else $={lane:G,revertLane:L.revertLane,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null},R===null?(S=R=$,p=d):R=R.next=$,Ne.lanes|=G,$a|=G;L=L.next}while(L!==null&&L!==t);if(R===null?p=d:R.next=S,!wt(d,e.memoizedState)&&(at=!0,H&&(n=$s,n!==null)))throw n;e.memoizedState=d,e.baseState=p,e.baseQueue=R,l.lastRenderedState=d}return o===null&&(l.lanes=0),[e.memoizedState,l.dispatch]}function Rc(e){var t=Ke(),n=t.queue;if(n===null)throw Error(i(311));n.lastRenderedReducer=e;var l=n.dispatch,o=n.pending,d=t.memoizedState;if(o!==null){n.pending=null;var p=o=o.next;do d=e(d,p.action),p=p.next;while(p!==o);wt(d,t.memoizedState)||(at=!0),t.memoizedState=d,t.baseQueue===null&&(t.baseState=d),n.lastRenderedState=d}return[d,l]}function nf(e,t,n){var l=Ne,o=Ke(),d=Me;if(d){if(n===void 0)throw Error(i(407));n=n()}else n=t();var p=!wt((Ve||o).memoizedState,n);p&&(o.memoizedState=n,at=!0),o=o.queue;var S=cf.bind(null,l,o,e);if(zn(2048,8,S,[e]),o.getSnapshot!==t||p||Xe!==null&&Xe.memoizedState.tag&1){if(l.flags|=2048,zs(9,hi(),lf.bind(null,l,o,n,t),null),$e===null)throw Error(i(349));d||(Ma&124)!==0||rf(l,t,n)}return n}function rf(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ne.updateQueue,t===null?(t=Ec(),Ne.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function lf(e,t,n,l){t.value=n,t.getSnapshot=l,of(t)&&uf(e)}function cf(e,t,n){return n(function(){of(t)&&uf(e)})}function of(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!wt(e,n)}catch{return!0}}function uf(e){var t=Os(e,2);t!==null&&Ct(t,e,2)}function Ac(e){var t=bt();if(typeof e=="function"){var n=e;if(e=n(),fs){ja(!0);try{n()}finally{ja(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ha,lastRenderedState:e},t}function df(e,t,n,l){return e.baseState=n,Dc(e,Ve,typeof l=="function"?l:ha)}function Px(e,t,n,l,o){if(xi(e))throw Error(i(485));if(e=t.action,e!==null){var d={payload:o,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(p){d.listeners.push(p)}};M.T!==null?n(!0):d.isTransition=!1,l(d),n=t.pending,n===null?(d.next=t.pending=d,ff(t,d)):(d.next=n.next,t.pending=n.next=d)}}function ff(e,t){var n=t.action,l=t.payload,o=e.state;if(t.isTransition){var d=M.T,p={};M.T=p;try{var S=n(o,l),R=M.S;R!==null&&R(p,S),mf(e,t,S)}catch(L){Cc(e,t,L)}finally{M.T=d}}else try{d=n(o,l),mf(e,t,d)}catch(L){Cc(e,t,L)}}function mf(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(l){hf(e,t,l)},function(l){return Cc(e,t,l)}):hf(e,t,n)}function hf(e,t,n){t.status="fulfilled",t.value=n,gf(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,ff(e,n)))}function Cc(e,t,n){var l=e.pending;if(e.pending=null,l!==null){l=l.next;do t.status="rejected",t.reason=n,gf(t),t=t.next;while(t!==l)}e.action=null}function gf(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function xf(e,t){return t}function pf(e,t){if(Me){var n=$e.formState;if(n!==null){e:{var l=Ne;if(Me){if(qe){t:{for(var o=qe,d=ea;o.nodeType!==8;){if(!d){o=null;break t}if(o=Kt(o.nextSibling),o===null){o=null;break t}}d=o.data,o=d==="F!"||d==="F"?o:null}if(o){qe=Kt(o.nextSibling),l=o.data==="F!";break e}}cs(l)}l=!1}l&&(t=n[0])}}return n=bt(),n.memoizedState=n.baseState=t,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xf,lastRenderedState:t},n.queue=l,n=Uf.bind(null,Ne,l),l.dispatch=n,l=Ac(!1),d=Oc.bind(null,Ne,!1,l.queue),l=bt(),o={state:t,dispatch:null,action:e,pending:null},l.queue=o,n=Px.bind(null,Ne,o,d,n),o.dispatch=n,l.memoizedState=e,[t,n,!1]}function bf(e){var t=Ke();return yf(t,Ve,e)}function yf(e,t,n){if(t=Dc(e,t,xf)[0],e=mi(ha)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var l=Pn(t)}catch(p){throw p===Un?li:p}else l=t;t=Ke();var o=t.queue,d=o.dispatch;return n!==t.memoizedState&&(Ne.flags|=2048,zs(9,hi(),zx.bind(null,o,n),null)),[l,d,e]}function zx(e,t){e.action=t}function vf(e){var t=Ke(),n=Ve;if(n!==null)return yf(t,n,e);Ke(),t=t.memoizedState,n=Ke();var l=n.queue.dispatch;return n.memoizedState=e,[t,l,!1]}function zs(e,t,n,l){return e={tag:e,create:n,deps:l,inst:t,next:null},t=Ne.updateQueue,t===null&&(t=Ec(),Ne.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(l=n.next,n.next=e,e.next=l,t.lastEffect=e),e}function hi(){return{destroy:void 0,resource:void 0}}function Nf(){return Ke().memoizedState}function gi(e,t,n,l){var o=bt();l=l===void 0?null:l,Ne.flags|=e,o.memoizedState=zs(1|t,hi(),n,l)}function zn(e,t,n,l){var o=Ke();l=l===void 0?null:l;var d=o.memoizedState.inst;Ve!==null&&l!==null&&yc(l,Ve.memoizedState.deps)?o.memoizedState=zs(t,d,n,l):(Ne.flags|=e,o.memoizedState=zs(1|t,d,n,l))}function Sf(e,t){gi(8390656,8,e,t)}function wf(e,t){zn(2048,8,e,t)}function Ef(e,t){return zn(4,2,e,t)}function jf(e,t){return zn(4,4,e,t)}function Df(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Rf(e,t,n){n=n!=null?n.concat([e]):null,zn(4,4,Df.bind(null,t,e),n)}function Tc(){}function Af(e,t){var n=Ke();t=t===void 0?null:t;var l=n.memoizedState;return t!==null&&yc(t,l[1])?l[0]:(n.memoizedState=[e,t],e)}function Cf(e,t){var n=Ke();t=t===void 0?null:t;var l=n.memoizedState;if(t!==null&&yc(t,l[1]))return l[0];if(l=e(),fs){ja(!0);try{e()}finally{ja(!1)}}return n.memoizedState=[l,t],l}function _c(e,t,n){return n===void 0||(Ma&1073741824)!==0?e.memoizedState=t:(e.memoizedState=n,e=Mm(),Ne.lanes|=e,$a|=e,n)}function Tf(e,t,n,l){return wt(n,t)?n:Fs.current!==null?(e=_c(e,n,l),wt(e,t)||(at=!0),e):(Ma&42)===0?(at=!0,e.memoizedState=n):(e=Mm(),Ne.lanes|=e,$a|=e,t)}function _f(e,t,n,l,o){var d=j.p;j.p=d!==0&&8>d?d:8;var p=M.T,S={};M.T=S,Oc(e,!1,t,n);try{var R=o(),L=M.S;if(L!==null&&L(S,R),R!==null&&typeof R=="object"&&typeof R.then=="function"){var H=$x(R,l);qn(e,t,H,At(e))}else qn(e,t,l,At(e))}catch(G){qn(e,t,{then:function(){},status:"rejected",reason:G},At())}finally{j.p=d,M.T=p}}function qx(){}function Mc(e,t,n,l){if(e.tag!==5)throw Error(i(476));var o=Mf(e).queue;_f(e,o,t,P,n===null?qx:function(){return If(e),n(l)})}function Mf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:P,baseState:P,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ha,lastRenderedState:P},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ha,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function If(e){var t=Mf(e).next.queue;qn(e,t,{},At())}function Ic(){return dt(cr)}function Of(){return Ke().memoizedState}function Vf(){return Ke().memoizedState}function Hx(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=At();e=Ta(n);var l=_a(t,e,n);l!==null&&(Ct(l,t,n),kn(l,t,n)),t={cache:oc()},e.payload=t;return}t=t.return}}function Yx(e,t,n){var l=At();n={lane:l,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},xi(e)?Lf(t,n):(n=Wl(e,t,n,l),n!==null&&(Ct(n,e,l),kf(n,t,l)))}function Uf(e,t,n){var l=At();qn(e,t,n,l)}function qn(e,t,n,l){var o={lane:l,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(xi(e))Lf(t,o);else{var d=e.alternate;if(e.lanes===0&&(d===null||d.lanes===0)&&(d=t.lastRenderedReducer,d!==null))try{var p=t.lastRenderedState,S=d(p,n);if(o.hasEagerState=!0,o.eagerState=S,wt(S,p))return Wr(e,t,o,0),$e===null&&Jr(),!1}catch{}finally{}if(n=Wl(e,t,o,l),n!==null)return Ct(n,e,l),kf(n,t,l),!0}return!1}function Oc(e,t,n,l){if(l={lane:2,revertLane:mo(),action:l,hasEagerState:!1,eagerState:null,next:null},xi(e)){if(t)throw Error(i(479))}else t=Wl(e,n,l,2),t!==null&&Ct(t,e,2)}function xi(e){var t=e.alternate;return e===Ne||t!==null&&t===Ne}function Lf(e,t){Bs=ui=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function kf(e,t,n){if((n&4194048)!==0){var l=t.lanes;l&=e.pendingLanes,n|=l,t.lanes=n,Hu(e,n)}}var pi={readContext:dt,use:fi,useCallback:Ye,useContext:Ye,useEffect:Ye,useImperativeHandle:Ye,useLayoutEffect:Ye,useInsertionEffect:Ye,useMemo:Ye,useReducer:Ye,useRef:Ye,useState:Ye,useDebugValue:Ye,useDeferredValue:Ye,useTransition:Ye,useSyncExternalStore:Ye,useId:Ye,useHostTransitionStatus:Ye,useFormState:Ye,useActionState:Ye,useOptimistic:Ye,useMemoCache:Ye,useCacheRefresh:Ye},$f={readContext:dt,use:fi,useCallback:function(e,t){return bt().memoizedState=[e,t===void 0?null:t],e},useContext:dt,useEffect:Sf,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,gi(4194308,4,Df.bind(null,t,e),n)},useLayoutEffect:function(e,t){return gi(4194308,4,e,t)},useInsertionEffect:function(e,t){gi(4,2,e,t)},useMemo:function(e,t){var n=bt();t=t===void 0?null:t;var l=e();if(fs){ja(!0);try{e()}finally{ja(!1)}}return n.memoizedState=[l,t],l},useReducer:function(e,t,n){var l=bt();if(n!==void 0){var o=n(t);if(fs){ja(!0);try{n(t)}finally{ja(!1)}}}else o=t;return l.memoizedState=l.baseState=o,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:o},l.queue=e,e=e.dispatch=Yx.bind(null,Ne,e),[l.memoizedState,e]},useRef:function(e){var t=bt();return e={current:e},t.memoizedState=e},useState:function(e){e=Ac(e);var t=e.queue,n=Uf.bind(null,Ne,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Tc,useDeferredValue:function(e,t){var n=bt();return _c(n,e,t)},useTransition:function(){var e=Ac(!1);return e=_f.bind(null,Ne,e.queue,!0,!1),bt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var l=Ne,o=bt();if(Me){if(n===void 0)throw Error(i(407));n=n()}else{if(n=t(),$e===null)throw Error(i(349));(Ae&124)!==0||rf(l,t,n)}o.memoizedState=n;var d={value:n,getSnapshot:t};return o.queue=d,Sf(cf.bind(null,l,d,e),[e]),l.flags|=2048,zs(9,hi(),lf.bind(null,l,d,n,t),null),n},useId:function(){var e=bt(),t=$e.identifierPrefix;if(Me){var n=da,l=ua;n=(l&~(1<<32-St(l)-1)).toString(32)+n,t=""+t+"R"+n,n=di++,0<n&&(t+="H"+n.toString(32)),t+=""}else n=Fx++,t=""+t+"r"+n.toString(32)+"";return e.memoizedState=t},useHostTransitionStatus:Ic,useFormState:pf,useActionState:pf,useOptimistic:function(e){var t=bt();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Oc.bind(null,Ne,!0,n),n.dispatch=t,[e,t]},useMemoCache:jc,useCacheRefresh:function(){return bt().memoizedState=Hx.bind(null,Ne)}},Ff={readContext:dt,use:fi,useCallback:Af,useContext:dt,useEffect:wf,useImperativeHandle:Rf,useInsertionEffect:Ef,useLayoutEffect:jf,useMemo:Cf,useReducer:mi,useRef:Nf,useState:function(){return mi(ha)},useDebugValue:Tc,useDeferredValue:function(e,t){var n=Ke();return Tf(n,Ve.memoizedState,e,t)},useTransition:function(){var e=mi(ha)[0],t=Ke().memoizedState;return[typeof e=="boolean"?e:Pn(e),t]},useSyncExternalStore:nf,useId:Of,useHostTransitionStatus:Ic,useFormState:bf,useActionState:bf,useOptimistic:function(e,t){var n=Ke();return df(n,Ve,e,t)},useMemoCache:jc,useCacheRefresh:Vf},Gx={readContext:dt,use:fi,useCallback:Af,useContext:dt,useEffect:wf,useImperativeHandle:Rf,useInsertionEffect:Ef,useLayoutEffect:jf,useMemo:Cf,useReducer:Rc,useRef:Nf,useState:function(){return Rc(ha)},useDebugValue:Tc,useDeferredValue:function(e,t){var n=Ke();return Ve===null?_c(n,e,t):Tf(n,Ve.memoizedState,e,t)},useTransition:function(){var e=Rc(ha)[0],t=Ke().memoizedState;return[typeof e=="boolean"?e:Pn(e),t]},useSyncExternalStore:nf,useId:Of,useHostTransitionStatus:Ic,useFormState:vf,useActionState:vf,useOptimistic:function(e,t){var n=Ke();return Ve!==null?df(n,Ve,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:jc,useCacheRefresh:Vf},qs=null,Hn=0;function bi(e){var t=Hn;return Hn+=1,qs===null&&(qs=[]),Zd(qs,e,t)}function Yn(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function yi(e,t){throw t.$$typeof===w?Error(i(525)):(e=Object.prototype.toString.call(t),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Bf(e){var t=e._init;return t(e._payload)}function Pf(e){function t(O,_){if(e){var U=O.deletions;U===null?(O.deletions=[_],O.flags|=16):U.push(_)}}function n(O,_){if(!e)return null;for(;_!==null;)t(O,_),_=_.sibling;return null}function l(O){for(var _=new Map;O!==null;)O.key!==null?_.set(O.key,O):_.set(O.index,O),O=O.sibling;return _}function o(O,_){return O=oa(O,_),O.index=0,O.sibling=null,O}function d(O,_,U){return O.index=U,e?(U=O.alternate,U!==null?(U=U.index,U<_?(O.flags|=67108866,_):U):(O.flags|=67108866,_)):(O.flags|=1048576,_)}function p(O){return e&&O.alternate===null&&(O.flags|=67108866),O}function S(O,_,U,Y){return _===null||_.tag!==6?(_=tc(U,O.mode,Y),_.return=O,_):(_=o(_,U),_.return=O,_)}function R(O,_,U,Y){var ie=U.type;return ie===v?H(O,_,U.props.children,Y,U.key):_!==null&&(_.elementType===ie||typeof ie=="object"&&ie!==null&&ie.$$typeof===se&&Bf(ie)===_.type)?(_=o(_,U.props),Yn(_,U),_.return=O,_):(_=ti(U.type,U.key,U.props,null,O.mode,Y),Yn(_,U),_.return=O,_)}function L(O,_,U,Y){return _===null||_.tag!==4||_.stateNode.containerInfo!==U.containerInfo||_.stateNode.implementation!==U.implementation?(_=ac(U,O.mode,Y),_.return=O,_):(_=o(_,U.children||[]),_.return=O,_)}function H(O,_,U,Y,ie){return _===null||_.tag!==7?(_=ns(U,O.mode,Y,ie),_.return=O,_):(_=o(_,U),_.return=O,_)}function G(O,_,U){if(typeof _=="string"&&_!==""||typeof _=="number"||typeof _=="bigint")return _=tc(""+_,O.mode,U),_.return=O,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case D:return U=ti(_.type,_.key,_.props,null,O.mode,U),Yn(U,_),U.return=O,U;case b:return _=ac(_,O.mode,U),_.return=O,_;case se:var Y=_._init;return _=Y(_._payload),G(O,_,U)}if(V(_)||be(_))return _=ns(_,O.mode,U,null),_.return=O,_;if(typeof _.then=="function")return G(O,bi(_),U);if(_.$$typeof===W)return G(O,ri(O,_),U);yi(O,_)}return null}function $(O,_,U,Y){var ie=_!==null?_.key:null;if(typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint")return ie!==null?null:S(O,_,""+U,Y);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case D:return U.key===ie?R(O,_,U,Y):null;case b:return U.key===ie?L(O,_,U,Y):null;case se:return ie=U._init,U=ie(U._payload),$(O,_,U,Y)}if(V(U)||be(U))return ie!==null?null:H(O,_,U,Y,null);if(typeof U.then=="function")return $(O,_,bi(U),Y);if(U.$$typeof===W)return $(O,_,ri(O,U),Y);yi(O,U)}return null}function F(O,_,U,Y,ie){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return O=O.get(U)||null,S(_,O,""+Y,ie);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case D:return O=O.get(Y.key===null?U:Y.key)||null,R(_,O,Y,ie);case b:return O=O.get(Y.key===null?U:Y.key)||null,L(_,O,Y,ie);case se:var we=Y._init;return Y=we(Y._payload),F(O,_,U,Y,ie)}if(V(Y)||be(Y))return O=O.get(U)||null,H(_,O,Y,ie,null);if(typeof Y.then=="function")return F(O,_,U,bi(Y),ie);if(Y.$$typeof===W)return F(O,_,U,ri(_,Y),ie);yi(_,Y)}return null}function he(O,_,U,Y){for(var ie=null,we=null,oe=_,me=_=0,nt=null;oe!==null&&me<U.length;me++){oe.index>me?(nt=oe,oe=null):nt=oe.sibling;var Te=$(O,oe,U[me],Y);if(Te===null){oe===null&&(oe=nt);break}e&&oe&&Te.alternate===null&&t(O,oe),_=d(Te,_,me),we===null?ie=Te:we.sibling=Te,we=Te,oe=nt}if(me===U.length)return n(O,oe),Me&&is(O,me),ie;if(oe===null){for(;me<U.length;me++)oe=G(O,U[me],Y),oe!==null&&(_=d(oe,_,me),we===null?ie=oe:we.sibling=oe,we=oe);return Me&&is(O,me),ie}for(oe=l(oe);me<U.length;me++)nt=F(oe,O,me,U[me],Y),nt!==null&&(e&&nt.alternate!==null&&oe.delete(nt.key===null?me:nt.key),_=d(nt,_,me),we===null?ie=nt:we.sibling=nt,we=nt);return e&&oe.forEach(function(Xa){return t(O,Xa)}),Me&&is(O,me),ie}function fe(O,_,U,Y){if(U==null)throw Error(i(151));for(var ie=null,we=null,oe=_,me=_=0,nt=null,Te=U.next();oe!==null&&!Te.done;me++,Te=U.next()){oe.index>me?(nt=oe,oe=null):nt=oe.sibling;var Xa=$(O,oe,Te.value,Y);if(Xa===null){oe===null&&(oe=nt);break}e&&oe&&Xa.alternate===null&&t(O,oe),_=d(Xa,_,me),we===null?ie=Xa:we.sibling=Xa,we=Xa,oe=nt}if(Te.done)return n(O,oe),Me&&is(O,me),ie;if(oe===null){for(;!Te.done;me++,Te=U.next())Te=G(O,Te.value,Y),Te!==null&&(_=d(Te,_,me),we===null?ie=Te:we.sibling=Te,we=Te);return Me&&is(O,me),ie}for(oe=l(oe);!Te.done;me++,Te=U.next())Te=F(oe,O,me,Te.value,Y),Te!==null&&(e&&Te.alternate!==null&&oe.delete(Te.key===null?me:Te.key),_=d(Te,_,me),we===null?ie=Te:we.sibling=Te,we=Te);return e&&oe.forEach(function(Xp){return t(O,Xp)}),Me&&is(O,me),ie}function Le(O,_,U,Y){if(typeof U=="object"&&U!==null&&U.type===v&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case D:e:{for(var ie=U.key;_!==null;){if(_.key===ie){if(ie=U.type,ie===v){if(_.tag===7){n(O,_.sibling),Y=o(_,U.props.children),Y.return=O,O=Y;break e}}else if(_.elementType===ie||typeof ie=="object"&&ie!==null&&ie.$$typeof===se&&Bf(ie)===_.type){n(O,_.sibling),Y=o(_,U.props),Yn(Y,U),Y.return=O,O=Y;break e}n(O,_);break}else t(O,_);_=_.sibling}U.type===v?(Y=ns(U.props.children,O.mode,Y,U.key),Y.return=O,O=Y):(Y=ti(U.type,U.key,U.props,null,O.mode,Y),Yn(Y,U),Y.return=O,O=Y)}return p(O);case b:e:{for(ie=U.key;_!==null;){if(_.key===ie)if(_.tag===4&&_.stateNode.containerInfo===U.containerInfo&&_.stateNode.implementation===U.implementation){n(O,_.sibling),Y=o(_,U.children||[]),Y.return=O,O=Y;break e}else{n(O,_);break}else t(O,_);_=_.sibling}Y=ac(U,O.mode,Y),Y.return=O,O=Y}return p(O);case se:return ie=U._init,U=ie(U._payload),Le(O,_,U,Y)}if(V(U))return he(O,_,U,Y);if(be(U)){if(ie=be(U),typeof ie!="function")throw Error(i(150));return U=ie.call(U),fe(O,_,U,Y)}if(typeof U.then=="function")return Le(O,_,bi(U),Y);if(U.$$typeof===W)return Le(O,_,ri(O,U),Y);yi(O,U)}return typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint"?(U=""+U,_!==null&&_.tag===6?(n(O,_.sibling),Y=o(_,U),Y.return=O,O=Y):(n(O,_),Y=tc(U,O.mode,Y),Y.return=O,O=Y),p(O)):n(O,_)}return function(O,_,U,Y){try{Hn=0;var ie=Le(O,_,U,Y);return qs=null,ie}catch(oe){if(oe===Un||oe===li)throw oe;var we=Et(29,oe,null,O.mode);return we.lanes=Y,we.return=O,we}finally{}}}var Hs=Pf(!0),zf=Pf(!1),Bt=T(null),ta=null;function Ia(e){var t=e.alternate;B(We,We.current&1),B(Bt,e),ta===null&&(t===null||Fs.current!==null||t.memoizedState!==null)&&(ta=e)}function qf(e){if(e.tag===22){if(B(We,We.current),B(Bt,e),ta===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(ta=e)}}else Oa()}function Oa(){B(We,We.current),B(Bt,Bt.current)}function ga(e){z(Bt),ta===e&&(ta=null),z(We)}var We=T(0);function vi(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||jo(n)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Vc(e,t,n,l){t=e.memoizedState,n=n(l,t),n=n==null?t:y({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Uc={enqueueSetState:function(e,t,n){e=e._reactInternals;var l=At(),o=Ta(l);o.payload=t,n!=null&&(o.callback=n),t=_a(e,o,l),t!==null&&(Ct(t,e,l),kn(t,e,l))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var l=At(),o=Ta(l);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=_a(e,o,l),t!==null&&(Ct(t,e,l),kn(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=At(),l=Ta(n);l.tag=2,t!=null&&(l.callback=t),t=_a(e,l,n),t!==null&&(Ct(t,e,n),kn(t,e,n))}};function Hf(e,t,n,l,o,d,p){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,d,p):t.prototype&&t.prototype.isPureReactComponent?!An(n,l)||!An(o,d):!0}function Yf(e,t,n,l){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,l),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,l),t.state!==e&&Uc.enqueueReplaceState(t,t.state,null)}function ms(e,t){var n=t;if("ref"in t){n={};for(var l in t)l!=="ref"&&(n[l]=t[l])}if(e=e.defaultProps){n===t&&(n=y({},n));for(var o in e)n[o]===void 0&&(n[o]=e[o])}return n}var Ni=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function Gf(e){Ni(e)}function Xf(e){console.error(e)}function Kf(e){Ni(e)}function Si(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(l){setTimeout(function(){throw l})}}function Zf(e,t,n){try{var l=e.onCaughtError;l(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(o){setTimeout(function(){throw o})}}function Lc(e,t,n){return n=Ta(n),n.tag=3,n.payload={element:null},n.callback=function(){Si(e,t)},n}function Qf(e){return e=Ta(e),e.tag=3,e}function Jf(e,t,n,l){var o=n.type.getDerivedStateFromError;if(typeof o=="function"){var d=l.value;e.payload=function(){return o(d)},e.callback=function(){Zf(t,n,l)}}var p=n.stateNode;p!==null&&typeof p.componentDidCatch=="function"&&(e.callback=function(){Zf(t,n,l),typeof o!="function"&&(Fa===null?Fa=new Set([this]):Fa.add(this));var S=l.stack;this.componentDidCatch(l.value,{componentStack:S!==null?S:""})})}function Xx(e,t,n,l,o){if(n.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(t=n.alternate,t!==null&&In(t,n,o,!0),n=Bt.current,n!==null){switch(n.tag){case 13:return ta===null?lo():n.alternate===null&&He===0&&(He=3),n.flags&=-257,n.flags|=65536,n.lanes=o,l===fc?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([l]):t.add(l),oo(e,l,o)),!1;case 22:return n.flags|=65536,l===fc?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([l])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([l]):n.add(l)),oo(e,l,o)),!1}throw Error(i(435,n.tag))}return oo(e,l,o),lo(),!1}if(Me)return t=Bt.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=o,l!==rc&&(e=Error(i(422),{cause:l}),Mn(Lt(e,n)))):(l!==rc&&(t=Error(i(423),{cause:l}),Mn(Lt(t,n))),e=e.current.alternate,e.flags|=65536,o&=-o,e.lanes|=o,l=Lt(l,n),o=Lc(e.stateNode,l,o),gc(e,o),He!==4&&(He=2)),!1;var d=Error(i(520),{cause:l});if(d=Lt(d,n),Wn===null?Wn=[d]:Wn.push(d),He!==4&&(He=2),t===null)return!0;l=Lt(l,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=o&-o,n.lanes|=e,e=Lc(n.stateNode,l,e),gc(n,e),!1;case 1:if(t=n.type,d=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||d!==null&&typeof d.componentDidCatch=="function"&&(Fa===null||!Fa.has(d))))return n.flags|=65536,o&=-o,n.lanes|=o,o=Qf(o),Jf(o,e,n,l),gc(n,o),!1}n=n.return}while(n!==null);return!1}var Wf=Error(i(461)),at=!1;function it(e,t,n,l){t.child=e===null?zf(t,null,n,l):Hs(t,e.child,n,l)}function em(e,t,n,l,o){n=n.render;var d=t.ref;if("ref"in l){var p={};for(var S in l)S!=="ref"&&(p[S]=l[S])}else p=l;return us(t),l=vc(e,t,n,p,d,o),S=Nc(),e!==null&&!at?(Sc(e,t,o),xa(e,t,o)):(Me&&S&&sc(t),t.flags|=1,it(e,t,l,o),t.child)}function tm(e,t,n,l,o){if(e===null){var d=n.type;return typeof d=="function"&&!ec(d)&&d.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=d,am(e,t,d,l,o)):(e=ti(n.type,null,l,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(d=e.child,!Hc(e,o)){var p=d.memoizedProps;if(n=n.compare,n=n!==null?n:An,n(p,l)&&e.ref===t.ref)return xa(e,t,o)}return t.flags|=1,e=oa(d,l),e.ref=t.ref,e.return=t,t.child=e}function am(e,t,n,l,o){if(e!==null){var d=e.memoizedProps;if(An(d,l)&&e.ref===t.ref)if(at=!1,t.pendingProps=l=d,Hc(e,o))(e.flags&131072)!==0&&(at=!0);else return t.lanes=e.lanes,xa(e,t,o)}return kc(e,t,n,l,o)}function sm(e,t,n){var l=t.pendingProps,o=l.children,d=e!==null?e.memoizedState:null;if(l.mode==="hidden"){if((t.flags&128)!==0){if(l=d!==null?d.baseLanes|n:n,e!==null){for(o=t.child=e.child,d=0;o!==null;)d=d|o.lanes|o.childLanes,o=o.sibling;t.childLanes=d&~l}else t.childLanes=0,t.child=null;return nm(e,t,l,n)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&ii(t,d!==null?d.cachePool:null),d!==null?tf(t,d):pc(),qf(t);else return t.lanes=t.childLanes=536870912,nm(e,t,d!==null?d.baseLanes|n:n,n)}else d!==null?(ii(t,d.cachePool),tf(t,d),Oa(),t.memoizedState=null):(e!==null&&ii(t,null),pc(),Oa());return it(e,t,o,n),t.child}function nm(e,t,n,l){var o=dc();return o=o===null?null:{parent:Je._currentValue,pool:o},t.memoizedState={baseLanes:n,cachePool:o},e!==null&&ii(t,null),pc(),qf(t),e!==null&&In(e,t,l,!0),null}function wi(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(i(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function kc(e,t,n,l,o){return us(t),n=vc(e,t,n,l,void 0,o),l=Nc(),e!==null&&!at?(Sc(e,t,o),xa(e,t,o)):(Me&&l&&sc(t),t.flags|=1,it(e,t,n,o),t.child)}function rm(e,t,n,l,o,d){return us(t),t.updateQueue=null,n=sf(t,l,n,o),af(e),l=Nc(),e!==null&&!at?(Sc(e,t,d),xa(e,t,d)):(Me&&l&&sc(t),t.flags|=1,it(e,t,n,d),t.child)}function im(e,t,n,l,o){if(us(t),t.stateNode===null){var d=Vs,p=n.contextType;typeof p=="object"&&p!==null&&(d=dt(p)),d=new n(l,d),t.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=Uc,t.stateNode=d,d._reactInternals=t,d=t.stateNode,d.props=l,d.state=t.memoizedState,d.refs={},mc(t),p=n.contextType,d.context=typeof p=="object"&&p!==null?dt(p):Vs,d.state=t.memoizedState,p=n.getDerivedStateFromProps,typeof p=="function"&&(Vc(t,n,p,l),d.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(p=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),p!==d.state&&Uc.enqueueReplaceState(d,d.state,null),Fn(t,l,d,o),$n(),d.state=t.memoizedState),typeof d.componentDidMount=="function"&&(t.flags|=4194308),l=!0}else if(e===null){d=t.stateNode;var S=t.memoizedProps,R=ms(n,S);d.props=R;var L=d.context,H=n.contextType;p=Vs,typeof H=="object"&&H!==null&&(p=dt(H));var G=n.getDerivedStateFromProps;H=typeof G=="function"||typeof d.getSnapshotBeforeUpdate=="function",S=t.pendingProps!==S,H||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(S||L!==p)&&Yf(t,d,l,p),Ca=!1;var $=t.memoizedState;d.state=$,Fn(t,l,d,o),$n(),L=t.memoizedState,S||$!==L||Ca?(typeof G=="function"&&(Vc(t,n,G,l),L=t.memoizedState),(R=Ca||Hf(t,n,R,l,$,L,p))?(H||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(t.flags|=4194308)):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=l,t.memoizedState=L),d.props=l,d.state=L,d.context=p,l=R):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),l=!1)}else{d=t.stateNode,hc(e,t),p=t.memoizedProps,H=ms(n,p),d.props=H,G=t.pendingProps,$=d.context,L=n.contextType,R=Vs,typeof L=="object"&&L!==null&&(R=dt(L)),S=n.getDerivedStateFromProps,(L=typeof S=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(p!==G||$!==R)&&Yf(t,d,l,R),Ca=!1,$=t.memoizedState,d.state=$,Fn(t,l,d,o),$n();var F=t.memoizedState;p!==G||$!==F||Ca||e!==null&&e.dependencies!==null&&ni(e.dependencies)?(typeof S=="function"&&(Vc(t,n,S,l),F=t.memoizedState),(H=Ca||Hf(t,n,H,l,$,F,R)||e!==null&&e.dependencies!==null&&ni(e.dependencies))?(L||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(l,F,R),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(l,F,R)),typeof d.componentDidUpdate=="function"&&(t.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof d.componentDidUpdate!="function"||p===e.memoizedProps&&$===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||p===e.memoizedProps&&$===e.memoizedState||(t.flags|=1024),t.memoizedProps=l,t.memoizedState=F),d.props=l,d.state=F,d.context=R,l=H):(typeof d.componentDidUpdate!="function"||p===e.memoizedProps&&$===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||p===e.memoizedProps&&$===e.memoizedState||(t.flags|=1024),l=!1)}return d=l,wi(e,t),l=(t.flags&128)!==0,d||l?(d=t.stateNode,n=l&&typeof n.getDerivedStateFromError!="function"?null:d.render(),t.flags|=1,e!==null&&l?(t.child=Hs(t,e.child,null,o),t.child=Hs(t,null,n,o)):it(e,t,n,o),t.memoizedState=d.state,e=t.child):e=xa(e,t,o),e}function lm(e,t,n,l){return _n(),t.flags|=256,it(e,t,n,l),t.child}var $c={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Fc(e){return{baseLanes:e,cachePool:Gd()}}function Bc(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=Pt),e}function cm(e,t,n){var l=t.pendingProps,o=!1,d=(t.flags&128)!==0,p;if((p=d)||(p=e!==null&&e.memoizedState===null?!1:(We.current&2)!==0),p&&(o=!0,t.flags&=-129),p=(t.flags&32)!==0,t.flags&=-33,e===null){if(Me){if(o?Ia(t):Oa(),Me){var S=qe,R;if(R=S){e:{for(R=S,S=ea;R.nodeType!==8;){if(!S){S=null;break e}if(R=Kt(R.nextSibling),R===null){S=null;break e}}S=R}S!==null?(t.memoizedState={dehydrated:S,treeContext:rs!==null?{id:ua,overflow:da}:null,retryLane:536870912,hydrationErrors:null},R=Et(18,null,null,0),R.stateNode=S,R.return=t,t.child=R,ht=t,qe=null,R=!0):R=!1}R||cs(t)}if(S=t.memoizedState,S!==null&&(S=S.dehydrated,S!==null))return jo(S)?t.lanes=32:t.lanes=536870912,null;ga(t)}return S=l.children,l=l.fallback,o?(Oa(),o=t.mode,S=Ei({mode:"hidden",children:S},o),l=ns(l,o,n,null),S.return=t,l.return=t,S.sibling=l,t.child=S,o=t.child,o.memoizedState=Fc(n),o.childLanes=Bc(e,p,n),t.memoizedState=$c,l):(Ia(t),Pc(t,S))}if(R=e.memoizedState,R!==null&&(S=R.dehydrated,S!==null)){if(d)t.flags&256?(Ia(t),t.flags&=-257,t=zc(e,t,n)):t.memoizedState!==null?(Oa(),t.child=e.child,t.flags|=128,t=null):(Oa(),o=l.fallback,S=t.mode,l=Ei({mode:"visible",children:l.children},S),o=ns(o,S,n,null),o.flags|=2,l.return=t,o.return=t,l.sibling=o,t.child=l,Hs(t,e.child,null,n),l=t.child,l.memoizedState=Fc(n),l.childLanes=Bc(e,p,n),t.memoizedState=$c,t=o);else if(Ia(t),jo(S)){if(p=S.nextSibling&&S.nextSibling.dataset,p)var L=p.dgst;p=L,l=Error(i(419)),l.stack="",l.digest=p,Mn({value:l,source:null,stack:null}),t=zc(e,t,n)}else if(at||In(e,t,n,!1),p=(n&e.childLanes)!==0,at||p){if(p=$e,p!==null&&(l=n&-n,l=(l&42)!==0?1:jl(l),l=(l&(p.suspendedLanes|n))!==0?0:l,l!==0&&l!==R.retryLane))throw R.retryLane=l,Os(e,l),Ct(p,e,l),Wf;S.data==="$?"||lo(),t=zc(e,t,n)}else S.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=R.treeContext,qe=Kt(S.nextSibling),ht=t,Me=!0,ls=null,ea=!1,e!==null&&($t[Ft++]=ua,$t[Ft++]=da,$t[Ft++]=rs,ua=e.id,da=e.overflow,rs=t),t=Pc(t,l.children),t.flags|=4096);return t}return o?(Oa(),o=l.fallback,S=t.mode,R=e.child,L=R.sibling,l=oa(R,{mode:"hidden",children:l.children}),l.subtreeFlags=R.subtreeFlags&65011712,L!==null?o=oa(L,o):(o=ns(o,S,n,null),o.flags|=2),o.return=t,l.return=t,l.sibling=o,t.child=l,l=o,o=t.child,S=e.child.memoizedState,S===null?S=Fc(n):(R=S.cachePool,R!==null?(L=Je._currentValue,R=R.parent!==L?{parent:L,pool:L}:R):R=Gd(),S={baseLanes:S.baseLanes|n,cachePool:R}),o.memoizedState=S,o.childLanes=Bc(e,p,n),t.memoizedState=$c,l):(Ia(t),n=e.child,e=n.sibling,n=oa(n,{mode:"visible",children:l.children}),n.return=t,n.sibling=null,e!==null&&(p=t.deletions,p===null?(t.deletions=[e],t.flags|=16):p.push(e)),t.child=n,t.memoizedState=null,n)}function Pc(e,t){return t=Ei({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Ei(e,t){return e=Et(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function zc(e,t,n){return Hs(t,e.child,null,n),e=Pc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function om(e,t,n){e.lanes|=t;var l=e.alternate;l!==null&&(l.lanes|=t),lc(e.return,t,n)}function qc(e,t,n,l,o){var d=e.memoizedState;d===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:l,tail:n,tailMode:o}:(d.isBackwards=t,d.rendering=null,d.renderingStartTime=0,d.last=l,d.tail=n,d.tailMode=o)}function um(e,t,n){var l=t.pendingProps,o=l.revealOrder,d=l.tail;if(it(e,t,l.children,n),l=We.current,(l&2)!==0)l=l&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&om(e,n,t);else if(e.tag===19)om(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}switch(B(We,l),o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&vi(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),qc(t,!1,o,n,d);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&vi(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}qc(t,!0,n,null,d);break;case"together":qc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function xa(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),$a|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(In(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(i(153));if(t.child!==null){for(e=t.child,n=oa(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=oa(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Hc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&ni(e)))}function Kx(e,t,n){switch(t.tag){case 3:ge(t,t.stateNode.containerInfo),Aa(t,Je,e.memoizedState.cache),_n();break;case 27:case 5:xe(t);break;case 4:ge(t,t.stateNode.containerInfo);break;case 10:Aa(t,t.type,t.memoizedProps.value);break;case 13:var l=t.memoizedState;if(l!==null)return l.dehydrated!==null?(Ia(t),t.flags|=128,null):(n&t.child.childLanes)!==0?cm(e,t,n):(Ia(t),e=xa(e,t,n),e!==null?e.sibling:null);Ia(t);break;case 19:var o=(e.flags&128)!==0;if(l=(n&t.childLanes)!==0,l||(In(e,t,n,!1),l=(n&t.childLanes)!==0),o){if(l)return um(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),B(We,We.current),l)break;return null;case 22:case 23:return t.lanes=0,sm(e,t,n);case 24:Aa(t,Je,e.memoizedState.cache)}return xa(e,t,n)}function dm(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)at=!0;else{if(!Hc(e,n)&&(t.flags&128)===0)return at=!1,Kx(e,t,n);at=(e.flags&131072)!==0}else at=!1,Me&&(t.flags&1048576)!==0&&Fd(t,si,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var l=t.elementType,o=l._init;if(l=o(l._payload),t.type=l,typeof l=="function")ec(l)?(e=ms(l,e),t.tag=1,t=im(null,t,l,e,n)):(t.tag=0,t=kc(null,t,l,e,n));else{if(l!=null){if(o=l.$$typeof,o===k){t.tag=11,t=em(null,t,l,e,n);break e}else if(o===q){t.tag=14,t=tm(null,t,l,e,n);break e}}throw t=de(l)||l,Error(i(306,t,""))}}return t;case 0:return kc(e,t,t.type,t.pendingProps,n);case 1:return l=t.type,o=ms(l,t.pendingProps),im(e,t,l,o,n);case 3:e:{if(ge(t,t.stateNode.containerInfo),e===null)throw Error(i(387));l=t.pendingProps;var d=t.memoizedState;o=d.element,hc(e,t),Fn(t,l,null,n);var p=t.memoizedState;if(l=p.cache,Aa(t,Je,l),l!==d.cache&&cc(t,[Je],n,!0),$n(),l=p.element,d.isDehydrated)if(d={element:l,isDehydrated:!1,cache:p.cache},t.updateQueue.baseState=d,t.memoizedState=d,t.flags&256){t=lm(e,t,l,n);break e}else if(l!==o){o=Lt(Error(i(424)),t),Mn(o),t=lm(e,t,l,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(qe=Kt(e.firstChild),ht=t,Me=!0,ls=null,ea=!0,n=zf(t,null,l,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(_n(),l===o){t=xa(e,t,n);break e}it(e,t,l,n)}t=t.child}return t;case 26:return wi(e,t),e===null?(n=g0(t.type,null,t.pendingProps,null))?t.memoizedState=n:Me||(n=t.type,e=t.pendingProps,l=ki(ne.current).createElement(n),l[ut]=t,l[xt]=e,ct(l,n,e),tt(l),t.stateNode=l):t.memoizedState=g0(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return xe(t),e===null&&Me&&(l=t.stateNode=f0(t.type,t.pendingProps,ne.current),ht=t,ea=!0,o=qe,za(t.type)?(Do=o,qe=Kt(l.firstChild)):qe=o),it(e,t,t.pendingProps.children,n),wi(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Me&&((o=l=qe)&&(l=wp(l,t.type,t.pendingProps,ea),l!==null?(t.stateNode=l,ht=t,qe=Kt(l.firstChild),ea=!1,o=!0):o=!1),o||cs(t)),xe(t),o=t.type,d=t.pendingProps,p=e!==null?e.memoizedProps:null,l=d.children,So(o,d)?l=null:p!==null&&So(o,p)&&(t.flags|=32),t.memoizedState!==null&&(o=vc(e,t,Bx,null,null,n),cr._currentValue=o),wi(e,t),it(e,t,l,n),t.child;case 6:return e===null&&Me&&((e=n=qe)&&(n=Ep(n,t.pendingProps,ea),n!==null?(t.stateNode=n,ht=t,qe=null,e=!0):e=!1),e||cs(t)),null;case 13:return cm(e,t,n);case 4:return ge(t,t.stateNode.containerInfo),l=t.pendingProps,e===null?t.child=Hs(t,null,l,n):it(e,t,l,n),t.child;case 11:return em(e,t,t.type,t.pendingProps,n);case 7:return it(e,t,t.pendingProps,n),t.child;case 8:return it(e,t,t.pendingProps.children,n),t.child;case 12:return it(e,t,t.pendingProps.children,n),t.child;case 10:return l=t.pendingProps,Aa(t,t.type,l.value),it(e,t,l.children,n),t.child;case 9:return o=t.type._context,l=t.pendingProps.children,us(t),o=dt(o),l=l(o),t.flags|=1,it(e,t,l,n),t.child;case 14:return tm(e,t,t.type,t.pendingProps,n);case 15:return am(e,t,t.type,t.pendingProps,n);case 19:return um(e,t,n);case 31:return l=t.pendingProps,n=t.mode,l={mode:l.mode,children:l.children},e===null?(n=Ei(l,n),n.ref=t.ref,t.child=n,n.return=t,t=n):(n=oa(e.child,l),n.ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return sm(e,t,n);case 24:return us(t),l=dt(Je),e===null?(o=dc(),o===null&&(o=$e,d=oc(),o.pooledCache=d,d.refCount++,d!==null&&(o.pooledCacheLanes|=n),o=d),t.memoizedState={parent:l,cache:o},mc(t),Aa(t,Je,o)):((e.lanes&n)!==0&&(hc(e,t),Fn(t,null,null,n),$n()),o=e.memoizedState,d=t.memoizedState,o.parent!==l?(o={parent:l,cache:l},t.memoizedState=o,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=o),Aa(t,Je,l)):(l=d.cache,Aa(t,Je,l),l!==o.cache&&cc(t,[Je],n,!0))),it(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function pa(e){e.flags|=4}function fm(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!v0(t)){if(t=Bt.current,t!==null&&((Ae&4194048)===Ae?ta!==null:(Ae&62914560)!==Ae&&(Ae&536870912)===0||t!==ta))throw Ln=fc,Xd;e.flags|=8192}}function ji(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?zu():536870912,e.lanes|=t,Ks|=t)}function Gn(e,t){if(!Me)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var l=null;n!==null;)n.alternate!==null&&(l=n),n=n.sibling;l===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function Pe(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,l=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,l|=o.subtreeFlags&65011712,l|=o.flags&65011712,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,l|=o.subtreeFlags,l|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=l,e.childLanes=n,t}function Zx(e,t,n){var l=t.pendingProps;switch(nc(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pe(t),null;case 1:return Pe(t),null;case 3:return n=t.stateNode,l=null,e!==null&&(l=e.memoizedState.cache),t.memoizedState.cache!==l&&(t.flags|=2048),ma(Je),ue(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Tn(t)?pa(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,zd())),Pe(t),null;case 26:return n=t.memoizedState,e===null?(pa(t),n!==null?(Pe(t),fm(t,n)):(Pe(t),t.flags&=-16777217)):n?n!==e.memoizedState?(pa(t),Pe(t),fm(t,n)):(Pe(t),t.flags&=-16777217):(e.memoizedProps!==l&&pa(t),Pe(t),t.flags&=-16777217),null;case 27:_e(t),n=ne.current;var o=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==l&&pa(t);else{if(!l){if(t.stateNode===null)throw Error(i(166));return Pe(t),null}e=J.current,Tn(t)?Bd(t):(e=f0(o,l,n),t.stateNode=e,pa(t))}return Pe(t),null;case 5:if(_e(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==l&&pa(t);else{if(!l){if(t.stateNode===null)throw Error(i(166));return Pe(t),null}if(e=J.current,Tn(t))Bd(t);else{switch(o=ki(ne.current),e){case 1:e=o.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=o.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=o.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=o.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof l.is=="string"?o.createElement("select",{is:l.is}):o.createElement("select"),l.multiple?e.multiple=!0:l.size&&(e.size=l.size);break;default:e=typeof l.is=="string"?o.createElement(n,{is:l.is}):o.createElement(n)}}e[ut]=t,e[xt]=l;e:for(o=t.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.tag!==27&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===t)break e;for(;o.sibling===null;){if(o.return===null||o.return===t)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}t.stateNode=e;e:switch(ct(e,n,l),n){case"button":case"input":case"select":case"textarea":e=!!l.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&pa(t)}}return Pe(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==l&&pa(t);else{if(typeof l!="string"&&t.stateNode===null)throw Error(i(166));if(e=ne.current,Tn(t)){if(e=t.stateNode,n=t.memoizedProps,l=null,o=ht,o!==null)switch(o.tag){case 27:case 5:l=o.memoizedProps}e[ut]=t,e=!!(e.nodeValue===n||l!==null&&l.suppressHydrationWarning===!0||r0(e.nodeValue,n)),e||cs(t)}else e=ki(e).createTextNode(l),e[ut]=t,t.stateNode=e}return Pe(t),null;case 13:if(l=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(o=Tn(t),l!==null&&l.dehydrated!==null){if(e===null){if(!o)throw Error(i(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(i(317));o[ut]=t}else _n(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Pe(t),o=!1}else o=zd(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=o),o=!0;if(!o)return t.flags&256?(ga(t),t):(ga(t),null)}if(ga(t),(t.flags&128)!==0)return t.lanes=n,t;if(n=l!==null,e=e!==null&&e.memoizedState!==null,n){l=t.child,o=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(o=l.alternate.memoizedState.cachePool.pool);var d=null;l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(d=l.memoizedState.cachePool.pool),d!==o&&(l.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),ji(t,t.updateQueue),Pe(t),null;case 4:return ue(),e===null&&po(t.stateNode.containerInfo),Pe(t),null;case 10:return ma(t.type),Pe(t),null;case 19:if(z(We),o=t.memoizedState,o===null)return Pe(t),null;if(l=(t.flags&128)!==0,d=o.rendering,d===null)if(l)Gn(o,!1);else{if(He!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(d=vi(e),d!==null){for(t.flags|=128,Gn(o,!1),e=d.updateQueue,t.updateQueue=e,ji(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)$d(n,e),n=n.sibling;return B(We,We.current&1|2),t.child}e=e.sibling}o.tail!==null&&Ot()>Ai&&(t.flags|=128,l=!0,Gn(o,!1),t.lanes=4194304)}else{if(!l)if(e=vi(d),e!==null){if(t.flags|=128,l=!0,e=e.updateQueue,t.updateQueue=e,ji(t,e),Gn(o,!0),o.tail===null&&o.tailMode==="hidden"&&!d.alternate&&!Me)return Pe(t),null}else 2*Ot()-o.renderingStartTime>Ai&&n!==536870912&&(t.flags|=128,l=!0,Gn(o,!1),t.lanes=4194304);o.isBackwards?(d.sibling=t.child,t.child=d):(e=o.last,e!==null?e.sibling=d:t.child=d,o.last=d)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ot(),t.sibling=null,e=We.current,B(We,l?e&1|2:e&1),t):(Pe(t),null);case 22:case 23:return ga(t),bc(),l=t.memoizedState!==null,e!==null?e.memoizedState!==null!==l&&(t.flags|=8192):l&&(t.flags|=8192),l?(n&536870912)!==0&&(t.flags&128)===0&&(Pe(t),t.subtreeFlags&6&&(t.flags|=8192)):Pe(t),n=t.updateQueue,n!==null&&ji(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),l=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),l!==n&&(t.flags|=2048),e!==null&&z(ds),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),ma(Je),Pe(t),null;case 25:return null;case 30:return null}throw Error(i(156,t.tag))}function Qx(e,t){switch(nc(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ma(Je),ue(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return _e(t),null;case 13:if(ga(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(i(340));_n()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return z(We),null;case 4:return ue(),null;case 10:return ma(t.type),null;case 22:case 23:return ga(t),bc(),e!==null&&z(ds),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return ma(Je),null;case 25:return null;default:return null}}function mm(e,t){switch(nc(t),t.tag){case 3:ma(Je),ue();break;case 26:case 27:case 5:_e(t);break;case 4:ue();break;case 13:ga(t);break;case 19:z(We);break;case 10:ma(t.type);break;case 22:case 23:ga(t),bc(),e!==null&&z(ds);break;case 24:ma(Je)}}function Xn(e,t){try{var n=t.updateQueue,l=n!==null?n.lastEffect:null;if(l!==null){var o=l.next;n=o;do{if((n.tag&e)===e){l=void 0;var d=n.create,p=n.inst;l=d(),p.destroy=l}n=n.next}while(n!==o)}}catch(S){ke(t,t.return,S)}}function Va(e,t,n){try{var l=t.updateQueue,o=l!==null?l.lastEffect:null;if(o!==null){var d=o.next;l=d;do{if((l.tag&e)===e){var p=l.inst,S=p.destroy;if(S!==void 0){p.destroy=void 0,o=t;var R=n,L=S;try{L()}catch(H){ke(o,R,H)}}}l=l.next}while(l!==d)}}catch(H){ke(t,t.return,H)}}function hm(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{ef(t,n)}catch(l){ke(e,e.return,l)}}}function gm(e,t,n){n.props=ms(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(l){ke(e,t,l)}}function Kn(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var l=e.stateNode;break;case 30:l=e.stateNode;break;default:l=e.stateNode}typeof n=="function"?e.refCleanup=n(l):n.current=l}}catch(o){ke(e,t,o)}}function aa(e,t){var n=e.ref,l=e.refCleanup;if(n!==null)if(typeof l=="function")try{l()}catch(o){ke(e,t,o)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(o){ke(e,t,o)}else n.current=null}function xm(e){var t=e.type,n=e.memoizedProps,l=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&l.focus();break e;case"img":n.src?l.src=n.src:n.srcSet&&(l.srcset=n.srcSet)}}catch(o){ke(e,e.return,o)}}function Yc(e,t,n){try{var l=e.stateNode;bp(l,e.type,n,t),l[xt]=t}catch(o){ke(e,e.return,o)}}function pm(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&za(e.type)||e.tag===4}function Gc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||pm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&za(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Xc(e,t,n){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Li));else if(l!==4&&(l===27&&za(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(Xc(e,t,n),e=e.sibling;e!==null;)Xc(e,t,n),e=e.sibling}function Di(e,t,n){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(l!==4&&(l===27&&za(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Di(e,t,n),e=e.sibling;e!==null;)Di(e,t,n),e=e.sibling}function bm(e){var t=e.stateNode,n=e.memoizedProps;try{for(var l=e.type,o=t.attributes;o.length;)t.removeAttributeNode(o[0]);ct(t,l,n),t[ut]=e,t[xt]=n}catch(d){ke(e,e.return,d)}}var ba=!1,Ge=!1,Kc=!1,ym=typeof WeakSet=="function"?WeakSet:Set,st=null;function Jx(e,t){if(e=e.containerInfo,vo=qi,e=Cd(e),Gl(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var l=n.getSelection&&n.getSelection();if(l&&l.rangeCount!==0){n=l.anchorNode;var o=l.anchorOffset,d=l.focusNode;l=l.focusOffset;try{n.nodeType,d.nodeType}catch{n=null;break e}var p=0,S=-1,R=-1,L=0,H=0,G=e,$=null;t:for(;;){for(var F;G!==n||o!==0&&G.nodeType!==3||(S=p+o),G!==d||l!==0&&G.nodeType!==3||(R=p+l),G.nodeType===3&&(p+=G.nodeValue.length),(F=G.firstChild)!==null;)$=G,G=F;for(;;){if(G===e)break t;if($===n&&++L===o&&(S=p),$===d&&++H===l&&(R=p),(F=G.nextSibling)!==null)break;G=$,$=G.parentNode}G=F}n=S===-1||R===-1?null:{start:S,end:R}}else n=null}n=n||{start:0,end:0}}else n=null;for(No={focusedElem:e,selectionRange:n},qi=!1,st=t;st!==null;)if(t=st,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,st=e;else for(;st!==null;){switch(t=st,d=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&d!==null){e=void 0,n=t,o=d.memoizedProps,d=d.memoizedState,l=n.stateNode;try{var he=ms(n.type,o,n.elementType===n.type);e=l.getSnapshotBeforeUpdate(he,d),l.__reactInternalSnapshotBeforeUpdate=e}catch(fe){ke(n,n.return,fe)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)Eo(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Eo(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=t.sibling,e!==null){e.return=t.return,st=e;break}st=t.return}}function vm(e,t,n){var l=n.flags;switch(n.tag){case 0:case 11:case 15:Ua(e,n),l&4&&Xn(5,n);break;case 1:if(Ua(e,n),l&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(p){ke(n,n.return,p)}else{var o=ms(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(o,t,e.__reactInternalSnapshotBeforeUpdate)}catch(p){ke(n,n.return,p)}}l&64&&hm(n),l&512&&Kn(n,n.return);break;case 3:if(Ua(e,n),l&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{ef(e,t)}catch(p){ke(n,n.return,p)}}break;case 27:t===null&&l&4&&bm(n);case 26:case 5:Ua(e,n),t===null&&l&4&&xm(n),l&512&&Kn(n,n.return);break;case 12:Ua(e,n);break;case 13:Ua(e,n),l&4&&wm(e,n),l&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=lp.bind(null,n),jp(e,n))));break;case 22:if(l=n.memoizedState!==null||ba,!l){t=t!==null&&t.memoizedState!==null||Ge,o=ba;var d=Ge;ba=l,(Ge=t)&&!d?La(e,n,(n.subtreeFlags&8772)!==0):Ua(e,n),ba=o,Ge=d}break;case 30:break;default:Ua(e,n)}}function Nm(e){var t=e.alternate;t!==null&&(e.alternate=null,Nm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Al(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Fe=null,yt=!1;function ya(e,t,n){for(n=n.child;n!==null;)Sm(e,t,n),n=n.sibling}function Sm(e,t,n){if(Nt&&typeof Nt.onCommitFiberUnmount=="function")try{Nt.onCommitFiberUnmount(xn,n)}catch{}switch(n.tag){case 26:Ge||aa(n,t),ya(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Ge||aa(n,t);var l=Fe,o=yt;za(n.type)&&(Fe=n.stateNode,yt=!1),ya(e,t,n),nr(n.stateNode),Fe=l,yt=o;break;case 5:Ge||aa(n,t);case 6:if(l=Fe,o=yt,Fe=null,ya(e,t,n),Fe=l,yt=o,Fe!==null)if(yt)try{(Fe.nodeType===9?Fe.body:Fe.nodeName==="HTML"?Fe.ownerDocument.body:Fe).removeChild(n.stateNode)}catch(d){ke(n,t,d)}else try{Fe.removeChild(n.stateNode)}catch(d){ke(n,t,d)}break;case 18:Fe!==null&&(yt?(e=Fe,u0(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),fr(e)):u0(Fe,n.stateNode));break;case 4:l=Fe,o=yt,Fe=n.stateNode.containerInfo,yt=!0,ya(e,t,n),Fe=l,yt=o;break;case 0:case 11:case 14:case 15:Ge||Va(2,n,t),Ge||Va(4,n,t),ya(e,t,n);break;case 1:Ge||(aa(n,t),l=n.stateNode,typeof l.componentWillUnmount=="function"&&gm(n,t,l)),ya(e,t,n);break;case 21:ya(e,t,n);break;case 22:Ge=(l=Ge)||n.memoizedState!==null,ya(e,t,n),Ge=l;break;default:ya(e,t,n)}}function wm(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{fr(e)}catch(n){ke(t,t.return,n)}}function Wx(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new ym),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new ym),t;default:throw Error(i(435,e.tag))}}function Zc(e,t){var n=Wx(e);t.forEach(function(l){var o=cp.bind(null,e,l);n.has(l)||(n.add(l),l.then(o,o))})}function jt(e,t){var n=t.deletions;if(n!==null)for(var l=0;l<n.length;l++){var o=n[l],d=e,p=t,S=p;e:for(;S!==null;){switch(S.tag){case 27:if(za(S.type)){Fe=S.stateNode,yt=!1;break e}break;case 5:Fe=S.stateNode,yt=!1;break e;case 3:case 4:Fe=S.stateNode.containerInfo,yt=!0;break e}S=S.return}if(Fe===null)throw Error(i(160));Sm(d,p,o),Fe=null,yt=!1,d=o.alternate,d!==null&&(d.return=null),o.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)Em(t,e),t=t.sibling}var Xt=null;function Em(e,t){var n=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:jt(t,e),Dt(e),l&4&&(Va(3,e,e.return),Xn(3,e),Va(5,e,e.return));break;case 1:jt(t,e),Dt(e),l&512&&(Ge||n===null||aa(n,n.return)),l&64&&ba&&(e=e.updateQueue,e!==null&&(l=e.callbacks,l!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?l:n.concat(l))));break;case 26:var o=Xt;if(jt(t,e),Dt(e),l&512&&(Ge||n===null||aa(n,n.return)),l&4){var d=n!==null?n.memoizedState:null;if(l=e.memoizedState,n===null)if(l===null)if(e.stateNode===null){e:{l=e.type,n=e.memoizedProps,o=o.ownerDocument||o;t:switch(l){case"title":d=o.getElementsByTagName("title")[0],(!d||d[yn]||d[ut]||d.namespaceURI==="http://www.w3.org/2000/svg"||d.hasAttribute("itemprop"))&&(d=o.createElement(l),o.head.insertBefore(d,o.querySelector("head > title"))),ct(d,l,n),d[ut]=e,tt(d),l=d;break e;case"link":var p=b0("link","href",o).get(l+(n.href||""));if(p){for(var S=0;S<p.length;S++)if(d=p[S],d.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&d.getAttribute("rel")===(n.rel==null?null:n.rel)&&d.getAttribute("title")===(n.title==null?null:n.title)&&d.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){p.splice(S,1);break t}}d=o.createElement(l),ct(d,l,n),o.head.appendChild(d);break;case"meta":if(p=b0("meta","content",o).get(l+(n.content||""))){for(S=0;S<p.length;S++)if(d=p[S],d.getAttribute("content")===(n.content==null?null:""+n.content)&&d.getAttribute("name")===(n.name==null?null:n.name)&&d.getAttribute("property")===(n.property==null?null:n.property)&&d.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&d.getAttribute("charset")===(n.charSet==null?null:n.charSet)){p.splice(S,1);break t}}d=o.createElement(l),ct(d,l,n),o.head.appendChild(d);break;default:throw Error(i(468,l))}d[ut]=e,tt(d),l=d}e.stateNode=l}else y0(o,e.type,e.stateNode);else e.stateNode=p0(o,l,e.memoizedProps);else d!==l?(d===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):d.count--,l===null?y0(o,e.type,e.stateNode):p0(o,l,e.memoizedProps)):l===null&&e.stateNode!==null&&Yc(e,e.memoizedProps,n.memoizedProps)}break;case 27:jt(t,e),Dt(e),l&512&&(Ge||n===null||aa(n,n.return)),n!==null&&l&4&&Yc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(jt(t,e),Dt(e),l&512&&(Ge||n===null||aa(n,n.return)),e.flags&32){o=e.stateNode;try{Rs(o,"")}catch(F){ke(e,e.return,F)}}l&4&&e.stateNode!=null&&(o=e.memoizedProps,Yc(e,o,n!==null?n.memoizedProps:o)),l&1024&&(Kc=!0);break;case 6:if(jt(t,e),Dt(e),l&4){if(e.stateNode===null)throw Error(i(162));l=e.memoizedProps,n=e.stateNode;try{n.nodeValue=l}catch(F){ke(e,e.return,F)}}break;case 3:if(Bi=null,o=Xt,Xt=$i(t.containerInfo),jt(t,e),Xt=o,Dt(e),l&4&&n!==null&&n.memoizedState.isDehydrated)try{fr(t.containerInfo)}catch(F){ke(e,e.return,F)}Kc&&(Kc=!1,jm(e));break;case 4:l=Xt,Xt=$i(e.stateNode.containerInfo),jt(t,e),Dt(e),Xt=l;break;case 12:jt(t,e),Dt(e);break;case 13:jt(t,e),Dt(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(ao=Ot()),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Zc(e,l)));break;case 22:o=e.memoizedState!==null;var R=n!==null&&n.memoizedState!==null,L=ba,H=Ge;if(ba=L||o,Ge=H||R,jt(t,e),Ge=H,ba=L,Dt(e),l&8192)e:for(t=e.stateNode,t._visibility=o?t._visibility&-2:t._visibility|1,o&&(n===null||R||ba||Ge||hs(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){R=n=t;try{if(d=R.stateNode,o)p=d.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none";else{S=R.stateNode;var G=R.memoizedProps.style,$=G!=null&&G.hasOwnProperty("display")?G.display:null;S.style.display=$==null||typeof $=="boolean"?"":(""+$).trim()}}catch(F){ke(R,R.return,F)}}}else if(t.tag===6){if(n===null){R=t;try{R.stateNode.nodeValue=o?"":R.memoizedProps}catch(F){ke(R,R.return,F)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}l&4&&(l=e.updateQueue,l!==null&&(n=l.retryQueue,n!==null&&(l.retryQueue=null,Zc(e,n))));break;case 19:jt(t,e),Dt(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Zc(e,l)));break;case 30:break;case 21:break;default:jt(t,e),Dt(e)}}function Dt(e){var t=e.flags;if(t&2){try{for(var n,l=e.return;l!==null;){if(pm(l)){n=l;break}l=l.return}if(n==null)throw Error(i(160));switch(n.tag){case 27:var o=n.stateNode,d=Gc(e);Di(e,d,o);break;case 5:var p=n.stateNode;n.flags&32&&(Rs(p,""),n.flags&=-33);var S=Gc(e);Di(e,S,p);break;case 3:case 4:var R=n.stateNode.containerInfo,L=Gc(e);Xc(e,L,R);break;default:throw Error(i(161))}}catch(H){ke(e,e.return,H)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function jm(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;jm(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Ua(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)vm(e,t.alternate,t),t=t.sibling}function hs(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Va(4,t,t.return),hs(t);break;case 1:aa(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&gm(t,t.return,n),hs(t);break;case 27:nr(t.stateNode);case 26:case 5:aa(t,t.return),hs(t);break;case 22:t.memoizedState===null&&hs(t);break;case 30:hs(t);break;default:hs(t)}e=e.sibling}}function La(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var l=t.alternate,o=e,d=t,p=d.flags;switch(d.tag){case 0:case 11:case 15:La(o,d,n),Xn(4,d);break;case 1:if(La(o,d,n),l=d,o=l.stateNode,typeof o.componentDidMount=="function")try{o.componentDidMount()}catch(L){ke(l,l.return,L)}if(l=d,o=l.updateQueue,o!==null){var S=l.stateNode;try{var R=o.shared.hiddenCallbacks;if(R!==null)for(o.shared.hiddenCallbacks=null,o=0;o<R.length;o++)Wd(R[o],S)}catch(L){ke(l,l.return,L)}}n&&p&64&&hm(d),Kn(d,d.return);break;case 27:bm(d);case 26:case 5:La(o,d,n),n&&l===null&&p&4&&xm(d),Kn(d,d.return);break;case 12:La(o,d,n);break;case 13:La(o,d,n),n&&p&4&&wm(o,d);break;case 22:d.memoizedState===null&&La(o,d,n),Kn(d,d.return);break;case 30:break;default:La(o,d,n)}t=t.sibling}}function Qc(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&On(n))}function Jc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&On(e))}function sa(e,t,n,l){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Dm(e,t,n,l),t=t.sibling}function Dm(e,t,n,l){var o=t.flags;switch(t.tag){case 0:case 11:case 15:sa(e,t,n,l),o&2048&&Xn(9,t);break;case 1:sa(e,t,n,l);break;case 3:sa(e,t,n,l),o&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&On(e)));break;case 12:if(o&2048){sa(e,t,n,l),e=t.stateNode;try{var d=t.memoizedProps,p=d.id,S=d.onPostCommit;typeof S=="function"&&S(p,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(R){ke(t,t.return,R)}}else sa(e,t,n,l);break;case 13:sa(e,t,n,l);break;case 23:break;case 22:d=t.stateNode,p=t.alternate,t.memoizedState!==null?d._visibility&2?sa(e,t,n,l):Zn(e,t):d._visibility&2?sa(e,t,n,l):(d._visibility|=2,Ys(e,t,n,l,(t.subtreeFlags&10256)!==0)),o&2048&&Qc(p,t);break;case 24:sa(e,t,n,l),o&2048&&Jc(t.alternate,t);break;default:sa(e,t,n,l)}}function Ys(e,t,n,l,o){for(o=o&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var d=e,p=t,S=n,R=l,L=p.flags;switch(p.tag){case 0:case 11:case 15:Ys(d,p,S,R,o),Xn(8,p);break;case 23:break;case 22:var H=p.stateNode;p.memoizedState!==null?H._visibility&2?Ys(d,p,S,R,o):Zn(d,p):(H._visibility|=2,Ys(d,p,S,R,o)),o&&L&2048&&Qc(p.alternate,p);break;case 24:Ys(d,p,S,R,o),o&&L&2048&&Jc(p.alternate,p);break;default:Ys(d,p,S,R,o)}t=t.sibling}}function Zn(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,l=t,o=l.flags;switch(l.tag){case 22:Zn(n,l),o&2048&&Qc(l.alternate,l);break;case 24:Zn(n,l),o&2048&&Jc(l.alternate,l);break;default:Zn(n,l)}t=t.sibling}}var Qn=8192;function Gs(e){if(e.subtreeFlags&Qn)for(e=e.child;e!==null;)Rm(e),e=e.sibling}function Rm(e){switch(e.tag){case 26:Gs(e),e.flags&Qn&&e.memoizedState!==null&&kp(Xt,e.memoizedState,e.memoizedProps);break;case 5:Gs(e);break;case 3:case 4:var t=Xt;Xt=$i(e.stateNode.containerInfo),Gs(e),Xt=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=Qn,Qn=16777216,Gs(e),Qn=t):Gs(e));break;default:Gs(e)}}function Am(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Jn(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var l=t[n];st=l,Tm(l,e)}Am(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Cm(e),e=e.sibling}function Cm(e){switch(e.tag){case 0:case 11:case 15:Jn(e),e.flags&2048&&Va(9,e,e.return);break;case 3:Jn(e);break;case 12:Jn(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Ri(e)):Jn(e);break;default:Jn(e)}}function Ri(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var l=t[n];st=l,Tm(l,e)}Am(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Va(8,t,t.return),Ri(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Ri(t));break;default:Ri(t)}e=e.sibling}}function Tm(e,t){for(;st!==null;){var n=st;switch(n.tag){case 0:case 11:case 15:Va(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var l=n.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:On(n.memoizedState.cache)}if(l=n.child,l!==null)l.return=n,st=l;else e:for(n=e;st!==null;){l=st;var o=l.sibling,d=l.return;if(Nm(l),l===n){st=null;break e}if(o!==null){o.return=d,st=o;break e}st=d}}}var ep={getCacheForType:function(e){var t=dt(Je),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n}},tp=typeof WeakMap=="function"?WeakMap:Map,Ie=0,$e=null,Ee=null,Ae=0,Oe=0,Rt=null,ka=!1,Xs=!1,Wc=!1,va=0,He=0,$a=0,gs=0,eo=0,Pt=0,Ks=0,Wn=null,vt=null,to=!1,ao=0,Ai=1/0,Ci=null,Fa=null,lt=0,Ba=null,Zs=null,Qs=0,so=0,no=null,_m=null,er=0,ro=null;function At(){if((Ie&2)!==0&&Ae!==0)return Ae&-Ae;if(M.T!==null){var e=ks;return e!==0?e:mo()}return Yu()}function Mm(){Pt===0&&(Pt=(Ae&536870912)===0||Me?Pu():536870912);var e=Bt.current;return e!==null&&(e.flags|=32),Pt}function Ct(e,t,n){(e===$e&&(Oe===2||Oe===9)||e.cancelPendingCommit!==null)&&(Js(e,0),Pa(e,Ae,Pt,!1)),bn(e,n),((Ie&2)===0||e!==$e)&&(e===$e&&((Ie&2)===0&&(gs|=n),He===4&&Pa(e,Ae,Pt,!1)),na(e))}function Im(e,t,n){if((Ie&6)!==0)throw Error(i(327));var l=!n&&(t&124)===0&&(t&e.expiredLanes)===0||pn(e,t),o=l?np(e,t):co(e,t,!0),d=l;do{if(o===0){Xs&&!l&&Pa(e,t,0,!1);break}else{if(n=e.current.alternate,d&&!ap(n)){o=co(e,t,!1),d=!1;continue}if(o===2){if(d=t,e.errorRecoveryDisabledLanes&d)var p=0;else p=e.pendingLanes&-536870913,p=p!==0?p:p&536870912?536870912:0;if(p!==0){t=p;e:{var S=e;o=Wn;var R=S.current.memoizedState.isDehydrated;if(R&&(Js(S,p).flags|=256),p=co(S,p,!1),p!==2){if(Wc&&!R){S.errorRecoveryDisabledLanes|=d,gs|=d,o=4;break e}d=vt,vt=o,d!==null&&(vt===null?vt=d:vt.push.apply(vt,d))}o=p}if(d=!1,o!==2)continue}}if(o===1){Js(e,0),Pa(e,t,0,!0);break}e:{switch(l=e,d=o,d){case 0:case 1:throw Error(i(345));case 4:if((t&4194048)!==t)break;case 6:Pa(l,t,Pt,!ka);break e;case 2:vt=null;break;case 3:case 5:break;default:throw Error(i(329))}if((t&62914560)===t&&(o=ao+300-Ot(),10<o)){if(Pa(l,t,Pt,!ka),Fr(l,0,!0)!==0)break e;l.timeoutHandle=c0(Om.bind(null,l,n,vt,Ci,to,t,Pt,gs,Ks,ka,d,2,-0,0),o);break e}Om(l,n,vt,Ci,to,t,Pt,gs,Ks,ka,d,0,-0,0)}}break}while(!0);na(e)}function Om(e,t,n,l,o,d,p,S,R,L,H,G,$,F){if(e.timeoutHandle=-1,G=t.subtreeFlags,(G&8192||(G&16785408)===16785408)&&(lr={stylesheets:null,count:0,unsuspend:Lp},Rm(t),G=$p(),G!==null)){e.cancelPendingCommit=G(Bm.bind(null,e,t,d,n,l,o,p,S,R,H,1,$,F)),Pa(e,d,p,!L);return}Bm(e,t,d,n,l,o,p,S,R)}function ap(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var l=0;l<n.length;l++){var o=n[l],d=o.getSnapshot;o=o.value;try{if(!wt(d(),o))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Pa(e,t,n,l){t&=~eo,t&=~gs,e.suspendedLanes|=t,e.pingedLanes&=~t,l&&(e.warmLanes|=t),l=e.expirationTimes;for(var o=t;0<o;){var d=31-St(o),p=1<<d;l[d]=-1,o&=~p}n!==0&&qu(e,n,t)}function Ti(){return(Ie&6)===0?(tr(0),!1):!0}function io(){if(Ee!==null){if(Oe===0)var e=Ee.return;else e=Ee,fa=os=null,wc(e),qs=null,Hn=0,e=Ee;for(;e!==null;)mm(e.alternate,e),e=e.return;Ee=null}}function Js(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,vp(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),io(),$e=e,Ee=n=oa(e.current,null),Ae=t,Oe=0,Rt=null,ka=!1,Xs=pn(e,t),Wc=!1,Ks=Pt=eo=gs=$a=He=0,vt=Wn=null,to=!1,(t&8)!==0&&(t|=t&32);var l=e.entangledLanes;if(l!==0)for(e=e.entanglements,l&=t;0<l;){var o=31-St(l),d=1<<o;t|=e[o],l&=~d}return va=t,Jr(),n}function Vm(e,t){Ne=null,M.H=pi,t===Un||t===li?(t=Qd(),Oe=3):t===Xd?(t=Qd(),Oe=4):Oe=t===Wf?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Rt=t,Ee===null&&(He=1,Si(e,Lt(t,e.current)))}function Um(){var e=M.H;return M.H=pi,e===null?pi:e}function Lm(){var e=M.A;return M.A=ep,e}function lo(){He=4,ka||(Ae&4194048)!==Ae&&Bt.current!==null||(Xs=!0),($a&134217727)===0&&(gs&134217727)===0||$e===null||Pa($e,Ae,Pt,!1)}function co(e,t,n){var l=Ie;Ie|=2;var o=Um(),d=Lm();($e!==e||Ae!==t)&&(Ci=null,Js(e,t)),t=!1;var p=He;e:do try{if(Oe!==0&&Ee!==null){var S=Ee,R=Rt;switch(Oe){case 8:io(),p=6;break e;case 3:case 2:case 9:case 6:Bt.current===null&&(t=!0);var L=Oe;if(Oe=0,Rt=null,Ws(e,S,R,L),n&&Xs){p=0;break e}break;default:L=Oe,Oe=0,Rt=null,Ws(e,S,R,L)}}sp(),p=He;break}catch(H){Vm(e,H)}while(!0);return t&&e.shellSuspendCounter++,fa=os=null,Ie=l,M.H=o,M.A=d,Ee===null&&($e=null,Ae=0,Jr()),p}function sp(){for(;Ee!==null;)km(Ee)}function np(e,t){var n=Ie;Ie|=2;var l=Um(),o=Lm();$e!==e||Ae!==t?(Ci=null,Ai=Ot()+500,Js(e,t)):Xs=pn(e,t);e:do try{if(Oe!==0&&Ee!==null){t=Ee;var d=Rt;t:switch(Oe){case 1:Oe=0,Rt=null,Ws(e,t,d,1);break;case 2:case 9:if(Kd(d)){Oe=0,Rt=null,$m(t);break}t=function(){Oe!==2&&Oe!==9||$e!==e||(Oe=7),na(e)},d.then(t,t);break e;case 3:Oe=7;break e;case 4:Oe=5;break e;case 7:Kd(d)?(Oe=0,Rt=null,$m(t)):(Oe=0,Rt=null,Ws(e,t,d,7));break;case 5:var p=null;switch(Ee.tag){case 26:p=Ee.memoizedState;case 5:case 27:var S=Ee;if(!p||v0(p)){Oe=0,Rt=null;var R=S.sibling;if(R!==null)Ee=R;else{var L=S.return;L!==null?(Ee=L,_i(L)):Ee=null}break t}}Oe=0,Rt=null,Ws(e,t,d,5);break;case 6:Oe=0,Rt=null,Ws(e,t,d,6);break;case 8:io(),He=6;break e;default:throw Error(i(462))}}rp();break}catch(H){Vm(e,H)}while(!0);return fa=os=null,M.H=l,M.A=o,Ie=n,Ee!==null?0:($e=null,Ae=0,Jr(),He)}function rp(){for(;Ee!==null&&!ku();)km(Ee)}function km(e){var t=dm(e.alternate,e,va);e.memoizedProps=e.pendingProps,t===null?_i(e):Ee=t}function $m(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=rm(n,t,t.pendingProps,t.type,void 0,Ae);break;case 11:t=rm(n,t,t.pendingProps,t.type.render,t.ref,Ae);break;case 5:wc(t);default:mm(n,t),t=Ee=$d(t,va),t=dm(n,t,va)}e.memoizedProps=e.pendingProps,t===null?_i(e):Ee=t}function Ws(e,t,n,l){fa=os=null,wc(t),qs=null,Hn=0;var o=t.return;try{if(Xx(e,o,t,n,Ae)){He=1,Si(e,Lt(n,e.current)),Ee=null;return}}catch(d){if(o!==null)throw Ee=o,d;He=1,Si(e,Lt(n,e.current)),Ee=null;return}t.flags&32768?(Me||l===1?e=!0:Xs||(Ae&536870912)!==0?e=!1:(ka=e=!0,(l===2||l===9||l===3||l===6)&&(l=Bt.current,l!==null&&l.tag===13&&(l.flags|=16384))),Fm(t,e)):_i(t)}function _i(e){var t=e;do{if((t.flags&32768)!==0){Fm(t,ka);return}e=t.return;var n=Zx(t.alternate,t,va);if(n!==null){Ee=n;return}if(t=t.sibling,t!==null){Ee=t;return}Ee=t=e}while(t!==null);He===0&&(He=5)}function Fm(e,t){do{var n=Qx(e.alternate,e);if(n!==null){n.flags&=32767,Ee=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Ee=e;return}Ee=e=n}while(e!==null);He=6,Ee=null}function Bm(e,t,n,l,o,d,p,S,R){e.cancelPendingCommit=null;do Mi();while(lt!==0);if((Ie&6)!==0)throw Error(i(327));if(t!==null){if(t===e.current)throw Error(i(177));if(d=t.lanes|t.childLanes,d|=Jl,Lg(e,n,d,p,S,R),e===$e&&(Ee=$e=null,Ae=0),Zs=t,Ba=e,Qs=n,so=d,no=o,_m=l,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,op(Lr,function(){return Ym(),null})):(e.callbackNode=null,e.callbackPriority=0),l=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||l){l=M.T,M.T=null,o=j.p,j.p=2,p=Ie,Ie|=4;try{Jx(e,t,n)}finally{Ie=p,j.p=o,M.T=l}}lt=1,Pm(),zm(),qm()}}function Pm(){if(lt===1){lt=0;var e=Ba,t=Zs,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=M.T,M.T=null;var l=j.p;j.p=2;var o=Ie;Ie|=4;try{Em(t,e);var d=No,p=Cd(e.containerInfo),S=d.focusedElem,R=d.selectionRange;if(p!==S&&S&&S.ownerDocument&&Ad(S.ownerDocument.documentElement,S)){if(R!==null&&Gl(S)){var L=R.start,H=R.end;if(H===void 0&&(H=L),"selectionStart"in S)S.selectionStart=L,S.selectionEnd=Math.min(H,S.value.length);else{var G=S.ownerDocument||document,$=G&&G.defaultView||window;if($.getSelection){var F=$.getSelection(),he=S.textContent.length,fe=Math.min(R.start,he),Le=R.end===void 0?fe:Math.min(R.end,he);!F.extend&&fe>Le&&(p=Le,Le=fe,fe=p);var O=Rd(S,fe),_=Rd(S,Le);if(O&&_&&(F.rangeCount!==1||F.anchorNode!==O.node||F.anchorOffset!==O.offset||F.focusNode!==_.node||F.focusOffset!==_.offset)){var U=G.createRange();U.setStart(O.node,O.offset),F.removeAllRanges(),fe>Le?(F.addRange(U),F.extend(_.node,_.offset)):(U.setEnd(_.node,_.offset),F.addRange(U))}}}}for(G=[],F=S;F=F.parentNode;)F.nodeType===1&&G.push({element:F,left:F.scrollLeft,top:F.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<G.length;S++){var Y=G[S];Y.element.scrollLeft=Y.left,Y.element.scrollTop=Y.top}}qi=!!vo,No=vo=null}finally{Ie=o,j.p=l,M.T=n}}e.current=t,lt=2}}function zm(){if(lt===2){lt=0;var e=Ba,t=Zs,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=M.T,M.T=null;var l=j.p;j.p=2;var o=Ie;Ie|=4;try{vm(e,t.alternate,t)}finally{Ie=o,j.p=l,M.T=n}}lt=3}}function qm(){if(lt===4||lt===3){lt=0,gn();var e=Ba,t=Zs,n=Qs,l=_m;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?lt=5:(lt=0,Zs=Ba=null,Hm(e,e.pendingLanes));var o=e.pendingLanes;if(o===0&&(Fa=null),Dl(n),t=t.stateNode,Nt&&typeof Nt.onCommitFiberRoot=="function")try{Nt.onCommitFiberRoot(xn,t,void 0,(t.current.flags&128)===128)}catch{}if(l!==null){t=M.T,o=j.p,j.p=2,M.T=null;try{for(var d=e.onRecoverableError,p=0;p<l.length;p++){var S=l[p];d(S.value,{componentStack:S.stack})}}finally{M.T=t,j.p=o}}(Qs&3)!==0&&Mi(),na(e),o=e.pendingLanes,(n&4194090)!==0&&(o&42)!==0?e===ro?er++:(er=0,ro=e):er=0,tr(0)}}function Hm(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,On(t)))}function Mi(e){return Pm(),zm(),qm(),Ym()}function Ym(){if(lt!==5)return!1;var e=Ba,t=so;so=0;var n=Dl(Qs),l=M.T,o=j.p;try{j.p=32>n?32:n,M.T=null,n=no,no=null;var d=Ba,p=Qs;if(lt=0,Zs=Ba=null,Qs=0,(Ie&6)!==0)throw Error(i(331));var S=Ie;if(Ie|=4,Cm(d.current),Dm(d,d.current,p,n),Ie=S,tr(0,!1),Nt&&typeof Nt.onPostCommitFiberRoot=="function")try{Nt.onPostCommitFiberRoot(xn,d)}catch{}return!0}finally{j.p=o,M.T=l,Hm(e,t)}}function Gm(e,t,n){t=Lt(n,t),t=Lc(e.stateNode,t,2),e=_a(e,t,2),e!==null&&(bn(e,2),na(e))}function ke(e,t,n){if(e.tag===3)Gm(e,e,n);else for(;t!==null;){if(t.tag===3){Gm(t,e,n);break}else if(t.tag===1){var l=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Fa===null||!Fa.has(l))){e=Lt(n,e),n=Qf(2),l=_a(t,n,2),l!==null&&(Jf(n,l,t,e),bn(l,2),na(l));break}}t=t.return}}function oo(e,t,n){var l=e.pingCache;if(l===null){l=e.pingCache=new tp;var o=new Set;l.set(t,o)}else o=l.get(t),o===void 0&&(o=new Set,l.set(t,o));o.has(n)||(Wc=!0,o.add(n),e=ip.bind(null,e,t,n),t.then(e,e))}function ip(e,t,n){var l=e.pingCache;l!==null&&l.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,$e===e&&(Ae&n)===n&&(He===4||He===3&&(Ae&62914560)===Ae&&300>Ot()-ao?(Ie&2)===0&&Js(e,0):eo|=n,Ks===Ae&&(Ks=0)),na(e)}function Xm(e,t){t===0&&(t=zu()),e=Os(e,t),e!==null&&(bn(e,t),na(e))}function lp(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Xm(e,n)}function cp(e,t){var n=0;switch(e.tag){case 13:var l=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:l=e.stateNode;break;case 22:l=e.stateNode._retryCache;break;default:throw Error(i(314))}l!==null&&l.delete(t),Xm(e,n)}function op(e,t){return ye(e,t)}var Ii=null,en=null,uo=!1,Oi=!1,fo=!1,xs=0;function na(e){e!==en&&e.next===null&&(en===null?Ii=en=e:en=en.next=e),Oi=!0,uo||(uo=!0,dp())}function tr(e,t){if(!fo&&Oi){fo=!0;do for(var n=!1,l=Ii;l!==null;){if(e!==0){var o=l.pendingLanes;if(o===0)var d=0;else{var p=l.suspendedLanes,S=l.pingedLanes;d=(1<<31-St(42|e)+1)-1,d&=o&~(p&~S),d=d&201326741?d&201326741|1:d?d|2:0}d!==0&&(n=!0,Jm(l,d))}else d=Ae,d=Fr(l,l===$e?d:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(d&3)===0||pn(l,d)||(n=!0,Jm(l,d));l=l.next}while(n);fo=!1}}function up(){Km()}function Km(){Oi=uo=!1;var e=0;xs!==0&&(yp()&&(e=xs),xs=0);for(var t=Ot(),n=null,l=Ii;l!==null;){var o=l.next,d=Zm(l,t);d===0?(l.next=null,n===null?Ii=o:n.next=o,o===null&&(en=n)):(n=l,(e!==0||(d&3)!==0)&&(Oi=!0)),l=o}tr(e)}function Zm(e,t){for(var n=e.suspendedLanes,l=e.pingedLanes,o=e.expirationTimes,d=e.pendingLanes&-62914561;0<d;){var p=31-St(d),S=1<<p,R=o[p];R===-1?((S&n)===0||(S&l)!==0)&&(o[p]=Ug(S,t)):R<=t&&(e.expiredLanes|=S),d&=~S}if(t=$e,n=Ae,n=Fr(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l=e.callbackNode,n===0||e===t&&(Oe===2||Oe===9)||e.cancelPendingCommit!==null)return l!==null&&l!==null&&et(l),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||pn(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(l!==null&&et(l),Dl(n)){case 2:case 8:n=Fu;break;case 32:n=Lr;break;case 268435456:n=Bu;break;default:n=Lr}return l=Qm.bind(null,e),n=ye(n,l),e.callbackPriority=t,e.callbackNode=n,t}return l!==null&&l!==null&&et(l),e.callbackPriority=2,e.callbackNode=null,2}function Qm(e,t){if(lt!==0&&lt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Mi()&&e.callbackNode!==n)return null;var l=Ae;return l=Fr(e,e===$e?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l===0?null:(Im(e,l,t),Zm(e,Ot()),e.callbackNode!=null&&e.callbackNode===n?Qm.bind(null,e):null)}function Jm(e,t){if(Mi())return null;Im(e,t,!0)}function dp(){Np(function(){(Ie&6)!==0?ye($u,up):Km()})}function mo(){return xs===0&&(xs=Pu()),xs}function Wm(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Hr(""+e)}function e0(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function fp(e,t,n,l,o){if(t==="submit"&&n&&n.stateNode===o){var d=Wm((o[xt]||null).action),p=l.submitter;p&&(t=(t=p[xt]||null)?Wm(t.formAction):p.getAttribute("formAction"),t!==null&&(d=t,p=null));var S=new Kr("action","action",null,l,o);e.push({event:S,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(xs!==0){var R=p?e0(o,p):new FormData(o);Mc(n,{pending:!0,data:R,method:o.method,action:d},null,R)}}else typeof d=="function"&&(S.preventDefault(),R=p?e0(o,p):new FormData(o),Mc(n,{pending:!0,data:R,method:o.method,action:d},d,R))},currentTarget:o}]})}}for(var ho=0;ho<Ql.length;ho++){var go=Ql[ho],mp=go.toLowerCase(),hp=go[0].toUpperCase()+go.slice(1);Gt(mp,"on"+hp)}Gt(Md,"onAnimationEnd"),Gt(Id,"onAnimationIteration"),Gt(Od,"onAnimationStart"),Gt("dblclick","onDoubleClick"),Gt("focusin","onFocus"),Gt("focusout","onBlur"),Gt(_x,"onTransitionRun"),Gt(Mx,"onTransitionStart"),Gt(Ix,"onTransitionCancel"),Gt(Vd,"onTransitionEnd"),Es("onMouseEnter",["mouseout","mouseover"]),Es("onMouseLeave",["mouseout","mouseover"]),Es("onPointerEnter",["pointerout","pointerover"]),Es("onPointerLeave",["pointerout","pointerover"]),es("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),es("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),es("onBeforeInput",["compositionend","keypress","textInput","paste"]),es("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),es("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),es("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ar="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gp=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ar));function t0(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var l=e[n],o=l.event;l=l.listeners;e:{var d=void 0;if(t)for(var p=l.length-1;0<=p;p--){var S=l[p],R=S.instance,L=S.currentTarget;if(S=S.listener,R!==d&&o.isPropagationStopped())break e;d=S,o.currentTarget=L;try{d(o)}catch(H){Ni(H)}o.currentTarget=null,d=R}else for(p=0;p<l.length;p++){if(S=l[p],R=S.instance,L=S.currentTarget,S=S.listener,R!==d&&o.isPropagationStopped())break e;d=S,o.currentTarget=L;try{d(o)}catch(H){Ni(H)}o.currentTarget=null,d=R}}}}function je(e,t){var n=t[Rl];n===void 0&&(n=t[Rl]=new Set);var l=e+"__bubble";n.has(l)||(a0(t,e,2,!1),n.add(l))}function xo(e,t,n){var l=0;t&&(l|=4),a0(n,e,l,t)}var Vi="_reactListening"+Math.random().toString(36).slice(2);function po(e){if(!e[Vi]){e[Vi]=!0,Xu.forEach(function(n){n!=="selectionchange"&&(gp.has(n)||xo(n,!1,e),xo(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Vi]||(t[Vi]=!0,xo("selectionchange",!1,t))}}function a0(e,t,n,l){switch(D0(t)){case 2:var o=Pp;break;case 8:o=zp;break;default:o=_o}n=o.bind(null,t,n,e),o=void 0,!kl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),l?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function bo(e,t,n,l,o){var d=l;if((t&1)===0&&(t&2)===0&&l!==null)e:for(;;){if(l===null)return;var p=l.tag;if(p===3||p===4){var S=l.stateNode.containerInfo;if(S===o)break;if(p===4)for(p=l.return;p!==null;){var R=p.tag;if((R===3||R===4)&&p.stateNode.containerInfo===o)return;p=p.return}for(;S!==null;){if(p=Ns(S),p===null)return;if(R=p.tag,R===5||R===6||R===26||R===27){l=d=p;continue e}S=S.parentNode}}l=l.return}cd(function(){var L=d,H=Ul(n),G=[];e:{var $=Ud.get(e);if($!==void 0){var F=Kr,he=e;switch(e){case"keypress":if(Gr(n)===0)break e;case"keydown":case"keyup":F=ox;break;case"focusin":he="focus",F=Pl;break;case"focusout":he="blur",F=Pl;break;case"beforeblur":case"afterblur":F=Pl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":F=dd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":F=Qg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":F=fx;break;case Md:case Id:case Od:F=ex;break;case Vd:F=hx;break;case"scroll":case"scrollend":F=Kg;break;case"wheel":F=xx;break;case"copy":case"cut":case"paste":F=ax;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":F=md;break;case"toggle":case"beforetoggle":F=bx}var fe=(t&4)!==0,Le=!fe&&(e==="scroll"||e==="scrollend"),O=fe?$!==null?$+"Capture":null:$;fe=[];for(var _=L,U;_!==null;){var Y=_;if(U=Y.stateNode,Y=Y.tag,Y!==5&&Y!==26&&Y!==27||U===null||O===null||(Y=Nn(_,O),Y!=null&&fe.push(sr(_,Y,U))),Le)break;_=_.return}0<fe.length&&($=new F($,he,null,n,H),G.push({event:$,listeners:fe}))}}if((t&7)===0){e:{if($=e==="mouseover"||e==="pointerover",F=e==="mouseout"||e==="pointerout",$&&n!==Vl&&(he=n.relatedTarget||n.fromElement)&&(Ns(he)||he[vs]))break e;if((F||$)&&($=H.window===H?H:($=H.ownerDocument)?$.defaultView||$.parentWindow:window,F?(he=n.relatedTarget||n.toElement,F=L,he=he?Ns(he):null,he!==null&&(Le=u(he),fe=he.tag,he!==Le||fe!==5&&fe!==27&&fe!==6)&&(he=null)):(F=null,he=L),F!==he)){if(fe=dd,Y="onMouseLeave",O="onMouseEnter",_="mouse",(e==="pointerout"||e==="pointerover")&&(fe=md,Y="onPointerLeave",O="onPointerEnter",_="pointer"),Le=F==null?$:vn(F),U=he==null?$:vn(he),$=new fe(Y,_+"leave",F,n,H),$.target=Le,$.relatedTarget=U,Y=null,Ns(H)===L&&(fe=new fe(O,_+"enter",he,n,H),fe.target=U,fe.relatedTarget=Le,Y=fe),Le=Y,F&&he)t:{for(fe=F,O=he,_=0,U=fe;U;U=tn(U))_++;for(U=0,Y=O;Y;Y=tn(Y))U++;for(;0<_-U;)fe=tn(fe),_--;for(;0<U-_;)O=tn(O),U--;for(;_--;){if(fe===O||O!==null&&fe===O.alternate)break t;fe=tn(fe),O=tn(O)}fe=null}else fe=null;F!==null&&s0(G,$,F,fe,!1),he!==null&&Le!==null&&s0(G,Le,he,fe,!0)}}e:{if($=L?vn(L):window,F=$.nodeName&&$.nodeName.toLowerCase(),F==="select"||F==="input"&&$.type==="file")var ie=Nd;else if(yd($))if(Sd)ie=Ax;else{ie=Dx;var we=jx}else F=$.nodeName,!F||F.toLowerCase()!=="input"||$.type!=="checkbox"&&$.type!=="radio"?L&&Ol(L.elementType)&&(ie=Nd):ie=Rx;if(ie&&(ie=ie(e,L))){vd(G,ie,n,H);break e}we&&we(e,$,L),e==="focusout"&&L&&$.type==="number"&&L.memoizedProps.value!=null&&Il($,"number",$.value)}switch(we=L?vn(L):window,e){case"focusin":(yd(we)||we.contentEditable==="true")&&(_s=we,Xl=L,Cn=null);break;case"focusout":Cn=Xl=_s=null;break;case"mousedown":Kl=!0;break;case"contextmenu":case"mouseup":case"dragend":Kl=!1,Td(G,n,H);break;case"selectionchange":if(Tx)break;case"keydown":case"keyup":Td(G,n,H)}var oe;if(ql)e:{switch(e){case"compositionstart":var me="onCompositionStart";break e;case"compositionend":me="onCompositionEnd";break e;case"compositionupdate":me="onCompositionUpdate";break e}me=void 0}else Ts?pd(e,n)&&(me="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(me="onCompositionStart");me&&(hd&&n.locale!=="ko"&&(Ts||me!=="onCompositionStart"?me==="onCompositionEnd"&&Ts&&(oe=od()):(Ra=H,$l="value"in Ra?Ra.value:Ra.textContent,Ts=!0)),we=Ui(L,me),0<we.length&&(me=new fd(me,e,null,n,H),G.push({event:me,listeners:we}),oe?me.data=oe:(oe=bd(n),oe!==null&&(me.data=oe)))),(oe=vx?Nx(e,n):Sx(e,n))&&(me=Ui(L,"onBeforeInput"),0<me.length&&(we=new fd("onBeforeInput","beforeinput",null,n,H),G.push({event:we,listeners:me}),we.data=oe)),fp(G,e,L,n,H)}t0(G,t)})}function sr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ui(e,t){for(var n=t+"Capture",l=[];e!==null;){var o=e,d=o.stateNode;if(o=o.tag,o!==5&&o!==26&&o!==27||d===null||(o=Nn(e,n),o!=null&&l.unshift(sr(e,o,d)),o=Nn(e,t),o!=null&&l.push(sr(e,o,d))),e.tag===3)return l;e=e.return}return[]}function tn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function s0(e,t,n,l,o){for(var d=t._reactName,p=[];n!==null&&n!==l;){var S=n,R=S.alternate,L=S.stateNode;if(S=S.tag,R!==null&&R===l)break;S!==5&&S!==26&&S!==27||L===null||(R=L,o?(L=Nn(n,d),L!=null&&p.unshift(sr(n,L,R))):o||(L=Nn(n,d),L!=null&&p.push(sr(n,L,R)))),n=n.return}p.length!==0&&e.push({event:t,listeners:p})}var xp=/\r\n?/g,pp=/\u0000|\uFFFD/g;function n0(e){return(typeof e=="string"?e:""+e).replace(xp,`
`).replace(pp,"")}function r0(e,t){return t=n0(t),n0(e)===t}function Li(){}function Ue(e,t,n,l,o,d){switch(n){case"children":typeof l=="string"?t==="body"||t==="textarea"&&l===""||Rs(e,l):(typeof l=="number"||typeof l=="bigint")&&t!=="body"&&Rs(e,""+l);break;case"className":Pr(e,"class",l);break;case"tabIndex":Pr(e,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":Pr(e,n,l);break;case"style":id(e,l,d);break;case"data":if(t!=="object"){Pr(e,"data",l);break}case"src":case"href":if(l===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(n);break}l=Hr(""+l),e.setAttribute(n,l);break;case"action":case"formAction":if(typeof l=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof d=="function"&&(n==="formAction"?(t!=="input"&&Ue(e,t,"name",o.name,o,null),Ue(e,t,"formEncType",o.formEncType,o,null),Ue(e,t,"formMethod",o.formMethod,o,null),Ue(e,t,"formTarget",o.formTarget,o,null)):(Ue(e,t,"encType",o.encType,o,null),Ue(e,t,"method",o.method,o,null),Ue(e,t,"target",o.target,o,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(n);break}l=Hr(""+l),e.setAttribute(n,l);break;case"onClick":l!=null&&(e.onclick=Li);break;case"onScroll":l!=null&&je("scroll",e);break;case"onScrollEnd":l!=null&&je("scrollend",e);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(i(61));if(n=l.__html,n!=null){if(o.children!=null)throw Error(i(60));e.innerHTML=n}}break;case"multiple":e.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":e.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){e.removeAttribute("xlink:href");break}n=Hr(""+l),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(n,""+l):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":l===!0?e.setAttribute(n,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(n,l):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?e.setAttribute(n,l):e.removeAttribute(n);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?e.removeAttribute(n):e.setAttribute(n,l);break;case"popover":je("beforetoggle",e),je("toggle",e),Br(e,"popover",l);break;case"xlinkActuate":la(e,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":la(e,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":la(e,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":la(e,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":la(e,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":la(e,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":la(e,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":la(e,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":la(e,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":Br(e,"is",l);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Gg.get(n)||n,Br(e,n,l))}}function yo(e,t,n,l,o,d){switch(n){case"style":id(e,l,d);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(i(61));if(n=l.__html,n!=null){if(o.children!=null)throw Error(i(60));e.innerHTML=n}}break;case"children":typeof l=="string"?Rs(e,l):(typeof l=="number"||typeof l=="bigint")&&Rs(e,""+l);break;case"onScroll":l!=null&&je("scroll",e);break;case"onScrollEnd":l!=null&&je("scrollend",e);break;case"onClick":l!=null&&(e.onclick=Li);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ku.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(o=n.endsWith("Capture"),t=n.slice(2,o?n.length-7:void 0),d=e[xt]||null,d=d!=null?d[n]:null,typeof d=="function"&&e.removeEventListener(t,d,o),typeof l=="function")){typeof d!="function"&&d!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,l,o);break e}n in e?e[n]=l:l===!0?e.setAttribute(n,""):Br(e,n,l)}}}function ct(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":je("error",e),je("load",e);var l=!1,o=!1,d;for(d in n)if(n.hasOwnProperty(d)){var p=n[d];if(p!=null)switch(d){case"src":l=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Ue(e,t,d,p,n,null)}}o&&Ue(e,t,"srcSet",n.srcSet,n,null),l&&Ue(e,t,"src",n.src,n,null);return;case"input":je("invalid",e);var S=d=p=o=null,R=null,L=null;for(l in n)if(n.hasOwnProperty(l)){var H=n[l];if(H!=null)switch(l){case"name":o=H;break;case"type":p=H;break;case"checked":R=H;break;case"defaultChecked":L=H;break;case"value":d=H;break;case"defaultValue":S=H;break;case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(i(137,t));break;default:Ue(e,t,l,H,n,null)}}ad(e,d,S,R,L,p,o,!1),zr(e);return;case"select":je("invalid",e),l=p=d=null;for(o in n)if(n.hasOwnProperty(o)&&(S=n[o],S!=null))switch(o){case"value":d=S;break;case"defaultValue":p=S;break;case"multiple":l=S;default:Ue(e,t,o,S,n,null)}t=d,n=p,e.multiple=!!l,t!=null?Ds(e,!!l,t,!1):n!=null&&Ds(e,!!l,n,!0);return;case"textarea":je("invalid",e),d=o=l=null;for(p in n)if(n.hasOwnProperty(p)&&(S=n[p],S!=null))switch(p){case"value":l=S;break;case"defaultValue":o=S;break;case"children":d=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:Ue(e,t,p,S,n,null)}nd(e,l,o,d),zr(e);return;case"option":for(R in n)if(n.hasOwnProperty(R)&&(l=n[R],l!=null))switch(R){case"selected":e.selected=l&&typeof l!="function"&&typeof l!="symbol";break;default:Ue(e,t,R,l,n,null)}return;case"dialog":je("beforetoggle",e),je("toggle",e),je("cancel",e),je("close",e);break;case"iframe":case"object":je("load",e);break;case"video":case"audio":for(l=0;l<ar.length;l++)je(ar[l],e);break;case"image":je("error",e),je("load",e);break;case"details":je("toggle",e);break;case"embed":case"source":case"link":je("error",e),je("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(L in n)if(n.hasOwnProperty(L)&&(l=n[L],l!=null))switch(L){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Ue(e,t,L,l,n,null)}return;default:if(Ol(t)){for(H in n)n.hasOwnProperty(H)&&(l=n[H],l!==void 0&&yo(e,t,H,l,n,void 0));return}}for(S in n)n.hasOwnProperty(S)&&(l=n[S],l!=null&&Ue(e,t,S,l,n,null))}function bp(e,t,n,l){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var o=null,d=null,p=null,S=null,R=null,L=null,H=null;for(F in n){var G=n[F];if(n.hasOwnProperty(F)&&G!=null)switch(F){case"checked":break;case"value":break;case"defaultValue":R=G;default:l.hasOwnProperty(F)||Ue(e,t,F,null,l,G)}}for(var $ in l){var F=l[$];if(G=n[$],l.hasOwnProperty($)&&(F!=null||G!=null))switch($){case"type":d=F;break;case"name":o=F;break;case"checked":L=F;break;case"defaultChecked":H=F;break;case"value":p=F;break;case"defaultValue":S=F;break;case"children":case"dangerouslySetInnerHTML":if(F!=null)throw Error(i(137,t));break;default:F!==G&&Ue(e,t,$,F,l,G)}}Ml(e,p,S,R,L,H,d,o);return;case"select":F=p=S=$=null;for(d in n)if(R=n[d],n.hasOwnProperty(d)&&R!=null)switch(d){case"value":break;case"multiple":F=R;default:l.hasOwnProperty(d)||Ue(e,t,d,null,l,R)}for(o in l)if(d=l[o],R=n[o],l.hasOwnProperty(o)&&(d!=null||R!=null))switch(o){case"value":$=d;break;case"defaultValue":S=d;break;case"multiple":p=d;default:d!==R&&Ue(e,t,o,d,l,R)}t=S,n=p,l=F,$!=null?Ds(e,!!n,$,!1):!!l!=!!n&&(t!=null?Ds(e,!!n,t,!0):Ds(e,!!n,n?[]:"",!1));return;case"textarea":F=$=null;for(S in n)if(o=n[S],n.hasOwnProperty(S)&&o!=null&&!l.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:Ue(e,t,S,null,l,o)}for(p in l)if(o=l[p],d=n[p],l.hasOwnProperty(p)&&(o!=null||d!=null))switch(p){case"value":$=o;break;case"defaultValue":F=o;break;case"children":break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(i(91));break;default:o!==d&&Ue(e,t,p,o,l,d)}sd(e,$,F);return;case"option":for(var he in n)if($=n[he],n.hasOwnProperty(he)&&$!=null&&!l.hasOwnProperty(he))switch(he){case"selected":e.selected=!1;break;default:Ue(e,t,he,null,l,$)}for(R in l)if($=l[R],F=n[R],l.hasOwnProperty(R)&&$!==F&&($!=null||F!=null))switch(R){case"selected":e.selected=$&&typeof $!="function"&&typeof $!="symbol";break;default:Ue(e,t,R,$,l,F)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var fe in n)$=n[fe],n.hasOwnProperty(fe)&&$!=null&&!l.hasOwnProperty(fe)&&Ue(e,t,fe,null,l,$);for(L in l)if($=l[L],F=n[L],l.hasOwnProperty(L)&&$!==F&&($!=null||F!=null))switch(L){case"children":case"dangerouslySetInnerHTML":if($!=null)throw Error(i(137,t));break;default:Ue(e,t,L,$,l,F)}return;default:if(Ol(t)){for(var Le in n)$=n[Le],n.hasOwnProperty(Le)&&$!==void 0&&!l.hasOwnProperty(Le)&&yo(e,t,Le,void 0,l,$);for(H in l)$=l[H],F=n[H],!l.hasOwnProperty(H)||$===F||$===void 0&&F===void 0||yo(e,t,H,$,l,F);return}}for(var O in n)$=n[O],n.hasOwnProperty(O)&&$!=null&&!l.hasOwnProperty(O)&&Ue(e,t,O,null,l,$);for(G in l)$=l[G],F=n[G],!l.hasOwnProperty(G)||$===F||$==null&&F==null||Ue(e,t,G,$,l,F)}var vo=null,No=null;function ki(e){return e.nodeType===9?e:e.ownerDocument}function i0(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function l0(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function So(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var wo=null;function yp(){var e=window.event;return e&&e.type==="popstate"?e===wo?!1:(wo=e,!0):(wo=null,!1)}var c0=typeof setTimeout=="function"?setTimeout:void 0,vp=typeof clearTimeout=="function"?clearTimeout:void 0,o0=typeof Promise=="function"?Promise:void 0,Np=typeof queueMicrotask=="function"?queueMicrotask:typeof o0<"u"?function(e){return o0.resolve(null).then(e).catch(Sp)}:c0;function Sp(e){setTimeout(function(){throw e})}function za(e){return e==="head"}function u0(e,t){var n=t,l=0,o=0;do{var d=n.nextSibling;if(e.removeChild(n),d&&d.nodeType===8)if(n=d.data,n==="/$"){if(0<l&&8>l){n=l;var p=e.ownerDocument;if(n&1&&nr(p.documentElement),n&2&&nr(p.body),n&4)for(n=p.head,nr(n),p=n.firstChild;p;){var S=p.nextSibling,R=p.nodeName;p[yn]||R==="SCRIPT"||R==="STYLE"||R==="LINK"&&p.rel.toLowerCase()==="stylesheet"||n.removeChild(p),p=S}}if(o===0){e.removeChild(d),fr(t);return}o--}else n==="$"||n==="$?"||n==="$!"?o++:l=n.charCodeAt(0)-48;else l=0;n=d}while(n);fr(t)}function Eo(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Eo(n),Al(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function wp(e,t,n,l){for(;e.nodeType===1;){var o=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!l&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(l){if(!e[yn])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(d=e.getAttribute("rel"),d==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(d!==o.rel||e.getAttribute("href")!==(o.href==null||o.href===""?null:o.href)||e.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin)||e.getAttribute("title")!==(o.title==null?null:o.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(d=e.getAttribute("src"),(d!==(o.src==null?null:o.src)||e.getAttribute("type")!==(o.type==null?null:o.type)||e.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin))&&d&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var d=o.name==null?null:""+o.name;if(o.type==="hidden"&&e.getAttribute("name")===d)return e}else return e;if(e=Kt(e.nextSibling),e===null)break}return null}function Ep(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=Kt(e.nextSibling),e===null))return null;return e}function jo(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function jp(e,t){var n=e.ownerDocument;if(e.data!=="$?"||n.readyState==="complete")t();else{var l=function(){t(),n.removeEventListener("DOMContentLoaded",l)};n.addEventListener("DOMContentLoaded",l),e._reactRetry=l}}function Kt(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var Do=null;function d0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}function f0(e,t,n){switch(t=ki(n),e){case"html":if(e=t.documentElement,!e)throw Error(i(452));return e;case"head":if(e=t.head,!e)throw Error(i(453));return e;case"body":if(e=t.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function nr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Al(e)}var zt=new Map,m0=new Set;function $i(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Na=j.d;j.d={f:Dp,r:Rp,D:Ap,C:Cp,L:Tp,m:_p,X:Ip,S:Mp,M:Op};function Dp(){var e=Na.f(),t=Ti();return e||t}function Rp(e){var t=Ss(e);t!==null&&t.tag===5&&t.type==="form"?If(t):Na.r(e)}var an=typeof document>"u"?null:document;function h0(e,t,n){var l=an;if(l&&typeof t=="string"&&t){var o=Ut(t);o='link[rel="'+e+'"][href="'+o+'"]',typeof n=="string"&&(o+='[crossorigin="'+n+'"]'),m0.has(o)||(m0.add(o),e={rel:e,crossOrigin:n,href:t},l.querySelector(o)===null&&(t=l.createElement("link"),ct(t,"link",e),tt(t),l.head.appendChild(t)))}}function Ap(e){Na.D(e),h0("dns-prefetch",e,null)}function Cp(e,t){Na.C(e,t),h0("preconnect",e,t)}function Tp(e,t,n){Na.L(e,t,n);var l=an;if(l&&e&&t){var o='link[rel="preload"][as="'+Ut(t)+'"]';t==="image"&&n&&n.imageSrcSet?(o+='[imagesrcset="'+Ut(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(o+='[imagesizes="'+Ut(n.imageSizes)+'"]')):o+='[href="'+Ut(e)+'"]';var d=o;switch(t){case"style":d=sn(e);break;case"script":d=nn(e)}zt.has(d)||(e=y({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),zt.set(d,e),l.querySelector(o)!==null||t==="style"&&l.querySelector(rr(d))||t==="script"&&l.querySelector(ir(d))||(t=l.createElement("link"),ct(t,"link",e),tt(t),l.head.appendChild(t)))}}function _p(e,t){Na.m(e,t);var n=an;if(n&&e){var l=t&&typeof t.as=="string"?t.as:"script",o='link[rel="modulepreload"][as="'+Ut(l)+'"][href="'+Ut(e)+'"]',d=o;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":d=nn(e)}if(!zt.has(d)&&(e=y({rel:"modulepreload",href:e},t),zt.set(d,e),n.querySelector(o)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(ir(d)))return}l=n.createElement("link"),ct(l,"link",e),tt(l),n.head.appendChild(l)}}}function Mp(e,t,n){Na.S(e,t,n);var l=an;if(l&&e){var o=ws(l).hoistableStyles,d=sn(e);t=t||"default";var p=o.get(d);if(!p){var S={loading:0,preload:null};if(p=l.querySelector(rr(d)))S.loading=5;else{e=y({rel:"stylesheet",href:e,"data-precedence":t},n),(n=zt.get(d))&&Ro(e,n);var R=p=l.createElement("link");tt(R),ct(R,"link",e),R._p=new Promise(function(L,H){R.onload=L,R.onerror=H}),R.addEventListener("load",function(){S.loading|=1}),R.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Fi(p,t,l)}p={type:"stylesheet",instance:p,count:1,state:S},o.set(d,p)}}}function Ip(e,t){Na.X(e,t);var n=an;if(n&&e){var l=ws(n).hoistableScripts,o=nn(e),d=l.get(o);d||(d=n.querySelector(ir(o)),d||(e=y({src:e,async:!0},t),(t=zt.get(o))&&Ao(e,t),d=n.createElement("script"),tt(d),ct(d,"link",e),n.head.appendChild(d)),d={type:"script",instance:d,count:1,state:null},l.set(o,d))}}function Op(e,t){Na.M(e,t);var n=an;if(n&&e){var l=ws(n).hoistableScripts,o=nn(e),d=l.get(o);d||(d=n.querySelector(ir(o)),d||(e=y({src:e,async:!0,type:"module"},t),(t=zt.get(o))&&Ao(e,t),d=n.createElement("script"),tt(d),ct(d,"link",e),n.head.appendChild(d)),d={type:"script",instance:d,count:1,state:null},l.set(o,d))}}function g0(e,t,n,l){var o=(o=ne.current)?$i(o):null;if(!o)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=sn(n.href),n=ws(o).hoistableStyles,l=n.get(t),l||(l={type:"style",instance:null,count:0,state:null},n.set(t,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=sn(n.href);var d=ws(o).hoistableStyles,p=d.get(e);if(p||(o=o.ownerDocument||o,p={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,p),(d=o.querySelector(rr(e)))&&!d._p&&(p.instance=d,p.state.loading=5),zt.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},zt.set(e,n),d||Vp(o,e,n,p.state))),t&&l===null)throw Error(i(528,""));return p}if(t&&l!==null)throw Error(i(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=nn(n),n=ws(o).hoistableScripts,l=n.get(t),l||(l={type:"script",instance:null,count:0,state:null},n.set(t,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function sn(e){return'href="'+Ut(e)+'"'}function rr(e){return'link[rel="stylesheet"]['+e+"]"}function x0(e){return y({},e,{"data-precedence":e.precedence,precedence:null})}function Vp(e,t,n,l){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?l.loading=1:(t=e.createElement("link"),l.preload=t,t.addEventListener("load",function(){return l.loading|=1}),t.addEventListener("error",function(){return l.loading|=2}),ct(t,"link",n),tt(t),e.head.appendChild(t))}function nn(e){return'[src="'+Ut(e)+'"]'}function ir(e){return"script[async]"+e}function p0(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var l=e.querySelector('style[data-href~="'+Ut(n.href)+'"]');if(l)return t.instance=l,tt(l),l;var o=y({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return l=(e.ownerDocument||e).createElement("style"),tt(l),ct(l,"style",o),Fi(l,n.precedence,e),t.instance=l;case"stylesheet":o=sn(n.href);var d=e.querySelector(rr(o));if(d)return t.state.loading|=4,t.instance=d,tt(d),d;l=x0(n),(o=zt.get(o))&&Ro(l,o),d=(e.ownerDocument||e).createElement("link"),tt(d);var p=d;return p._p=new Promise(function(S,R){p.onload=S,p.onerror=R}),ct(d,"link",l),t.state.loading|=4,Fi(d,n.precedence,e),t.instance=d;case"script":return d=nn(n.src),(o=e.querySelector(ir(d)))?(t.instance=o,tt(o),o):(l=n,(o=zt.get(d))&&(l=y({},n),Ao(l,o)),e=e.ownerDocument||e,o=e.createElement("script"),tt(o),ct(o,"link",l),e.head.appendChild(o),t.instance=o);case"void":return null;default:throw Error(i(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(l=t.instance,t.state.loading|=4,Fi(l,n.precedence,e));return t.instance}function Fi(e,t,n){for(var l=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),o=l.length?l[l.length-1]:null,d=o,p=0;p<l.length;p++){var S=l[p];if(S.dataset.precedence===t)d=S;else if(d!==o)break}d?d.parentNode.insertBefore(e,d.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Ro(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Ao(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Bi=null;function b0(e,t,n){if(Bi===null){var l=new Map,o=Bi=new Map;o.set(n,l)}else o=Bi,l=o.get(n),l||(l=new Map,o.set(n,l));if(l.has(e))return l;for(l.set(e,null),n=n.getElementsByTagName(e),o=0;o<n.length;o++){var d=n[o];if(!(d[yn]||d[ut]||e==="link"&&d.getAttribute("rel")==="stylesheet")&&d.namespaceURI!=="http://www.w3.org/2000/svg"){var p=d.getAttribute(t)||"";p=e+p;var S=l.get(p);S?S.push(d):l.set(p,[d])}}return l}function y0(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Up(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function v0(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var lr=null;function Lp(){}function kp(e,t,n){if(lr===null)throw Error(i(475));var l=lr;if(t.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&(t.state.loading&4)===0){if(t.instance===null){var o=sn(n.href),d=e.querySelector(rr(o));if(d){e=d._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(l.count++,l=Pi.bind(l),e.then(l,l)),t.state.loading|=4,t.instance=d,tt(d);return}d=e.ownerDocument||e,n=x0(n),(o=zt.get(o))&&Ro(n,o),d=d.createElement("link"),tt(d);var p=d;p._p=new Promise(function(S,R){p.onload=S,p.onerror=R}),ct(d,"link",n),t.instance=d}l.stylesheets===null&&(l.stylesheets=new Map),l.stylesheets.set(t,e),(e=t.state.preload)&&(t.state.loading&3)===0&&(l.count++,t=Pi.bind(l),e.addEventListener("load",t),e.addEventListener("error",t))}}function $p(){if(lr===null)throw Error(i(475));var e=lr;return e.stylesheets&&e.count===0&&Co(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Co(e,e.stylesheets),e.unsuspend){var l=e.unsuspend;e.unsuspend=null,l()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}function Pi(){if(this.count--,this.count===0){if(this.stylesheets)Co(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var zi=null;function Co(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,zi=new Map,t.forEach(Fp,e),zi=null,Pi.call(e))}function Fp(e,t){if(!(t.state.loading&4)){var n=zi.get(e);if(n)var l=n.get(null);else{n=new Map,zi.set(e,n);for(var o=e.querySelectorAll("link[data-precedence],style[data-precedence]"),d=0;d<o.length;d++){var p=o[d];(p.nodeName==="LINK"||p.getAttribute("media")!=="not all")&&(n.set(p.dataset.precedence,p),l=p)}l&&n.set(null,l)}o=t.instance,p=o.getAttribute("data-precedence"),d=n.get(p)||l,d===l&&n.set(null,o),n.set(p,o),this.count++,l=Pi.bind(this),o.addEventListener("load",l),o.addEventListener("error",l),d?d.parentNode.insertBefore(o,d.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(o,e.firstChild)),t.state.loading|=4}}var cr={$$typeof:W,Provider:null,Consumer:null,_currentValue:P,_currentValue2:P,_threadCount:0};function Bp(e,t,n,l,o,d,p,S){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=El(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=El(0),this.hiddenUpdates=El(null),this.identifierPrefix=l,this.onUncaughtError=o,this.onCaughtError=d,this.onRecoverableError=p,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=S,this.incompleteTransitions=new Map}function N0(e,t,n,l,o,d,p,S,R,L,H,G){return e=new Bp(e,t,n,p,S,R,L,G),t=1,d===!0&&(t|=24),d=Et(3,null,null,t),e.current=d,d.stateNode=e,t=oc(),t.refCount++,e.pooledCache=t,t.refCount++,d.memoizedState={element:l,isDehydrated:n,cache:t},mc(d),e}function S0(e){return e?(e=Vs,e):Vs}function w0(e,t,n,l,o,d){o=S0(o),l.context===null?l.context=o:l.pendingContext=o,l=Ta(t),l.payload={element:n},d=d===void 0?null:d,d!==null&&(l.callback=d),n=_a(e,l,t),n!==null&&(Ct(n,e,t),kn(n,e,t))}function E0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function To(e,t){E0(e,t),(e=e.alternate)&&E0(e,t)}function j0(e){if(e.tag===13){var t=Os(e,67108864);t!==null&&Ct(t,e,67108864),To(e,67108864)}}var qi=!0;function Pp(e,t,n,l){var o=M.T;M.T=null;var d=j.p;try{j.p=2,_o(e,t,n,l)}finally{j.p=d,M.T=o}}function zp(e,t,n,l){var o=M.T;M.T=null;var d=j.p;try{j.p=8,_o(e,t,n,l)}finally{j.p=d,M.T=o}}function _o(e,t,n,l){if(qi){var o=Mo(l);if(o===null)bo(e,t,l,Hi,n),R0(e,l);else if(Hp(o,e,t,n,l))l.stopPropagation();else if(R0(e,l),t&4&&-1<qp.indexOf(e)){for(;o!==null;){var d=Ss(o);if(d!==null)switch(d.tag){case 3:if(d=d.stateNode,d.current.memoizedState.isDehydrated){var p=Wa(d.pendingLanes);if(p!==0){var S=d;for(S.pendingLanes|=2,S.entangledLanes|=2;p;){var R=1<<31-St(p);S.entanglements[1]|=R,p&=~R}na(d),(Ie&6)===0&&(Ai=Ot()+500,tr(0))}}break;case 13:S=Os(d,2),S!==null&&Ct(S,d,2),Ti(),To(d,2)}if(d=Mo(l),d===null&&bo(e,t,l,Hi,n),d===o)break;o=d}o!==null&&l.stopPropagation()}else bo(e,t,l,null,n)}}function Mo(e){return e=Ul(e),Io(e)}var Hi=null;function Io(e){if(Hi=null,e=Ns(e),e!==null){var t=u(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=m(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Hi=e,null}function D0(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Cg()){case $u:return 2;case Fu:return 8;case Lr:case Tg:return 32;case Bu:return 268435456;default:return 32}default:return 32}}var Oo=!1,qa=null,Ha=null,Ya=null,or=new Map,ur=new Map,Ga=[],qp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function R0(e,t){switch(e){case"focusin":case"focusout":qa=null;break;case"dragenter":case"dragleave":Ha=null;break;case"mouseover":case"mouseout":Ya=null;break;case"pointerover":case"pointerout":or.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ur.delete(t.pointerId)}}function dr(e,t,n,l,o,d){return e===null||e.nativeEvent!==d?(e={blockedOn:t,domEventName:n,eventSystemFlags:l,nativeEvent:d,targetContainers:[o]},t!==null&&(t=Ss(t),t!==null&&j0(t)),e):(e.eventSystemFlags|=l,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function Hp(e,t,n,l,o){switch(t){case"focusin":return qa=dr(qa,e,t,n,l,o),!0;case"dragenter":return Ha=dr(Ha,e,t,n,l,o),!0;case"mouseover":return Ya=dr(Ya,e,t,n,l,o),!0;case"pointerover":var d=o.pointerId;return or.set(d,dr(or.get(d)||null,e,t,n,l,o)),!0;case"gotpointercapture":return d=o.pointerId,ur.set(d,dr(ur.get(d)||null,e,t,n,l,o)),!0}return!1}function A0(e){var t=Ns(e.target);if(t!==null){var n=u(t);if(n!==null){if(t=n.tag,t===13){if(t=m(n),t!==null){e.blockedOn=t,kg(e.priority,function(){if(n.tag===13){var l=At();l=jl(l);var o=Os(n,l);o!==null&&Ct(o,n,l),To(n,l)}});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Yi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Mo(e.nativeEvent);if(n===null){n=e.nativeEvent;var l=new n.constructor(n.type,n);Vl=l,n.target.dispatchEvent(l),Vl=null}else return t=Ss(n),t!==null&&j0(t),e.blockedOn=n,!1;t.shift()}return!0}function C0(e,t,n){Yi(e)&&n.delete(t)}function Yp(){Oo=!1,qa!==null&&Yi(qa)&&(qa=null),Ha!==null&&Yi(Ha)&&(Ha=null),Ya!==null&&Yi(Ya)&&(Ya=null),or.forEach(C0),ur.forEach(C0)}function Gi(e,t){e.blockedOn===t&&(e.blockedOn=null,Oo||(Oo=!0,f.unstable_scheduleCallback(f.unstable_NormalPriority,Yp)))}var Xi=null;function T0(e){Xi!==e&&(Xi=e,f.unstable_scheduleCallback(f.unstable_NormalPriority,function(){Xi===e&&(Xi=null);for(var t=0;t<e.length;t+=3){var n=e[t],l=e[t+1],o=e[t+2];if(typeof l!="function"){if(Io(l||n)===null)continue;break}var d=Ss(n);d!==null&&(e.splice(t,3),t-=3,Mc(d,{pending:!0,data:o,method:n.method,action:l},l,o))}}))}function fr(e){function t(R){return Gi(R,e)}qa!==null&&Gi(qa,e),Ha!==null&&Gi(Ha,e),Ya!==null&&Gi(Ya,e),or.forEach(t),ur.forEach(t);for(var n=0;n<Ga.length;n++){var l=Ga[n];l.blockedOn===e&&(l.blockedOn=null)}for(;0<Ga.length&&(n=Ga[0],n.blockedOn===null);)A0(n),n.blockedOn===null&&Ga.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(l=0;l<n.length;l+=3){var o=n[l],d=n[l+1],p=o[xt]||null;if(typeof d=="function")p||T0(n);else if(p){var S=null;if(d&&d.hasAttribute("formAction")){if(o=d,p=d[xt]||null)S=p.formAction;else if(Io(o)!==null)continue}else S=p.action;typeof S=="function"?n[l+1]=S:(n.splice(l,3),l-=3),T0(n)}}}function Vo(e){this._internalRoot=e}Ki.prototype.render=Vo.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(i(409));var n=t.current,l=At();w0(n,l,e,t,null,null)},Ki.prototype.unmount=Vo.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;w0(e.current,2,null,e,null,null),Ti(),t[vs]=null}};function Ki(e){this._internalRoot=e}Ki.prototype.unstable_scheduleHydration=function(e){if(e){var t=Yu();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ga.length&&t!==0&&t<Ga[n].priority;n++);Ga.splice(n,0,e),n===0&&A0(e)}};var _0=a.version;if(_0!=="19.1.0")throw Error(i(527,_0,"19.1.0"));j.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=g(t),e=e!==null?x(e):null,e=e===null?null:e.stateNode,e};var Gp={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:M,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zi.isDisabled&&Zi.supportsFiber)try{xn=Zi.inject(Gp),Nt=Zi}catch{}}return hr.createRoot=function(e,t){if(!c(e))throw Error(i(299));var n=!1,l="",o=Gf,d=Xf,p=Kf,S=null;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onUncaughtError!==void 0&&(o=t.onUncaughtError),t.onCaughtError!==void 0&&(d=t.onCaughtError),t.onRecoverableError!==void 0&&(p=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(S=t.unstable_transitionCallbacks)),t=N0(e,1,!1,null,null,n,l,o,d,p,S,null),e[vs]=t.current,po(e),new Vo(t)},hr.hydrateRoot=function(e,t,n){if(!c(e))throw Error(i(299));var l=!1,o="",d=Gf,p=Xf,S=Kf,R=null,L=null;return n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onUncaughtError!==void 0&&(d=n.onUncaughtError),n.onCaughtError!==void 0&&(p=n.onCaughtError),n.onRecoverableError!==void 0&&(S=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(R=n.unstable_transitionCallbacks),n.formState!==void 0&&(L=n.formState)),t=N0(e,1,!0,t,n??null,l,o,d,p,S,R,L),t.context=S0(null),n=t.current,l=At(),l=jl(l),o=Ta(l),o.callback=null,_a(n,o,l),n=l,t.current.lanes=n,bn(t,n),na(t),e[vs]=t.current,po(e),new Ki(t)},hr.version="19.1.0",hr}var B0;function ib(){if(B0)return ko.exports;B0=1;function f(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(f)}catch(a){console.error(a)}}return f(),ko.exports=rb(),ko.exports}var lb=ib();const cb=Au(lb);class ob{parseTruckNumber(a){const s=this.parseFromLicensePlate(a.licensePlate);if(s.confidence==="high")return s;if(a.dotNumber){const c=this.parseFromDOTNumber(a.dotNumber);if(c.confidence==="high")return c}const i=this.parseFromVIN(a.vin);if(i.confidence==="medium")return i;if(a.registrationNumber){const c=this.parseFromRegistrationNumber(a.registrationNumber);if(c.confidence==="medium")return c}return this.generateFromVIN(a.vin)}parseFromLicensePlate(a){const s=a.toUpperCase().replace(/[^A-Z0-9]/g,"");let i=s.match(/(?:TRK|TRUCK)(\d+)/);return i?{truckNumber:`Truck #${parseInt(i[1]).toString().padStart(3,"0")}`,confidence:"high",source:"license_plate",originalValue:a,needsReview:!1}:(i=s.match(/(?:FLEET|FLT)(\d+)/),i?{truckNumber:`Truck #${parseInt(i[1]).toString().padStart(3,"0")}`,confidence:"high",source:"license_plate",originalValue:a,needsReview:!1}:(i=s.match(/(?:UNIT|U)(\d+)/),i?{truckNumber:`Truck #${parseInt(i[1]).toString().padStart(3,"0")}`,confidence:"high",source:"license_plate",originalValue:a,needsReview:!1}:(i=s.match(/([A-Z]+)(\d{2,3})$/),i&&parseInt(i[2])<=999?{truckNumber:`Truck #${parseInt(i[2]).toString().padStart(3,"0")}`,confidence:"medium",source:"license_plate",originalValue:a,needsReview:!0}:(i=s.match(/^(\d{2,3})([A-Z]+)/),i&&parseInt(i[1])<=999?{truckNumber:`Truck #${parseInt(i[1]).toString().padStart(3,"0")}`,confidence:"medium",source:"license_plate",originalValue:a,needsReview:!0}:{truckNumber:"",confidence:"low",source:"license_plate",originalValue:a,needsReview:!0}))))}parseFromDOTNumber(a){const i=a.replace(/[^0-9]/g,"").slice(-3),c=parseInt(i);return c>=1&&c<=999?{truckNumber:`Truck #${c.toString().padStart(3,"0")}`,confidence:"medium",source:"dot_number",originalValue:a,needsReview:!0}:{truckNumber:"",confidence:"low",source:"dot_number",originalValue:a,needsReview:!0}}parseFromVIN(a){const s=a.match(/(\d{2,3})/g);if(s)for(const i of s){const c=parseInt(i);if(c>=1&&c<=999)return{truckNumber:`Truck #${c.toString().padStart(3,"0")}`,confidence:"low",source:"vin_pattern",originalValue:a,needsReview:!0}}return{truckNumber:"",confidence:"low",source:"vin_pattern",originalValue:a,needsReview:!0}}parseFromRegistrationNumber(a){const i=a.toUpperCase().replace(/[^A-Z0-9]/g,"").match(/(\d{2,3})/);if(i){const c=parseInt(i[1]);if(c>=1&&c<=999)return{truckNumber:`Truck #${c.toString().padStart(3,"0")}`,confidence:"medium",source:"document_text",originalValue:a,needsReview:!0}}return{truckNumber:"",confidence:"low",source:"document_text",originalValue:a,needsReview:!0}}generateFromVIN(a){const s=a.slice(-3),i=parseInt(s.replace(/[^0-9]/g,""));return i>0?{truckNumber:`Unit ${i.toString().padStart(3,"0")}`,confidence:"low",source:"generated",originalValue:a,needsReview:!0}:{truckNumber:`Vehicle ${a.slice(-4)}`,confidence:"low",source:"generated",originalValue:a,needsReview:!0}}parseFromDocumentText(a){const s=[],i=a.toUpperCase(),c=i.match(/LICENSE\s+PLATE:\s*([A-Z0-9]+)/);if(c){const m=this.parseFromLicensePlate(c[1]);m.confidence!=="low"&&s.push({...m,source:"document_license_plate"})}return[/(?:TRUCK|VEHICLE|UNIT)\s*#?(\d{1,3})/g,/(?:FLEET)\s*#?(\d{1,3})/g,/(?:ID|IDENTIFIER)\s*#?(\d{1,3})/g,/(?:NUMBER|NO\.?)\s*(\d{1,3})/g,/TRK(\d{1,3})/g].forEach(m=>{let h;for(;(h=m.exec(i))!==null;){const g=parseInt(h[1]);g>=1&&g<=999&&s.push({truckNumber:`Truck #${g.toString().padStart(3,"0")}`,confidence:"medium",source:"document_text",originalValue:h[0],needsReview:!1})}}),s}validateTruckNumber(a){const s=a.trim(),i=[{regex:/^(?:truck|unit|vehicle)\s*#?(\d{1,3})$/i,format:"Truck #"},{regex:/^#?(\d{1,3})$/,format:"Truck #"},{regex:/^t(\d{1,3})$/i,format:"Truck #"}];for(const c of i){const u=s.match(c.regex);if(u){const m=parseInt(u[1]);if(m>=1&&m<=999)return{isValid:!0,cleaned:`${c.format}${m.toString().padStart(3,"0")}`}}}return{isValid:!1,cleaned:s,suggestion:'Format: "Truck #001" or just "47" for Truck #047'}}getDisplayNumber(a){const s=a.match(/(\d+)/);return s?`#${s[1]}`:a}findDuplicates(a){const s=new Map;return a.forEach(i=>{const c=s.get(i.truckNumber)||[];c.push(i.vin),s.set(i.truckNumber,c)}),Array.from(s.entries()).filter(([i,c])=>c.length>1).map(([i,c])=>({truckNumber:i,vins:c}))}}const vu=new ob;class ub{constructor(){ce(this,"errors",[]);ce(this,"notifications",[]);ce(this,"listeners",[]);ce(this,"notificationListeners",[])}handleOCRError(a,s,i){const c={id:this.generateId(),type:"ocr",severity:"medium",message:`OCR processing failed for ${s}: ${a instanceof Error?a.message:String(a)}`,userMessage:`Unable to read text from ${s}. The file may be corrupted, low quality, or contain handwritten text.`,details:{fileName:s,originalError:a},timestamp:new Date,resolved:!1,actions:i?[{label:"Retry",type:"retry",handler:i},{label:"Skip File",type:"dismiss",handler:()=>this.resolveError(c.id)}]:void 0};return this.addError(c),this.addNotification({id:this.generateId(),message:`Failed to process ${s}. Using fallback data.`,type:"warning",duration:5e3}),c}handleValidationError(a,s,i){const c={id:this.generateId(),type:"validation",severity:"medium",message:`Validation failed for ${a}: ${JSON.stringify(s)}`,userMessage:`Invalid ${a}: ${i.join(", ")}`,details:{field:a,value:s,requirements:i},timestamp:new Date,resolved:!1};return this.addError(c),c}handleStorageError(a,s,i){const c={id:this.generateId(),type:"storage",severity:"high",message:`Storage operation failed: ${a} - ${s instanceof Error?s.message:String(s)}`,userMessage:"Unable to save data. Your browser storage may be full or disabled.",details:{operation:a,originalError:s},timestamp:new Date,resolved:!1,actions:[{label:"Clear Old Data",type:"retry",handler:()=>{this.clearOldData(),i==null||i()}},{label:"Export Data",type:"redirect",handler:()=>this.exportDataForRecovery()}]};return this.addError(c),this.addNotification({id:this.generateId(),message:"Storage error: Unable to save changes",type:"error",actions:c.actions}),c}handleCriticalError(a,s){const i={id:this.generateId(),type:"system",severity:"critical",message:`Critical error in ${s}: ${a instanceof Error?a.message:String(a)}`,userMessage:"A critical error occurred. Please refresh the page or contact support.",details:{context:s,originalError:a,stack:a instanceof Error?a.stack:void 0},timestamp:new Date,resolved:!1,actions:[{label:"Refresh Page",type:"refresh",handler:()=>window.location.reload()}]};return this.addError(i),this.addNotification({id:this.generateId(),message:"Critical error occurred - please refresh the page",type:"error",actions:i.actions}),console.error("Critical Error:",i),i}handleUserError(a,s){const i={id:this.generateId(),type:"user",severity:"low",message:a,userMessage:s||a,timestamp:new Date,resolved:!1};return this.addError(i),this.addNotification({id:this.generateId(),message:i.userMessage,type:"info",duration:3e3}),i}showSuccess(a,s=3e3){this.addNotification({id:this.generateId(),message:a,type:"success",duration:s})}showInfo(a,s){this.addNotification({id:this.generateId(),message:a,type:"info",duration:s})}addError(a){this.errors.unshift(a),this.errors.length>50&&(this.errors=this.errors.slice(0,50)),this.notifyListeners()}addNotification(a){this.notifications.unshift(a),a.duration&&setTimeout(()=>{this.dismissNotification(a.id)},a.duration),this.notifyNotificationListeners()}resolveError(a){const s=this.errors.find(i=>i.id===a);s&&(s.resolved=!0,this.notifyListeners())}dismissNotification(a){this.notifications=this.notifications.filter(s=>s.id!==a),this.notifyNotificationListeners()}getErrors(){return[...this.errors]}getNotifications(){return[...this.notifications]}getUnresolvedErrors(){return this.errors.filter(a=>!a.resolved)}subscribe(a){return this.listeners.push(a),()=>{this.listeners=this.listeners.filter(s=>s!==a)}}subscribeToNotifications(a){return this.notificationListeners.push(a),()=>{this.notificationListeners=this.notificationListeners.filter(s=>s!==a)}}clearAll(){this.errors=[],this.notifications=[],this.notifyListeners(),this.notifyNotificationListeners()}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2,9)}notifyListeners(){this.listeners.forEach(a=>a(this.errors))}notifyNotificationListeners(){this.notificationListeners.forEach(a=>a(this.notifications))}clearOldData(){try{Object.keys(localStorage).filter(i=>i.startsWith("truckbo_")&&!i.includes("drivers_data")&&!i.includes("fleet_data")).forEach(i=>localStorage.removeItem(i)),this.showSuccess("Cleared old data to free up storage space")}catch(a){console.error("Failed to clear old data:",a)}}exportDataForRecovery(){try{const a={drivers:JSON.parse(localStorage.getItem("truckbo_drivers_data")||"[]"),fleet:JSON.parse(localStorage.getItem("truckbo_fleet_data")||"[]"),timestamp:new Date().toISOString()},s=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),i=URL.createObjectURL(s),c=document.createElement("a");c.href=i,c.download=`truckbo-backup-${new Date().toISOString().split("T")[0]}.json`,c.click(),URL.revokeObjectURL(i),this.showSuccess("Data exported successfully")}catch(a){console.error("Failed to export data:",a),this.handleCriticalError(a,"data export")}}}const De=new ub,qh={},db=Object.freeze(Object.defineProperty({__proto__:null,default:qh},Symbol.toStringTag,{value:"Module"}));function fb(f){try{return crypto.getRandomValues(new Uint8Array(f))}catch{}try{return qh.randomBytes(f)}catch{}throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative")}function mb(f,a){if(f=f||Hh,typeof f!="number")throw Error("Illegal arguments: "+typeof f+", "+typeof a);f<4?f=4:f>31&&(f=31);var s=[];return s.push("$2b$"),f<10&&s.push("0"),s.push(f.toString()),s.push("$"),s.push(Su(fb(Tr),Tr)),s.join("")}function hb(f,a,s){if(typeof a=="function"&&(s=a,a=void 0),typeof f=="function"&&(s=f,f=void 0),typeof f>"u")f=Hh;else if(typeof f!="number")throw Error("illegal arguments: "+typeof f);function i(c){Qt(function(){try{c(null,mb(f))}catch(u){c(u)}})}if(s){if(typeof s!="function")throw Error("Illegal callback: "+typeof s);i(s)}else return new Promise(function(c,u){i(function(m,h){if(m){u(m);return}c(h)})})}function Nu(f,a,s,i){function c(u){typeof f=="string"&&typeof a=="number"?hb(a,function(m,h){Y0(f,h,u,i)}):typeof f=="string"&&typeof a=="string"?Y0(f,a,u,i):Qt(u.bind(this,Error("Illegal arguments: "+typeof f+", "+typeof a)))}if(s){if(typeof s!="function")throw Error("Illegal callback: "+typeof s);c(s)}else return new Promise(function(u,m){c(function(h,g){if(h){m(h);return}u(g)})})}function gb(f,a){for(var s=f.length^a.length,i=0;i<f.length;++i)s|=f.charCodeAt(i)^a.charCodeAt(i);return s===0}function xb(f,a,s,i){function c(u){if(typeof f!="string"||typeof a!="string"){Qt(u.bind(this,Error("Illegal arguments: "+typeof f+", "+typeof a)));return}if(a.length!==60){Qt(u.bind(this,null,!1));return}Nu(f,a.substring(0,29),function(m,h){m?u(m):u(null,gb(h,a))},i)}if(s){if(typeof s!="function")throw Error("Illegal callback: "+typeof s);c(s)}else return new Promise(function(u,m){c(function(h,g){if(h){m(h);return}u(g)})})}var Qt=typeof process<"u"&&process&&typeof process.nextTick=="function"?typeof setImmediate=="function"?setImmediate:process.nextTick:setTimeout;function pb(f){for(var a=0,s=0,i=0;i<f.length;++i)s=f.charCodeAt(i),s<128?a+=1:s<2048?a+=2:(s&64512)===55296&&(f.charCodeAt(i+1)&64512)===56320?(++i,a+=4):a+=3;return a}function bb(f){for(var a=0,s,i,c=new Array(pb(f)),u=0,m=f.length;u<m;++u)s=f.charCodeAt(u),s<128?c[a++]=s:s<2048?(c[a++]=s>>6|192,c[a++]=s&63|128):(s&64512)===55296&&((i=f.charCodeAt(u+1))&64512)===56320?(s=65536+((s&1023)<<10)+(i&1023),++u,c[a++]=s>>18|240,c[a++]=s>>12&63|128,c[a++]=s>>6&63|128,c[a++]=s&63|128):(c[a++]=s>>12|224,c[a++]=s>>6&63|128,c[a++]=s&63|128);return c}var rn="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),Ka=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1];function Su(f,a){var s=0,i=[],c,u;if(a<=0||a>f.length)throw Error("Illegal len: "+a);for(;s<a;){if(c=f[s++]&255,i.push(rn[c>>2&63]),c=(c&3)<<4,s>=a){i.push(rn[c&63]);break}if(u=f[s++]&255,c|=u>>4&15,i.push(rn[c&63]),c=(u&15)<<2,s>=a){i.push(rn[c&63]);break}u=f[s++]&255,c|=u>>6&3,i.push(rn[c&63]),i.push(rn[u&63])}return i.join("")}function yb(f,a){for(var s=0,i=f.length,c=0,u=[],m,h,g,x,y,w;s<i-1&&c<a&&(w=f.charCodeAt(s++),m=w<Ka.length?Ka[w]:-1,w=f.charCodeAt(s++),h=w<Ka.length?Ka[w]:-1,!(m==-1||h==-1||(y=m<<2>>>0,y|=(h&48)>>4,u.push(String.fromCharCode(y)),++c>=a||s>=i)||(w=f.charCodeAt(s++),g=w<Ka.length?Ka[w]:-1,g==-1)||(y=(h&15)<<4>>>0,y|=(g&60)>>2,u.push(String.fromCharCode(y)),++c>=a||s>=i)));)w=f.charCodeAt(s++),x=w<Ka.length?Ka[w]:-1,y=(g&3)<<6>>>0,y|=x,u.push(String.fromCharCode(y)),++c;var D=[];for(s=0;s<c;s++)D.push(u[s].charCodeAt(0));return D}var Tr=16,Hh=10,vb=16,Nb=100,P0=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],z0=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],Yh=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function _r(f,a,s,i){var c,u=f[a],m=f[a+1];return u^=s[0],c=i[u>>>24],c+=i[256|u>>16&255],c^=i[512|u>>8&255],c+=i[768|u&255],m^=c^s[1],c=i[m>>>24],c+=i[256|m>>16&255],c^=i[512|m>>8&255],c+=i[768|m&255],u^=c^s[2],c=i[u>>>24],c+=i[256|u>>16&255],c^=i[512|u>>8&255],c+=i[768|u&255],m^=c^s[3],c=i[m>>>24],c+=i[256|m>>16&255],c^=i[512|m>>8&255],c+=i[768|m&255],u^=c^s[4],c=i[u>>>24],c+=i[256|u>>16&255],c^=i[512|u>>8&255],c+=i[768|u&255],m^=c^s[5],c=i[m>>>24],c+=i[256|m>>16&255],c^=i[512|m>>8&255],c+=i[768|m&255],u^=c^s[6],c=i[u>>>24],c+=i[256|u>>16&255],c^=i[512|u>>8&255],c+=i[768|u&255],m^=c^s[7],c=i[m>>>24],c+=i[256|m>>16&255],c^=i[512|m>>8&255],c+=i[768|m&255],u^=c^s[8],c=i[u>>>24],c+=i[256|u>>16&255],c^=i[512|u>>8&255],c+=i[768|u&255],m^=c^s[9],c=i[m>>>24],c+=i[256|m>>16&255],c^=i[512|m>>8&255],c+=i[768|m&255],u^=c^s[10],c=i[u>>>24],c+=i[256|u>>16&255],c^=i[512|u>>8&255],c+=i[768|u&255],m^=c^s[11],c=i[m>>>24],c+=i[256|m>>16&255],c^=i[512|m>>8&255],c+=i[768|m&255],u^=c^s[12],c=i[u>>>24],c+=i[256|u>>16&255],c^=i[512|u>>8&255],c+=i[768|u&255],m^=c^s[13],c=i[m>>>24],c+=i[256|m>>16&255],c^=i[512|m>>8&255],c+=i[768|m&255],u^=c^s[14],c=i[u>>>24],c+=i[256|u>>16&255],c^=i[512|u>>8&255],c+=i[768|u&255],m^=c^s[15],c=i[m>>>24],c+=i[256|m>>16&255],c^=i[512|m>>8&255],c+=i[768|m&255],u^=c^s[16],f[a]=m^s[vb+1],f[a+1]=u,f}function on(f,a){for(var s=0,i=0;s<4;++s)i=i<<8|f[a]&255,a=(a+1)%f.length;return{key:i,offp:a}}function q0(f,a,s){for(var i=0,c=[0,0],u=a.length,m=s.length,h,g=0;g<u;g++)h=on(f,i),i=h.offp,a[g]=a[g]^h.key;for(g=0;g<u;g+=2)c=_r(c,0,a,s),a[g]=c[0],a[g+1]=c[1];for(g=0;g<m;g+=2)c=_r(c,0,a,s),s[g]=c[0],s[g+1]=c[1]}function Sb(f,a,s,i){for(var c=0,u=[0,0],m=s.length,h=i.length,g,x=0;x<m;x++)g=on(a,c),c=g.offp,s[x]=s[x]^g.key;for(c=0,x=0;x<m;x+=2)g=on(f,c),c=g.offp,u[0]^=g.key,g=on(f,c),c=g.offp,u[1]^=g.key,u=_r(u,0,s,i),s[x]=u[0],s[x+1]=u[1];for(x=0;x<h;x+=2)g=on(f,c),c=g.offp,u[0]^=g.key,g=on(f,c),c=g.offp,u[1]^=g.key,u=_r(u,0,s,i),i[x]=u[0],i[x+1]=u[1]}function H0(f,a,s,i,c){var u=Yh.slice(),m=u.length,h;if(s<4||s>31)if(h=Error("Illegal number of rounds (4-31): "+s),i){Qt(i.bind(this,h));return}else throw h;if(a.length!==Tr)if(h=Error("Illegal salt length: "+a.length+" != "+Tr),i){Qt(i.bind(this,h));return}else throw h;s=1<<s>>>0;var g,x,y=0,w;typeof Int32Array=="function"?(g=new Int32Array(P0),x=new Int32Array(z0)):(g=P0.slice(),x=z0.slice()),Sb(a,f,g,x);function D(){if(c&&c(y/s),y<s)for(var v=Date.now();y<s&&(y=y+1,q0(f,g,x),q0(a,g,x),!(Date.now()-v>Nb)););else{for(y=0;y<64;y++)for(w=0;w<m>>1;w++)_r(u,w<<1,g,x);var E=[];for(y=0;y<m;y++)E.push((u[y]>>24&255)>>>0),E.push((u[y]>>16&255)>>>0),E.push((u[y]>>8&255)>>>0),E.push((u[y]&255)>>>0);if(i){i(null,E);return}else return E}i&&Qt(D)}if(typeof i<"u")D();else for(var b;;)if(typeof(b=D())<"u")return b||[]}function Y0(f,a,s,i){var c;if(typeof f!="string"||typeof a!="string")if(c=Error("Invalid string / salt: Not a string"),s){Qt(s.bind(this,c));return}else throw c;var u,m;if(a.charAt(0)!=="$"||a.charAt(1)!=="2")if(c=Error("Invalid salt version: "+a.substring(0,2)),s){Qt(s.bind(this,c));return}else throw c;if(a.charAt(2)==="$")u="\0",m=3;else{if(u=a.charAt(2),u!=="a"&&u!=="b"&&u!=="y"||a.charAt(3)!=="$")if(c=Error("Invalid salt revision: "+a.substring(2,4)),s){Qt(s.bind(this,c));return}else throw c;m=4}if(a.charAt(m+2)>"$")if(c=Error("Missing salt rounds"),s){Qt(s.bind(this,c));return}else throw c;var h=parseInt(a.substring(m,m+1),10)*10,g=parseInt(a.substring(m+1,m+2),10),x=h+g,y=a.substring(m+3,m+25);f+=u>="a"?"\0":"";var w=bb(f),D=yb(y,Tr);function b(v){var E=[];return E.push("$2"),u>="a"&&E.push(u),E.push("$"),x<10&&E.push("0"),E.push(x.toString()),E.push("$"),E.push(Su(D,D.length)),E.push(Su(v,Yh.length*4-1)),E.join("")}if(typeof s>"u")return b(H0(w,D,x));H0(w,D,x,function(v,E){v?s(v,null):s(null,b(E))},i)}class wb{constructor(){ce(this,"SESSION_KEY","truckbo_session");ce(this,"COMPANIES_KEY","truckbo_companies");ce(this,"USERS_KEY","truckbo_users");ce(this,"LOGIN_ATTEMPTS_KEY","truckbo_login_attempts");ce(this,"MAX_LOGIN_ATTEMPTS",5);ce(this,"LOCKOUT_DURATION",900*1e3);ce(this,"SALT_ROUNDS",12);ce(this,"currentSession",null);ce(this,"sessionListeners",[]);this.loadSession()}async initializeDemo(){const a=[{id:"company_demo1",name:"Sunbelt Trucking LLC",dotNumber:"12345678",mcNumber:"MC-987654",address:{street:"123 Industrial Blvd",city:"Dallas",state:"TX",zipCode:"75201"},contactEmail:"admin@sunbelttrucking.com",contactPhone:"214-555-0123",subscription:{plan:"professional",status:"active",expiresAt:"2025-12-31T23:59:59Z",maxVehicles:50,maxDrivers:100,maxUsers:10},settings:{allowDriverSelfService:!0,requireTwoFactor:!1,documentRetentionDays:2555,autoRenewalAlerts:!0},createdAt:new Date().toISOString(),isActive:!0},{id:"company_demo2",name:"Lone Star Logistics",dotNumber:"87654321",mcNumber:"MC-123456",address:{street:"456 Commerce Way",city:"Houston",state:"TX",zipCode:"77001"},contactEmail:"admin@lonestarlogistics.com",contactPhone:"713-555-0456",subscription:{plan:"basic",status:"active",expiresAt:"2025-06-30T23:59:59Z",maxVehicles:10,maxDrivers:20,maxUsers:3},settings:{allowDriverSelfService:!1,requireTwoFactor:!0,documentRetentionDays:1825,autoRenewalAlerts:!0},createdAt:new Date().toISOString(),isActive:!0}],i=await Nu("TruckBo2025!",this.SALT_ROUNDS),c=[{id:"user_admin1",email:"admin@sunbelttrucking.com",firstName:"Sarah",lastName:"Johnson",role:"admin",companyId:"company_demo1",companyName:"Sunbelt Trucking LLC",permissions:this.getAllPermissions(),lastLogin:new Date().toISOString(),isActive:!0,createdAt:new Date().toISOString(),passwordHash:i,failedLoginAttempts:0},{id:"user_manager1",email:"manager@sunbelttrucking.com",firstName:"Mike",lastName:"Rodriguez",role:"manager",companyId:"company_demo1",companyName:"Sunbelt Trucking LLC",permissions:this.getManagerPermissions(),lastLogin:new Date().toISOString(),isActive:!0,createdAt:new Date().toISOString(),passwordHash:i,failedLoginAttempts:0},{id:"user_admin2",email:"admin@lonestarlogistics.com",firstName:"Jennifer",lastName:"Davis",role:"admin",companyId:"company_demo2",companyName:"Lone Star Logistics",permissions:this.getAllPermissions(),lastLogin:new Date().toISOString(),isActive:!0,createdAt:new Date().toISOString(),passwordHash:i,failedLoginAttempts:0}];localStorage.setItem(this.COMPANIES_KEY,JSON.stringify(a)),localStorage.setItem(this.USERS_KEY,JSON.stringify(c)),console.log(" Demo authentication data initialized with secure passwords"),console.log(" Demo password for all accounts: TruckBo2025!")}async login(a){try{if(await this.checkRateLimit(a.email))throw new Error("Too many failed login attempts. Account temporarily locked.");const i=this.getUsers(),c=this.getCompanies(),u=i.find(x=>x.email.toLowerCase()===a.email.toLowerCase()&&x.isActive);if(!u)throw await this.recordFailedAttempt(a.email),new Error("Invalid email or password");if(u.lockedUntil&&new Date<new Date(u.lockedUntil))throw new Error("Account is temporarily locked. Please try again later.");if(!await xb(a.password,u.passwordHash))throw await this.recordFailedAttempt(a.email),u.failedLoginAttempts+=1,u.failedLoginAttempts>=this.MAX_LOGIN_ATTEMPTS&&(u.lockedUntil=new Date(Date.now()+this.LOCKOUT_DURATION).toISOString()),this.saveUsers(i),new Error("Invalid email or password");u.failedLoginAttempts=0,u.lockedUntil=void 0,await this.clearFailedAttempts(a.email);const h=c.find(x=>x.id===u.companyId);if(!h||!h.isActive)throw new Error("Company account is not active");if(h.subscription.status!=="active")throw new Error("Company subscription is not active. Please contact support.");u.lastLogin=new Date().toISOString(),this.saveUsers(i);const g={user:u,company:h,token:await this.generateSecureToken(),expiresAt:new Date(Date.now()+7200*1e3).toISOString(),refreshToken:await this.generateSecureToken()};return this.currentSession=g,this.saveSession(g),this.notifySessionListeners(),De.showSuccess(`Welcome back, ${u.firstName}!`),console.log(` User logged in: ${u.email} (${h.name})`),g}catch(s){throw De.handleUserError(s instanceof Error?s.message:"Login failed","Please check your credentials and try again"),s}}async registerCompany(a){try{const s=this.validatePasswordStrength(a.adminUser.password);if(!s.isValid)throw new Error(s.message);const i=this.getCompanies(),c=this.getUsers();if(i.find(b=>b.contactEmail.toLowerCase()===a.contactEmail.toLowerCase()||b.name.toLowerCase()===a.companyName.toLowerCase()))throw new Error("A company with this name or email already exists");if(c.find(b=>b.email.toLowerCase()===a.adminUser.email.toLowerCase()))throw new Error("A user with this email already exists");const h=await Nu(a.adminUser.password,this.SALT_ROUNDS),g=`company_${Date.now()}`,x={id:g,name:a.companyName,dotNumber:a.dotNumber,mcNumber:a.mcNumber,address:a.address,contactEmail:a.contactEmail,contactPhone:a.contactPhone,subscription:{plan:a.subscription.plan,status:"active",expiresAt:new Date(Date.now()+720*60*60*1e3).toISOString(),maxVehicles:this.getSubscriptionLimits(a.subscription.plan).maxVehicles,maxDrivers:this.getSubscriptionLimits(a.subscription.plan).maxDrivers,maxUsers:this.getSubscriptionLimits(a.subscription.plan).maxUsers},settings:{allowDriverSelfService:a.subscription.plan!=="basic",requireTwoFactor:a.subscription.plan==="enterprise",documentRetentionDays:2555,autoRenewalAlerts:!0},createdAt:new Date().toISOString(),isActive:!0},w={id:`user_${Date.now()}`,email:a.adminUser.email,firstName:a.adminUser.firstName,lastName:a.adminUser.lastName,role:"admin",companyId:g,companyName:a.companyName,permissions:this.getAllPermissions(),lastLogin:new Date().toISOString(),isActive:!0,createdAt:new Date().toISOString(),passwordHash:h,failedLoginAttempts:0};i.push(x),c.push(w),this.saveCompanies(i),this.saveUsers(c);const D={user:w,company:x,token:await this.generateSecureToken(),expiresAt:new Date(Date.now()+7200*1e3).toISOString(),refreshToken:await this.generateSecureToken()};return this.currentSession=D,this.saveSession(D),this.notifySessionListeners(),De.showSuccess(`Welcome to TruckBo Pro, ${w.firstName}! Your company has been registered.`),console.log(` New company registered: ${x.name}`),D}catch(s){throw De.handleUserError(s instanceof Error?s.message:"Registration failed","Please check your information and try again"),s}}logout(){this.currentSession&&(console.log(` User logged out: ${this.currentSession.user.email}`),De.showInfo(`Goodbye, ${this.currentSession.user.firstName}!`)),this.currentSession=null,localStorage.removeItem(this.SESSION_KEY),this.notifySessionListeners()}getCurrentSession(){return this.currentSession}getCurrentUser(){var a;return((a=this.currentSession)==null?void 0:a.user)||null}getCurrentCompany(){var a;return((a=this.currentSession)==null?void 0:a.company)||null}isAuthenticated(){if(!this.currentSession)return!1;const a=new Date,s=new Date(this.currentSession.expiresAt);return a>=s?(this.logout(),!1):!0}hasPermission(a,s){return this.currentSession?this.currentSession.user.permissions.some(c=>c.resource===a&&c.actions.includes(s)):!1}isAdmin(){var a;return((a=this.currentSession)==null?void 0:a.user.role)==="admin"}canManageUsers(){return this.hasPermission("users","create")&&this.hasPermission("users","update")}subscribeToSession(a){return this.sessionListeners.push(a),()=>{this.sessionListeners=this.sessionListeners.filter(s=>s!==a)}}getCompanyScopedKey(a){var i;const s=(i=this.getCurrentCompany())==null?void 0:i.id;if(!s)throw new Error("No authenticated company found");return`${a}_${s}`}getSubscriptionLimits(a){const s={basic:{maxVehicles:10,maxDrivers:20,maxUsers:3},professional:{maxVehicles:50,maxDrivers:100,maxUsers:10},enterprise:{maxVehicles:500,maxDrivers:1e3,maxUsers:50}};return s[a]||s.basic}getAllPermissions(){return[{resource:"vehicles",actions:["create","read","update","delete","export"]},{resource:"drivers",actions:["create","read","update","delete","export"]},{resource:"documents",actions:["create","read","update","delete","export"]},{resource:"reports",actions:["create","read","export"]},{resource:"users",actions:["create","read","update","delete"]},{resource:"settings",actions:["read","update"]}]}getManagerPermissions(){return[{resource:"vehicles",actions:["create","read","update","export"]},{resource:"drivers",actions:["create","read","update","export"]},{resource:"documents",actions:["create","read","update","export"]},{resource:"reports",actions:["create","read","export"]},{resource:"users",actions:["read"]},{resource:"settings",actions:["read"]}]}async generateSecureToken(){const a=new Uint8Array(32);return crypto.getRandomValues(a),Array.from(a,s=>s.toString(16).padStart(2,"0")).join("")}validatePasswordStrength(a){const i=/[A-Z]/.test(a),c=/[a-z]/.test(a),u=/\d/.test(a),m=/[!@#$%^&*(),.?":{}|<>]/.test(a);return a.length<12?{isValid:!1,message:"Password must be at least 12 characters long"}:i?c?u?m?{isValid:!0,message:"Password is strong"}:{isValid:!1,message:"Password must contain at least one special character"}:{isValid:!1,message:"Password must contain at least one number"}:{isValid:!1,message:"Password must contain at least one lowercase letter"}:{isValid:!1,message:"Password must contain at least one uppercase letter"}}async checkRateLimit(a){const i=this.getLoginAttempts().find(c=>c.email.toLowerCase()===a.toLowerCase());return i?!!(i.lockedUntil&&new Date<new Date(i.lockedUntil)):!1}async recordFailedAttempt(a){const s=this.getLoginAttempts(),i=s.findIndex(c=>c.email.toLowerCase()===a.toLowerCase());i>=0?(s[i].attempts+=1,s[i].lastAttempt=new Date().toISOString(),s[i].attempts>=this.MAX_LOGIN_ATTEMPTS&&(s[i].lockedUntil=new Date(Date.now()+this.LOCKOUT_DURATION).toISOString())):s.push({email:a.toLowerCase(),attempts:1,lastAttempt:new Date().toISOString()}),this.saveLoginAttempts(s)}async clearFailedAttempts(a){const i=this.getLoginAttempts().filter(c=>c.email.toLowerCase()!==a.toLowerCase());this.saveLoginAttempts(i)}getLoginAttempts(){try{const a=localStorage.getItem(this.LOGIN_ATTEMPTS_KEY);return a?JSON.parse(a):[]}catch(a){return console.error("Error loading login attempts:",a),[]}}saveLoginAttempts(a){localStorage.setItem(this.LOGIN_ATTEMPTS_KEY,JSON.stringify(a))}loadSession(){try{const a=localStorage.getItem(this.SESSION_KEY);if(a){const s=JSON.parse(a),i=new Date,c=new Date(s.expiresAt);i<c?(this.currentSession=s,console.log(` Session restored for: ${s.user.email}`)):(localStorage.removeItem(this.SESSION_KEY),console.log(" Session expired, removed from storage"))}}catch(a){console.error("Error loading session:",a),localStorage.removeItem(this.SESSION_KEY)}}saveSession(a){localStorage.setItem(this.SESSION_KEY,JSON.stringify(a))}notifySessionListeners(){this.sessionListeners.forEach(a=>a(this.currentSession))}getCompanies(){try{const a=localStorage.getItem(this.COMPANIES_KEY);return a?JSON.parse(a):[]}catch(a){return console.error("Error loading companies:",a),[]}}saveCompanies(a){localStorage.setItem(this.COMPANIES_KEY,JSON.stringify(a))}getUsers(){try{const a=localStorage.getItem(this.USERS_KEY);return a?JSON.parse(a):[]}catch(a){return console.error("Error loading users:",a),[]}}saveUsers(a){localStorage.setItem(this.USERS_KEY,JSON.stringify(a))}}const ot=new wb;class Eb{constructor(){ce(this,"BASE_STORAGE_KEY","truckbo_fleet_data");ce(this,"BASE_BACKUP_KEY","truckbo_fleet_backup");ce(this,"BASE_DRIVERS_STORAGE_KEY","truckbo_drivers_data");ce(this,"BASE_DRIVERS_BACKUP_KEY","truckbo_drivers_backup");ce(this,"listeners",[])}getStorageKey(){try{return ot.getCompanyScopedKey(this.BASE_STORAGE_KEY)}catch{return this.BASE_STORAGE_KEY}}getBackupKey(){try{return ot.getCompanyScopedKey(this.BASE_BACKUP_KEY)}catch{return this.BASE_BACKUP_KEY}}getDriversStorageKey(){try{return ot.getCompanyScopedKey(this.BASE_DRIVERS_STORAGE_KEY)}catch{return this.BASE_DRIVERS_STORAGE_KEY}}getDriversBackupKey(){try{return ot.getCompanyScopedKey(this.BASE_DRIVERS_BACKUP_KEY)}catch{return this.BASE_DRIVERS_BACKUP_KEY}}getFleet(){try{const a=localStorage.getItem(this.getStorageKey());return a?JSON.parse(a):[]}catch(a){return console.error("Error loading fleet data:",a),this.getBackup()}}saveFleet(a){try{return this.createBackup(),localStorage.setItem(this.getStorageKey(),JSON.stringify(a)),this.notifyListeners(),!0}catch(s){return console.error("Error saving fleet data:",s),!1}}addVehicle(a){try{const s=this.getFleet();if(s.some(u=>u.vin===a.vin))throw new Error(`Vehicle with VIN ${a.vin} already exists`);let i=a.truckNumber;if(!i){const u=vu.parseTruckNumber({vin:a.vin,licensePlate:a.licensePlate,dotNumber:a.dotNumber,make:a.make,model:a.model});i=u.truckNumber||this.generateTruckNumber(s),console.log(` Auto-detected truck number for ${a.vin}:`,{detected:u.truckNumber,confidence:u.confidence,source:u.source,needsReview:u.needsReview})}const c={...a,truckNumber:i,id:this.generateId(),dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()};return s.push(c),this.saveFleet(s),c}catch(s){return console.error("Error adding vehicle:",s),null}}addVehicles(a){const s=[],i=[];return a.forEach(c=>{try{const u=this.addVehicle(c);u?s.push(u):i.push({vehicle:c,error:"Failed to add vehicle"})}catch(u){i.push({vehicle:c,error:u instanceof Error?u.message:String(u)})}}),{successful:s,failed:i}}updateVehicle(a,s){try{const i=this.getFleet(),c=i.findIndex(u=>u.id===a);if(c===-1)throw new Error(`Vehicle with ID ${a} not found`);return i[c]={...i[c],...s,lastUpdated:new Date().toISOString()},this.saveFleet(i)}catch(i){return console.error("Error updating vehicle:",i),!1}}removeVehicle(a){try{const s=this.getFleet(),i=s.filter(c=>c.id!==a);if(i.length===s.length)throw new Error(`Vehicle with ID ${a} not found`);return this.saveFleet(i)}catch(s){return console.error("Error removing vehicle:",s),!1}}searchVehicles(a){const s=this.getFleet(),i=a.toLowerCase();return s.filter(c=>c.vin.toLowerCase().includes(i)||c.make.toLowerCase().includes(i)||c.model.toLowerCase().includes(i)||c.licensePlate.toLowerCase().includes(i)||c.truckNumber.toLowerCase().includes(i))}getFleetStats(){const a=this.getFleet();return{total:a.length,active:a.filter(s=>s.status==="active").length,inactive:a.filter(s=>s.status==="inactive").length,recentlyAdded:a.filter(s=>{const i=new Date(s.dateAdded),c=new Date;return c.setDate(c.getDate()-7),i>c}).length}}exportFleet(){const a=this.getFleet();return JSON.stringify(a,null,2)}importFleet(a){try{const s=JSON.parse(a);if(!Array.isArray(s))throw new Error("Invalid data format - expected array of vehicles");const i=s.filter(c=>c.vin&&c.make&&c.model);if(i.length===0)throw new Error("No valid vehicles found in import data");return this.saveFleet(i),{success:!0,message:`Successfully imported ${i.length} vehicles`,count:i.length}}catch(s){return{success:!1,message:`Import failed: ${s instanceof Error?s.message:String(s)}`}}}createBackup(){const a=localStorage.getItem(this.getStorageKey());a&&localStorage.setItem(this.getBackupKey(),a)}getBackup(){try{const a=localStorage.getItem(this.getBackupKey());return a?JSON.parse(a):[]}catch(a){return console.error("Error loading backup:",a),[]}}restoreFromBackup(){try{const a=localStorage.getItem(this.getBackupKey());return a?(localStorage.setItem(this.getStorageKey(),a),this.notifyListeners(),!0):!1}catch(a){return console.error("Error restoring backup:",a),!1}}clearFleet(){try{return this.createBackup(),localStorage.removeItem(this.getStorageKey()),this.notifyListeners(),!0}catch(a){return console.error("Error clearing fleet:",a),!1}}generateId(){return`vehicle_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateTruckNumber(a){const s=a.map(c=>c.truckNumber).filter(c=>c==null?void 0:c.match(/^Truck #\d+$/)).map(c=>parseInt(c.replace("Truck #",""))).filter(c=>!isNaN(c));return`Truck #${(s.length>0?Math.max(...s)+1:1).toString().padStart(3,"0")}`}getDrivers(){try{const a=localStorage.getItem(this.getDriversStorageKey());return(a?JSON.parse(a):[]).map(i=>({...i,medicalCertificate:{...i.medicalCertificate,...this.calculateCertificateStatus(i.medicalCertificate.expirationDate)},cdlInfo:{...i.cdlInfo,...this.calculateCertificateStatus(i.cdlInfo.expirationDate)}}))}catch(a){return console.error("Error loading drivers data:",a),this.getDriversBackup()}}saveDrivers(a){try{return this.createDriversBackup(),localStorage.setItem(this.getDriversStorageKey(),JSON.stringify(a)),this.notifyListeners(),!0}catch(s){return console.error("Error saving drivers data:",s),!1}}addDriver(a){try{const s=this.getDrivers();if(s.find(m=>m.employeeId===a.employeeId))return console.error("Driver with this employee ID already exists:",a.employeeId),null;if(s.find(m=>m.cdlInfo.cdlNumber===a.cdlInfo.cdlNumber))return console.error("Driver with this CDL number already exists:",a.cdlInfo.cdlNumber),null;const u={...a,id:this.generateId(),dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString(),medicalCertificate:{...a.medicalCertificate,...this.calculateCertificateStatus(a.medicalCertificate.expirationDate)},cdlInfo:{...a.cdlInfo,...this.calculateCertificateStatus(a.cdlInfo.expirationDate)}};return s.push(u),this.saveDrivers(s)?(console.log(" Driver added successfully:",u.firstName,u.lastName),u):(console.error(" Failed to save driver"),null)}catch(s){return console.error("Error adding driver:",s),null}}updateDriver(a,s){try{const i=this.getDrivers(),c=i.findIndex(u=>u.id===a);return c===-1?(console.error("Driver not found:",a),!1):(i[c]={...i[c],...s,lastUpdated:new Date().toISOString(),medicalCertificate:s.medicalCertificate?{...s.medicalCertificate,...this.calculateCertificateStatus(s.medicalCertificate.expirationDate)}:i[c].medicalCertificate,cdlInfo:s.cdlInfo?{...s.cdlInfo,...this.calculateCertificateStatus(s.cdlInfo.expirationDate)}:i[c].cdlInfo},this.saveDrivers(i))}catch(i){return console.error("Error updating driver:",i),!1}}getDriversWithExpiringCertificates(a=30){return this.getDrivers().filter(s=>s.medicalCertificate.daysUntilExpiry<=a||s.cdlInfo.daysUntilExpiry<=a)}calculateCertificateStatus(a){try{const s=new Date(a),i=new Date,c=s.getTime()-i.getTime(),u=Math.ceil(c/(1e3*3600*24));let m;return u<0?m="expired":u<=30?m="expiring_soon":m="valid",{status:m,daysUntilExpiry:u}}catch(s){return console.error("Error calculating certificate status:",s),{status:"invalid",daysUntilExpiry:-999}}}createDriversBackup(){try{const a=localStorage.getItem(this.getDriversStorageKey());a&&localStorage.setItem(this.getDriversBackupKey(),a)}catch(a){console.error("Error creating drivers backup:",a)}}getDriversBackup(){try{const a=localStorage.getItem(this.getDriversBackupKey());return a?JSON.parse(a):[]}catch(a){return console.error("Error loading drivers backup:",a),[]}}subscribe(a){return this.listeners.push(a),()=>{this.listeners=this.listeners.filter(s=>s!==a)}}notifyListeners(){this.listeners.forEach(a=>{try{a()}catch(s){console.error("Error in fleet storage listener:",s)}})}}const ze=new Eb,G0=1e4,jb=5e4,X0=1e5,Db=999999,K0=1e5,Rb=999999,Ab=17,Cb=/^[A-HJ-NPR-Z0-9]{17}$/i,Tb="TRK",ps={DOT_INSPECTION:"2025-07-22",REGISTRATION:"2025-06-22",INSURANCE:"2025-05-22",IFTA:"2024-12-31",STATE_PERMITS:"2025-04-22",EMISSIONS:"2025-08-22",WEIGHT_CERT:"2025-03-22"},bs={DOT_INSPECTION:365,REGISTRATION:335,INSURANCE:304,IFTA:162,STATE_PERMITS:274,EMISSIONS:396,WEIGHT_CERT:243},_b=`VIN
SAMPLE1234567890A
SAMPLE1234567890B
SAMPLE1234567890C`,Mb={VIN:"vin"},Ib=9;class Ob{constructor(){ce(this,"vehicles",[]);ce(this,"complianceTasks",[]);ce(this,"subscribers",[])}subscribe(a){return this.subscribers.push(a),()=>{this.subscribers=this.subscribers.filter(s=>s!==a)}}notify(){this.subscribers.forEach(a=>a())}getAllVehicles(){return[...this.vehicles]}getAllComplianceTasks(){return[...this.complianceTasks]}addVehicles(a){const s=a.filter(i=>i.status==="success").map(i=>({id:Date.now().toString()+Math.random().toString(36).substr(2,Ib),vin:i.vin,make:i.make,model:i.model,year:i.year,licensePlate:`${Tb}-${i.vin.slice(-3)}`,status:"active",mileage:Math.floor(Math.random()*(jb-G0))+G0,fuelType:i.fuelType,maxWeight:i.maxWeight,vehicleClass:i.vehicleClass,dotNumber:`DOT${Math.floor(Math.random()*(Db-X0))+X0}`,mcNumber:`MC${Math.floor(Math.random()*(Rb-K0))+K0}`,purchaseDate:new Date().toISOString().split("T")[0],compliance:{dotInspection:{status:"compliant",expiryDate:ps.DOT_INSPECTION,daysUntilExpiry:bs.DOT_INSPECTION},registration:{status:"compliant",expiryDate:ps.REGISTRATION,daysUntilExpiry:bs.REGISTRATION},insurance:{status:"compliant",expiryDate:ps.INSURANCE,daysUntilExpiry:bs.INSURANCE},ifta:{status:"compliant",expiryDate:ps.IFTA,daysUntilExpiry:bs.IFTA},statePermits:{status:"compliant",expiryDate:ps.STATE_PERMITS,daysUntilExpiry:bs.STATE_PERMITS},emissions:{status:"compliant",expiryDate:ps.EMISSIONS,daysUntilExpiry:bs.EMISSIONS},weightCert:{status:"compliant",expiryDate:ps.WEIGHT_CERT,daysUntilExpiry:bs.WEIGHT_CERT}}}));return this.vehicles.push(...s),this.notify(),s}updateTaskStatus(a,s){const i=this.complianceTasks.findIndex(c=>c.id===a);i!==-1&&(this.complianceTasks[i]={...this.complianceTasks[i],status:s,updatedDate:new Date().toISOString(),completedDate:s==="completed"?new Date().toISOString():void 0},this.notify())}getFleetStats(){const a=this.vehicles.length,s=this.vehicles.filter(m=>m.status==="active").length,i=this.vehicles.filter(m=>m.status==="inactive").length;let c=0,u=0;return this.vehicles.forEach(m=>{Object.values(m.compliance).forEach(h=>{h.status==="warning"&&c++,h.status==="expired"&&u++})}),{total:a,active:s,inactive:i,complianceWarnings:c,complianceExpired:u}}getComplianceStats(){const a=this.complianceTasks.length,s=this.complianceTasks.filter(g=>g.status==="pending").length,i=this.complianceTasks.filter(g=>g.status==="in_progress").length,c=this.complianceTasks.filter(g=>g.status==="completed").length,u=this.complianceTasks.filter(g=>g.status==="overdue").length,m=this.complianceTasks.filter(g=>g.priority==="critical").length,h=this.complianceTasks.filter(g=>g.priority==="high").length;return{total:a,pending:s,inProgress:i,completed:c,overdue:u,critical:m,high:h}}}const rt=new Ob,Gh=f=>{if(!f||typeof f!="string")return!1;const a=f.toUpperCase().trim();return a.length===Ab&&Cb.test(a)},Vb=async f=>new Promise((a,s)=>{const i=new FileReader;i.onload=c=>{var u;try{const h=((u=c.target)==null?void 0:u.result).split(`
`).map(x=>x.trim()).filter(x=>x),g=[];h.forEach((x,y)=>{const D=x.split(",").map(b=>b.trim().replace(/['"]/g,""))[0];y===0&&D.toLowerCase()===Mb.VIN||D&&g.push({vin:D.toUpperCase(),isValid:Gh(D),row:y+1})}),a(g)}catch(m){s(m)}},i.onerror=()=>s(new Error("Failed to read file")),i.readAsText(f)}),Ub=()=>{const f=_b,a=new Blob([f],{type:"text/csv"}),s=window.URL.createObjectURL(a),i=document.createElement("a");i.style.display="none",i.href=s,i.download="vin_sample.csv",document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(s),document.body.removeChild(i)},Lb=({isOpen:f,onClose:a,onVehicleAdded:s})=>{const[i,c]=K.useState({vin:"",make:"",model:"",year:new Date().getFullYear(),licensePlate:"",dotNumber:"",truckNumber:"",status:"active"}),[u,m]=K.useState({}),[h,g]=K.useState(!1),x=()=>{c({vin:"",make:"",model:"",year:new Date().getFullYear(),licensePlate:"",dotNumber:"",truckNumber:"",status:"active"}),m({})},y=()=>{const b={};return i.vin.trim()?i.vin.length!==17&&(b.vin="VIN must be 17 characters"):b.vin="VIN is required",i.make.trim()||(b.make="Make is required"),i.model.trim()||(b.model="Model is required"),(i.year<1900||i.year>new Date().getFullYear()+1)&&(b.year="Please enter a valid year"),i.licensePlate.trim()||(b.licensePlate="License plate is required"),m(b),Object.keys(b).length===0},w=async b=>{if(b.preventDefault(),!!y()){g(!0);try{const v=ze.addVehicle({vin:i.vin.toUpperCase(),make:i.make,model:i.model,year:i.year,licensePlate:i.licensePlate.toUpperCase(),dotNumber:i.dotNumber||void 0,truckNumber:i.truckNumber||"",status:i.status});v?(s(v),x(),a()):m({general:"Failed to add vehicle. VIN may already exist."})}catch(v){m({general:v instanceof Error?v.message:String(v)||"Failed to add vehicle"})}finally{g(!1)}}},D=()=>{x(),a()};return f?r.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6 rounded-t-2xl",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-black",children:" Add New Vehicle"}),r.jsx("p",{className:"text-blue-100 mt-1",children:"Add a single vehicle to your existing fleet"})]}),r.jsx("button",{onClick:D,className:"w-10 h-10 bg-white/20 hover:bg-white/30 rounded-xl flex items-center justify-center transition-colors duration-200",children:r.jsx("span",{className:"text-xl",children:""})})]})}),r.jsxs("form",{onSubmit:w,className:"p-6 space-y-6",children:[u.general&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-red-500 text-xl mr-3",children:""}),r.jsx("span",{className:"text-red-700 font-medium",children:u.general})]})}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:[" Truck Number ",r.jsx("span",{className:"text-slate-500",children:"(Auto-detected from license plate if left empty)"})]}),r.jsx("input",{type:"text",value:i.truckNumber,onChange:b=>c({...i,truckNumber:b.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-slate-300 focus:border-purple-500 transition-colors duration-200 text-lg font-bold",placeholder:"Truck #047 or Unit 47 (leave empty for auto-detection)"}),r.jsx("p",{className:"text-xs text-slate-600 mt-1",children:" Leave empty and we'll automatically detect from your license plate (e.g., TRK047  Truck #047)"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["VIN Number ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.vin,onChange:b=>c({...i,vin:b.target.value.toUpperCase()}),className:`w-full px-4 py-3 rounded-xl border-2 font-mono text-sm transition-colors duration-200 ${u.vin?"border-red-300 bg-red-50 focus:border-red-500":"border-slate-300 focus:border-blue-500"}`,placeholder:"1HGCM82633A123456",maxLength:17}),u.vin&&r.jsx("p",{className:"text-red-600 text-sm mt-1 font-medium",children:u.vin})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["Make ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.make,onChange:b=>c({...i,make:b.target.value}),className:`w-full px-4 py-3 rounded-xl border-2 transition-colors duration-200 ${u.make?"border-red-300 bg-red-50 focus:border-red-500":"border-slate-300 focus:border-blue-500"}`,placeholder:"Freightliner"}),u.make&&r.jsx("p",{className:"text-red-600 text-sm mt-1 font-medium",children:u.make})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["Model ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.model,onChange:b=>c({...i,model:b.target.value}),className:`w-full px-4 py-3 rounded-xl border-2 transition-colors duration-200 ${u.model?"border-red-300 bg-red-50 focus:border-red-500":"border-slate-300 focus:border-blue-500"}`,placeholder:"Cascadia"}),u.model&&r.jsx("p",{className:"text-red-600 text-sm mt-1 font-medium",children:u.model})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["Year ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",value:i.year,onChange:b=>c({...i,year:parseInt(b.target.value)||new Date().getFullYear()}),className:`w-full px-4 py-3 rounded-xl border-2 transition-colors duration-200 ${u.year?"border-red-300 bg-red-50 focus:border-red-500":"border-slate-300 focus:border-blue-500"}`,min:"1900",max:new Date().getFullYear()+1}),u.year&&r.jsx("p",{className:"text-red-600 text-sm mt-1 font-medium",children:u.year})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["License Plate ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i.licensePlate,onChange:b=>c({...i,licensePlate:b.target.value.toUpperCase()}),className:`w-full px-4 py-3 rounded-xl border-2 font-mono transition-colors duration-200 ${u.licensePlate?"border-red-300 bg-red-50 focus:border-red-500":"border-slate-300 focus:border-blue-500"}`,placeholder:"ABC123"}),u.licensePlate&&r.jsx("p",{className:"text-red-600 text-sm mt-1 font-medium",children:u.licensePlate})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["DOT Number ",r.jsx("span",{className:"text-amber-600",children:"(Required for Compliance Data)"})]}),r.jsx("input",{type:"text",value:i.dotNumber,onChange:b=>c({...i,dotNumber:b.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-slate-300 focus:border-blue-500 transition-colors duration-200",placeholder:"1234567"}),r.jsx("p",{className:"text-xs text-slate-600 mt-1",children:" DOT number identifies the carrier/company. Required for FMCSA compliance lookups."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Initial Status"}),r.jsxs("select",{value:i.status,onChange:b=>c({...i,status:b.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-slate-300 focus:border-blue-500 transition-colors duration-200",children:[r.jsx("option",{value:"active",children:" Active"}),r.jsx("option",{value:"maintenance",children:" Maintenance"}),r.jsx("option",{value:"inactive",children:" Inactive"})]})]})]}),r.jsxs("div",{className:"flex gap-4 pt-6 border-t border-slate-200",children:[r.jsx("button",{type:"button",onClick:D,className:"flex-1 px-6 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-bold transition-colors duration-200",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:h,className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-xl font-bold transition-all duration-200 hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:h?r.jsxs("span",{className:"flex items-center justify-center",children:[r.jsx("span",{className:"animate-spin mr-2",children:""}),"Adding Vehicle..."]}):" Add Vehicle"})]})]})]})}):null},kb=({isOpen:f,onClose:a,onVehiclesAdded:s})=>{const[i,c]=K.useState("csv_upload"),[u,m]=K.useState(null),[h,g]=K.useState(""),[,x]=K.useState([]),[y,w]=K.useState([]),[D,b]=K.useState(!1),[v,E]=K.useState("upload"),[A,X]=K.useState(null),C=K.useRef(null),W=()=>{c("csv_upload"),m(null),g(""),x([]),w([]),b(!1),E("upload"),X(null)},k=()=>{W(),a()},Z=ae=>ae.length!==17?!1:/^[A-HJ-NPR-Z0-9]{17}$/i.test(ae),le=ae=>ae.split(`
`).map(V=>V.trim()).filter(V=>V.length>0).map((V,M)=>({vin:V.toUpperCase(),isValid:Z(V),row:M+1})),q=ae=>new Promise((de,V)=>{const M=new FileReader;M.onload=j=>{var P;try{const N=((P=j.target)==null?void 0:P.result).split(`
`).map(B=>B.trim()).filter(B=>B.length>0),z=(N[0].toLowerCase().includes("vin")?N.slice(1):N).map((B,J)=>{const ne=B.split(",").map(Re=>Re.trim().replace(/"/g,""))[0];return{vin:ne.toUpperCase(),isValid:Z(ne),row:J+2}});de(z)}catch{V(new Error("Failed to parse CSV file"))}},M.onerror=()=>V(new Error("Failed to read file")),M.readAsText(ae)}),se=ae=>{var V;const de=(V=ae.target.files)==null?void 0:V[0];de&&(m(de),X(null))},te=async()=>{if(!h.trim()){X("Please enter at least one VIN");return}b(!0),E("processing");try{const ae=le(h);if(x(ae),ae.length===0)throw new Error("No valid VINs found");const de=ae.map(V=>({vin:V.vin,status:"active",isValid:V.isValid,needsReview:!V.isValid,missingFields:V.isValid?["make","model","year","licensePlate"]:["vin","make","model","year","licensePlate"]}));w(de),E("review")}catch(ae){X(ae instanceof Error?ae.message:String(ae)||"Failed to process VIN list"),E("upload")}finally{b(!1)}},Ce=async()=>{if(!u){X("Please select a CSV file");return}b(!0),E("processing");try{const ae=await q(u);if(x(ae),ae.length===0)throw new Error("No valid data found in CSV file");const de=ae.map(V=>({vin:V.vin,status:"active",isValid:V.isValid,needsReview:!V.isValid,missingFields:V.isValid?["make","model","year","licensePlate"]:["vin","make","model","year","licensePlate"]}));w(de),E("review")}catch(ae){X(ae instanceof Error?ae.message:String(ae)||"Failed to process CSV file"),E("upload")}finally{b(!1)}},ee=async()=>{const ae=y.filter(de=>de.isValid);if(ae.length===0){X("No valid vehicles to add");return}b(!0);try{const de=ae.map(M=>({vin:M.vin,make:M.make||"Unknown",model:M.model||"Unknown",year:M.year||new Date().getFullYear(),licensePlate:M.licensePlate||`${M.vin.slice(-6)}`,dotNumber:M.dotNumber,truckNumber:"",status:M.status})),V=ze.addVehicles(de);if(V.successful.length>0)s(V.successful),E("complete"),setTimeout(()=>{k()},2e3);else throw new Error("Failed to add vehicles to fleet")}catch(de){X(de instanceof Error?de.message:String(de)||"Failed to add vehicles")}finally{b(!1)}},be=()=>{const ae=`VIN,Make,Model,Year,License_Plate,DOT_Number
1HGCM82633A123456,Honda,Civic,2022,ABC123,1234567
1FTFW1ET5DFC12345,Ford,F-150,2023,XYZ789,7654321`,de=new Blob([ae],{type:"text/csv"}),V=window.URL.createObjectURL(de),M=document.createElement("a");M.href=V,M.download="sample_vehicle_import.csv",document.body.appendChild(M),M.click(),document.body.removeChild(M),window.URL.revokeObjectURL(V)};return f?r.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsx("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 text-white p-6 rounded-t-2xl",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-black",children:" Bulk Add Vehicles"}),r.jsx("p",{className:"text-green-100 mt-1",children:"Add multiple vehicles to your existing fleet"})]}),r.jsx("button",{onClick:k,className:"w-10 h-10 bg-white/20 hover:bg-white/30 rounded-xl flex items-center justify-center transition-colors duration-200",children:r.jsx("span",{className:"text-xl",children:""})})]})}),r.jsxs("div",{className:"p-6",children:[A&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-red-500 text-xl mr-3",children:""}),r.jsx("span",{className:"text-red-700 font-medium",children:A})]})}),v==="upload"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-8",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Choose Import Method"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsx("div",{className:`group relative border-2 rounded-xl p-6 cursor-pointer transition-all duration-300 ${i==="csv_upload"?"border-green-500 bg-green-50 shadow-lg":"border-gray-200 hover:border-green-300 hover:bg-green-50/50"}`,onClick:()=>c("csv_upload"),children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center text-white text-2xl font-bold mb-4 mx-auto group-hover:scale-110 transition-transform duration-300",children:"CSV"}),r.jsx("h4",{className:"font-bold text-xl mb-3 text-gray-900",children:"CSV File Upload"}),r.jsx("p",{className:"text-gray-600",children:"Upload a CSV file with vehicle information"})]})}),r.jsx("div",{className:`group relative border-2 rounded-xl p-6 cursor-pointer transition-all duration-300 ${i==="vin_list"?"border-green-500 bg-green-50 shadow-lg":"border-gray-200 hover:border-green-300 hover:bg-green-50/50"}`,onClick:()=>c("vin_list"),children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center text-white text-2xl font-bold mb-4 mx-auto group-hover:scale-110 transition-transform duration-300",children:"VIN"}),r.jsx("h4",{className:"font-bold text-xl mb-3 text-gray-900",children:"VIN List"}),r.jsx("p",{className:"text-gray-600",children:"Paste a list of VIN numbers"})]})})]})]}),i==="csv_upload"&&r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-blue-600 text-lg",children:""})})}),r.jsxs("div",{className:"ml-4 flex-1",children:[r.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"CSV Format"}),r.jsxs("p",{className:"text-blue-700 text-sm mb-3",children:["Your CSV should have columns: VIN, Make, Model, Year, License_Plate, DOT_Number",r.jsx("br",{}),r.jsx("strong",{children:"Note:"})," DOT_Number is required for compliance data (identifies the carrier/company)"]}),r.jsx("button",{onClick:be,className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-4 py-2 rounded-xl font-bold text-sm transition-all duration-300 shadow-lg shadow-blue-900/20 hover:shadow-xl hover:shadow-blue-900/30 hover:scale-105 active:scale-95",children:" Download Sample CSV"})]})]})}),r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-green-400 transition-colors duration-200",children:[r.jsx("input",{ref:C,type:"file",accept:".csv",onChange:se,className:"hidden"}),r.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl flex items-center justify-center text-white text-3xl font-bold mx-auto mb-4",children:""}),r.jsx("h5",{className:"text-lg font-semibold text-gray-900 mb-2",children:u?`Selected: ${u.name}`:"Drop your CSV file here"}),r.jsx("p",{className:"text-gray-500 mb-4",children:u?"Click process to continue":"or click to browse files"}),r.jsx("button",{onClick:()=>{var ae;return(ae=C.current)==null?void 0:ae.click()},className:"bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 hover:scale-105 active:scale-95",children:u?" Change File":" Browse Files"})]}),r.jsx("button",{onClick:Ce,disabled:!u||D,className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white px-8 py-4 rounded-2xl font-black text-lg shadow-xl shadow-green-900/20 hover:shadow-2xl hover:shadow-green-900/30 transition-all duration-300 hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:D?" Processing...":" Process CSV File"})]}),i==="vin_list"&&r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-blue-600 text-lg",children:""})})}),r.jsxs("div",{className:"ml-4 flex-1",children:[r.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"VIN List Format"}),r.jsx("p",{className:"text-blue-700 text-sm",children:"Enter one VIN per line. VINs must be exactly 17 characters long."})]})]})}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Paste VIN Numbers (one per line)"}),r.jsx("textarea",{value:h,onChange:ae=>g(ae.target.value),className:"w-full h-40 px-4 py-3 rounded-xl border-2 border-gray-300 focus:border-blue-500 font-mono text-sm resize-none",placeholder:`1HGCM82633A123456
1FTFW1ET5DFC12345
JH4KA8260MC123456`})]}),r.jsx("button",{onClick:te,disabled:!h.trim()||D,className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-8 py-4 rounded-2xl font-black text-lg shadow-xl shadow-blue-900/20 hover:shadow-2xl hover:shadow-blue-900/30 transition-all duration-300 hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:D?" Processing...":" Process VIN List"})]})]}),v==="processing"&&r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"animate-spin text-6xl mb-4",children:""}),r.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Processing Vehicle Data"}),r.jsx("p",{className:"text-gray-600",children:"Validating VINs and preparing vehicle records..."})]}),v==="review"&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Review Vehicles"}),r.jsxs("div",{className:"text-sm text-gray-600",children:[y.filter(ae=>ae.isValid).length," valid of ",y.length," total"]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[r.jsx("div",{className:"font-semibold text-blue-800",children:"Total VINs"}),r.jsx("div",{className:"text-2xl text-blue-600",children:y.length})]}),r.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[r.jsx("div",{className:"font-semibold text-green-800",children:"Valid VINs"}),r.jsx("div",{className:"text-2xl text-green-600",children:y.filter(ae=>ae.isValid).length})]}),r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[r.jsx("div",{className:"font-semibold text-red-800",children:"Invalid VINs"}),r.jsx("div",{className:"text-2xl text-red-600",children:y.filter(ae=>!ae.isValid).length})]})]}),r.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 mb-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-yellow-500 text-xl mr-3",children:""}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold text-yellow-800",children:"Note"}),r.jsx("p",{className:"text-yellow-700 text-sm",children:"Vehicles will be added with placeholder data for missing information. You can edit them later in Fleet Management."})]})]})}),r.jsx("div",{className:"max-h-60 overflow-y-auto",children:r.jsx("div",{className:"space-y-2",children:y.map((ae,de)=>r.jsx("div",{className:`p-4 rounded-lg border ${ae.isValid?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-lg mr-2",children:ae.isValid?"":""}),r.jsx("span",{className:"font-mono text-sm font-bold",children:ae.vin})]}),r.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${ae.isValid?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:ae.isValid?"Valid":"Invalid VIN"})]})},de))})}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{onClick:()=>E("upload"),className:"flex-1 px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-xl font-bold transition-colors duration-200",children:" Back"}),r.jsx("button",{onClick:ee,disabled:y.filter(ae=>ae.isValid).length===0||D,className:"flex-2 px-8 py-3 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white rounded-xl font-bold transition-all duration-200 hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:D?" Adding...":` Add ${y.filter(ae=>ae.isValid).length} Vehicles`})]})]}),v==="complete"&&r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"text-6xl mb-4",children:""}),r.jsx("h3",{className:"text-2xl font-bold text-green-600 mb-2",children:"Vehicles Added Successfully!"}),r.jsxs("p",{className:"text-gray-600",children:[y.filter(ae=>ae.isValid).length," vehicles have been added to your fleet."]}),r.jsx("div",{className:"mt-6",children:r.jsxs("div",{className:"inline-flex items-center text-green-600",children:[r.jsx("span",{className:"animate-spin mr-2",children:""}),"Closing automatically..."]})})]})]})]})}):null};var Po={exports:{}},Z0;function $b(){return Z0||(Z0=1,function(f){var a=function(s){var i=Object.prototype,c=i.hasOwnProperty,u=Object.defineProperty||function(I,N,T){I[N]=T.value},m,h=typeof Symbol=="function"?Symbol:{},g=h.iterator||"@@iterator",x=h.asyncIterator||"@@asyncIterator",y=h.toStringTag||"@@toStringTag";function w(I,N,T){return Object.defineProperty(I,N,{value:T,enumerable:!0,configurable:!0,writable:!0}),I[N]}try{w({},"")}catch{w=function(N,T,z){return N[T]=z}}function D(I,N,T,z){var B=N&&N.prototype instanceof W?N:W,J=Object.create(B.prototype),re=new M(z||[]);return u(J,"_invoke",{value:be(I,T,re)}),J}s.wrap=D;function b(I,N,T){try{return{type:"normal",arg:I.call(N,T)}}catch(z){return{type:"throw",arg:z}}}var v="suspendedStart",E="suspendedYield",A="executing",X="completed",C={};function W(){}function k(){}function Z(){}var le={};w(le,g,function(){return this});var q=Object.getPrototypeOf,se=q&&q(q(j([])));se&&se!==i&&c.call(se,g)&&(le=se);var te=Z.prototype=W.prototype=Object.create(le);k.prototype=Z,u(te,"constructor",{value:Z,configurable:!0}),u(Z,"constructor",{value:k,configurable:!0}),k.displayName=w(Z,y,"GeneratorFunction");function Ce(I){["next","throw","return"].forEach(function(N){w(I,N,function(T){return this._invoke(N,T)})})}s.isGeneratorFunction=function(I){var N=typeof I=="function"&&I.constructor;return N?N===k||(N.displayName||N.name)==="GeneratorFunction":!1},s.mark=function(I){return Object.setPrototypeOf?Object.setPrototypeOf(I,Z):(I.__proto__=Z,w(I,y,"GeneratorFunction")),I.prototype=Object.create(te),I},s.awrap=function(I){return{__await:I}};function ee(I,N){function T(J,re,ne,Re){var ge=b(I[J],I,re);if(ge.type==="throw")Re(ge.arg);else{var ue=ge.arg,xe=ue.value;return xe&&typeof xe=="object"&&c.call(xe,"__await")?N.resolve(xe.__await).then(function(_e){T("next",_e,ne,Re)},function(_e){T("throw",_e,ne,Re)}):N.resolve(xe).then(function(_e){ue.value=_e,ne(ue)},function(_e){return T("throw",_e,ne,Re)})}}var z;function B(J,re){function ne(){return new N(function(Re,ge){T(J,re,Re,ge)})}return z=z?z.then(ne,ne):ne()}u(this,"_invoke",{value:B})}Ce(ee.prototype),w(ee.prototype,x,function(){return this}),s.AsyncIterator=ee,s.async=function(I,N,T,z,B){B===void 0&&(B=Promise);var J=new ee(D(I,N,T,z),B);return s.isGeneratorFunction(N)?J:J.next().then(function(re){return re.done?re.value:J.next()})};function be(I,N,T){var z=v;return function(J,re){if(z===A)throw new Error("Generator is already running");if(z===X){if(J==="throw")throw re;return P()}for(T.method=J,T.arg=re;;){var ne=T.delegate;if(ne){var Re=ae(ne,T);if(Re){if(Re===C)continue;return Re}}if(T.method==="next")T.sent=T._sent=T.arg;else if(T.method==="throw"){if(z===v)throw z=X,T.arg;T.dispatchException(T.arg)}else T.method==="return"&&T.abrupt("return",T.arg);z=A;var ge=b(I,N,T);if(ge.type==="normal"){if(z=T.done?X:E,ge.arg===C)continue;return{value:ge.arg,done:T.done}}else ge.type==="throw"&&(z=X,T.method="throw",T.arg=ge.arg)}}}function ae(I,N){var T=N.method,z=I.iterator[T];if(z===m)return N.delegate=null,T==="throw"&&I.iterator.return&&(N.method="return",N.arg=m,ae(I,N),N.method==="throw")||T!=="return"&&(N.method="throw",N.arg=new TypeError("The iterator does not provide a '"+T+"' method")),C;var B=b(z,I.iterator,N.arg);if(B.type==="throw")return N.method="throw",N.arg=B.arg,N.delegate=null,C;var J=B.arg;if(!J)return N.method="throw",N.arg=new TypeError("iterator result is not an object"),N.delegate=null,C;if(J.done)N[I.resultName]=J.value,N.next=I.nextLoc,N.method!=="return"&&(N.method="next",N.arg=m);else return J;return N.delegate=null,C}Ce(te),w(te,y,"Generator"),w(te,g,function(){return this}),w(te,"toString",function(){return"[object Generator]"});function de(I){var N={tryLoc:I[0]};1 in I&&(N.catchLoc=I[1]),2 in I&&(N.finallyLoc=I[2],N.afterLoc=I[3]),this.tryEntries.push(N)}function V(I){var N=I.completion||{};N.type="normal",delete N.arg,I.completion=N}function M(I){this.tryEntries=[{tryLoc:"root"}],I.forEach(de,this),this.reset(!0)}s.keys=function(I){var N=Object(I),T=[];for(var z in N)T.push(z);return T.reverse(),function B(){for(;T.length;){var J=T.pop();if(J in N)return B.value=J,B.done=!1,B}return B.done=!0,B}};function j(I){if(I){var N=I[g];if(N)return N.call(I);if(typeof I.next=="function")return I;if(!isNaN(I.length)){var T=-1,z=function B(){for(;++T<I.length;)if(c.call(I,T))return B.value=I[T],B.done=!1,B;return B.value=m,B.done=!0,B};return z.next=z}}return{next:P}}s.values=j;function P(){return{value:m,done:!0}}return M.prototype={constructor:M,reset:function(I){if(this.prev=0,this.next=0,this.sent=this._sent=m,this.done=!1,this.delegate=null,this.method="next",this.arg=m,this.tryEntries.forEach(V),!I)for(var N in this)N.charAt(0)==="t"&&c.call(this,N)&&!isNaN(+N.slice(1))&&(this[N]=m)},stop:function(){this.done=!0;var I=this.tryEntries[0],N=I.completion;if(N.type==="throw")throw N.arg;return this.rval},dispatchException:function(I){if(this.done)throw I;var N=this;function T(Re,ge){return J.type="throw",J.arg=I,N.next=Re,ge&&(N.method="next",N.arg=m),!!ge}for(var z=this.tryEntries.length-1;z>=0;--z){var B=this.tryEntries[z],J=B.completion;if(B.tryLoc==="root")return T("end");if(B.tryLoc<=this.prev){var re=c.call(B,"catchLoc"),ne=c.call(B,"finallyLoc");if(re&&ne){if(this.prev<B.catchLoc)return T(B.catchLoc,!0);if(this.prev<B.finallyLoc)return T(B.finallyLoc)}else if(re){if(this.prev<B.catchLoc)return T(B.catchLoc,!0)}else if(ne){if(this.prev<B.finallyLoc)return T(B.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(I,N){for(var T=this.tryEntries.length-1;T>=0;--T){var z=this.tryEntries[T];if(z.tryLoc<=this.prev&&c.call(z,"finallyLoc")&&this.prev<z.finallyLoc){var B=z;break}}B&&(I==="break"||I==="continue")&&B.tryLoc<=N&&N<=B.finallyLoc&&(B=null);var J=B?B.completion:{};return J.type=I,J.arg=N,B?(this.method="next",this.next=B.finallyLoc,C):this.complete(J)},complete:function(I,N){if(I.type==="throw")throw I.arg;return I.type==="break"||I.type==="continue"?this.next=I.arg:I.type==="return"?(this.rval=this.arg=I.arg,this.method="return",this.next="end"):I.type==="normal"&&N&&(this.next=N),C},finish:function(I){for(var N=this.tryEntries.length-1;N>=0;--N){var T=this.tryEntries[N];if(T.finallyLoc===I)return this.complete(T.completion,T.afterLoc),V(T),C}},catch:function(I){for(var N=this.tryEntries.length-1;N>=0;--N){var T=this.tryEntries[N];if(T.tryLoc===I){var z=T.completion;if(z.type==="throw"){var B=z.arg;V(T)}return B}}throw new Error("illegal catch attempt")},delegateYield:function(I,N,T){return this.delegate={iterator:j(I),resultName:N,nextLoc:T},this.method==="next"&&(this.arg=m),C}},s}(f.exports);try{regeneratorRuntime=a}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=a:Function("r","regeneratorRuntime = r")(a)}}(Po)),Po.exports}var zo,Q0;function Tu(){return Q0||(Q0=1,zo=(f,a)=>`${f}-${a}-${Math.random().toString(16).slice(3,8)}`),zo}var qo,J0;function Xh(){if(J0)return qo;J0=1;const f=Tu();let a=0;return qo=({id:s,action:i,payload:c={}})=>{let u=s;return typeof u>"u"&&(u=f("Job",a),a+=1),{id:u,action:i,payload:c}},qo}var gr={},W0;function _u(){if(W0)return gr;W0=1;let f=!1;return gr.logging=f,gr.setLogging=a=>{f=a},gr.log=(...a)=>f?console.log.apply(this,a):null,gr}var Ho,eh;function Fb(){if(eh)return Ho;eh=1;const f=Xh(),{log:a}=_u(),s=Tu();let i=0;return Ho=()=>{const c=s("Scheduler",i),u={},m={};let h=[];i+=1;const g=()=>h.length,x=()=>Object.keys(u).length,y=()=>{if(h.length!==0){const E=Object.keys(u);for(let A=0;A<E.length;A+=1)if(typeof m[E[A]]>"u"){h[0](u[E[A]]);break}}},w=(E,A)=>new Promise((X,C)=>{const W=f({action:E,payload:A});h.push(async k=>{h.shift(),m[k.id]=W;try{X(await k[E].apply(this,[...A,W.id]))}catch(Z){C(Z)}finally{delete m[k.id],y()}}),a(`[${c}]: Add ${W.id} to JobQueue`),a(`[${c}]: JobQueue length=${h.length}`),y()});return{addWorker:E=>(u[E.id]=E,a(`[${c}]: Add ${E.id}`),a(`[${c}]: Number of workers=${x()}`),y(),E.id),addJob:async(E,...A)=>{if(x()===0)throw Error(`[${c}]: You need to have at least one worker before adding jobs`);return w(E,A)},terminate:async()=>{Object.keys(u).forEach(async E=>{await u[E].terminate()}),h=[]},getQueueLen:g,getNumWorkers:x}},Ho}function Kh(f){throw new Error('Could not dynamically require "'+f+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Yo,th;function Bb(){return th||(th=1,Yo=f=>{const a={};return typeof WorkerGlobalScope<"u"?a.type="webworker":typeof document=="object"?a.type="browser":typeof process=="object"&&typeof Kh=="function"&&(a.type="node"),typeof f>"u"?a:a[f]}),Yo}var Go,ah;function Pb(){if(ah)return Go;ah=1;const a=Bb()("type")==="browser"?s=>new URL(s,window.location.href).href:s=>s;return Go=s=>{const i={...s};return["corePath","workerPath","langPath"].forEach(c=>{s[c]&&(i[c]=a(i[c]))}),i},Go}var Xo,sh;function Zh(){return sh||(sh=1,Xo={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),Xo}const zb="6.0.1",qb={version:zb};var Ko,nh;function Hb(){return nh||(nh=1,Ko={workerBlobURL:!0,logger:()=>{}}),Ko}var Zo,rh;function Yb(){if(rh)return Zo;rh=1;const f=qb.version;return Zo={...Hb(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${f}/dist/worker.min.js`},Zo}var Qo,ih;function Gb(){return ih||(ih=1,Qo=({workerPath:f,workerBlobURL:a})=>{let s;if(Blob&&URL&&a){const i=new Blob([`importScripts("${f}");`],{type:"application/javascript"});s=new Worker(URL.createObjectURL(i))}else s=new Worker(f);return s}),Qo}var Jo,lh;function Xb(){return lh||(lh=1,Jo=f=>{f.terminate()}),Jo}var Wo,ch;function Kb(){return ch||(ch=1,Wo=(f,a)=>{f.onmessage=({data:s})=>{a(s)}}),Wo}var eu,oh;function Zb(){return oh||(oh=1,eu=async(f,a)=>{f.postMessage(a)}),eu}var tu,uh;function Qb(){if(uh)return tu;uh=1;const f=s=>new Promise((i,c)=>{const u=new FileReader;u.onload=()=>{i(u.result)},u.onerror=({target:{error:{code:m}}})=>{c(Error(`File could not be read! Code=${m}`))},u.readAsArrayBuffer(s)}),a=async s=>{let i=s;if(typeof s>"u")return"undefined";if(typeof s=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(s)?i=atob(s.split(",")[1]).split("").map(c=>c.charCodeAt(0)):i=await(await fetch(s)).arrayBuffer();else if(typeof HTMLElement<"u"&&s instanceof HTMLElement)s.tagName==="IMG"&&(i=await a(s.src)),s.tagName==="VIDEO"&&(i=await a(s.poster)),s.tagName==="CANVAS"&&await new Promise(c=>{s.toBlob(async u=>{i=await f(u),c()})});else if(typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas){const c=await s.convertToBlob();i=await f(c)}else(s instanceof File||s instanceof Blob)&&(i=await f(s));return new Uint8Array(i)};return tu=a,tu}var au,dh;function Jb(){if(dh)return au;dh=1;const f=Yb(),a=Gb(),s=Xb(),i=Kb(),c=Zb(),u=Qb();return au={defaultOptions:f,spawnWorker:a,terminateWorker:s,onMessage:i,send:c,loadImage:u},au}var su,fh;function Qh(){if(fh)return su;fh=1;const f=Pb(),a=Xh(),{log:s}=_u(),i=Tu(),c=Zh(),{defaultOptions:u,spawnWorker:m,terminateWorker:h,onMessage:g,loadImage:x,send:y}=Jb();let w=0;return su=async(D="eng",b=c.LSTM_ONLY,v={},E={})=>{const A=i("Worker",w),{logger:X,errorHandler:C,...W}=f({...u,...v}),k={},Z=typeof D=="string"?D.split("+"):D;let le=b,q=E;const se=[c.DEFAULT,c.LSTM_ONLY].includes(b)&&!W.legacyCore;let te,Ce;const ee=new Promise((ue,xe)=>{Ce=ue,te=xe}),be=ue=>{te(ue.message)};let ae=m(W);ae.onerror=be,w+=1;const de=({id:ue,action:xe,payload:_e})=>new Promise((Qe,ye)=>{s(`[${A}]: Start ${ue}, action=${xe}`);const et=`${xe}-${ue}`;k[et]={resolve:Qe,reject:ye},y(ae,{workerId:A,jobId:ue,action:xe,payload:_e})}),V=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),M=ue=>de(a({id:ue,action:"load",payload:{options:{lstmOnly:se,corePath:W.corePath,logging:W.logging}}})),j=(ue,xe,_e)=>de(a({id:_e,action:"FS",payload:{method:"writeFile",args:[ue,xe]}})),P=(ue,xe)=>de(a({id:xe,action:"FS",payload:{method:"readFile",args:[ue,{encoding:"utf8"}]}})),I=(ue,xe)=>de(a({id:xe,action:"FS",payload:{method:"unlink",args:[ue]}})),N=(ue,xe,_e)=>de(a({id:_e,action:"FS",payload:{method:ue,args:xe}})),T=(ue,xe)=>de(a({id:xe,action:"loadLanguage",payload:{langs:ue,options:{langPath:W.langPath,dataPath:W.dataPath,cachePath:W.cachePath,cacheMethod:W.cacheMethod,gzip:W.gzip,lstmOnly:[c.DEFAULT,c.LSTM_ONLY].includes(le)&&!W.legacyLang}}})),z=(ue,xe,_e,Qe)=>de(a({id:Qe,action:"initialize",payload:{langs:ue,oem:xe,config:_e}})),B=(ue="eng",xe,_e,Qe)=>{if(se&&[c.TESSERACT_ONLY,c.TESSERACT_LSTM_COMBINED].includes(xe))throw Error("Legacy model requested but code missing.");const ye=xe||le;le=ye;const et=_e||q;q=et;const gn=(typeof ue=="string"?ue.split("+"):ue).filter(Ot=>!Z.includes(Ot));return Z.push(...gn),gn.length>0?T(gn,Qe).then(()=>z(ue,ye,et,Qe)):z(ue,ye,et,Qe)},J=(ue={},xe)=>de(a({id:xe,action:"setParameters",payload:{params:ue}})),re=async(ue,xe={},_e={text:!0},Qe)=>de(a({id:Qe,action:"recognize",payload:{image:await x(ue),options:xe,output:_e}})),ne=async(ue,xe)=>{if(se)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return de(a({id:xe,action:"detect",payload:{image:await x(ue)}}))},Re=async()=>(ae!==null&&(h(ae),ae=null),Promise.resolve());g(ae,({workerId:ue,jobId:xe,status:_e,action:Qe,data:ye})=>{const et=`${Qe}-${xe}`;if(_e==="resolve")s(`[${ue}]: Complete ${xe}`),k[et].resolve({jobId:xe,data:ye}),delete k[et];else if(_e==="reject")if(k[et].reject(ye),delete k[et],Qe==="load"&&te(ye),C)C(ye);else throw Error(ye);else _e==="progress"&&X({...ye,userJobId:xe})});const ge={id:A,worker:ae,load:V,writeText:j,readText:P,removeFile:I,FS:N,reinitialize:B,setParameters:J,recognize:re,detect:ne,terminate:Re};return M().then(()=>T(D)).then(()=>z(D,b,E)).then(()=>Ce(ge)).catch(()=>{}),ee},su}var nu,mh;function Wb(){if(mh)return nu;mh=1;const f=Qh();return nu={recognize:async(i,c,u)=>{const m=await f(c,1,u);return m.recognize(i).finally(async()=>{await m.terminate()})},detect:async(i,c)=>{const u=await f("osd",0,c);return u.detect(i).finally(async()=>{await u.terminate()})}},nu}var ru,hh;function ey(){return hh||(hh=1,ru={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),ru}var iu,gh;function ty(){return gh||(gh=1,iu={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),iu}var lu,xh;function ay(){if(xh)return lu;xh=1,$b();const f=Fb(),a=Qh(),s=Wb(),i=ey(),c=Zh(),u=ty(),{setLogging:m}=_u();return lu={languages:i,OEM:c,PSM:u,createScheduler:f,createWorker:a,setLogging:m,...s},lu}var ph=ay();function sy(){const[f,a]=K.useState([]);K.useEffect(()=>{const m=De.subscribeToNotifications(a);return a(De.getNotifications()),m},[]);const s=m=>{switch(m){case"error":return"";case"warning":return"";case"success":return"";case"info":return"";default:return""}},i=m=>{switch(m){case"error":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"success":return"bg-green-50 border-green-200 text-green-800";case"info":return"bg-blue-50 border-blue-200 text-blue-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}},c=(m,h)=>{m.handler(),m.type==="dismiss"&&De.dismissNotification(h)},u=m=>{De.dismissNotification(m)};return f.length===0?null:r.jsxs("div",{className:"fixed top-4 right-4 z-50 space-y-2",style:{maxWidth:"400px"},children:[f.slice(0,5).map(m=>r.jsx("div",{className:`border rounded-lg p-4 shadow-lg transition-all duration-300 ${i(m.type)}`,children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx("span",{className:"text-lg flex-shrink-0",children:s(m.type)}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-sm font-medium break-words",children:m.message}),m.actions&&m.actions.length>0&&r.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:m.actions.map((h,g)=>r.jsx("button",{onClick:()=>c(h,m.id),className:"text-xs px-2 py-1 rounded border border-current hover:bg-current hover:text-white transition-colors",children:h.label},g))})]})]}),r.jsx("button",{onClick:()=>u(m.id),className:"flex-shrink-0 ml-2 text-current hover:opacity-70 transition-opacity","aria-label":"Dismiss notification",children:""})]})},m.id)),f.length>5&&r.jsx("div",{className:"text-center",children:r.jsxs("button",{onClick:()=>De.clearAll(),className:"text-xs text-gray-500 hover:text-gray-700 underline",children:["Clear all (",f.length," total)"]})})]})}function Mr({message:f="Processing...",size:a="md"}){const s={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return r.jsxs("div",{className:"flex flex-col items-center justify-center p-4",children:[r.jsx("div",{className:`animate-spin rounded-full border-b-2 border-blue-600 ${s[a]}`}),r.jsx("p",{className:"mt-2 text-sm text-gray-600",children:f})]})}class ny extends zh.Component{constructor(a){super(a),this.state={hasError:!1}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,s){console.error("Error Boundary caught an error:",a,s),De.handleCriticalError(a,"React Error Boundary")}render(){return this.state.hasError?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:r.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6 text-center",children:[r.jsx("div",{className:"text-6xl mb-4",children:""}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Something went wrong"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"The application encountered an unexpected error. Please refresh the page to continue."}),r.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium",children:"Refresh Page"})]})}):this.props.children}}class ry{constructor(){ce(this,"steps",[]);ce(this,"listeners",[])}addStep(a){this.steps.push({...a,status:"pending"}),this.notifyListeners()}updateStep(a,s){const i=this.steps.findIndex(c=>c.id===a);i!==-1&&(this.steps[i]={...this.steps[i],...s},this.notifyListeners())}startStep(a,s){this.updateStep(a,{status:"in_progress",details:s,progress:0})}updateProgress(a,s,i){this.updateStep(a,{progress:s,details:i})}completeStep(a,s){this.updateStep(a,{status:"completed",progress:100,details:s})}failStep(a,s){this.updateStep(a,{status:"failed",error:s})}getSteps(){return[...this.steps]}clear(){this.steps=[],this.notifyListeners()}subscribe(a){return this.listeners.push(a),()=>{this.listeners=this.listeners.filter(s=>s!==a)}}notifyListeners(){this.listeners.forEach(a=>a(this.steps))}}const qt=new ry;class iy{validateVIN(a){const s=[],i=[];if(!a)return s.push({field:"vin",message:"VIN is required",value:a,severity:"error"}),{isValid:!1,errors:s,warnings:i};const c=a.replace(/\s/g,"").toUpperCase();c.length!==17&&s.push({field:"vin",message:`VIN must be exactly 17 characters, got ${c.length}`,value:a,severity:"error"});const u=c.match(/[IOQ]/g);return u&&s.push({field:"vin",message:`VIN contains invalid characters: ${u.join(", ")}. VINs cannot contain I, O, or Q`,value:a,severity:"error"}),/^[A-HJ-NPR-Z0-9]{17}$/.test(c)||s.push({field:"vin",message:"VIN contains invalid characters. Only letters and numbers allowed (no I, O, Q)",value:a,severity:"error"}),c.length===17&&(this.validateVINCheckDigit(c)||i.push({field:"vin",message:"VIN check digit validation failed. Please verify VIN is correct",value:a,suggestion:"Double-check the VIN against the vehicle title or registration"})),{isValid:s.length===0,errors:s,warnings:i}}validateMedicalCertificate(a){const s=[],i=[];a.certificateNumber?/^[A-Z0-9]{8,20}$/i.test(a.certificateNumber)||i.push({field:"certificateNumber",message:"Medical certificate number format may be incorrect",value:a.certificateNumber,suggestion:"Certificate numbers are typically 8-20 alphanumeric characters"}):s.push({field:"certificateNumber",message:"Medical certificate number is required",value:a.certificateNumber,severity:"error"});const c=this.validateDateFields(a,[{field:"issuedDate",required:!0,label:"Issue Date"},{field:"expirationDate",required:!0,label:"Expiration Date"}]);if(s.push(...c.errors),i.push(...c.warnings),a.issuedDate&&a.expirationDate){const u=new Date(a.issuedDate),m=new Date(a.expirationDate);m<=u&&s.push({field:"expirationDate",message:"Expiration date must be after issue date",value:a.expirationDate,severity:"error"}),Math.floor((m.getTime()-u.getTime())/(1e3*60*60*24))>730&&i.push({field:"expirationDate",message:"Medical certificate validity period seems unusually long",value:a.expirationDate,suggestion:"Standard medical certificates are valid for up to 2 years"})}return a.examinerName?/^(Dr\.?\s+)?[A-Z][a-z]+\s+[A-Z][a-z]+/i.test(a.examinerName)||i.push({field:"examinerName",message:"Examiner name format may be incorrect",value:a.examinerName,suggestion:'Format should be "Dr. First Last" or "First Last"'}):s.push({field:"examinerName",message:"Medical examiner name is required",value:a.examinerName,severity:"error"}),a.examinerNationalRegistry&&!/^[A-Z0-9]{6,12}$/i.test(a.examinerNationalRegistry)&&i.push({field:"examinerNationalRegistry",message:"National Registry number format may be incorrect",value:a.examinerNationalRegistry,suggestion:"Registry numbers are typically 6-12 alphanumeric characters"}),{isValid:s.length===0,errors:s,warnings:i}}validateCDL(a){const s=[],i=[];a.cdlNumber?/^[A-Z0-9\-]{8,20}$/i.test(a.cdlNumber)||i.push({field:"cdlNumber",message:"CDL number format may be incorrect",value:a.cdlNumber,suggestion:"CDL numbers vary by state but are typically 8-20 characters"}):s.push({field:"cdlNumber",message:"CDL number is required",value:a.cdlNumber,severity:"error"}),a.cdlClass?["A","B","C"].includes(a.cdlClass.toUpperCase())||s.push({field:"cdlClass",message:"CDL class must be A, B, or C",value:a.cdlClass,severity:"error"}):s.push({field:"cdlClass",message:"CDL class is required",value:a.cdlClass,severity:"error"}),a.cdlState?this.isValidUSState(a.cdlState)||s.push({field:"cdlState",message:"Invalid US state code",value:a.cdlState,severity:"error"}):s.push({field:"cdlState",message:"CDL issuing state is required",value:a.cdlState,severity:"error"});const c=this.validateDateFields(a,[{field:"cdlIssueDate",required:!1,label:"Issue Date"},{field:"cdlExpirationDate",required:!0,label:"Expiration Date"}]);if(s.push(...c.errors),i.push(...c.warnings),a.cdlEndorsements&&Array.isArray(a.cdlEndorsements)){const u=["H","N","P","S","T","X"],m=a.cdlEndorsements.filter(h=>!u.includes(h.toUpperCase()));m.length>0&&i.push({field:"cdlEndorsements",message:`Unknown endorsements: ${m.join(", ")}`,value:a.cdlEndorsements,suggestion:"Valid endorsements are: H, N, P, S, T, X"})}return{isValid:s.length===0,errors:s,warnings:i}}validateDriverInfo(a){const s=[],i=[];if(a.firstName?/^[A-Za-z\s\-']{1,50}$/.test(a.firstName)||s.push({field:"firstName",message:"First name contains invalid characters",value:a.firstName,severity:"error"}):s.push({field:"firstName",message:"First name is required",value:a.firstName,severity:"error"}),a.lastName?/^[A-Za-z\s\-']{1,50}$/.test(a.lastName)||s.push({field:"lastName",message:"Last name contains invalid characters",value:a.lastName,severity:"error"}):s.push({field:"lastName",message:"Last name is required",value:a.lastName,severity:"error"}),a.employeeId?/^[A-Z0-9]{3,20}$/i.test(a.employeeId)||i.push({field:"employeeId",message:"Employee ID format may be non-standard",value:a.employeeId,suggestion:"Employee IDs are typically 3-20 alphanumeric characters"}):s.push({field:"employeeId",message:"Employee ID is required",value:a.employeeId,severity:"error"}),a.dateOfBirth){const c=this.validateDateOfBirth(a.dateOfBirth);s.push(...c.errors),i.push(...c.warnings)}if(a.email){const c=this.validateEmail(a.email);s.push(...c.errors),i.push(...c.warnings)}if(a.phone){const c=this.validatePhone(a.phone);i.push(...c.warnings)}return{isValid:s.length===0,errors:s,warnings:i}}validateVehicleRegistration(a){const s=[],i=[];a.licensePlate?/^[A-Z0-9\-\s]{2,8}$/i.test(a.licensePlate)||i.push({field:"licensePlate",message:"License plate format may be incorrect",value:a.licensePlate,suggestion:"License plates are typically 2-8 alphanumeric characters"}):s.push({field:"licensePlate",message:"License plate is required",value:a.licensePlate,severity:"error"});const c=this.validateDateFields(a,[{field:"registrationExpiry",required:!0,label:"Registration Expiry"}]);if(s.push(...c.errors),i.push(...c.warnings),a.registrationState&&!this.isValidUSState(a.registrationState)&&s.push({field:"registrationState",message:"Invalid US state code",value:a.registrationState,severity:"error"}),a.year){const u=new Date().getFullYear();(a.year<1990||a.year>u+1)&&i.push({field:"year",message:`Vehicle year ${a.year} seems unusual`,value:a.year,suggestion:`Expected range: 1990-${u+1}`})}return{isValid:s.length===0,errors:s,warnings:i}}validateInsuranceData(a){const s=[],i=[];a.policyNumber||s.push({field:"policyNumber",message:"Insurance policy number is required",value:a.policyNumber,severity:"error"});const c=this.validateDateFields(a,[{field:"insuranceExpiry",required:!0,label:"Insurance Expiry"}]);return s.push(...c.errors),i.push(...c.warnings),a.coverageAmount&&(typeof a.coverageAmount!="number"||a.coverageAmount<0?s.push({field:"coverageAmount",message:"Coverage amount must be a positive number",value:a.coverageAmount,severity:"error"}):a.coverageAmount<75e4&&i.push({field:"coverageAmount",message:"Coverage amount may be below DOT requirements",value:a.coverageAmount,suggestion:"Commercial vehicles typically require $750,000+ liability coverage"})),{isValid:s.length===0,errors:s,warnings:i}}validateDateFields(a,s){const i=[],c=[];return s.forEach(({field:u,required:m,label:h})=>{const g=a[u];if(!g&&m){i.push({field:u,message:`${h} is required`,value:g,severity:"error"});return}if(g)if(!this.validateDate(String(g)).isValid)i.push({field:u,message:`${h} is not a valid date`,value:g,severity:"error"});else{const y=new Date(String(g)),w=new Date;(u.includes("expir")||u.includes("Expir"))&&y<w&&c.push({field:u,message:`${h} appears to be in the past`,value:g,suggestion:"Expired documents may need renewal"})}}),{isValid:i.length===0,errors:i,warnings:c}}validateDate(a){const s=[];if(!a)return{isValid:!1,errors:[{field:"date",message:"Date is required",value:a,severity:"error"}],warnings:[]};const i=new Date(a);return isNaN(i.getTime())&&s.push({field:"date",message:"Invalid date format",value:a,severity:"error"}),{isValid:s.length===0,errors:s,warnings:[]}}validateDateOfBirth(a){const s=[],i=[],c=this.validateDate(a);if(!c.isValid)return c;const u=new Date(a),h=Math.floor((new Date().getTime()-u.getTime())/(1e3*60*60*24*365.25));return h<18?s.push({field:"dateOfBirth",message:"Driver must be at least 18 years old",value:a,severity:"error"}):h<21&&i.push({field:"dateOfBirth",message:"Driver is under 21 - interstate restrictions may apply",value:a,suggestion:"Check interstate driving restrictions for drivers under 21"}),h>100&&i.push({field:"dateOfBirth",message:"Age seems unusually high",value:a,suggestion:"Please verify date of birth"}),{isValid:s.length===0,errors:s,warnings:i}}validateEmail(a){const s=[],i=[];return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)||s.push({field:"email",message:"Invalid email format",value:a,severity:"error"}),{isValid:s.length===0,errors:s,warnings:i}}validatePhone(a){const s=[],i=a.replace(/\D/g,"");return i.length!==10&&i.length!==11&&s.push({field:"phone",message:"Phone number format may be incorrect",value:a,suggestion:"Use format: (555) 123-4567 or 555-123-4567"}),{isValid:!0,errors:[],warnings:s}}validateVINCheckDigit(a){const s=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2],i={A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,J:1,K:2,L:3,M:4,N:5,P:7,R:9,S:2,T:3,U:4,V:5,W:6,X:7,Y:8,Z:9};let c=0;for(let h=0;h<17;h++){if(h===8)continue;const g=a[h],x=isNaN(parseInt(g))?i[g]||0:parseInt(g);c+=x*s[h]}const u=c%11,m=u===10?"X":u.toString();return a[8]===m}isValidUSState(a){return["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY","DC"].includes(a.toUpperCase())}validateDriverRecord(a){const s=[],i=[],c=this.validateDriverInfo(a);if(s.push(...c.errors),i.push(...c.warnings),a.medicalCertificate&&typeof a.medicalCertificate=="object"&&a.medicalCertificate!==null){const u=this.validateMedicalCertificate(a.medicalCertificate);s.push(...u.errors),i.push(...u.warnings)}if(a.cdlInfo&&typeof a.cdlInfo=="object"&&a.cdlInfo!==null){const u=this.validateCDL(a.cdlInfo);s.push(...u.errors),i.push(...u.warnings)}return{isValid:s.length===0,errors:s,warnings:i}}validateVehicleRecord(a){const s=[],i=[];if(a.vin&&typeof a.vin=="string"){const u=this.validateVIN(a.vin);s.push(...u.errors),i.push(...u.warnings)}const c=this.validateVehicleRegistration(a);if(s.push(...c.errors),i.push(...c.warnings),a.insuranceCarrier||a.policyNumber||a.insuranceExpiry){const u=this.validateInsuranceData(a);s.push(...u.errors),i.push(...u.warnings)}return{isValid:s.length===0,errors:s,warnings:i}}handleValidationResults(a,s){a.isValid||a.errors.forEach(i=>{De.handleValidationError(i.field,i.value,[i.message])}),a.warnings.forEach(i=>{De.showInfo(`${i.field}: ${i.message}${i.suggestion?` (${i.suggestion})`:""}`,5e3)}),a.isValid&&a.warnings.length===0&&De.showSuccess(`${s} validation passed!`)}}const Qi=new iy;function pe(f,a,s,i,c){if(typeof a=="function"?f!==a||!0:!a.has(f))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a.set(f,s),s}function Q(f,a,s,i){if(s==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?f!==a||!i:!a.has(f))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?i:s==="a"?i.call(f):i?i.value:a.get(f)}let Jh=function(){const{crypto:f}=globalThis;if(f!=null&&f.randomUUID)return Jh=f.randomUUID.bind(f),f.randomUUID();const a=new Uint8Array(1),s=f?()=>f.getRandomValues(a)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^s()&15>>+i/4).toString(16))};function Ir(f){return typeof f=="object"&&f!==null&&("name"in f&&f.name==="AbortError"||"message"in f&&String(f.message).includes("FetchRequestCanceledException"))}const wu=f=>{if(f instanceof Error)return f;if(typeof f=="object"&&f!==null){try{if(Object.prototype.toString.call(f)==="[object Error]"){const a=new Error(f.message,f.cause?{cause:f.cause}:{});return f.stack&&(a.stack=f.stack),f.cause&&!a.cause&&(a.cause=f.cause),f.name&&(a.name=f.name),a}}catch{}try{return new Error(JSON.stringify(f))}catch{}}return new Error(f)};class Se extends Error{}class mt extends Se{constructor(a,s,i,c){super(`${mt.makeMessage(a,s,i)}`),this.status=a,this.headers=c,this.requestID=c==null?void 0:c.get("request-id"),this.error=s}static makeMessage(a,s,i){const c=s!=null&&s.message?typeof s.message=="string"?s.message:JSON.stringify(s.message):s?JSON.stringify(s):i;return a&&c?`${a} ${c}`:a?`${a} status code (no body)`:c||"(no status code or body)"}static generate(a,s,i,c){if(!a||!c)return new Nl({message:i,cause:wu(s)});const u=s;return a===400?new eg(a,u,i,c):a===401?new tg(a,u,i,c):a===403?new ag(a,u,i,c):a===404?new sg(a,u,i,c):a===409?new ng(a,u,i,c):a===422?new rg(a,u,i,c):a===429?new ig(a,u,i,c):a>=500?new lg(a,u,i,c):new mt(a,u,i,c)}}class Jt extends mt{constructor({message:a}={}){super(void 0,void 0,a||"Request was aborted.",void 0)}}class Nl extends mt{constructor({message:a,cause:s}){super(void 0,void 0,a||"Connection error.",void 0),s&&(this.cause=s)}}class Wh extends Nl{constructor({message:a}={}){super({message:a??"Request timed out."})}}class eg extends mt{}class tg extends mt{}class ag extends mt{}class sg extends mt{}class ng extends mt{}class rg extends mt{}class ig extends mt{}class lg extends mt{}const ly=/^[a-z][a-z0-9+.-]*:/i,cy=f=>ly.test(f);let Eu=f=>(Eu=Array.isArray,Eu(f)),bh=Eu;function yh(f){return typeof f!="object"?{}:f??{}}function oy(f){if(!f)return!0;for(const a in f)return!1;return!0}function uy(f,a){return Object.prototype.hasOwnProperty.call(f,a)}const dy=(f,a)=>{if(typeof a!="number"||!Number.isInteger(a))throw new Se(`${f} must be an integer`);if(a<0)throw new Se(`${f} must be a positive integer`);return a},cg=f=>{try{return JSON.parse(f)}catch{return}},fy=f=>new Promise(a=>setTimeout(a,f)),un="0.57.0",my=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function hy(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const gy=()=>{var s;const f=hy();if(f==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":un,"X-Stainless-OS":Nh(Deno.build.os),"X-Stainless-Arch":vh(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((s=Deno.version)==null?void 0:s.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":un,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(f==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":un,"X-Stainless-OS":Nh(globalThis.process.platform??"unknown"),"X-Stainless-Arch":vh(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const a=xy();return a?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":un,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${a.browser}`,"X-Stainless-Runtime-Version":a.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":un,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function xy(){if(typeof navigator>"u"||!navigator)return null;const f=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:a,pattern:s}of f){const i=s.exec(navigator.userAgent);if(i){const c=i[1]||0,u=i[2]||0,m=i[3]||0;return{browser:a,version:`${c}.${u}.${m}`}}}return null}const vh=f=>f==="x32"?"x32":f==="x86_64"||f==="x64"?"x64":f==="arm"?"arm":f==="aarch64"||f==="arm64"?"arm64":f?`other:${f}`:"unknown",Nh=f=>(f=f.toLowerCase(),f.includes("ios")?"iOS":f==="android"?"Android":f==="darwin"?"MacOS":f==="win32"?"Windows":f==="freebsd"?"FreeBSD":f==="openbsd"?"OpenBSD":f==="linux"?"Linux":f?`Other:${f}`:"Unknown");let Sh;const py=()=>Sh??(Sh=gy());function by(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new Anthropic({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function og(...f){const a=globalThis.ReadableStream;if(typeof a>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new a(...f)}function ug(f){let a=Symbol.asyncIterator in f?f[Symbol.asyncIterator]():f[Symbol.iterator]();return og({start(){},async pull(s){const{done:i,value:c}=await a.next();i?s.close():s.enqueue(c)},async cancel(){var s;await((s=a.return)==null?void 0:s.call(a))}})}function Mu(f){if(f[Symbol.asyncIterator])return f;const a=f.getReader();return{async next(){try{const s=await a.read();return s!=null&&s.done&&a.releaseLock(),s}catch(s){throw a.releaseLock(),s}},async return(){const s=a.cancel();return a.releaseLock(),await s,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function yy(f){var i,c;if(f===null||typeof f!="object")return;if(f[Symbol.asyncIterator]){await((c=(i=f[Symbol.asyncIterator]()).return)==null?void 0:c.call(i));return}const a=f.getReader(),s=a.cancel();a.releaseLock(),await s}const vy=({headers:f,body:a})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(a)});function Ny(f){let a=0;for(const c of f)a+=c.length;const s=new Uint8Array(a);let i=0;for(const c of f)s.set(c,i),i+=c.length;return s}let wh;function Iu(f){let a;return(wh??(a=new globalThis.TextEncoder,wh=a.encode.bind(a)))(f)}let Eh;function jh(f){let a;return(Eh??(a=new globalThis.TextDecoder,Eh=a.decode.bind(a)))(f)}var Tt,_t;class Or{constructor(){Tt.set(this,void 0),_t.set(this,void 0),pe(this,Tt,new Uint8Array),pe(this,_t,null)}decode(a){if(a==null)return[];const s=a instanceof ArrayBuffer?new Uint8Array(a):typeof a=="string"?Iu(a):a;pe(this,Tt,Ny([Q(this,Tt,"f"),s]));const i=[];let c;for(;(c=Sy(Q(this,Tt,"f"),Q(this,_t,"f")))!=null;){if(c.carriage&&Q(this,_t,"f")==null){pe(this,_t,c.index);continue}if(Q(this,_t,"f")!=null&&(c.index!==Q(this,_t,"f")+1||c.carriage)){i.push(jh(Q(this,Tt,"f").subarray(0,Q(this,_t,"f")-1))),pe(this,Tt,Q(this,Tt,"f").subarray(Q(this,_t,"f"))),pe(this,_t,null);continue}const u=Q(this,_t,"f")!==null?c.preceding-1:c.preceding,m=jh(Q(this,Tt,"f").subarray(0,u));i.push(m),pe(this,Tt,Q(this,Tt,"f").subarray(c.index)),pe(this,_t,null)}return i}flush(){return Q(this,Tt,"f").length?this.decode(`
`):[]}}Tt=new WeakMap,_t=new WeakMap;Or.NEWLINE_CHARS=new Set([`
`,"\r"]);Or.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Sy(f,a){for(let c=a??0;c<f.length;c++){if(f[c]===10)return{preceding:c,index:c+1,carriage:!1};if(f[c]===13)return{preceding:c,index:c+1,carriage:!0}}return null}function wy(f){for(let i=0;i<f.length-1;i++){if(f[i]===10&&f[i+1]===10||f[i]===13&&f[i+1]===13)return i+2;if(f[i]===13&&f[i+1]===10&&i+3<f.length&&f[i+2]===13&&f[i+3]===10)return i+4}return-1}const bl={off:0,error:200,warn:300,info:400,debug:500},Dh=(f,a,s)=>{if(f){if(uy(bl,f))return f;gt(s).warn(`${a} was set to ${JSON.stringify(f)}, expected one of ${JSON.stringify(Object.keys(bl))}`)}};function Ar(){}function Ji(f,a,s){return!a||bl[f]>bl[s]?Ar:a[f].bind(a)}const Ey={error:Ar,warn:Ar,info:Ar,debug:Ar};let Rh=new WeakMap;function gt(f){const a=f.logger,s=f.logLevel??"off";if(!a)return Ey;const i=Rh.get(a);if(i&&i[0]===s)return i[1];const c={error:Ji("error",a,s),warn:Ji("warn",a,s),info:Ji("info",a,s),debug:Ji("debug",a,s)};return Rh.set(a,[s,c]),c}const ys=f=>(f.options&&(f.options={...f.options},delete f.options.headers),f.headers&&(f.headers=Object.fromEntries((f.headers instanceof Headers?[...f.headers]:Object.entries(f.headers)).map(([a,s])=>[a,a.toLowerCase()==="x-api-key"||a.toLowerCase()==="authorization"||a.toLowerCase()==="cookie"||a.toLowerCase()==="set-cookie"?"***":s]))),"retryOfRequestLogID"in f&&(f.retryOfRequestLogID&&(f.retryOf=f.retryOfRequestLogID),delete f.retryOfRequestLogID),f);var xr;class ia{constructor(a,s,i){this.iterator=a,xr.set(this,void 0),this.controller=s,pe(this,xr,i)}static fromSSEResponse(a,s,i){let c=!1;const u=i?gt(i):console;async function*m(){if(c)throw new Se("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");c=!0;let h=!1;try{for await(const g of jy(a,s)){if(g.event==="completion")try{yield JSON.parse(g.data)}catch(x){throw u.error("Could not parse message into JSON:",g.data),u.error("From chunk:",g.raw),x}if(g.event==="message_start"||g.event==="message_delta"||g.event==="message_stop"||g.event==="content_block_start"||g.event==="content_block_delta"||g.event==="content_block_stop")try{yield JSON.parse(g.data)}catch(x){throw u.error("Could not parse message into JSON:",g.data),u.error("From chunk:",g.raw),x}if(g.event!=="ping"&&g.event==="error")throw new mt(void 0,cg(g.data)??g.data,void 0,a.headers)}h=!0}catch(g){if(Ir(g))return;throw g}finally{h||s.abort()}}return new ia(m,s,i)}static fromReadableStream(a,s,i){let c=!1;async function*u(){const h=new Or,g=Mu(a);for await(const x of g)for(const y of h.decode(x))yield y;for(const x of h.flush())yield x}async function*m(){if(c)throw new Se("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");c=!0;let h=!1;try{for await(const g of u())h||g&&(yield JSON.parse(g));h=!0}catch(g){if(Ir(g))return;throw g}finally{h||s.abort()}}return new ia(m,s,i)}[(xr=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const a=[],s=[],i=this.iterator(),c=u=>({next:()=>{if(u.length===0){const m=i.next();a.push(m),s.push(m)}return u.shift()}});return[new ia(()=>c(a),this.controller,Q(this,xr,"f")),new ia(()=>c(s),this.controller,Q(this,xr,"f"))]}toReadableStream(){const a=this;let s;return og({async start(){s=a[Symbol.asyncIterator]()},async pull(i){try{const{value:c,done:u}=await s.next();if(u)return i.close();const m=Iu(JSON.stringify(c)+`
`);i.enqueue(m)}catch(c){i.error(c)}},async cancel(){var i;await((i=s.return)==null?void 0:i.call(s))}})}}async function*jy(f,a){if(!f.body)throw a.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Se("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Se("Attempted to iterate over a response with no body");const s=new Ry,i=new Or,c=Mu(f.body);for await(const u of Dy(c))for(const m of i.decode(u)){const h=s.decode(m);h&&(yield h)}for(const u of i.flush()){const m=s.decode(u);m&&(yield m)}}async function*Dy(f){let a=new Uint8Array;for await(const s of f){if(s==null)continue;const i=s instanceof ArrayBuffer?new Uint8Array(s):typeof s=="string"?Iu(s):s;let c=new Uint8Array(a.length+i.length);c.set(a),c.set(i,a.length),a=c;let u;for(;(u=wy(a))!==-1;)yield a.slice(0,u),a=a.slice(u)}a.length>0&&(yield a)}class Ry{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(a){if(a.endsWith("\r")&&(a=a.substring(0,a.length-1)),!a){if(!this.event&&!this.data.length)return null;const u={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],u}if(this.chunks.push(a),a.startsWith(":"))return null;let[s,i,c]=Ay(a,":");return c.startsWith(" ")&&(c=c.substring(1)),s==="event"?this.event=c:s==="data"&&this.data.push(c),null}}function Ay(f,a){const s=f.indexOf(a);return s!==-1?[f.substring(0,s),a,f.substring(s+a.length)]:[f,"",""]}async function dg(f,a){const{response:s,requestLogID:i,retryOfRequestLogID:c,startTime:u}=a,m=await(async()=>{var w;if(a.options.stream)return gt(f).debug("response",s.status,s.url,s.headers,s.body),a.options.__streamClass?a.options.__streamClass.fromSSEResponse(s,a.controller):ia.fromSSEResponse(s,a.controller);if(s.status===204)return null;if(a.options.__binaryResponse)return s;const h=s.headers.get("content-type"),g=(w=h==null?void 0:h.split(";")[0])==null?void 0:w.trim();if((g==null?void 0:g.includes("application/json"))||(g==null?void 0:g.endsWith("+json"))){const D=await s.json();return fg(D,s)}return await s.text()})();return gt(f).debug(`[${i}] response parsed`,ys({retryOfRequestLogID:c,url:s.url,status:s.status,body:m,durationMs:Date.now()-u})),m}function fg(f,a){return!f||typeof f!="object"||Array.isArray(f)?f:Object.defineProperty(f,"_request_id",{value:a.headers.get("request-id"),enumerable:!1})}var Cr;class Sl extends Promise{constructor(a,s,i=dg){super(c=>{c(null)}),this.responsePromise=s,this.parseResponse=i,Cr.set(this,void 0),pe(this,Cr,a)}_thenUnwrap(a){return new Sl(Q(this,Cr,"f"),this.responsePromise,async(s,i)=>fg(a(await this.parseResponse(s,i),i),i.response))}asResponse(){return this.responsePromise.then(a=>a.response)}async withResponse(){const[a,s]=await Promise.all([this.parse(),this.asResponse()]);return{data:a,response:s,request_id:s.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(a=>this.parseResponse(Q(this,Cr,"f"),a))),this.parsedPromise}then(a,s){return this.parse().then(a,s)}catch(a){return this.parse().catch(a)}finally(a){return this.parse().finally(a)}}Cr=new WeakMap;var Wi;class Cy{constructor(a,s,i,c){Wi.set(this,void 0),pe(this,Wi,a),this.options=c,this.response=s,this.body=i}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const a=this.nextPageRequestOptions();if(!a)throw new Se("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await Q(this,Wi,"f").requestAPIList(this.constructor,a)}async*iterPages(){let a=this;for(yield a;a.hasNextPage();)a=await a.getNextPage(),yield a}async*[(Wi=new WeakMap,Symbol.asyncIterator)](){for await(const a of this.iterPages())for(const s of a.getPaginatedItems())yield s}}class Ty extends Sl{constructor(a,s,i){super(a,s,async(c,u)=>new i(c,u.response,await dg(c,u),u.options))}async*[Symbol.asyncIterator](){const a=await this;for await(const s of a)yield s}}class Vr extends Cy{constructor(a,s,i,c){super(a,s,i,c),this.data=i.data||[],this.has_more=i.has_more||!1,this.first_id=i.first_id||null,this.last_id=i.last_id||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var s;if((s=this.options.query)!=null&&s.before_id){const i=this.first_id;return i?{...this.options,query:{...yh(this.options.query),before_id:i}}:null}const a=this.last_id;return a?{...this.options,query:{...yh(this.options.query),after_id:a}}:null}}const mg=()=>{var f;if(typeof File>"u"){const{process:a}=globalThis,s=typeof((f=a==null?void 0:a.versions)==null?void 0:f.node)=="string"&&parseInt(a.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(s?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function fn(f,a,s){return mg(),new File(f,a??"unknown_file",s)}function xl(f){return(typeof f=="object"&&f!==null&&("name"in f&&f.name&&String(f.name)||"url"in f&&f.url&&String(f.url)||"filename"in f&&f.filename&&String(f.filename)||"path"in f&&f.path&&String(f.path))||"").split(/[\\/]/).pop()||void 0}const hg=f=>f!=null&&typeof f=="object"&&typeof f[Symbol.asyncIterator]=="function",_y=async(f,a)=>({...f,body:await Iy(f.body,a)}),Ah=new WeakMap;function My(f){const a=typeof f=="function"?f:f.fetch,s=Ah.get(a);if(s)return s;const i=(async()=>{try{const c="Response"in a?a.Response:(await a("data:,")).constructor,u=new FormData;return u.toString()!==await new c(u).text()}catch{return!0}})();return Ah.set(a,i),i}const Iy=async(f,a)=>{if(!await My(a))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const s=new FormData;return await Promise.all(Object.entries(f||{}).map(([i,c])=>ju(s,i,c))),s},Oy=f=>f instanceof Blob&&"name"in f,ju=async(f,a,s)=>{if(s!==void 0){if(s==null)throw new TypeError(`Received null for "${a}"; to pass null in FormData, you must use the string 'null'`);if(typeof s=="string"||typeof s=="number"||typeof s=="boolean")f.append(a,String(s));else if(s instanceof Response){let i={};const c=s.headers.get("Content-Type");c&&(i={type:c}),f.append(a,fn([await s.blob()],xl(s),i))}else if(hg(s))f.append(a,fn([await new Response(ug(s)).blob()],xl(s)));else if(Oy(s))f.append(a,fn([s],xl(s),{type:s.type}));else if(Array.isArray(s))await Promise.all(s.map(i=>ju(f,a+"[]",i)));else if(typeof s=="object")await Promise.all(Object.entries(s).map(([i,c])=>ju(f,`${a}[${i}]`,c)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${s} instead`)}},gg=f=>f!=null&&typeof f=="object"&&typeof f.size=="number"&&typeof f.type=="string"&&typeof f.text=="function"&&typeof f.slice=="function"&&typeof f.arrayBuffer=="function",Vy=f=>f!=null&&typeof f=="object"&&typeof f.name=="string"&&typeof f.lastModified=="number"&&gg(f),Uy=f=>f!=null&&typeof f=="object"&&typeof f.url=="string"&&typeof f.blob=="function";async function Ly(f,a,s){if(mg(),f=await f,a||(a=xl(f)),Vy(f))return f instanceof File&&a==null&&s==null?f:fn([await f.arrayBuffer()],a??f.name,{type:f.type,lastModified:f.lastModified,...s});if(Uy(f)){const c=await f.blob();return a||(a=new URL(f.url).pathname.split(/[\\/]/).pop()),fn(await Du(c),a,s)}const i=await Du(f);if(!(s!=null&&s.type)){const c=i.find(u=>typeof u=="object"&&"type"in u&&u.type);typeof c=="string"&&(s={...s,type:c})}return fn(i,a,s)}async function Du(f){var s;let a=[];if(typeof f=="string"||ArrayBuffer.isView(f)||f instanceof ArrayBuffer)a.push(f);else if(gg(f))a.push(f instanceof Blob?f:await f.arrayBuffer());else if(hg(f))for await(const i of f)a.push(...await Du(i));else{const i=(s=f==null?void 0:f.constructor)==null?void 0:s.name;throw new Error(`Unexpected data type: ${typeof f}${i?`; constructor: ${i}`:""}${ky(f)}`)}return a}function ky(f){return typeof f!="object"||f===null?"":`; props: [${Object.getOwnPropertyNames(f).map(s=>`"${s}"`).join(", ")}]`}class Ea{constructor(a){this._client=a}}const xg=Symbol.for("brand.privateNullableHeaders");function*$y(f){if(!f)return;if(xg in f){const{values:i,nulls:c}=f;yield*i.entries();for(const u of c)yield[u,null];return}let a=!1,s;f instanceof Headers?s=f.entries():bh(f)?s=f:(a=!0,s=Object.entries(f??{}));for(let i of s){const c=i[0];if(typeof c!="string")throw new TypeError("expected header name to be a string");const u=bh(i[1])?i[1]:[i[1]];let m=!1;for(const h of u)h!==void 0&&(a&&!m&&(m=!0,yield[c,null]),yield[c,h])}}const Be=f=>{const a=new Headers,s=new Set;for(const i of f){const c=new Set;for(const[u,m]of $y(i)){const h=u.toLowerCase();c.has(h)||(a.delete(u),c.add(h)),m===null?(a.delete(u),s.add(h)):(a.append(u,m),s.delete(h))}}return{[xg]:!0,values:a,nulls:s}};function pg(f){return f.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Ch=Object.freeze(Object.create(null)),Fy=(f=pg)=>function(s,...i){if(s.length===1)return s[0];let c=!1;const u=[],m=s.reduce((y,w,D)=>{var E;/[?#]/.test(w)&&(c=!0);const b=i[D];let v=(c?encodeURIComponent:f)(""+b);return D!==i.length&&(b==null||typeof b=="object"&&b.toString===((E=Object.getPrototypeOf(Object.getPrototypeOf(b.hasOwnProperty??Ch)??Ch))==null?void 0:E.toString))&&(v=b+"",u.push({start:y.length+w.length,length:v.length,error:`Value of type ${Object.prototype.toString.call(b).slice(8,-1)} is not a valid path parameter`})),y+w+(D===i.length?"":v)},""),h=m.split(/[?#]/,1)[0],g=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let x;for(;(x=g.exec(h))!==null;)u.push({start:x.index,length:x[0].length,error:`Value "${x[0]}" can't be safely passed as a path parameter`});if(u.sort((y,w)=>y.start-w.start),u.length>0){let y=0;const w=u.reduce((D,b)=>{const v=" ".repeat(b.start-y),E="^".repeat(b.length);return y=b.start+b.length,D+v+E},"");throw new Se(`Path parameters result in path with invalid segments:
${u.map(D=>D.error).join(`
`)}
${m}
${w}`)}return m},Wt=Fy(pg);class bg extends Ea{list(a={},s){const{betas:i,...c}=a??{};return this._client.getAPIList("/v1/files",Vr,{query:c,...s,headers:Be([{"anthropic-beta":[...i??[],"files-api-2025-04-14"].toString()},s==null?void 0:s.headers])})}delete(a,s={},i){const{betas:c}=s??{};return this._client.delete(Wt`/v1/files/${a}`,{...i,headers:Be([{"anthropic-beta":[...c??[],"files-api-2025-04-14"].toString()},i==null?void 0:i.headers])})}download(a,s={},i){const{betas:c}=s??{};return this._client.get(Wt`/v1/files/${a}/content`,{...i,headers:Be([{"anthropic-beta":[...c??[],"files-api-2025-04-14"].toString(),Accept:"application/binary"},i==null?void 0:i.headers]),__binaryResponse:!0})}retrieveMetadata(a,s={},i){const{betas:c}=s??{};return this._client.get(Wt`/v1/files/${a}`,{...i,headers:Be([{"anthropic-beta":[...c??[],"files-api-2025-04-14"].toString()},i==null?void 0:i.headers])})}upload(a,s){const{betas:i,...c}=a;return this._client.post("/v1/files",_y({body:c,...s,headers:Be([{"anthropic-beta":[...i??[],"files-api-2025-04-14"].toString()},s==null?void 0:s.headers])},this._client))}}let yg=class extends Ea{retrieve(a,s={},i){const{betas:c}=s??{};return this._client.get(Wt`/v1/models/${a}?beta=true`,{...i,headers:Be([{...(c==null?void 0:c.toString())!=null?{"anthropic-beta":c==null?void 0:c.toString()}:void 0},i==null?void 0:i.headers])})}list(a={},s){const{betas:i,...c}=a??{};return this._client.getAPIList("/v1/models?beta=true",Vr,{query:c,...s,headers:Be([{...(i==null?void 0:i.toString())!=null?{"anthropic-beta":i==null?void 0:i.toString()}:void 0},s==null?void 0:s.headers])})}};class wl{constructor(a,s){this.iterator=a,this.controller=s}async*decoder(){const a=new Or;for await(const s of this.iterator)for(const i of a.decode(s))yield JSON.parse(i);for(const s of a.flush())yield JSON.parse(s)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(a,s){if(!a.body)throw s.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Se("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Se("Attempted to iterate over a response with no body");return new wl(Mu(a.body),s)}}let vg=class extends Ea{create(a,s){const{betas:i,...c}=a;return this._client.post("/v1/messages/batches?beta=true",{body:c,...s,headers:Be([{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString()},s==null?void 0:s.headers])})}retrieve(a,s={},i){const{betas:c}=s??{};return this._client.get(Wt`/v1/messages/batches/${a}?beta=true`,{...i,headers:Be([{"anthropic-beta":[...c??[],"message-batches-2024-09-24"].toString()},i==null?void 0:i.headers])})}list(a={},s){const{betas:i,...c}=a??{};return this._client.getAPIList("/v1/messages/batches?beta=true",Vr,{query:c,...s,headers:Be([{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString()},s==null?void 0:s.headers])})}delete(a,s={},i){const{betas:c}=s??{};return this._client.delete(Wt`/v1/messages/batches/${a}?beta=true`,{...i,headers:Be([{"anthropic-beta":[...c??[],"message-batches-2024-09-24"].toString()},i==null?void 0:i.headers])})}cancel(a,s={},i){const{betas:c}=s??{};return this._client.post(Wt`/v1/messages/batches/${a}/cancel?beta=true`,{...i,headers:Be([{"anthropic-beta":[...c??[],"message-batches-2024-09-24"].toString()},i==null?void 0:i.headers])})}async results(a,s={},i){const c=await this.retrieve(a);if(!c.results_url)throw new Se(`No batch \`results_url\`; Has it finished processing? ${c.processing_status} - ${c.id}`);const{betas:u}=s??{};return this._client.get(c.results_url,{...i,headers:Be([{"anthropic-beta":[...u??[],"message-batches-2024-09-24"].toString(),Accept:"application/binary"},i==null?void 0:i.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((m,h)=>wl.fromResponse(h.response,h.controller))}};const By=f=>{let a=0,s=[];for(;a<f.length;){let i=f[a];if(i==="\\"){a++;continue}if(i==="{"){s.push({type:"brace",value:"{"}),a++;continue}if(i==="}"){s.push({type:"brace",value:"}"}),a++;continue}if(i==="["){s.push({type:"paren",value:"["}),a++;continue}if(i==="]"){s.push({type:"paren",value:"]"}),a++;continue}if(i===":"){s.push({type:"separator",value:":"}),a++;continue}if(i===","){s.push({type:"delimiter",value:","}),a++;continue}if(i==='"'){let h="",g=!1;for(i=f[++a];i!=='"';){if(a===f.length){g=!0;break}if(i==="\\"){if(a++,a===f.length){g=!0;break}h+=i+f[a],i=f[++a]}else h+=i,i=f[++a]}i=f[++a],g||s.push({type:"string",value:h});continue}if(i&&/\s/.test(i)){a++;continue}let u=/[0-9]/;if(i&&u.test(i)||i==="-"||i==="."){let h="";for(i==="-"&&(h+=i,i=f[++a]);i&&u.test(i)||i===".";)h+=i,i=f[++a];s.push({type:"number",value:h});continue}let m=/[a-z]/i;if(i&&m.test(i)){let h="";for(;i&&m.test(i)&&a!==f.length;)h+=i,i=f[++a];if(h=="true"||h=="false"||h==="null")s.push({type:"name",value:h});else{a++;continue}continue}a++}return s},dn=f=>{if(f.length===0)return f;let a=f[f.length-1];switch(a.type){case"separator":return f=f.slice(0,f.length-1),dn(f);case"number":let s=a.value[a.value.length-1];if(s==="."||s==="-")return f=f.slice(0,f.length-1),dn(f);case"string":let i=f[f.length-2];if((i==null?void 0:i.type)==="delimiter")return f=f.slice(0,f.length-1),dn(f);if((i==null?void 0:i.type)==="brace"&&i.value==="{")return f=f.slice(0,f.length-1),dn(f);break;case"delimiter":return f=f.slice(0,f.length-1),dn(f)}return f},Py=f=>{let a=[];return f.map(s=>{s.type==="brace"&&(s.value==="{"?a.push("}"):a.splice(a.lastIndexOf("}"),1)),s.type==="paren"&&(s.value==="["?a.push("]"):a.splice(a.lastIndexOf("]"),1))}),a.length>0&&a.reverse().map(s=>{s==="}"?f.push({type:"brace",value:"}"}):s==="]"&&f.push({type:"paren",value:"]"})}),f},zy=f=>{let a="";return f.map(s=>{switch(s.type){case"string":a+='"'+s.value+'"';break;default:a+=s.value;break}}),a},Ng=f=>JSON.parse(zy(Py(dn(By(f)))));var Ht,Za,pr,el,br,yr,tl,vr,Sa,Nr,al,sl,ln,nl,rl,cu,Th,il,ou,uu,du,_h;const Mh="__json_buf";function Ih(f){return f.type==="tool_use"||f.type==="server_tool_use"||f.type==="mcp_tool_use"}class yl{constructor(){Ht.add(this),this.messages=[],this.receivedMessages=[],Za.set(this,void 0),this.controller=new AbortController,pr.set(this,void 0),el.set(this,()=>{}),br.set(this,()=>{}),yr.set(this,void 0),tl.set(this,()=>{}),vr.set(this,()=>{}),Sa.set(this,{}),Nr.set(this,!1),al.set(this,!1),sl.set(this,!1),ln.set(this,!1),nl.set(this,void 0),rl.set(this,void 0),il.set(this,a=>{if(pe(this,al,!0),Ir(a)&&(a=new Jt),a instanceof Jt)return pe(this,sl,!0),this._emit("abort",a);if(a instanceof Se)return this._emit("error",a);if(a instanceof Error){const s=new Se(a.message);return s.cause=a,this._emit("error",s)}return this._emit("error",new Se(String(a)))}),pe(this,pr,new Promise((a,s)=>{pe(this,el,a,"f"),pe(this,br,s,"f")})),pe(this,yr,new Promise((a,s)=>{pe(this,tl,a,"f"),pe(this,vr,s,"f")})),Q(this,pr,"f").catch(()=>{}),Q(this,yr,"f").catch(()=>{})}get response(){return Q(this,nl,"f")}get request_id(){return Q(this,rl,"f")}async withResponse(){const a=await Q(this,pr,"f");if(!a)throw new Error("Could not resolve a `Response` object");return{data:this,response:a,request_id:a.headers.get("request-id")}}static fromReadableStream(a){const s=new yl;return s._run(()=>s._fromReadableStream(a)),s}static createMessage(a,s,i){const c=new yl;for(const u of s.messages)c._addMessageParam(u);return c._run(()=>c._createMessage(a,{...s,stream:!0},{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),c}_run(a){a().then(()=>{this._emitFinal(),this._emit("end")},Q(this,il,"f"))}_addMessageParam(a){this.messages.push(a)}_addMessage(a,s=!0){this.receivedMessages.push(a),s&&this._emit("message",a)}async _createMessage(a,s,i){var m;const c=i==null?void 0:i.signal;let u;c&&(c.aborted&&this.controller.abort(),u=this.controller.abort.bind(this.controller),c.addEventListener("abort",u));try{Q(this,Ht,"m",ou).call(this);const{response:h,data:g}=await a.create({...s,stream:!0},{...i,signal:this.controller.signal}).withResponse();this._connected(h);for await(const x of g)Q(this,Ht,"m",uu).call(this,x);if((m=g.controller.signal)!=null&&m.aborted)throw new Jt;Q(this,Ht,"m",du).call(this)}finally{c&&u&&c.removeEventListener("abort",u)}}_connected(a){this.ended||(pe(this,nl,a),pe(this,rl,a==null?void 0:a.headers.get("request-id")),Q(this,el,"f").call(this,a),this._emit("connect"))}get ended(){return Q(this,Nr,"f")}get errored(){return Q(this,al,"f")}get aborted(){return Q(this,sl,"f")}abort(){this.controller.abort()}on(a,s){return(Q(this,Sa,"f")[a]||(Q(this,Sa,"f")[a]=[])).push({listener:s}),this}off(a,s){const i=Q(this,Sa,"f")[a];if(!i)return this;const c=i.findIndex(u=>u.listener===s);return c>=0&&i.splice(c,1),this}once(a,s){return(Q(this,Sa,"f")[a]||(Q(this,Sa,"f")[a]=[])).push({listener:s,once:!0}),this}emitted(a){return new Promise((s,i)=>{pe(this,ln,!0),a!=="error"&&this.once("error",i),this.once(a,s)})}async done(){pe(this,ln,!0),await Q(this,yr,"f")}get currentMessage(){return Q(this,Za,"f")}async finalMessage(){return await this.done(),Q(this,Ht,"m",cu).call(this)}async finalText(){return await this.done(),Q(this,Ht,"m",Th).call(this)}_emit(a,...s){if(Q(this,Nr,"f"))return;a==="end"&&(pe(this,Nr,!0),Q(this,tl,"f").call(this));const i=Q(this,Sa,"f")[a];if(i&&(Q(this,Sa,"f")[a]=i.filter(c=>!c.once),i.forEach(({listener:c})=>c(...s))),a==="abort"){const c=s[0];!Q(this,ln,"f")&&!(i!=null&&i.length)&&Promise.reject(c),Q(this,br,"f").call(this,c),Q(this,vr,"f").call(this,c),this._emit("end");return}if(a==="error"){const c=s[0];!Q(this,ln,"f")&&!(i!=null&&i.length)&&Promise.reject(c),Q(this,br,"f").call(this,c),Q(this,vr,"f").call(this,c),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",Q(this,Ht,"m",cu).call(this))}async _fromReadableStream(a,s){var u;const i=s==null?void 0:s.signal;let c;i&&(i.aborted&&this.controller.abort(),c=this.controller.abort.bind(this.controller),i.addEventListener("abort",c));try{Q(this,Ht,"m",ou).call(this),this._connected(null);const m=ia.fromReadableStream(a,this.controller);for await(const h of m)Q(this,Ht,"m",uu).call(this,h);if((u=m.controller.signal)!=null&&u.aborted)throw new Jt;Q(this,Ht,"m",du).call(this)}finally{i&&c&&i.removeEventListener("abort",c)}}[(Za=new WeakMap,pr=new WeakMap,el=new WeakMap,br=new WeakMap,yr=new WeakMap,tl=new WeakMap,vr=new WeakMap,Sa=new WeakMap,Nr=new WeakMap,al=new WeakMap,sl=new WeakMap,ln=new WeakMap,nl=new WeakMap,rl=new WeakMap,il=new WeakMap,Ht=new WeakSet,cu=function(){if(this.receivedMessages.length===0)throw new Se("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},Th=function(){if(this.receivedMessages.length===0)throw new Se("stream ended without producing a Message with role=assistant");const s=this.receivedMessages.at(-1).content.filter(i=>i.type==="text").map(i=>i.text);if(s.length===0)throw new Se("stream ended without producing a content block with type=text");return s.join(" ")},ou=function(){this.ended||pe(this,Za,void 0)},uu=function(s){if(this.ended)return;const i=Q(this,Ht,"m",_h).call(this,s);switch(this._emit("streamEvent",s,i),s.type){case"content_block_delta":{const c=i.content.at(-1);switch(s.delta.type){case"text_delta":{c.type==="text"&&this._emit("text",s.delta.text,c.text||"");break}case"citations_delta":{c.type==="text"&&this._emit("citation",s.delta.citation,c.citations??[]);break}case"input_json_delta":{Ih(c)&&c.input&&this._emit("inputJson",s.delta.partial_json,c.input);break}case"thinking_delta":{c.type==="thinking"&&this._emit("thinking",s.delta.thinking,c.thinking);break}case"signature_delta":{c.type==="thinking"&&this._emit("signature",c.signature);break}default:s.delta}break}case"message_stop":{this._addMessageParam(i),this._addMessage(i,!0);break}case"content_block_stop":{this._emit("contentBlock",i.content.at(-1));break}case"message_start":{pe(this,Za,i);break}}},du=function(){if(this.ended)throw new Se("stream has ended, this shouldn't happen");const s=Q(this,Za,"f");if(!s)throw new Se("request ended without sending any chunks");return pe(this,Za,void 0),s},_h=function(s){let i=Q(this,Za,"f");if(s.type==="message_start"){if(i)throw new Se(`Unexpected event order, got ${s.type} before receiving "message_stop"`);return s.message}if(!i)throw new Se(`Unexpected event order, got ${s.type} before "message_start"`);switch(s.type){case"message_stop":return i;case"message_delta":return i.container=s.delta.container,i.stop_reason=s.delta.stop_reason,i.stop_sequence=s.delta.stop_sequence,i.usage.output_tokens=s.usage.output_tokens,s.usage.input_tokens!=null&&(i.usage.input_tokens=s.usage.input_tokens),s.usage.cache_creation_input_tokens!=null&&(i.usage.cache_creation_input_tokens=s.usage.cache_creation_input_tokens),s.usage.cache_read_input_tokens!=null&&(i.usage.cache_read_input_tokens=s.usage.cache_read_input_tokens),s.usage.server_tool_use!=null&&(i.usage.server_tool_use=s.usage.server_tool_use),i;case"content_block_start":return i.content.push(s.content_block),i;case"content_block_delta":{const c=i.content.at(s.index);switch(s.delta.type){case"text_delta":{(c==null?void 0:c.type)==="text"&&(i.content[s.index]={...c,text:(c.text||"")+s.delta.text});break}case"citations_delta":{(c==null?void 0:c.type)==="text"&&(i.content[s.index]={...c,citations:[...c.citations??[],s.delta.citation]});break}case"input_json_delta":{if(c&&Ih(c)){let u=c[Mh]||"";u+=s.delta.partial_json;const m={...c};if(Object.defineProperty(m,Mh,{value:u,enumerable:!1,writable:!0}),u)try{m.input=Ng(u)}catch(h){const g=new Se(`Unable to parse tool parameter JSON from model. Please retry your request or adjust your prompt. Error: ${h}. JSON: ${u}`);Q(this,il,"f").call(this,g)}i.content[s.index]=m}break}case"thinking_delta":{(c==null?void 0:c.type)==="thinking"&&(i.content[s.index]={...c,thinking:c.thinking+s.delta.thinking});break}case"signature_delta":{(c==null?void 0:c.type)==="thinking"&&(i.content[s.index]={...c,signature:s.delta.signature});break}default:s.delta}return i}case"content_block_stop":return i}},Symbol.asyncIterator)](){const a=[],s=[];let i=!1;return this.on("streamEvent",c=>{const u=s.shift();u?u.resolve(c):a.push(c)}),this.on("end",()=>{i=!0;for(const c of s)c.resolve(void 0);s.length=0}),this.on("abort",c=>{i=!0;for(const u of s)u.reject(c);s.length=0}),this.on("error",c=>{i=!0;for(const u of s)u.reject(c);s.length=0}),{next:async()=>a.length?{value:a.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise((u,m)=>s.push({resolve:u,reject:m})).then(u=>u?{value:u,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ia(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}const Sg={"claude-opus-4-20250514":8192,"claude-opus-4-0":8192,"claude-4-opus-20250514":8192,"anthropic.claude-opus-4-20250514-v1:0":8192,"claude-opus-4@20250514":8192},Oh={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};let Ou=class extends Ea{constructor(){super(...arguments),this.batches=new vg(this._client)}create(a,s){const{betas:i,...c}=a;c.model in Oh&&console.warn(`The model '${c.model}' is deprecated and will reach end-of-life on ${Oh[c.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let u=this._client._options.timeout;if(!c.stream&&u==null){const m=Sg[c.model]??void 0;u=this._client.calculateNonstreamingTimeout(c.max_tokens,m)}return this._client.post("/v1/messages?beta=true",{body:c,timeout:u??6e5,...s,headers:Be([{...(i==null?void 0:i.toString())!=null?{"anthropic-beta":i==null?void 0:i.toString()}:void 0},s==null?void 0:s.headers]),stream:a.stream??!1})}stream(a,s){return yl.createMessage(this,a,s)}countTokens(a,s){const{betas:i,...c}=a;return this._client.post("/v1/messages/count_tokens?beta=true",{body:c,...s,headers:Be([{"anthropic-beta":[...i??[],"token-counting-2024-11-01"].toString()},s==null?void 0:s.headers])})}};Ou.Batches=vg;class Ur extends Ea{constructor(){super(...arguments),this.models=new yg(this._client),this.messages=new Ou(this._client),this.files=new bg(this._client)}}Ur.Models=yg;Ur.Messages=Ou;Ur.Files=bg;class wg extends Ea{create(a,s){const{betas:i,...c}=a;return this._client.post("/v1/complete",{body:c,timeout:this._client._options.timeout??6e5,...s,headers:Be([{...(i==null?void 0:i.toString())!=null?{"anthropic-beta":i==null?void 0:i.toString()}:void 0},s==null?void 0:s.headers]),stream:a.stream??!1})}}var Yt,Qa,Sr,ll,wr,Er,cl,jr,wa,Dr,ol,ul,cn,dl,fl,fu,Vh,mu,hu,gu,xu,Uh;const Lh="__json_buf";function kh(f){return f.type==="tool_use"||f.type==="server_tool_use"}class vl{constructor(){Yt.add(this),this.messages=[],this.receivedMessages=[],Qa.set(this,void 0),this.controller=new AbortController,Sr.set(this,void 0),ll.set(this,()=>{}),wr.set(this,()=>{}),Er.set(this,void 0),cl.set(this,()=>{}),jr.set(this,()=>{}),wa.set(this,{}),Dr.set(this,!1),ol.set(this,!1),ul.set(this,!1),cn.set(this,!1),dl.set(this,void 0),fl.set(this,void 0),mu.set(this,a=>{if(pe(this,ol,!0),Ir(a)&&(a=new Jt),a instanceof Jt)return pe(this,ul,!0),this._emit("abort",a);if(a instanceof Se)return this._emit("error",a);if(a instanceof Error){const s=new Se(a.message);return s.cause=a,this._emit("error",s)}return this._emit("error",new Se(String(a)))}),pe(this,Sr,new Promise((a,s)=>{pe(this,ll,a,"f"),pe(this,wr,s,"f")})),pe(this,Er,new Promise((a,s)=>{pe(this,cl,a,"f"),pe(this,jr,s,"f")})),Q(this,Sr,"f").catch(()=>{}),Q(this,Er,"f").catch(()=>{})}get response(){return Q(this,dl,"f")}get request_id(){return Q(this,fl,"f")}async withResponse(){const a=await Q(this,Sr,"f");if(!a)throw new Error("Could not resolve a `Response` object");return{data:this,response:a,request_id:a.headers.get("request-id")}}static fromReadableStream(a){const s=new vl;return s._run(()=>s._fromReadableStream(a)),s}static createMessage(a,s,i){const c=new vl;for(const u of s.messages)c._addMessageParam(u);return c._run(()=>c._createMessage(a,{...s,stream:!0},{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),c}_run(a){a().then(()=>{this._emitFinal(),this._emit("end")},Q(this,mu,"f"))}_addMessageParam(a){this.messages.push(a)}_addMessage(a,s=!0){this.receivedMessages.push(a),s&&this._emit("message",a)}async _createMessage(a,s,i){var m;const c=i==null?void 0:i.signal;let u;c&&(c.aborted&&this.controller.abort(),u=this.controller.abort.bind(this.controller),c.addEventListener("abort",u));try{Q(this,Yt,"m",hu).call(this);const{response:h,data:g}=await a.create({...s,stream:!0},{...i,signal:this.controller.signal}).withResponse();this._connected(h);for await(const x of g)Q(this,Yt,"m",gu).call(this,x);if((m=g.controller.signal)!=null&&m.aborted)throw new Jt;Q(this,Yt,"m",xu).call(this)}finally{c&&u&&c.removeEventListener("abort",u)}}_connected(a){this.ended||(pe(this,dl,a),pe(this,fl,a==null?void 0:a.headers.get("request-id")),Q(this,ll,"f").call(this,a),this._emit("connect"))}get ended(){return Q(this,Dr,"f")}get errored(){return Q(this,ol,"f")}get aborted(){return Q(this,ul,"f")}abort(){this.controller.abort()}on(a,s){return(Q(this,wa,"f")[a]||(Q(this,wa,"f")[a]=[])).push({listener:s}),this}off(a,s){const i=Q(this,wa,"f")[a];if(!i)return this;const c=i.findIndex(u=>u.listener===s);return c>=0&&i.splice(c,1),this}once(a,s){return(Q(this,wa,"f")[a]||(Q(this,wa,"f")[a]=[])).push({listener:s,once:!0}),this}emitted(a){return new Promise((s,i)=>{pe(this,cn,!0),a!=="error"&&this.once("error",i),this.once(a,s)})}async done(){pe(this,cn,!0),await Q(this,Er,"f")}get currentMessage(){return Q(this,Qa,"f")}async finalMessage(){return await this.done(),Q(this,Yt,"m",fu).call(this)}async finalText(){return await this.done(),Q(this,Yt,"m",Vh).call(this)}_emit(a,...s){if(Q(this,Dr,"f"))return;a==="end"&&(pe(this,Dr,!0),Q(this,cl,"f").call(this));const i=Q(this,wa,"f")[a];if(i&&(Q(this,wa,"f")[a]=i.filter(c=>!c.once),i.forEach(({listener:c})=>c(...s))),a==="abort"){const c=s[0];!Q(this,cn,"f")&&!(i!=null&&i.length)&&Promise.reject(c),Q(this,wr,"f").call(this,c),Q(this,jr,"f").call(this,c),this._emit("end");return}if(a==="error"){const c=s[0];!Q(this,cn,"f")&&!(i!=null&&i.length)&&Promise.reject(c),Q(this,wr,"f").call(this,c),Q(this,jr,"f").call(this,c),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",Q(this,Yt,"m",fu).call(this))}async _fromReadableStream(a,s){var u;const i=s==null?void 0:s.signal;let c;i&&(i.aborted&&this.controller.abort(),c=this.controller.abort.bind(this.controller),i.addEventListener("abort",c));try{Q(this,Yt,"m",hu).call(this),this._connected(null);const m=ia.fromReadableStream(a,this.controller);for await(const h of m)Q(this,Yt,"m",gu).call(this,h);if((u=m.controller.signal)!=null&&u.aborted)throw new Jt;Q(this,Yt,"m",xu).call(this)}finally{i&&c&&i.removeEventListener("abort",c)}}[(Qa=new WeakMap,Sr=new WeakMap,ll=new WeakMap,wr=new WeakMap,Er=new WeakMap,cl=new WeakMap,jr=new WeakMap,wa=new WeakMap,Dr=new WeakMap,ol=new WeakMap,ul=new WeakMap,cn=new WeakMap,dl=new WeakMap,fl=new WeakMap,mu=new WeakMap,Yt=new WeakSet,fu=function(){if(this.receivedMessages.length===0)throw new Se("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},Vh=function(){if(this.receivedMessages.length===0)throw new Se("stream ended without producing a Message with role=assistant");const s=this.receivedMessages.at(-1).content.filter(i=>i.type==="text").map(i=>i.text);if(s.length===0)throw new Se("stream ended without producing a content block with type=text");return s.join(" ")},hu=function(){this.ended||pe(this,Qa,void 0)},gu=function(s){if(this.ended)return;const i=Q(this,Yt,"m",Uh).call(this,s);switch(this._emit("streamEvent",s,i),s.type){case"content_block_delta":{const c=i.content.at(-1);switch(s.delta.type){case"text_delta":{c.type==="text"&&this._emit("text",s.delta.text,c.text||"");break}case"citations_delta":{c.type==="text"&&this._emit("citation",s.delta.citation,c.citations??[]);break}case"input_json_delta":{kh(c)&&c.input&&this._emit("inputJson",s.delta.partial_json,c.input);break}case"thinking_delta":{c.type==="thinking"&&this._emit("thinking",s.delta.thinking,c.thinking);break}case"signature_delta":{c.type==="thinking"&&this._emit("signature",c.signature);break}default:s.delta}break}case"message_stop":{this._addMessageParam(i),this._addMessage(i,!0);break}case"content_block_stop":{this._emit("contentBlock",i.content.at(-1));break}case"message_start":{pe(this,Qa,i);break}}},xu=function(){if(this.ended)throw new Se("stream has ended, this shouldn't happen");const s=Q(this,Qa,"f");if(!s)throw new Se("request ended without sending any chunks");return pe(this,Qa,void 0),s},Uh=function(s){let i=Q(this,Qa,"f");if(s.type==="message_start"){if(i)throw new Se(`Unexpected event order, got ${s.type} before receiving "message_stop"`);return s.message}if(!i)throw new Se(`Unexpected event order, got ${s.type} before "message_start"`);switch(s.type){case"message_stop":return i;case"message_delta":return i.stop_reason=s.delta.stop_reason,i.stop_sequence=s.delta.stop_sequence,i.usage.output_tokens=s.usage.output_tokens,s.usage.input_tokens!=null&&(i.usage.input_tokens=s.usage.input_tokens),s.usage.cache_creation_input_tokens!=null&&(i.usage.cache_creation_input_tokens=s.usage.cache_creation_input_tokens),s.usage.cache_read_input_tokens!=null&&(i.usage.cache_read_input_tokens=s.usage.cache_read_input_tokens),s.usage.server_tool_use!=null&&(i.usage.server_tool_use=s.usage.server_tool_use),i;case"content_block_start":return i.content.push({...s.content_block}),i;case"content_block_delta":{const c=i.content.at(s.index);switch(s.delta.type){case"text_delta":{(c==null?void 0:c.type)==="text"&&(i.content[s.index]={...c,text:(c.text||"")+s.delta.text});break}case"citations_delta":{(c==null?void 0:c.type)==="text"&&(i.content[s.index]={...c,citations:[...c.citations??[],s.delta.citation]});break}case"input_json_delta":{if(c&&kh(c)){let u=c[Lh]||"";u+=s.delta.partial_json;const m={...c};Object.defineProperty(m,Lh,{value:u,enumerable:!1,writable:!0}),u&&(m.input=Ng(u)),i.content[s.index]=m}break}case"thinking_delta":{(c==null?void 0:c.type)==="thinking"&&(i.content[s.index]={...c,thinking:c.thinking+s.delta.thinking});break}case"signature_delta":{(c==null?void 0:c.type)==="thinking"&&(i.content[s.index]={...c,signature:s.delta.signature});break}default:s.delta}return i}case"content_block_stop":return i}},Symbol.asyncIterator)](){const a=[],s=[];let i=!1;return this.on("streamEvent",c=>{const u=s.shift();u?u.resolve(c):a.push(c)}),this.on("end",()=>{i=!0;for(const c of s)c.resolve(void 0);s.length=0}),this.on("abort",c=>{i=!0;for(const u of s)u.reject(c);s.length=0}),this.on("error",c=>{i=!0;for(const u of s)u.reject(c);s.length=0}),{next:async()=>a.length?{value:a.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise((u,m)=>s.push({resolve:u,reject:m})).then(u=>u?{value:u,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ia(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class Eg extends Ea{create(a,s){return this._client.post("/v1/messages/batches",{body:a,...s})}retrieve(a,s){return this._client.get(Wt`/v1/messages/batches/${a}`,s)}list(a={},s){return this._client.getAPIList("/v1/messages/batches",Vr,{query:a,...s})}delete(a,s){return this._client.delete(Wt`/v1/messages/batches/${a}`,s)}cancel(a,s){return this._client.post(Wt`/v1/messages/batches/${a}/cancel`,s)}async results(a,s){const i=await this.retrieve(a);if(!i.results_url)throw new Se(`No batch \`results_url\`; Has it finished processing? ${i.processing_status} - ${i.id}`);return this._client.get(i.results_url,{...s,headers:Be([{Accept:"application/binary"},s==null?void 0:s.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((c,u)=>wl.fromResponse(u.response,u.controller))}}class Vu extends Ea{constructor(){super(...arguments),this.batches=new Eg(this._client)}create(a,s){a.model in $h&&console.warn(`The model '${a.model}' is deprecated and will reach end-of-life on ${$h[a.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let i=this._client._options.timeout;if(!a.stream&&i==null){const c=Sg[a.model]??void 0;i=this._client.calculateNonstreamingTimeout(a.max_tokens,c)}return this._client.post("/v1/messages",{body:a,timeout:i??6e5,...s,stream:a.stream??!1})}stream(a,s){return vl.createMessage(this,a,s)}countTokens(a,s){return this._client.post("/v1/messages/count_tokens",{body:a,...s})}}const $h={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};Vu.Batches=Eg;class jg extends Ea{retrieve(a,s={},i){const{betas:c}=s??{};return this._client.get(Wt`/v1/models/${a}`,{...i,headers:Be([{...(c==null?void 0:c.toString())!=null?{"anthropic-beta":c==null?void 0:c.toString()}:void 0},i==null?void 0:i.headers])})}list(a={},s){const{betas:i,...c}=a??{};return this._client.getAPIList("/v1/models",Vr,{query:c,...s,headers:Be([{...(i==null?void 0:i.toString())!=null?{"anthropic-beta":i==null?void 0:i.toString()}:void 0},s==null?void 0:s.headers])})}}var pu={};const ml=f=>{var a,s,i,c;if(typeof globalThis.process<"u")return((a=pu==null?void 0:pu[f])==null?void 0:a.trim())??void 0;if(typeof globalThis.Deno<"u")return(c=(i=(s=globalThis.Deno.env)==null?void 0:s.get)==null?void 0:i.call(s,f))==null?void 0:c.trim()};var Ru,Uu,pl,Dg;class Ze{constructor({baseURL:a=ml("ANTHROPIC_BASE_URL"),apiKey:s=ml("ANTHROPIC_API_KEY")??null,authToken:i=ml("ANTHROPIC_AUTH_TOKEN")??null,...c}={}){Ru.add(this),pl.set(this,void 0);const u={apiKey:s,authToken:i,...c,baseURL:a||"https://api.anthropic.com"};if(!u.dangerouslyAllowBrowser&&my())throw new Se(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Anthropic({ apiKey, dangerouslyAllowBrowser: true });
`);this.baseURL=u.baseURL,this.timeout=u.timeout??Uu.DEFAULT_TIMEOUT,this.logger=u.logger??console;const m="warn";this.logLevel=m,this.logLevel=Dh(u.logLevel,"ClientOptions.logLevel",this)??Dh(ml("ANTHROPIC_LOG"),"process.env['ANTHROPIC_LOG']",this)??m,this.fetchOptions=u.fetchOptions,this.maxRetries=u.maxRetries??2,this.fetch=u.fetch??by(),pe(this,pl,vy),this._options=u,this.apiKey=s,this.authToken=i}withOptions(a){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,authToken:this.authToken,...a})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:a,nulls:s}){if(!(this.apiKey&&a.get("x-api-key"))&&!s.has("x-api-key")&&!(this.authToken&&a.get("authorization"))&&!s.has("authorization"))throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}async authHeaders(a){return Be([await this.apiKeyAuth(a),await this.bearerAuth(a)])}async apiKeyAuth(a){if(this.apiKey!=null)return Be([{"X-Api-Key":this.apiKey}])}async bearerAuth(a){if(this.authToken!=null)return Be([{Authorization:`Bearer ${this.authToken}`}])}stringifyQuery(a){return Object.entries(a).filter(([s,i])=>typeof i<"u").map(([s,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(s)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(s)}=`;throw new Se(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${un}`}defaultIdempotencyKey(){return`stainless-node-retry-${Jh()}`}makeStatusError(a,s,i,c){return mt.generate(a,s,i,c)}buildURL(a,s,i){const c=!Q(this,Ru,"m",Dg).call(this)&&i||this.baseURL,u=cy(a)?new URL(a):new URL(c+(c.endsWith("/")&&a.startsWith("/")?a.slice(1):a)),m=this.defaultQuery();return oy(m)||(s={...m,...s}),typeof s=="object"&&s&&!Array.isArray(s)&&(u.search=this.stringifyQuery(s)),u.toString()}_calculateNonstreamingTimeout(a){if(3600*a/128e3>600)throw new Se("Streaming is strongly recommended for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#streaming-responses for more details");return 600*1e3}async prepareOptions(a){}async prepareRequest(a,{url:s,options:i}){}get(a,s){return this.methodRequest("get",a,s)}post(a,s){return this.methodRequest("post",a,s)}patch(a,s){return this.methodRequest("patch",a,s)}put(a,s){return this.methodRequest("put",a,s)}delete(a,s){return this.methodRequest("delete",a,s)}methodRequest(a,s,i){return this.request(Promise.resolve(i).then(c=>({method:a,path:s,...c})))}request(a,s=null){return new Sl(this,this.makeRequest(a,s,void 0))}async makeRequest(a,s,i){var X,C;const c=await a,u=c.maxRetries??this.maxRetries;s==null&&(s=u),await this.prepareOptions(c);const{req:m,url:h,timeout:g}=await this.buildRequest(c,{retryCount:u-s});await this.prepareRequest(m,{url:h,options:c});const x="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),y=i===void 0?"":`, retryOf: ${i}`,w=Date.now();if(gt(this).debug(`[${x}] sending request`,ys({retryOfRequestLogID:i,method:c.method,url:h,options:c,headers:m.headers})),(X=c.signal)!=null&&X.aborted)throw new Jt;const D=new AbortController,b=await this.fetchWithTimeout(h,m,g,D).catch(wu),v=Date.now();if(b instanceof Error){const W=`retrying, ${s} attempts remaining`;if((C=c.signal)!=null&&C.aborted)throw new Jt;const k=Ir(b)||/timed? ?out/i.test(String(b)+("cause"in b?String(b.cause):""));if(s)return gt(this).info(`[${x}] connection ${k?"timed out":"failed"} - ${W}`),gt(this).debug(`[${x}] connection ${k?"timed out":"failed"} (${W})`,ys({retryOfRequestLogID:i,url:h,durationMs:v-w,message:b.message})),this.retryRequest(c,s,i??x);throw gt(this).info(`[${x}] connection ${k?"timed out":"failed"} - error; no more retries left`),gt(this).debug(`[${x}] connection ${k?"timed out":"failed"} (error; no more retries left)`,ys({retryOfRequestLogID:i,url:h,durationMs:v-w,message:b.message})),k?new Wh:new Nl({cause:b})}const E=[...b.headers.entries()].filter(([W])=>W==="request-id").map(([W,k])=>", "+W+": "+JSON.stringify(k)).join(""),A=`[${x}${y}${E}] ${m.method} ${h} ${b.ok?"succeeded":"failed"} with status ${b.status} in ${v-w}ms`;if(!b.ok){const W=await this.shouldRetry(b);if(s&&W){const te=`retrying, ${s} attempts remaining`;return await yy(b.body),gt(this).info(`${A} - ${te}`),gt(this).debug(`[${x}] response error (${te})`,ys({retryOfRequestLogID:i,url:b.url,status:b.status,headers:b.headers,durationMs:v-w})),this.retryRequest(c,s,i??x,b.headers)}const k=W?"error; no more retries left":"error; not retryable";gt(this).info(`${A} - ${k}`);const Z=await b.text().catch(te=>wu(te).message),le=cg(Z),q=le?void 0:Z;throw gt(this).debug(`[${x}] response error (${k})`,ys({retryOfRequestLogID:i,url:b.url,status:b.status,headers:b.headers,message:q,durationMs:Date.now()-w})),this.makeStatusError(b.status,le,q,b.headers)}return gt(this).info(A),gt(this).debug(`[${x}] response start`,ys({retryOfRequestLogID:i,url:b.url,status:b.status,headers:b.headers,durationMs:v-w})),{response:b,options:c,controller:D,requestLogID:x,retryOfRequestLogID:i,startTime:w}}getAPIList(a,s,i){return this.requestAPIList(s,{method:"get",path:a,...i})}requestAPIList(a,s){const i=this.makeRequest(s,null,void 0);return new Ty(this,i,a)}async fetchWithTimeout(a,s,i,c){const{signal:u,method:m,...h}=s||{};u&&u.addEventListener("abort",()=>c.abort());const g=setTimeout(()=>c.abort(),i),x=globalThis.ReadableStream&&h.body instanceof globalThis.ReadableStream||typeof h.body=="object"&&h.body!==null&&Symbol.asyncIterator in h.body,y={signal:c.signal,...x?{duplex:"half"}:{},method:"GET",...h};m&&(y.method=m.toUpperCase());try{return await this.fetch.call(void 0,a,y)}finally{clearTimeout(g)}}async shouldRetry(a){const s=a.headers.get("x-should-retry");return s==="true"?!0:s==="false"?!1:a.status===408||a.status===409||a.status===429||a.status>=500}async retryRequest(a,s,i,c){let u;const m=c==null?void 0:c.get("retry-after-ms");if(m){const g=parseFloat(m);Number.isNaN(g)||(u=g)}const h=c==null?void 0:c.get("retry-after");if(h&&!u){const g=parseFloat(h);Number.isNaN(g)?u=Date.parse(h)-Date.now():u=g*1e3}if(!(u&&0<=u&&u<60*1e3)){const g=a.maxRetries??this.maxRetries;u=this.calculateDefaultRetryTimeoutMillis(s,g)}return await fy(u),this.makeRequest(a,s-1,i)}calculateDefaultRetryTimeoutMillis(a,s){const u=s-a,m=Math.min(.5*Math.pow(2,u),8),h=1-Math.random()*.25;return m*h*1e3}calculateNonstreamingTimeout(a,s){if(36e5*a/128e3>6e5||s!=null&&a>s)throw new Se("Streaming is strongly recommended for operations that may token longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#long-requests for more details");return 6e5}async buildRequest(a,{retryCount:s=0}={}){const i={...a},{method:c,path:u,query:m,defaultBaseURL:h}=i,g=this.buildURL(u,m,h);"timeout"in i&&dy("timeout",i.timeout),i.timeout=i.timeout??this.timeout;const{bodyHeaders:x,body:y}=this.buildBody({options:i}),w=await this.buildHeaders({options:a,method:c,bodyHeaders:x,retryCount:s});return{req:{method:c,headers:w,...i.signal&&{signal:i.signal},...globalThis.ReadableStream&&y instanceof globalThis.ReadableStream&&{duplex:"half"},...y&&{body:y},...this.fetchOptions??{},...i.fetchOptions??{}},url:g,timeout:i.timeout}}async buildHeaders({options:a,method:s,bodyHeaders:i,retryCount:c}){let u={};this.idempotencyHeader&&s!=="get"&&(a.idempotencyKey||(a.idempotencyKey=this.defaultIdempotencyKey()),u[this.idempotencyHeader]=a.idempotencyKey);const m=Be([u,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(c),...a.timeout?{"X-Stainless-Timeout":String(Math.trunc(a.timeout/1e3))}:{},...py(),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01"},await this.authHeaders(a),this._options.defaultHeaders,i,a.headers]);return this.validateHeaders(m),m.values}buildBody({options:{body:a,headers:s}}){if(!a)return{bodyHeaders:void 0,body:void 0};const i=Be([s]);return ArrayBuffer.isView(a)||a instanceof ArrayBuffer||a instanceof DataView||typeof a=="string"&&i.values.has("content-type")||a instanceof Blob||a instanceof FormData||a instanceof URLSearchParams||globalThis.ReadableStream&&a instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:a}:typeof a=="object"&&(Symbol.asyncIterator in a||Symbol.iterator in a&&"next"in a&&typeof a.next=="function")?{bodyHeaders:void 0,body:ug(a)}:Q(this,pl,"f").call(this,{body:a,headers:i})}}Uu=Ze,pl=new WeakMap,Ru=new WeakSet,Dg=function(){return this.baseURL!=="https://api.anthropic.com"};Ze.Anthropic=Uu;Ze.HUMAN_PROMPT=`

Human:`;Ze.AI_PROMPT=`

Assistant:`;Ze.DEFAULT_TIMEOUT=6e5;Ze.AnthropicError=Se;Ze.APIError=mt;Ze.APIConnectionError=Nl;Ze.APIConnectionTimeoutError=Wh;Ze.APIUserAbortError=Jt;Ze.NotFoundError=sg;Ze.ConflictError=ng;Ze.RateLimitError=ig;Ze.BadRequestError=eg;Ze.AuthenticationError=tg;Ze.InternalServerError=lg;Ze.PermissionDeniedError=ag;Ze.UnprocessableEntityError=rg;Ze.toFile=Ly;class hn extends Ze{constructor(){super(...arguments),this.completions=new wg(this),this.messages=new Vu(this),this.models=new jg(this),this.beta=new Ur(this)}}hn.Completions=wg;hn.Messages=Vu;hn.Models=jg;hn.Beta=Ur;const{HUMAN_PROMPT:Vv,AI_PROMPT:Uv}=hn;var bu={exports:{}};const qy=Qp(db);var yu,Fh;function Hy(){if(Fh)return yu;Fh=1;var f=null;function a(c){let u={normalizeWhitespace:!1,disableCombineTextItems:!1};return c.getTextContent(u).then(function(m){let h,g="";for(let x of m.items)h==x.transform[5]||!h?g+=x.str:g+=`
`+x.str,h=x.transform[5];return g})}const s={pagerender:a,max:0,version:"v1.10.100"};async function i(c,u){let m={numpages:0,numrender:0,info:null,metadata:null,text:"",version:null};typeof u>"u"&&(u=s),typeof u.pagerender!="function"&&(u.pagerender=s.pagerender),typeof u.max!="number"&&(u.max=s.max),typeof u.version!="string"&&(u.version=s.version),u.version=="default"&&(u.version=s.version),f=f||Kh(`./pdf.js/${u.version}/build/pdf.js`),m.version=f.version,f.disableWorker=!0;let h=await f.getDocument(c);m.numpages=h.numPages;let g=await h.getMetadata().catch(function(w){return null});m.info=g?g.info:null,m.metadata=g?g.metadata:null;let x=u.max<=0?h.numPages:u.max;x=x>h.numPages?h.numPages:x,m.text="";for(var y=1;y<=x;y++){let w=await h.getPage(y).then(D=>u.pagerender(D)).catch(D=>{debugger;return""});m.text=`${m.text}

${w}`}return m.numrender=x,h.destroy(),m}return yu=i,yu}var Bh;function Yy(){return Bh||(Bh=1,function(f){const a=qy,s=Hy();if(f.exports=s,!f.parent){let c="./test/data/05-versions-space.pdf",u=a.readFileSync(c);s(u).then(function(m){a.writeFileSync(`${c}.txt`,m.text,{encoding:"utf8",flag:"w"});debugger}).catch(function(m){debugger})}}(bu)),bu.exports}var Gy=Yy();const Xy=Au(Gy);var Ky={};class Zy{constructor(){ce(this,"anthropic");ce(this,"isInitialized",!1);const a=Ky.ANTHROPIC_API_KEY||void 0;if(!a){console.warn("Claude API key not found. Document processing will be limited.");return}this.anthropic=new hn({apiKey:a}),this.isInitialized=!0}async processDocument(a,s={}){const i=Date.now();try{if(!this.isInitialized)throw new Error("Claude Vision processor not initialized. Check API key.");if(!this.anthropic)throw new Error("Claude API client not initialized.");let c,u;if(a.type==="application/pdf"){const m=await a.arrayBuffer(),h=Buffer.from(m),g=await Xy(h);return u="text/plain",c=Buffer.from(g.text).toString("base64"),await this.processTextDocument(g.text,s,i)}else if(a.type.startsWith("image/")){u=a.type;const m=await a.arrayBuffer();return c=Buffer.from(m).toString("base64"),await this.processImageDocument(c,u,s,i)}else throw new Error(`Unsupported file type: ${a.type}`)}catch(c){return console.error("Claude Vision processing error:",c),{success:!1,error:c instanceof Error?c.message:"Unknown processing error",processingTime:Date.now()-i}}}async processImageDocument(a,s,i,c){var m;const u=this.buildExtractionPrompt(i.expectedDocumentType);try{const h=await this.anthropic.messages.create({model:"claude-3-5-sonnet-20241022",max_tokens:2e3,messages:[{role:"user",content:[{type:"image",source:{type:"base64",media_type:s,data:a}},{type:"text",text:u}]}]}),g=((m=h.content[0])==null?void 0:m.type)==="text"?h.content[0].text:"";return{success:!0,data:this.parseClaudeResponse(g),processingTime:Date.now()-c}}catch(h){return console.error("Claude API error:",h),{success:!1,error:h instanceof Error?h.message:"Claude API error",processingTime:Date.now()-c}}}async processTextDocument(a,s,i){var u;const c=this.buildTextExtractionPrompt(a,s.expectedDocumentType);try{const m=await this.anthropic.messages.create({model:"claude-3-5-sonnet-20241022",max_tokens:2e3,messages:[{role:"user",content:c}]}),h=((u=m.content[0])==null?void 0:u.type)==="text"?m.content[0].text:"";return{success:!0,data:this.parseClaudeResponse(h),processingTime:Date.now()-i}}catch(m){return console.error("Claude API error:",m),{success:!1,error:m instanceof Error?m.message:"Claude API error",processingTime:Date.now()-i}}}buildExtractionPrompt(a){return`You are an expert document processor specializing in commercial trucking compliance documents with advanced noise filtering and OCR error correction.

CRITICAL MISSION: Extract ONLY compliance-relevant data while filtering noise and correcting OCR errors to minimize manual review.

 DOCUMENT NOISE FILTERING - IGNORE:
- Headers/footers with page numbers, watermarks, logos
- Navigation elements, form instructions, disclaimers  
- Boilerplate text like "For office use only", "Do not write below this line"
- Repeated legal text, terms and conditions, privacy notices
- Barcode data, QR codes, reference numbers unless they're document IDs
- Form field labels that don't contain actual data
- Administrative stamps that don't affect compliance status

 OCR ERROR CORRECTION - APPLY:
- Common character substitutions: 0O, 1Il, 5S, 8B, 6G
- Fix "rn"  "m", "vv"  "w", "cl"  "d" patterns
- Correct space insertions in VINs, license plates, policy numbers
- Fix date format corruptions (slashes, dots, spaces)
- Repair partial words in vehicle makes/models using context

 FOCUS ONLY ON COMPLIANCE DATA:
- Vehicle identification (VIN, license plate, make/model/year)
- Driver information (name, license number, endorsements)
- Document dates (issue, expiration, effective dates)
- Insurance details (policy number, company, coverage amounts)
- Medical certificate information
- Registration details and authority information
- DOT numbers and permit information

Analyze this document image and extract all relevant information. The document could be:
- Vehicle registration
- Commercial insurance policy  
- DOT medical certificate
- CDL (Commercial Driver's License)
- DOT inspection report
- Operating permit
- Or any other trucking-related document

${a?`The user expects this to be a ${a} document.`:""}

Return your analysis as a JSON object with this EXACT structure:
{
  "documentType": "registration|insurance|medical_certificate|cdl_license|inspection|permit|unknown",
  "confidence": 0.95,
  "extractedData": {
    "vin": "string",
    "licensePlate": "string", 
    "make": "string",
    "model": "string",
    "year": "string",
    "driverName": "string",
    "licenseNumber": "string",
    "licenseClass": "string",
    "endorsements": ["array", "of", "strings"],
    "issueDate": "YYYY-MM-DD",
    "expirationDate": "YYYY-MM-DD", 
    "effectiveDate": "YYYY-MM-DD",
    "policyNumber": "string",
    "insuranceCompany": "string",
    "coverageAmount": "string",
    "medicalExaminerName": "string",
    "medicalCertificateNumber": "string",
    "restrictions": ["array", "of", "restrictions"],
    "registrationNumber": "string",
    "state": "string",
    "ownerName": "string",
    "documentNumber": "string",
    "authority": "string",
    "status": "string"
  },
  "fieldConfidence": {
    "vin": 0.95,
    "expirationDate": 0.90,
    "licensePlate": 0.85
  },
  "dataQuality": {
    "isComplete": true,
    "missingCriticalFields": ["vin", "expirationDate"],
    "invalidFields": [
      {"field": "vin", "issue": "Too short (12 chars, need 17)"},
      {"field": "year", "issue": "Year 2030 is unrealistic"}
    ],
    "qualityScore": 0.85
  },
  "conflicts": {
    "hasConflicts": false,
    "conflictDetails": [
      {
        "field": "expirationDate", 
        "values": ["2024-12-31", "2025-01-15"],
        "recommendation": "Use 2025-01-15 (clearer text, higher confidence)"
      }
    ]
  },
  "validationResults": {
    "vinValid": true,
    "datesRealistic": true,
    "documentsExpired": false,
    "requiresImmediateAction": false
  },
  "processingNotes": ["Document quality excellent", "All critical fields present"],
  "requiresReview": false,
  "autoApprovalRecommended": true
}

 COMPLIANCE-FOCUSED EXTRACTION RULES:
1. **VIN Validation**: Must be exactly 17 characters, alphanumeric (no I, O, Q)
2. **Date Validation**: 
   - Issue dates should be in the past
   - Expiry dates should be future but realistic (not >10 years out)
   - Flag dates before 2020 or after 2030 as suspicious
3. **Data Completeness**:
   - Registration MUST have: VIN, licensePlate, expirationDate, state
   - Insurance MUST have: VIN or licensePlate, policyNumber, expirationDate, coverageAmount
   - CDL MUST have: driverName, licenseNumber, expirationDate, state, licenseClass
   - Medical MUST have: driverName, expirationDate, medicalCertificateNumber

 PRIORITIZED FIELD EXTRACTION (extract in order of importance):
**CRITICAL FIELDS (always extract):**
- VIN numbers (17 characters, check for spaces/OCR errors)
- License plates (state format validation)
- Expiration dates (MM/DD/YYYY, MM-DD-YYYY, Month DD, YYYY)
- Driver names (First Last format for CDL/Medical docs)
- Policy numbers (alphanumeric, often with hyphens)

**HIGH PRIORITY (extract if clearly visible):**
- Issue dates, effective dates
- Vehicle make/model/year (validate against known commercial brands)
- Insurance company names, coverage amounts
- State codes (2-letter abbreviations)
- DOT numbers, Medical examiner information

**MEDIUM PRIORITY (extract if confident):**
- License classes, endorsements, restrictions
- Registration numbers, owner names
- Document numbers, authority information

 CONFLICT DETECTION:
- Multiple values for same field in document (choose most confident)
- Contradictory information (flag for review)
- Cross-field validation failures (VIN format vs year mismatch)

 SMART AUTO-APPROVAL CRITERIA:
- Overall confidence > 90%
- No missing critical fields
- No validation failures  
- Document quality score > 80%
- No significant conflicts detected
 Set autoApprovalRecommended: true

 REQUIRE REVIEW IF:
- Confidence < 80%
- Missing critical fields
- Invalid VIN format
- Expired documents (unless insurance renewal)
- Conflicting data within document
- Poor image quality affecting extraction
 Set requiresReview: true, autoApprovalRecommended: false

 FIELD CONFIDENCE SCORING:
Rate each extracted field 0.0-1.0 based on:
- Text clarity in image/document
- Data validation success (format, realistic values)
- Cross-field consistency (dates align, VIN matches year)
- Format correctness (proper patterns for field type)
- Context validation (field appears in appropriate section)

Only include fields actually present in document. Use null for missing fields.`}buildTextExtractionPrompt(a,s){return`You are an expert document processor specializing in commercial trucking compliance documents with advanced noise filtering and OCR error correction.

CRITICAL MISSION: Extract ONLY compliance-relevant data while filtering noise and correcting OCR errors to minimize manual review.

 DOCUMENT NOISE FILTERING - IGNORE:
- Headers/footers with page numbers, watermarks, company logos
- Navigation elements, form instructions, legal disclaimers  
- Boilerplate text like "For office use only", "Do not write below this line"
- Repeated legal text, terms and conditions, privacy notices
- Barcode data, QR codes, reference numbers unless they're document IDs
- Form field labels that don't contain actual data
- Administrative stamps that don't affect compliance status

 OCR ERROR CORRECTION - APPLY:
- Common character substitutions: 0O, 1Il, 5S, 8B, 6G
- Fix "rn"  "m", "vv"  "w", "cl"  "d" patterns
- Correct space insertions in VINs, license plates, policy numbers
- Fix date format corruptions (slashes, dots, spaces)
- Repair partial words in vehicle makes/models using context

 FOCUS ONLY ON COMPLIANCE DATA:
- Vehicle identification (VIN, license plate, make/model/year)
- Driver information (name, license number, endorsements)
- Document dates (issue, expiration, effective dates)
- Insurance details (policy number, company, coverage amounts)
- Medical certificate information
- Registration details and authority information
- DOT numbers and permit information

Analyze this cleaned document text and extract all relevant information:

CLEANED DOCUMENT TEXT:
${this.preprocessDocumentText(a)}

${s?`The user expects this to be a ${s} document.`:""}

Return your analysis as a JSON object with the EXACT same structure as the image processing prompt, including:
- Enhanced fieldConfidence scoring
- dataQuality assessment  
- conflicts detection
- validationResults
- autoApprovalRecommended flag

Apply the same ENHANCED VALIDATION RULES:
1. **VIN Validation**: Must be exactly 17 characters, alphanumeric (no I, O, Q)
2. **Date Validation**: Realistic date ranges, proper formatting
3. **Data Completeness**: All critical fields for document type
4. **Conflict Detection**: Multiple values, contradictory info
5. **Smart Auto-Approval**: High confidence + complete + valid data

Focus on:
- Identifying the document type accurately with confidence scoring
- Extracting all compliance-relevant dates with validation
- Finding vehicle and driver identification with format checking
- Detecting any internal conflicts or inconsistencies
- Providing field-level confidence for each extracted value
- Recommending auto-approval only for high-quality, complete documents`}parseClaudeResponse(a){var s,i;try{const c=a.match(/\{[\s\S]*\}/);if(!c)throw new Error("No JSON found in response");const u=JSON.parse(c[0]),m=this.validateAndScoreExtractedData(u);return{documentType:u.documentType||"unknown",confidence:m.adjustedConfidence,extractedData:m.validatedData,fieldConfidence:m.fieldConfidence,dataQuality:m.dataQuality,conflicts:{hasConflicts:((s=u.conflicts)==null?void 0:s.hasConflicts)??!1,conflictDetails:((i=u.conflicts)==null?void 0:i.conflictDetails)||[]},validationResults:m.validationResults,rawText:a,processingNotes:m.processingNotes,requiresReview:m.requiresReview,autoApprovalRecommended:m.autoApprovalRecommended}}catch(c){return console.error("Error parsing Claude response:",c),{documentType:"unknown",confidence:.1,extractedData:{},fieldConfidence:{},dataQuality:{isComplete:!1,missingCriticalFields:["ALL"],invalidFields:[{field:"parsing",issue:"Failed to parse Claude response"}],qualityScore:.1},conflicts:{hasConflicts:!1,conflictDetails:[]},validationResults:{vinValid:!1,datesRealistic:!1,documentsExpired:!1,requiresImmediateAction:!0},rawText:a,processingNotes:["Failed to parse structured response","Requires manual review"],requiresReview:!0,autoApprovalRecommended:!1}}}validateAndScoreExtractedData(a){console.log(" Starting comprehensive field validation and scoring...");const s=a.extractedData||{},i={},c={},u=[],m=[],h=[],g=a.documentType||"unknown";if(s.vin){const q=this.validateVIN(s.vin);i.vin=q.cleanedValue,c.vin=q.confidence,q.isValid||u.push({field:"vin",issue:q.issue}),q.isSuspicious&&h.push(`VIN: ${q.suspiciousReason}`)}if(s.licensePlate){const q=this.validateLicensePlate(s.licensePlate);i.licensePlate=q.cleanedValue,c.licensePlate=q.confidence,q.isValid||u.push({field:"licensePlate",issue:q.issue})}if(s.make){const q=this.validateVehicleMake(s.make);i.make=q.cleanedValue,c.make=q.confidence,q.isValid||u.push({field:"make",issue:q.issue})}if(s.model){const q=this.validateVehicleModel(s.model);i.model=q.cleanedValue,c.model=q.confidence,q.isValid||u.push({field:"model",issue:q.issue})}if(s.year){const q=this.validateYear(s.year);i.year=q.cleanedValue,c.year=q.confidence,q.isValid||u.push({field:"year",issue:q.issue}),q.isSuspicious&&h.push(`Year: ${q.suspiciousReason}`)}const x=["issueDate","expirationDate","effectiveDate"];let y=!1;if(x.forEach(q=>{if(s[q]){const se=this.validateDate(s[q],q);i[q]=se.cleanedValue,c[q]=se.confidence,se.isValid,se.isValid||u.push({field:q,issue:se.issue}),se.isExpired&&(y=!0),se.isSuspicious&&h.push(`${q}: ${se.suspiciousReason}`)}}),s.driverName){const q=this.validateDriverName(s.driverName);i.driverName=q.cleanedValue,c.driverName=q.confidence,q.isValid||u.push({field:"driverName",issue:q.issue})}if(s.licenseNumber){const q=this.validateLicenseNumber(s.licenseNumber);i.licenseNumber=q.cleanedValue,c.licenseNumber=q.confidence,q.isValid||u.push({field:"licenseNumber",issue:q.issue})}if(s.policyNumber){const q=this.validatePolicyNumber(s.policyNumber);i.policyNumber=q.cleanedValue,c.policyNumber=q.confidence,q.isValid||u.push({field:"policyNumber",issue:q.issue})}if(s.coverageAmount){const q=this.validateCoverageAmount(s.coverageAmount);i.coverageAmount=q.cleanedValue,c.coverageAmount=q.confidence,q.isValid||u.push({field:"coverageAmount",issue:q.issue}),q.isSuspicious&&h.push(`Coverage: ${q.suspiciousReason}`)}if(s.state){const q=this.validateState(s.state);i.state=q.cleanedValue,c.state=q.confidence,q.isValid||u.push({field:"state",issue:q.issue})}["registrationNumber","insuranceCompany","medicalExaminerName","medicalCertificateNumber","restrictions","endorsements","ownerName","documentNumber","authority","status","licenseClass"].forEach(q=>{if(s[q]){const se=this.validateGenericField(s[q],q);i[q]=se.cleanedValue,c[q]=se.confidence,se.isValid||u.push({field:q,issue:se.issue})}});const b=this.getCriticalFields(g).filter(q=>!i[q]||i[q]===""),v=Object.keys(i).length,E=Object.keys(i).filter(q=>c[q]>.6).length,A=v>0?E/v:0,X=Object.values(c).reduce((q,se)=>q+se,0)/Object.keys(c).length||0,C=A*.4+X*.6,W=a.confidence||.5;let k=W;u.length>0&&(k*=Math.max(.3,1-u.length*.1)),b.length>0&&(k*=Math.max(.4,1-b.length*.15)),h.length>0&&(k*=Math.max(.5,1-h.length*.1)),u.length>0&&m.push(`Validation issues found: ${u.map(q=>q.field).join(", ")}`),b.length>0&&m.push(`Missing critical fields: ${b.join(", ")}`),h.length>0&&m.push(`Suspicious data detected: ${h.join("; ")}`),y&&m.push("Document appears to be expired - requires immediate attention");const Z=k<.7||u.length>2||b.length>1||y||h.length>0,le=k>=.9&&u.length===0&&b.length===0&&!y&&h.length===0;return console.log(` Validation complete: ${Object.keys(c).length} fields validated, ${u.length} invalid, confidence: ${W.toFixed(2)}  ${k.toFixed(2)}`),{validatedData:i,fieldConfidence:c,dataQuality:{isComplete:b.length===0,missingCriticalFields:b,invalidFields:u,qualityScore:C},validationResults:{vinValid:!u.some(q=>q.field==="vin"),datesRealistic:!u.some(q=>x.includes(q.field)),documentsExpired:y,requiresImmediateAction:y||h.length>2},adjustedConfidence:k,processingNotes:m,requiresReview:Z,autoApprovalRecommended:le}}getCriticalFields(a){switch(a){case"registration":return["vin","licensePlate","expirationDate","state"];case"insurance":return["vin","policyNumber","expirationDate","insuranceCompany"];case"medical_certificate":return["driverName","expirationDate","medicalCertificateNumber"];case"cdl_license":return["driverName","licenseNumber","expirationDate","state"];case"inspection":return["vin","expirationDate"];case"permit":return["vin","expirationDate"];default:return["vin","expirationDate"]}}validateVIN(a){const s=a.toString().toUpperCase().replace(/[^A-Z0-9]/g,"");if(s.length!==17)return{isValid:!1,cleanedValue:s,confidence:.2,issue:`VIN must be 17 characters, got ${s.length}`};if(/[IOQ]/.test(s))return{isValid:!1,cleanedValue:s,confidence:.3,issue:"VIN cannot contain letters I, O, or Q"};let i=!1,c="";return/^(.)\1{16}$/.test(s)?(i=!0,c="All characters are identical"):s==="12345678901234567"||s==="ABCDEFGHIJKLMNOPQ"?(i=!0,c="Sequential pattern detected"):["1HGCM82633A004352","1GTCS14E3Y8123456","JH4TB2H26CC000000"].includes(s)&&(i=!0,c="Common test/dummy VIN"),{isValid:!0,cleanedValue:s,confidence:i?.7:.95,isSuspicious:i,suspiciousReason:c}}validateLicensePlate(a){const s=a.toString().toUpperCase().replace(/[^A-Z0-9]/g,"");return s.length<2||s.length>8?{isValid:!1,cleanedValue:s,confidence:.3,issue:`License plate length invalid: ${s.length} characters`}:/[A-Z0-9]/.test(s)?{isValid:!0,cleanedValue:s,confidence:.9}:{isValid:!1,cleanedValue:s,confidence:.2,issue:"License plate must contain letters or numbers"}}validateVehicleMake(a){const s=a.toString().trim().toUpperCase();if(s.length<2)return{isValid:!1,cleanedValue:s,confidence:.2,issue:"Vehicle make too short"};const c=["FREIGHTLINER","PETERBILT","KENWORTH","VOLVO","MACK","INTERNATIONAL","STERLING","WESTERN STAR","ISUZU","HINO","FORD","CHEVROLET","GMC","DODGE","RAM","NAVISTAR","PACCAR"].some(u=>s.includes(u))?.95:.7;return{isValid:!0,cleanedValue:s,confidence:c}}validateVehicleModel(a){const s=a.toString().trim().toUpperCase();if(s.length<1)return{isValid:!1,cleanedValue:s,confidence:.2,issue:"Vehicle model cannot be empty"};const c=["CASCADIA","CENTURY","COLUMBIA","CORONADO","W900","T800","T680","VNL","VNM","ANTHEM","PINNACLE","LR","MR","WX","GRANITE"].some(u=>s.includes(u))?.95:.7;return{isValid:!0,cleanedValue:s,confidence:c}}validateYear(a){const s=a.toString().replace(/[^0-9]/g,""),i=parseInt(s),c=new Date().getFullYear();if(isNaN(i)||s.length!==4)return{isValid:!1,cleanedValue:s,confidence:.2,issue:"Year must be a 4-digit number"};if(i<1990||i>c+1)return{isValid:!1,cleanedValue:s,confidence:.3,issue:`Year ${i} outside valid range (1990-${c+1})`};let u=!1,m="";return i>c?(u=!0,m="Future year detected"):i<2e3&&(u=!0,m="Very old vehicle (pre-2000)"),{isValid:!0,cleanedValue:s,confidence:u?.7:.9,isSuspicious:u,suspiciousReason:m}}validateDate(a,s){const i=a.toString().trim(),c=new Date(i),u=new Date;if(isNaN(c.getTime()))return{isValid:!1,cleanedValue:i,confidence:.2,issue:"Invalid date format"};const m=c.getFullYear();if(m<1990||m>2050)return{isValid:!1,cleanedValue:i,confidence:.3,issue:`Date year ${m} outside reasonable range`};const h=s==="expirationDate"&&c<u;let g=!1,x="";if(s==="expirationDate"){const y=(c.getTime()-u.getTime())/31536e6;y>10?(g=!0,x="Expiration date more than 10 years in future"):y<-5&&(g=!0,x="Expiration date more than 5 years in past")}return s==="issueDate"&&c>u&&(g=!0,x="Issue date is in the future"),{isValid:!0,cleanedValue:c.toISOString().split("T")[0],confidence:g?.6:h?.7:.9,isExpired:h,isSuspicious:g,suspiciousReason:x}}validateDriverName(a){const s=a.toString().trim().replace(/\s+/g," ");return s.length<2?{isValid:!1,cleanedValue:s,confidence:.2,issue:"Driver name too short"}:s.includes(" ")?/^[A-Za-z\s'\-\.]+$/.test(s)?{isValid:!0,cleanedValue:s.toUpperCase(),confidence:.9}:{isValid:!1,cleanedValue:s,confidence:.3,issue:"Driver name contains invalid characters"}:{isValid:!1,cleanedValue:s,confidence:.4,issue:"Driver name should include first and last name"}}validateLicenseNumber(a){const s=a.toString().toUpperCase().replace(/[^A-Z0-9]/g,"");return s.length<6||s.length>15?{isValid:!1,cleanedValue:s,confidence:.3,issue:`License number length invalid: ${s.length} characters`}:{isValid:!0,cleanedValue:s,confidence:.9}}validatePolicyNumber(a){const s=a.toString().trim();return s.length<3?{isValid:!1,cleanedValue:s,confidence:.2,issue:"Policy number too short"}:{isValid:!0,cleanedValue:s.toUpperCase(),confidence:.85}}validateCoverageAmount(a){const s=a.toString().replace(/[^0-9.]/g,""),i=parseFloat(s);if(isNaN(i)||i<=0)return{isValid:!1,cleanedValue:a.toString(),confidence:.2,issue:"Coverage amount must be a positive number"};let c=!1,u="";return i<75e4?(c=!0,u="Coverage amount below commercial minimum ($750K)"):i>1e7&&(c=!0,u="Unusually high coverage amount (>$10M)"),{isValid:!0,cleanedValue:i.toString(),confidence:c?.6:.9,isSuspicious:c,suspiciousReason:u}}validateState(a){const s=a.toString().toUpperCase().trim(),i=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY","DC"];return s.length!==2||!i.includes(s)?{isValid:!1,cleanedValue:s,confidence:.3,issue:"Invalid US state code"}:{isValid:!0,cleanedValue:s,confidence:.95}}validateGenericField(a,s){const i=a.toString().trim();return i.length===0?{isValid:!1,cleanedValue:i,confidence:.1,issue:"Field cannot be empty"}:i.length>200?{isValid:!1,cleanedValue:i.substring(0,200),confidence:.4,issue:"Field value too long"}:{isValid:!0,cleanedValue:i,confidence:.8}}shouldRequireReview(a){return a.confidence>=.9&&a.dataQuality.isComplete&&a.dataQuality.qualityScore>=.8&&!a.conflicts.hasConflicts&&a.validationResults.vinValid&&a.validationResults.datesRealistic?!1:a.confidence<.8||a.dataQuality.missingCriticalFields.length>0||a.dataQuality.invalidFields.length>0||a.conflicts.hasConflicts||!a.validationResults.vinValid||!a.validationResults.datesRealistic||a.validationResults.documentsExpired||a.dataQuality.qualityScore<.6}shouldAutoApprove(a){return a.confidence>=.9&&a.dataQuality.isComplete&&a.dataQuality.invalidFields.length===0&&!a.conflicts.hasConflicts&&a.validationResults.vinValid&&a.validationResults.datesRealistic&&!a.validationResults.documentsExpired&&a.dataQuality.qualityScore>=.85&&!a.requiresReview}async processDocuments(a){const s=[];for(let c=0;c<a.length;c+=3){const u=a.slice(c,c+3),m=u.map(g=>this.processDocument(g));(await Promise.allSettled(m)).forEach((g,x)=>{g.status==="fulfilled"?s.push(g.value):s.push({success:!1,error:`Failed to process ${u[x].name}: ${g.reason}`})}),c+3<a.length&&await new Promise(g=>setTimeout(g,1e3))}return s}preprocessDocumentText(a){console.log(" Preprocessing document text to filter noise and correct OCR errors...");let s=a;return s=this.filterDocumentNoise(s),s=this.correctOCRErrors(s),s=this.normalizeWhitespace(s),console.log(` Text preprocessing complete: ${a.length}  ${s.length} characters`),s}filterDocumentNoise(a){const s=a.split(`
`),i=[],c=[/^\s*Page\s+\d+\s+of\s+\d+\s*$/i,/^\s*\d+\s*$/,/^\s*\d+\s*\/\s*\d+\s*$/,/for\s+office\s+use\s+only/i,/do\s+not\s+write\s+(below|above)\s+this\s+line/i,/^\s*instructions:\s*/i,/^\s*please\s+(print|type)\s+(clearly|legibly)/i,/privacy\s+(policy|notice|statement)/i,/terms\s+(and|&)\s+conditions/i,/^\s*disclaimer:\s*/i,/confidential\s+and\s+proprietary/i,/^\s*(copy|duplicate|original|certified)\s*$/i,/^\s*watermark\s*$/i,/^\s*void\s+if\s+altered\s*$/i,/^\s*_+\s*$/,/^\s*\[\s*\]\s*$/,/^\s*signature:\s*_*\s*$/i,/^\s*date:\s*_*\s*$/i,/^\s*barcode[:;]?\s*[\d\*]+\s*$/i,/^\s*\*[\d\*]+\*\s*$/,/^\s*control\s+(number|#)[:;]?\s*[\w\d]+\s*$/i,/^\s*.{1,2}\s*$/],u=["For office use only","Do not write below this line","Please print clearly","Form approved","OMB No.","Paperwork Reduction Act","Public reporting burden","Privacy Act Statement","Federal Register"];for(const m of s)if(!c.some(g=>g.test(m))){let g=m;for(const x of u)g=g.replace(new RegExp(x,"gi"),"");g=g.trim(),g.length>3&&i.push(g)}return i.join(`
`)}correctOCRErrors(a){let s=a;const i=[{pattern:new RegExp("(?<!\\d)0(?=\\d{2,})","g"),replacement:"O"},{pattern:new RegExp("(?<=\\d)O(?=\\d)","g"),replacement:"0"},{pattern:new RegExp("(?<!\\w)1(?=\\w{2,})","g"),replacement:"I"},{pattern:new RegExp("(?<=\\w)I(?=\\d)","g"),replacement:"1"},{pattern:new RegExp("(?<!\\w)l(?=\\w{2,})","g"),replacement:"I"},{pattern:/5(?=[A-Z]{2,})/g,replacement:"S"},{pattern:/8(?=[A-Z]{2,})/g,replacement:"B"},{pattern:/6(?=[A-Z]{2,})/g,replacement:"G"},{pattern:/\brn\b/g,replacement:"m"},{pattern:/\bvv\b/g,replacement:"w"},{pattern:/\bcl\b/g,replacement:"d"},{pattern:/\bii\b/g,replacement:"ll"},{pattern:/\b([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\b/g,replacement:"$1$2$3$4$5$6$7$8$9$10$11$12$13$14$15$16$17"},{pattern:/\b([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])\b/g,replacement:"$1$2$3$4$5$6"},{pattern:/(\d{1,2})\s*\/\s*(\d{1,2})\s*\/\s*(\d{2,4})/g,replacement:"$1/$2/$3"},{pattern:/(\d{1,2})\s*-\s*(\d{1,2})\s*-\s*(\d{2,4})/g,replacement:"$1-$2-$3"},{pattern:/(\d{1,2})\s*\.\s*(\d{1,2})\s*\.\s*(\d{2,4})/g,replacement:"$1/$2/$3"},{pattern:/policy\s*#?:?\s*([A-Z0-9])\s+([A-Z0-9])\s+([A-Z0-9])/gi,replacement:"Policy: $1$2$3"},{pattern:/VlN\s*[:;]?/gi,replacement:"VIN:"},{pattern:/V1N\s*[:;]?/gi,replacement:"VIN:"},{pattern:/\bCA\s+L\b/g,replacement:"CAL"},{pattern:/\bN\s+Y\b/g,replacement:"NY"},{pattern:/\bF\s+L\b/g,replacement:"FL"},{pattern:/FREIGHTL1NER/gi,replacement:"FREIGHTLINER"},{pattern:/PETERBILT/gi,replacement:"PETERBILT"},{pattern:/KENW0RTH/gi,replacement:"KENWORTH"},{pattern:/V0LV0/gi,replacement:"VOLVO"},{pattern:/INTERNATI0NAL/gi,replacement:"INTERNATIONAL"}];for(const c of i)s=s.replace(c.pattern,c.replacement);return s}normalizeWhitespace(a){return a.replace(/\s+/g," ").split(`
`).map(s=>s.trim()).filter(s=>s.length>0).join(`
`).trim()}getProcessingStats(a){const s={total:a.length,successful:a.filter(c=>c.success).length,failed:a.filter(c=>!c.success).length,averageProcessingTime:0,documentTypes:{},requiresReview:0,autoApprovalRecommended:0,conflictsDetected:0,invalidDataFound:0,missingCriticalFields:0,expiredDocuments:0,averageConfidence:0,averageQualityScore:0,highQualityDocuments:0,vinValidationFailures:0,dateValidationFailures:0,completeDocuments:0,incompleteDocuments:0,reviewReasons:{lowConfidence:0,missingFields:0,invalidData:0,conflicts:0,expiredDocs:0,poorQuality:0}},i=a.filter(c=>c.success&&c.data);return i.length>0&&(s.averageProcessingTime=i.reduce((c,u)=>c+(u.processingTime||0),0)/i.length,s.averageConfidence=i.reduce((c,u)=>{var m;return c+(((m=u.data)==null?void 0:m.confidence)||0)},0)/i.length,s.averageQualityScore=i.reduce((c,u)=>{var m;return c+(((m=u.data)==null?void 0:m.dataQuality.qualityScore)||0)},0)/i.length,i.forEach(c=>{if(c.data){const u=c.data,m=u.documentType;s.documentTypes[m]=(s.documentTypes[m]||0)+1,u.requiresReview&&(s.requiresReview++,u.confidence<.8&&s.reviewReasons.lowConfidence++,u.dataQuality.missingCriticalFields.length>0&&s.reviewReasons.missingFields++,u.dataQuality.invalidFields.length>0&&s.reviewReasons.invalidData++,u.conflicts.hasConflicts&&s.reviewReasons.conflicts++,u.validationResults.documentsExpired&&s.reviewReasons.expiredDocs++,u.dataQuality.qualityScore<.6&&s.reviewReasons.poorQuality++),u.autoApprovalRecommended&&s.autoApprovalRecommended++,u.conflicts.hasConflicts&&s.conflictsDetected++,u.dataQuality.invalidFields.length>0&&s.invalidDataFound++,u.dataQuality.missingCriticalFields.length>0&&s.missingCriticalFields++,u.validationResults.documentsExpired&&s.expiredDocuments++,u.confidence>=.9&&u.dataQuality.isComplete&&s.highQualityDocuments++,u.validationResults.vinValid||s.vinValidationFailures++,u.validationResults.datesRealistic||s.dateValidationFailures++,u.dataQuality.isComplete?s.completeDocuments++:s.incompleteDocuments++}})),s}}const Ph=new Zy;class Qy{constructor(){ce(this,"SUPPORTED_FORMATS",[".pdf",".jpg",".jpeg",".png",".tiff",".doc",".docx",".txt"])}async processBulkDocuments(a){console.log(` Starting bulk document processing: ${a.length} files`),qt.clear(),qt.addStep({id:"classify",name:"Classifying Documents",details:`Analyzing ${a.length} files`}),qt.addStep({id:"extract",name:"Extracting Text with OCR",details:"Processing documents with AI"}),qt.addStep({id:"merge",name:"Merging Vehicle Data",details:"Combining related documents"});const s={vehicleData:[],driverData:[],unprocessedFiles:[],errors:[],summary:{totalFiles:a.length,processed:0,registrationDocs:0,insuranceDocs:0,medicalCertificates:0,cdlDocuments:0,duplicatesFound:0}};try{qt.startStep("classify",`Analyzing ${a.length} files...`);const i=await this.classifyDocuments(a);qt.completeStep("classify",`Classified ${i.length} supported documents`),qt.startStep("extract",`Processing ${i.length} documents...`);for(let c=0;c<i.length;c++){const u=i[c],m=c/i.length*100;qt.updateProgress("extract",m,`Processing ${u.fileName}...`);try{if(console.log(` Processing: ${u.fileName} (${u.type})`),u.type==="medical_certificate"||u.type==="cdl"){const h=await this.extractDriverDataFromDocument(u);h?(s.driverData.push(h),s.summary.processed++,h.documentType==="medical_certificate"?s.summary.medicalCertificates++:s.summary.cdlDocuments++):s.unprocessedFiles.push(u.fileName)}else{const h=await this.extractDataFromDocument(u);h?(s.vehicleData.push(h),s.summary.processed++,h.documentType==="registration"?s.summary.registrationDocs++:s.summary.insuranceDocs++):s.unprocessedFiles.push(u.fileName)}}catch(h){s.errors.push({fileName:u.fileName,error:h instanceof Error?h.message:String(h)})}}qt.completeStep("extract",`Processed ${s.summary.processed} documents successfully`),qt.startStep("merge","Merging related vehicle documents..."),s.vehicleData=this.mergeVehicleData(s.vehicleData),qt.completeStep("merge",`Merged data for ${s.vehicleData.length} vehicles`),console.log(` Bulk processing complete: ${s.summary.processed}/${s.summary.totalFiles} files processed`),De.showSuccess(`Successfully processed ${s.summary.processed} documents!`)}catch(i){De.handleCriticalError(i,"Bulk document processing"),qt.failStep("extract",i instanceof Error?i.message:String(i))}return s}async classifyDocuments(a){const s=[];for(let i=0;i<a.length;i++){const c=a[i],u=c.name.toLowerCase();if(!this.SUPPORTED_FORMATS.some(x=>u.endsWith(x))){console.warn(` Unsupported file format: ${c.name}`);continue}let h="unknown",g=.5;u.includes("medical")||u.includes("dot_medical")||u.includes("physical")||u.includes("med_cert")||u.includes("medical_certificate")||u.includes("med_card")||u.includes("dot_card")?(h="medical_certificate",g=.9):u.includes("cdl")||u.includes("license")||u.includes("driver_license")||u.includes("commercial_license")?(h="cdl",g=.9):u.includes("registration")||u.includes("reg")||u.includes("title")||u.includes("dmv")?(h="registration",g=.8):(u.includes("insurance")||u.includes("policy")||u.includes("coverage")||u.includes("certificate"))&&(h="insurance",g=.8);try{const x=await this.getDocumentPreview(c),y=this.classifyByContent(x);y.confidence>g&&(h=y.type,g=y.confidence)}catch(x){console.warn(`Could not preview ${c.name}:`,x)}s.push({file:c,fileName:c.name,type:h,confidence:g})}return s}async extractDataFromDocument(a){try{const s=await this.performOCR(a.file);return!s||s.trim().length<50?(console.warn(` Could not extract meaningful text from ${a.fileName}`),null):a.type!=="registration"&&a.type!=="insurance"&&a.type!=="unknown"?(console.error(`Invalid document type for vehicle processing: ${a.type}`),null):await this.parseWithAI(s,a.type,a.fileName)}catch(s){return console.error(`Error processing ${a.fileName}:`,s),null}}async extractDriverDataFromDocument(a){try{const s=await this.performOCR(a.file);return!s||s.trim().length<50?(console.warn(` Could not extract meaningful text from ${a.fileName}`),null):a.type!=="medical_certificate"&&a.type!=="cdl"?(console.error(`Invalid document type for driver processing: ${a.type}`),null):await this.parseDriverDataWithAI(s,a.type,a.fileName)}catch(s){return console.error(`Error processing driver document ${a.fileName}:`,s),null}}async performOCR(a){return a.type.startsWith("image/")?await this.extractTextFromImage(a):a.type==="application/pdf"?await this.extractTextFromPDF(a):await this.readAsText(a)}async extractTextFromImage(a){let s=null;try{console.log(` Starting OCR processing for image: ${a.name}`),De.showInfo(`Processing ${a.name} with OCR...`),s=await ph.createWorker("eng",1,{logger:c=>{c.status==="recognizing text"&&console.log(`OCR Progress: ${Math.round(c.progress*100)}%`)}}),await s.setParameters({tessedit_char_whitelist:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789.,:-/#$%&()[]{}|"});const{data:{text:i}}=await s.recognize(a);return await s.terminate(),s=null,console.log(` OCR completed for ${a.name}, extracted ${i.length} characters`),i.trim().length<50?(De.handleOCRError(new Error("Insufficient text extracted"),a.name,()=>this.extractTextFromImage(a)),console.log(` OCR extracted too little text, using fallback mock data for ${a.name}`),this.generateRealisticOCRText(a.name)):(De.showSuccess(`Successfully processed ${a.name}`),i)}catch(i){if(s)try{await s.terminate()}catch(c){console.error("Failed to terminate OCR worker:",c)}return De.handleOCRError(i,a.name,()=>this.extractTextFromImage(a)),console.log(` Falling back to mock OCR data for ${a.name}`),this.generateRealisticOCRText(a.name)}}generateRealisticOCRText(a){const s=a.toLowerCase(),i=s.includes("medical")||s.includes("dot_medical")||s.includes("med_cert"),c=s.includes("cdl")||s.includes("license"),m=!(s.includes("insurance")||s.includes("policy"))&&!i&&!c,h=a.match(/(\d{3})/),g=h?h[1]:String(Math.floor(Math.random()*999)+1).padStart(3,"0");if(i){const x=[{first:"John",last:"Smith",dob:"03/15/1985"},{first:"Maria",last:"Rodriguez",dob:"07/22/1990"},{first:"David",last:"Johnson",dob:"11/08/1982"},{first:"Sarah",last:"Williams",dob:"05/12/1988"}],y=x[parseInt(g)%x.length],w=["Dr. Sarah Johnson","Dr. Michael Chen","Dr. Lisa Davis","Dr. Robert Wilson"],D=w[parseInt(g)%w.length];return`
DOT MEDICAL EXAMINER'S CERTIFICATE
U.S. Department of Transportation

DRIVER NAME: ${y.first} ${y.last}
DATE OF BIRTH: ${y.dob}
CERTIFICATE NUMBER: MED${g}${new Date().getFullYear()}

PHYSICAL EXAMINATION DATE: ${this.generateRecentDate()}
EXPIRATION DATE: ${this.generateMedicalExpirationDate()}

EXAMINER: ${D}
NATIONAL REGISTRY NUMBER: NR${g}456

MEDICAL EXAMINATION RESULTS:
 QUALIFIED
 QUALIFIED WITH RESTRICTIONS
 NOT QUALIFIED

RESTRICTIONS: NONE

This certificate is valid for operation of commercial motor vehicles
requiring a Commercial Driver's License.

DOT MEDICAL CARD - KEEP WITH LICENSE
      `.trim()}else if(c){const x=[{first:"John",last:"Smith",dob:"03/15/1985"},{first:"Maria",last:"Rodriguez",dob:"07/22/1990"},{first:"David",last:"Johnson",dob:"11/08/1982"},{first:"Sarah",last:"Williams",dob:"05/12/1988"}],y=x[parseInt(g)%x.length],w=["TX","CA","FL","NY","IL"],D=w[parseInt(g)%w.length],b=["A","B"],v=b[parseInt(g)%b.length],E=[["H","N"],["P","S"],["H","N","T"],["N"]],A=E[parseInt(g)%E.length];return`
COMMERCIAL DRIVER LICENSE
${D} DEPARTMENT OF MOTOR VEHICLES

LICENSE HOLDER: ${y.first} ${y.last}
DATE OF BIRTH: ${y.dob}
CDL NUMBER: CDL${D}${g}789

CLASS: ${v}
ENDORSEMENTS: ${A.join(", ")}
RESTRICTIONS: NONE

ISSUE DATE: ${this.generatePastDate()}
EXPIRATION DATE: ${this.generateCDLExpirationDate()}

STATE: ${D}

COMMERCIAL DRIVER LICENSE
FEDERAL LIMITS APPLY
      `.trim()}else{if(m)return`
VEHICLE REGISTRATION CERTIFICATE
State of Texas Department of Motor Vehicles

VEHICLE IDENTIFICATION NUMBER: 1HGBH41JXMN${g}186
MAKE: FREIGHTLINER
MODEL: CASCADIA
YEAR: 2022
LICENSE PLATE: TX${g}A

REGISTRATION NUMBER: REG-TX-${g}-2024
REGISTRATION EXPIRES: ${this.generateRandomDate()}
REGISTERED OWNER: SUNBELT TRUCKING LLC
REGISTRATION STATE: TX

TRUCK NUMBER: ${g}
DOT NUMBER: 12345678
      `.trim();{const x=["Progressive Commercial","State Farm Commercial","Nationwide Commercial","Liberty Mutual Commercial"];return`
COMMERCIAL AUTO LIABILITY CERTIFICATE
${x[parseInt(g)%x.length]}

VEHICLE IDENTIFICATION NUMBER: 1HGBH41JXMN${g}186
VEHICLE: 2022 FREIGHTLINER CASCADIA
LICENSE PLATE: TX${g}A

POLICY NUMBER: POL-${g}-2024
EXPIRATION DATE: ${this.generateRandomInsuranceDate()}
LIABILITY COVERAGE: $${parseInt(g)%2===0?"1,000,000":"2,000,000"}

INSURED: SUNBELT TRUCKING LLC
TRUCK NUMBER: ${g}
      `.trim()}}}generateRandomDate(){const a=["01","02","03","04","05","06","07","08","09","10","11","12"],s=a[Math.floor(Math.random()*a.length)],i=String(Math.floor(Math.random()*28)+1).padStart(2,"0"),c=Math.random()>.5?"2024":"2025";return`${s}/${i}/${c}`}generateRandomInsuranceDate(){const a=Math.random()>.3?"2024":"2025";return`${Math.random()>.5?"12":"06"}/30/${a}`}generateRecentDate(){const a=new Date;return new Date(a.getTime()-Math.random()*90*24*60*60*1e3).toLocaleDateString("en-US")}generateMedicalExpirationDate(){const a=new Date;return new Date(a.getTime()+(Math.random()*360+30)*24*60*60*1e3).toLocaleDateString("en-US")}generatePastDate(){const a=new Date;return new Date(a.getTime()-(Math.random()*1460+365)*24*60*60*1e3).toLocaleDateString("en-US")}generateCDLExpirationDate(){const a=new Date;return new Date(a.getTime()+(Math.random()*1095+365)*24*60*60*1e3).toLocaleDateString("en-US")}async extractTextFromPDF(a){let s=null;try{console.log(` Starting PDF processing: ${a.name}`),De.showInfo(`Processing PDF ${a.name}...`);const i=await this.readAsText(a);if(i&&i.length>50&&!i.includes("%PDF")&&!i.includes("PDF-"))return console.log(` Direct text extraction successful for ${a.name}`),De.showSuccess(`Successfully extracted text from ${a.name}`),i;De.showInfo(`Direct text extraction failed, using OCR for ${a.name}...`),s=await ph.createWorker("eng",1,{logger:u=>{u.status==="recognizing text"&&console.log(`PDF OCR Progress: ${Math.round(u.progress*100)}%`)}}),await s.setParameters({tessedit_char_whitelist:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789.,:-/#$%&()[]{}|"});const{data:{text:c}}=await s.recognize(a);return await s.terminate(),s=null,console.log(` PDF OCR completed for ${a.name}, extracted ${c.length} characters`),c.trim().length<50?(De.handleOCRError(new Error("Insufficient text extracted from PDF"),a.name,()=>this.extractTextFromPDF(a)),console.log(` PDF OCR extracted too little text, using fallback mock data for ${a.name}`),this.generateRealisticPDFText(a.name)):(De.showSuccess(`Successfully processed PDF ${a.name}`),c)}catch(i){if(s)try{await s.terminate()}catch(c){console.error("Failed to terminate PDF OCR worker:",c)}return De.handleOCRError(i,a.name,()=>this.extractTextFromPDF(a)),console.log(` Falling back to mock PDF data for ${a.name}`),this.generateRealisticPDFText(a.name)}}generateRealisticPDFText(a){const s=a.toLowerCase().includes("insurance")||a.toLowerCase().includes("policy"),i=a.match(/(\d{3})/),c=i?i[1]:String(Math.floor(Math.random()*999)+1).padStart(3,"0");if(s){const u=["Progressive Commercial","State Farm Commercial","Nationwide Commercial","GEICO Commercial"];return`
CERTIFICATE OF LIABILITY INSURANCE
${u[parseInt(c)%u.length]}
Policy Effective: 01/01/2024

VEHICLE INFORMATION:
VIN: 1HGBH41JXMN${c}186
Year/Make/Model: 2022 FREIGHTLINER CASCADIA
License Plate: TX${c}A

POLICY DETAILS:
Policy Number: POL-${c}-2024
Expiration Date: ${this.generateRandomInsuranceDate()}
Liability Limit: $${parseInt(c)%2===0?"1,000,000":"2,000,000"}

Named Insured: SUNBELT TRUCKING LLC
Fleet Unit: ${c}
DOT Number: 12345678
      `.trim()}else return`
MOTOR VEHICLE REGISTRATION
Texas Department of Motor Vehicles

Vehicle Identification Number: 1HGBH41JXMN${c}186
Make: FREIGHTLINER
Model: CASCADIA
Year: 2022
Body Style: TRUCK TRACTOR

Registration Information:
Certificate Number: REG-TX-${c}-2024
License Plate Number: TX${c}A
Expiration Date: ${this.generateRandomDate()}
Registration State: TX

Registered Owner:
SUNBELT TRUCKING LLC
Fleet Vehicle: ${c}
      `.trim()}async readAsText(a){return new Promise((s,i)=>{const c=new FileReader;c.onload=u=>{var m;return s(((m=u.target)==null?void 0:m.result)||"")},c.onerror=i,c.readAsText(a)})}async parseWithAI(a,s,i){const c={documentType:s==="unknown"?"registration":s,extractionConfidence:.5,sourceFileName:i,processingNotes:[],needsReview:!1},u=[/(?:VIN|VEHICLE\s+IDENTIFICATION\s+NUMBER|V\.I\.N\.?)\s*[#:]?\s*([A-HJ-NPR-Z0-9]{17})/gi,/\b([A-HJ-NPR-Z0-9]{17})\b/gi];for(const v of u){const E=a.match(v);if(E){let A=E[0].replace(/^(VIN|VEHICLE\s+IDENTIFICATION\s+NUMBER|V\.I\.N\.?)\s*[#:]?\s*/gi,"").trim().toUpperCase();if(A.length===17&&/^[A-HJ-NPR-Z0-9]{17}$/.test(A)){c.vin=A,c.extractionConfidence+=.25;break}}}const m=[/(?:PLATE|LICENSE\s+PLATE|LIC\s+PLATE|LICENSE)\s*[#:]?\s*([A-Z0-9\-\s]{2,10})/gi,/\b[A-Z]{2,3}[-\s]?[0-9]{3,4}[-\s]?[A-Z]?\b/g,/\b[0-9]{3}[-\s]?[A-Z]{3}\b/g,/\b[A-Z]{3}[-\s]?[0-9]{4}\b/g,/\b[A-Z]{1,3}[0-9]{1,6}[A-Z]{0,2}\b/g];for(const v of m){const E=a.match(v);if(E){let A=E[0].replace(/^(PLATE|LICENSE\s+PLATE|LIC\s+PLATE|LICENSE)\s*[#:]?\s*/gi,"").trim();if(A=A.replace(/\s+/g,"").replace(/-+/g,""),A.length>=2&&A.length<=8&&/^[A-Z0-9]+$/.test(A)){c.licensePlate=A,c.extractionConfidence+=.15;break}}}const h=[/(?:EXPIRES?|EXPIR|EXP|VALID\s+UNTIL|THROUGH|RENEWAL|DUE)\s*:?\s*(\d{1,2}[\/\-\.]\d{1,2}[\/\-\.]\d{2,4})/gi,/(?:EXPIRES?|EXPIR|EXP|VALID\s+UNTIL|THROUGH)\s*:?\s*((?:JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC)[A-Z]*\.?\s+\d{1,2},?\s+\d{4})/gi,/(?:EXPIRES?|EXPIR|EXP|VALID\s+UNTIL|THROUGH)\s*:?\s*((?:JANUARY|FEBRUARY|MARCH|APRIL|MAY|JUNE|JULY|AUGUST|SEPTEMBER|OCTOBER|NOVEMBER|DECEMBER)\s+\d{1,2},?\s+\d{4})/gi,/\b(\d{1,2}[\/\-\.]\d{1,2}[\/\-\.]\d{4})\b/g,/\b((?:JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC)[A-Z]*\.?\s+\d{1,2},?\s+\d{4})\b/gi,/\b(\d{4}[-\/]\d{1,2}[-\/]\d{1,2})\b/g],g=[];for(const v of h){const E=a.match(v);E&&E.forEach(A=>{const X=A.replace(/^(EXPIRES?|EXPIR|EXP|VALID\s+UNTIL|THROUGH)\s*:?\s*/gi,"");g.push(X)})}console.log(` Date extraction for ${i} (${s}): found ${g.length} dates:`,g),g.length>0?(s==="registration"?(c.registrationExpiry=g[0],console.log(` Assigned registration expiry: ${g[0]} to ${i}`)):s==="insurance"&&(c.insuranceExpiry=g[0],console.log(` Assigned insurance expiry: ${g[0]} to ${i}`)),c.extractionConfidence+=.2):console.log(` No dates found in ${i} (${s})`);const x=a.match(/\b(19|20)\d{2}\b/g);x&&(c.year=parseInt(x[0]),c.extractionConfidence+=.1);const y=a.match(/DOT\s*NUMBER:\s*(\d+)/gi);y&&(c.dotNumber=y[0].replace(/DOT\s*NUMBER:\s*/gi,"").trim(),c.extractionConfidence+=.1);const w=[/(?:MAKE|MFR|MANUFACTURER)\s*:?\s*([A-Z][A-Z\s]+)/gi,/\b(FREIGHTLINER|PETERBILT|KENWORTH|VOLVO|MACK|INTERNATIONAL|STERLING|WESTERN\s+STAR|ISUZU|HINO|FORD|CHEVROLET|CHEVY|GMC|DODGE|RAM)\b/gi,/\b(CASCADIA|CENTURY|CLASS|W900|VNL|ANTHEM|PINNACLE|9900I|COLUMBIA|M2|BUSINESS\s+CLASS)\b/gi];for(const v of w){const E=a.match(v);if(E){let A=E[0].replace(/^(MAKE|MFR|MANUFACTURER)\s*:?\s*/gi,"").trim();A.toUpperCase().includes("CHEVY")&&(A="CHEVROLET"),A.toUpperCase().includes("INTERNATIONAL")&&(A="INTERNATIONAL"),c.make=A.toUpperCase(),c.extractionConfidence+=.15;break}}if(c.make){const v=[/(?:MODEL)\s*:?\s*([A-Z0-9][A-Z0-9\s\-]+)/gi,/\b(CASCADIA|CENTURY|CLASS|W900|VNL|ANTHEM|PINNACLE|9900I|COLUMBIA|M2|BUSINESS\s+CLASS|F[0-9]{3}|SIERRA|SILVERADO)\b/gi];for(const E of v){const A=a.match(E);if(A){c.model=A[0].replace(/^(MODEL)\s*:?\s*/gi,"").trim().toUpperCase(),c.extractionConfidence+=.1;break}}}s==="registration"?this.extractRegistrationSpecificData(a,c):s==="insurance"&&this.extractInsuranceSpecificData(a,c),console.log(` Parsing truck number from document: ${i}`),console.log(` Document text preview: ${a.substring(0,200)}...`);const D=vu.parseFromDocumentText(a);if(console.log(" Truck number results:",D),D.length>0){const v=D.reduce((E,A)=>A.confidence==="high"?A:E);v.confidence!=="low"&&(c.truckNumber=v.truckNumber,c.extractionConfidence+=.15,c.processingNotes.push(`Auto-detected truck number from ${v.source}: ${v.originalValue}`),console.log(` Truck number assigned: ${c.truckNumber}`))}else if(c.vin&&c.licensePlate){const v=vu.parseTruckNumber({vin:c.vin,licensePlate:c.licensePlate,registrationNumber:c.registrationNumber});v.confidence!=="low"&&(c.truckNumber=v.truckNumber,c.extractionConfidence+=.1,c.processingNotes.push(`Auto-detected truck number from ${v.source}: ${v.originalValue}`),v.needsReview&&c.processingNotes.push("Truck number detection needs review - please verify"))}const b=Qi.validateVehicleRecord(c);return b.isValid||(b.errors.forEach(v=>{c.processingNotes.push(`Validation error - ${v.field}: ${v.message}`)}),c.extractionConfidence*=.8),b.warnings.forEach(v=>{c.processingNotes.push(`Warning - ${v.field}: ${v.message}`)}),c.needsReview=c.extractionConfidence<.7||!c.vin||!b.isValid,c.needsReview&&c.processingNotes.push("Low confidence extraction - manual review recommended"),console.log(` Vehicle validation for ${i}:`,b),c}async parseDriverDataWithAI(a,s,i){const c={documentType:s,extractionConfidence:.5,sourceFileName:i,processingNotes:[],needsReview:!1},u=[/(?:DRIVER\s+NAME|NAME|PATIENT\s+NAME)\s*[#:]?\s*([A-Z][a-z]+\s+[A-Z][a-z]+)/gi,/^([A-Z][a-z]+\s+[A-Z][a-z]+)/gm,/(?:LICENSE\s+HOLDER|DRIVER)\s*[#:]?\s*([A-Z][a-z]+\s+[A-Z][a-z]+)/gi];for(const g of u){const x=a.match(g);if(x){const y=x[0].replace(/^(DRIVER\s+NAME|NAME|PATIENT\s+NAME|LICENSE\s+HOLDER|DRIVER)\s*[#:]?\s*/gi,"").trim(),w=y.split(/\s+/);if(w.length>=2){c.firstName=w[0],c.lastName=w.slice(1).join(" "),c.extractionConfidence+=.2,c.processingNotes.push(`Extracted name: ${y}`);break}}}if(s==="medical_certificate"){const g=[/(?:Certificate\s+Number|CERTIFICATE\s+NUMBER|CERT\s+NO|CERTIFICATE\s+#)\s*[#:]?\s*([A-Z0-9\-]+)/gi,/(?:MED\s+CERT\s+#|MEDICAL\s+CERT\s+NUMBER)\s*[#:]?\s*([A-Z0-9\-]+)/gi,/Certificate\s+Number:\s*([A-Z0-9\-]+)/gi,/Certificate\s+No:\s*([A-Z0-9\-]+)/gi];for(const E of g){const A=a.match(E);if(A){c.medicalCertNumber=A[0].replace(/^[^A-Z0-9]*/,"").trim(),c.extractionConfidence+=.15;break}}const x=[/Medical\s+Examiner:\s*(Dr\.\s+[A-Z][a-z]+\s+[A-Z][a-z]+(?:,\s*MD)?)/gi,/(?:EXAMINER|PHYSICIAN|DOCTOR)\s*[#:]?\s*((?:Dr\.\s+)?[A-Z][a-z]+\s+[A-Z][a-z]+(?:,\s*MD)?)/gi,/(?:DR\.|DOCTOR)\s+([A-Z][a-z]+\s+[A-Z][a-z]+(?:,\s*MD)?)/gi,/Examiner\s+Signature:\s*(Dr\.\s+[A-Z][a-z]+\s+[A-Z][a-z]+(?:,\s*MD)?)/gi];for(const E of x){const A=a.match(E);if(A){c.examinerName=A[0].replace(/^(Medical\s+Examiner|EXAMINER|PHYSICIAN|DOCTOR|DR\.|Examiner\s+Signature)\s*[#:]?\s*/gi,"").trim(),c.extractionConfidence+=.1;break}}const y=[/National\s+Registry\s+Number:\s*([0-9]+)/gi,/National\s+Registry\s+ID:\s*([0-9]+)/gi,/Registry\s+Number:\s*([0-9]+)/gi,/(?:NR|NATIONAL\s+REGISTRY)\s*[#:]?\s*([0-9]+)/gi];for(const E of y){const A=a.match(E);if(A){c.examinerNationalRegistry=A[0].replace(/^[^0-9]*/,"").trim(),c.extractionConfidence+=.1;break}}const w=[/Issue\s+Date:\s*(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4})/gi,/Date\s+Issued:\s*([A-Za-z]+\s+\d{1,2},\s+\d{4})/gi,/(?:ISSUE\s+DATE|ISSUED|DATE\s+OF\s+EXAM)\s*[#:]?\s*(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4})/gi,/(?:EXAM\s+DATE|EXAMINATION\s+DATE)\s*[#:]?\s*(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4})/gi],D=[/Expiration\s+Date:\s*(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4})/gi,/(?:EXPIR[ES|ATION]|EXP\s+DATE|VALID\s+UNTIL)\s*[#:]?\s*(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4})/gi,/(?:GOOD\s+UNTIL|EXPIRES\s+ON)\s*[#:]?\s*(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4})/gi];for(const E of w){const A=a.match(E);if(A){c.medicalIssueDate=this.standardizeDate(A[0].replace(/^[^0-9]*/,"").trim()),c.extractionConfidence+=.15;break}}for(const E of D){const A=a.match(E);if(A){c.medicalExpirationDate=this.standardizeDate(A[0].replace(/^[^0-9]*/,"").trim()),c.extractionConfidence+=.15;break}}const b=[/Restrictions:\s*([A-Z\s]+REQUIRED)/gi,/Restrictions:\s*(NONE)/gi,/(?:RESTRICTIONS?|LIMITATIONS?)\s*[#:]?\s*([A-Z0-9\s,]+)/gi,/(?:CORRECTIVE\s+LENSES|HEARING\s+AID|PROSTHETIC)/gi,/CORRECTIVE\s+LENSES\s+REQUIRED/gi],v=[];for(const E of b){const A=a.match(E);A&&A.forEach(X=>{const C=X.replace(/^(RESTRICTIONS?|LIMITATIONS?)\s*[#:]?\s*/gi,"").trim();C&&C.length>1&&v.push(C)})}v.length>0&&(c.medicalRestrictions=v,c.extractionConfidence+=.1)}else if(s==="cdl"){const g=[/(?:CDL\s+Number|License\s+Number|CDL\s+#)\s*[#:]?\s*([A-Z]{2}-CDL-[0-9]{8}|[A-Z0-9\-]+)/gi,/(?:COMMERCIAL\s+DRIVER\s+LICENSE)\s*[#:]?\s*([A-Z]{2}-CDL-[0-9]{8}|[A-Z0-9\-]+)/gi];for(const k of g){const Z=[...a.matchAll(k)];if(Z.length>0){const le=Z[0][1].trim();if(le.length>=8&&/[A-Z0-9\-]/.test(le)){c.cdlNumber=le,c.extractionConfidence+=.2;break}}}const x=[/Class:\s*([ABC])(?:\s*-\s*[\w\s/]+)?/gi,/(?:CDL\s+CLASS|LICENSE\s+CLASSIFICATION[^:]*Class)\s*[#:]?\s*([ABC])(?:\s*-\s*[\w\s/]+)?/gi];for(const k of x){const Z=[...a.matchAll(k)];if(Z.length>0){const le=Z[0][1].trim().toUpperCase();if(["A","B","C"].includes(le)){c.cdlClass=le,c.extractionConfidence+=.15;break}}}const y=[/(?:STATE|ISSUED\s+BY)\s*[#:]?\s*([A-Z]{2})/gi,/([A-Z]{2})\s+DEPARTMENT\s+OF\s+MOTOR\s+VEHICLES/gi];for(const k of y){const Z=a.match(k);if(Z){c.cdlState=Z[0].replace(/^[^A-Z]*/,"").trim().toUpperCase().slice(0,2),c.extractionConfidence+=.1;break}}const w=[/(?:Issue\s+Date|Original\s+Issue)\s*[#:]?\s*(\d{1,2}\/\d{1,2}\/\d{4})/gi,/(?:ISSUED)\s*[#:]?\s*(\d{1,2}\/\d{1,2}\/\d{4})/gi],D=[/(?:Expiration\s+Date|Current\s+Expiration)\s*[#:]?\s*(\d{1,2}\/\d{1,2}\/\d{4})/gi,/(?:EXPIRES?)\s*[#:]?\s*(\d{1,2}\/\d{1,2}\/\d{4})/gi];for(const k of w){const Z=[...a.matchAll(k)];if(Z.length>0){c.cdlIssueDate=this.standardizeDate(Z[0][1].trim()),c.extractionConfidence+=.1;break}}for(const k of D){const Z=[...a.matchAll(k)];if(Z.length>0){c.cdlExpirationDate=this.standardizeDate(Z[0][1].trim()),c.extractionConfidence+=.15;break}}const b=[],v=/(?:COMMERCIAL\s+)?ENDORSEMENTS([^]*?)(?=RESTRICTIONS|MEDICAL|DRIVER RECORD|$)/i,E=a.match(v);if(E){const k=E[1],Z=/([A-Z])\s*[-]\s*([^\n\r]+)/g;[...k.matchAll(Z)].forEach(q=>{const se=q[1].trim();["H","N","P","S","T","X","W"].includes(se)&&b.push(se)})}const A=[/(?:ENDORSEMENTS?)\s*[#:]?\s*([HNTPSX\s,]+)/gi,/(?:ENDORSE)\s*[#:]?\s*([HNTPSX\s,]+)/gi];if(b.length===0)for(const k of A)[...a.matchAll(k)].forEach(le=>{const se=le[1].trim().match(/[HNTPSX]/g);se&&b.push(...se)});b.length>0&&(c.cdlEndorsements=[...new Set(b)],c.extractionConfidence+=.15);const X=[],C=/RESTRICTIONS([^]*?)(?=MEDICAL|DRIVER RECORD|California DMV|Texas DPS|$)/i,W=a.match(C);if(W){const k=W[1];if(!k.includes("NONE")){const Z=/([A-Z])\s*[-]\s*([^\n\r]+)/g;[...k.matchAll(Z)].forEach(q=>{const se=q[1].trim(),te=q[2].trim();X.push(`${se} - ${te}`)})}}X.length>0&&(c.cdlRestrictions=X,c.extractionConfidence+=.1)}const m=[/(?:DATE\s+OF\s+BIRTH|DOB|BIRTH\s+DATE)\s*[#:]?\s*(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4})/gi,/(?:BORN)\s*[#:]?\s*(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4})/gi];for(const g of m){const x=a.match(g);if(x){c.dateOfBirth=this.standardizeDate(x[0].replace(/^[^0-9]*/,"").trim()),c.extractionConfidence+=.1;break}}const h=Qi.validateDriverInfo(c);if(s==="medical_certificate"){const g=Qi.validateMedicalCertificate({certificateNumber:c.medicalCertNumber,issuedDate:c.medicalIssueDate,expirationDate:c.medicalExpirationDate,examinerName:c.examinerName,examinerNationalRegistry:c.examinerNationalRegistry,restrictions:c.medicalRestrictions});h.errors.push(...g.errors),h.warnings.push(...g.warnings),h.isValid=h.isValid&&g.isValid}if(s==="cdl"){const g=Qi.validateCDL({cdlNumber:c.cdlNumber,cdlClass:c.cdlClass,cdlState:c.cdlState,cdlIssueDate:c.cdlIssueDate,cdlExpirationDate:c.cdlExpirationDate,cdlEndorsements:c.cdlEndorsements});h.errors.push(...g.errors),h.warnings.push(...g.warnings),h.isValid=h.isValid&&g.isValid}return h.isValid||(h.errors.forEach(g=>{c.processingNotes.push(`Validation error - ${g.field}: ${g.message}`)}),c.extractionConfidence*=.8),h.warnings.forEach(g=>{c.processingNotes.push(`Warning - ${g.field}: ${g.message}`)}),c.needsReview=c.extractionConfidence<.7||!c.firstName||!c.lastName||!h.isValid,c.needsReview&&c.processingNotes.push("Low confidence extraction - manual review recommended"),console.log(` Driver validation for ${i}:`,h),c}standardizeDate(a){try{const i=a.replace(/[^\d\/\-]/g,"").split(/[\/\-]/);if(i.length===3){let c=parseInt(i[2]),u=parseInt(i[0]),m=parseInt(i[1]);return c<100&&(c+=c<50?2e3:1900),`${c}-${u.toString().padStart(2,"0")}-${m.toString().padStart(2,"0")}`}return a}catch(s){return console.warn("Error standardizing date:",a,s),a}}extractRegistrationSpecificData(a,s){const i=[/(?:REG|REGISTRATION)\s*(?:NUMBER|NO|#)?\s*[:#]?\s*([A-Z0-9\-]+)/gi,/(?:CERTIFICATE|CERT)\s*(?:NUMBER|NO|#)?\s*[:#]?\s*([A-Z0-9\-]+)/gi,/\b([A-Z]{2,3}[-\s]?[0-9]{6,8}[-\s]?[A-Z0-9]*)\b/g];for(const m of i){const h=a.match(m);if(h){s.registrationNumber=h[0].replace(/^(REG|REGISTRATION|CERTIFICATE|CERT)\s*(?:NUMBER|NO|#)?\s*[:#]?\s*/gi,"").trim();break}}const c=[/\b(AL|AK|AZ|AR|CA|CO|CT|DE|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY)\b/g,/\b(TEXAS|CALIFORNIA|FLORIDA|NEW\s+YORK|PENNSYLVANIA|ILLINOIS|OHIO|GEORGIA|NORTH\s+CAROLINA|MICHIGAN)\b/gi];for(const m of c){const h=a.match(m);if(h){let g=h[0].toUpperCase();const x={TEXAS:"TX",CALIFORNIA:"CA",FLORIDA:"FL","NEW YORK":"NY",PENNSYLVANIA:"PA",ILLINOIS:"IL",OHIO:"OH",GEORGIA:"GA","NORTH CAROLINA":"NC",MICHIGAN:"MI"};s.registrationState=x[g]||g;break}}const u=[/(?:OWNER|REGISTERED\s+TO|REGISTRANT)\s*:?\s*([A-Z][A-Z\s,\.&]+(?:LLC|INC|CORP|CO|COMPANY|TRUCKING)*)/gi,/(?:NAME)\s*:?\s*([A-Z][A-Z\s,\.&]+(?:LLC|INC|CORP|CO|COMPANY|TRUCKING)*)/gi];for(const m of u){const h=a.match(m);if(h){s.registeredOwner=h[0].replace(/^(OWNER|REGISTERED\s+TO|REGISTRANT|NAME)\s*:?\s*/gi,"").trim();break}}}extractInsuranceSpecificData(a,s){console.log(` Extracting insurance data from: ${s.sourceFileName}`);const i=[/(?:CARRIER|COMPANY|INSURER)\s*:?\s*([A-Z\s&]+)/gi,/\b(STATE\s+FARM|GEICO|PROGRESSIVE|ALLSTATE|FARMERS|LIBERTY\s+MUTUAL|NATIONWIDE|USAA)\b/gi];for(const m of i){const h=a.match(m);if(h){s.insuranceCarrier=h[0].replace(/^(CARRIER|COMPANY|INSURER)\s*:?\s*/gi,"").trim();break}}const c=a.match(/(?:POLICY|POL)\s*[#:]?\s*([A-Z0-9\-]+)/gi);c&&(s.policyNumber=c[0].replace(/^(POLICY|POL)\s*[#:]?\s*/gi,""));const u=a.match(/\$[\d,]+/g);if(u){const m=u[0].replace(/[$,]/g,"");s.coverageAmount=parseInt(m)}console.log(` Insurance extraction complete for ${s.sourceFileName}:`,{carrier:s.insuranceCarrier,policy:s.policyNumber,expiry:s.insuranceExpiry,coverage:s.coverageAmount})}async getDocumentPreview(a){return a.type.startsWith("image/")?`IMAGE_${a.name}`:(await this.readAsText(a)).substring(0,1e3)}classifyByContent(a){const s=a.toLowerCase(),i=["registration","department of motor vehicles","dmv","vehicle title","license plate"],c=i.reduce((h,g)=>h+(s.includes(g)?1:0),0)/i.length,u=["insurance","policy","coverage","premium","certificate","liability"],m=u.reduce((h,g)=>h+(s.includes(g)?1:0),0)/u.length;return c>m&&c>.3?{type:"registration",confidence:c}:m>.3?{type:"insurance",confidence:m}:{type:"unknown",confidence:.1}}mergeVehicleData(a){console.log(" DEBUG: Input data analysis"),console.log(` Starting vehicle merge process for ${a.length} records`),console.log(`
 DETAILED INPUT ANALYSIS:`),a.forEach((w,D)=>{console.log(`Record ${D+1} (${w.sourceFileName}):`),console.log(`  Raw VIN: "${w.vin}"`),console.log(`  Normalized VIN: "${w.vin?w.vin.replace(/[^A-Z0-9]/g,"").toUpperCase():"NONE"}"`),console.log(`  License Plate: "${w.licensePlate}"`),console.log(`  Document Type: "${w.documentType}"`),console.log(`  Make/Model/Year: "${w.make}" / "${w.model}" / ${w.year}`),console.log(`  Confidence: ${w.extractionConfidence}`),console.log("---")});const s={},i=[],c={};i.push(`Starting merge for ${a.length} records`);const u={},m={},h={};a.forEach(w=>{if(w.vin&&w.vin.length>=10){const b=w.vin.replace(/\s+/g,"").toUpperCase();u[b]=(u[b]||0)+1}if(w.licensePlate&&w.licensePlate.length>=2){const b=w.licensePlate.replace(/\s+/g,"").toUpperCase();m[b]=(m[b]||0)+1}const D=this.extractVehicleKeyFromFilename(w.sourceFileName);h[D]=(h[D]||0)+1}),console.log(`
 Vehicle identifier analysis:`,{vins:Object.keys(u).length,plates:Object.keys(m).length,filePatterns:Object.keys(h).length,vinCounts:u,plateCounts:m,filePatterns:h}),i.push(`Analysis found: ${Object.keys(u).length} unique VINs, ${Object.keys(m).length} unique plates`),console.log(`
 KEY GENERATION AND MERGING PROCESS:`),a.forEach((w,D)=>{let b=this.generateSmartVehicleKey(w,u,m,h);if(console.log(`
 Processing record ${D+1}: ${w.sourceFileName}`),console.log(`  Generated key: "${b}"`),console.log(`  VIN: "${w.vin}" | Plate: "${w.licensePlate}" | Type: "${w.documentType}"`),c[b]||(c[b]=[]),c[b].push(w.sourceFileName),s[b]){const v=s[b];console.log(` DUPLICATE DETECTED! Merging with existing key: "${b}"`),console.log(`  Previous file: ${v.sourceFileName}`),console.log(`  Current file: ${w.sourceFileName}`),console.log(`  Files using this key: [${c[b].join(", ")}]`),i.push(`MERGED: ${w.sourceFileName} with existing record (key: ${b})`),s[b]={vin:this.selectBestValue(v.vin,w.vin,E=>E&&E.length===17),licensePlate:this.selectBestValue(v.licensePlate,w.licensePlate,E=>E&&E.length>=2),make:this.selectBestValue(v.make,w.make,E=>E&&E.length>0),model:this.selectBestValue(v.model,w.model,E=>E&&E.length>0),year:this.selectBestValue(v.year,w.year,E=>E&&E>1990&&E<=new Date().getFullYear()+1),truckNumber:this.selectBestValue(v.truckNumber,w.truckNumber,E=>E&&E.length>0),dotNumber:this.selectBestValue(v.dotNumber,w.dotNumber,E=>E&&E.length>0),registrationNumber:this.selectBestValue(v.registrationNumber,w.registrationNumber,E=>E&&E.length>0),registrationState:this.selectBestValue(v.registrationState,w.registrationState,E=>E&&E.length===2),registrationExpiry:this.selectBestValue(v.registrationExpiry,w.registrationExpiry,E=>E&&this.isValidDate(E)),registeredOwner:this.selectBestValue(v.registeredOwner,w.registeredOwner,E=>E&&E.length>0),insuranceCarrier:this.selectBestValue(v.insuranceCarrier,w.insuranceCarrier,E=>E&&E.length>0),policyNumber:this.selectBestValue(v.policyNumber,w.policyNumber,E=>E&&E.length>0),insuranceExpiry:this.selectBestValue(v.insuranceExpiry,w.insuranceExpiry,E=>E&&this.isValidDate(E)),coverageAmount:this.selectBestValue(v.coverageAmount,w.coverageAmount,E=>E&&E>0),documentType:this.combineDocumentTypes(v.documentType,w.documentType),sourceFileName:`${v.sourceFileName}, ${w.sourceFileName}`,processingNotes:[...v.processingNotes||[],...w.processingNotes||[]],extractionConfidence:Math.max(v.extractionConfidence||0,w.extractionConfidence||0),needsReview:v.needsReview||w.needsReview,lastUpdated:new Date().toISOString(),...v,...w},s[b].processingNotes=s[b].processingNotes||[],s[b].processingNotes.push(`Merged data from ${w.documentType} document: ${w.sourceFileName}`)}else s[b]={...w,lastUpdated:new Date().toISOString()},console.log(` NEW RECORD for key: "${b}"`),console.log(`  First file with this key: ${w.sourceFileName}`),i.push(`NEW: ${w.sourceFileName} created new record (key: ${b})`)});const g=Object.values(s);console.log(`
 FINAL MERGE RESULTS:`),console.log(`Original records: ${a.length} -> Final vehicles: ${g.length}`),console.log(`
 KEY USAGE SUMMARY:`),Object.entries(c).forEach(([w,D])=>{console.log(`Key "${w}": ${D.length} files`),D.forEach((b,v)=>{console.log(`  ${v+1}. ${b}`)})}),console.log(`
 MERGE SUMMARY:`),i.forEach(w=>console.log(`   ${w}`));const x=i.filter(w=>w.startsWith("MERGED:")).length,y=i.filter(w=>w.startsWith("NEW:")).length;return console.log(`
 Final Stats: ${x} merges performed, ${y} new records created`),y===1&&x===a.length-1?console.log(` SUCCESS: Perfect merge! All ${a.length} files merged into 1 vehicle`):y===a.length?console.log(" NO MERGING: All files created separate vehicles (merging failed)"):console.log(` PARTIAL MERGE: ${a.length} files -> ${y} vehicles`),g}generateSmartVehicleKey(a,s,i,c){if(a.vin){const m=a.vin.replace(/[^A-Z0-9]/g,"").toUpperCase();if(m.length===17)return console.log(` Using VIN key: ${m} (from file: ${a.sourceFileName})`),`VIN:${m}`;console.log(` Invalid VIN length (${m.length}): ${m} from ${a.sourceFileName}`)}if(a.licensePlate){const m=a.licensePlate.replace(/[^A-Z0-9]/g,"").toUpperCase();if(m.length>=2)return console.log(` Using PLATE key: ${m} (from file: ${a.sourceFileName})`),`PLATE:${m}`}const u=this.extractVehicleKeyFromFilename(a.sourceFileName);if(u&&u!=="UNKNOWN")return console.log(` Using PATTERN key: ${u} (from file: ${a.sourceFileName})`),`PATTERN:${u}`;if(a.make&&a.model&&a.year){const m=`${a.make}_${a.model}_${a.year}`.replace(/\s+/g,"_").toUpperCase();return console.log(` Using VEHICLE key: ${m} (from file: ${a.sourceFileName})`),`VEHICLE:${m}`}return console.log(` Using FILE key: ${a.sourceFileName} (no reliable identifiers found)`),`FILE:${a.sourceFileName}`}extractVehicleKeyFromFilename(a){const s=[/(\d{3})/,/([A-Z]{2,3}\d{3,4})/,/MTS[-_]?(\d+)/i,/(truck|vehicle)[-_]?(\d+)/i];for(const i of s){const c=a.match(i);if(c)return c[1]||c[0]}return a.replace(/\.[^.]+$/,"").replace(/[^a-zA-Z0-9]/g,"_")}selectBestValue(a,s,i){return a&&s&&i(a)&&i(s)||s&&i(s)?s:a&&i(a)?a:s||a}combineDocumentTypes(a,s){return a===s?a:a?s?[a,s].sort().join("+"):a:s}isValidDate(a){if(!a)return!1;const s=new Date(a);return!isNaN(s.getTime())&&s.getFullYear()>1990&&s.getFullYear()<2050}detectAndRemoveDuplicates(a,s){console.log(` Starting duplicate detection for ${a.length} ${s} records`);const i={},c=[],u=[];return a.forEach(m=>{const h=this.generateDuplicateKeys(m,s);let g=!1;for(const x of h)if(i[x]){i[x].push(m),g=!0;break}if(!g){const x=h[0];i[x]=[m]}}),Object.entries(i).forEach(([m,h])=>{if(h.length===1)c.push(h[0]);else{console.log(` Found ${h.length} duplicates for key: ${m}`);const g=this.selectBestRecord(h,s),x=h.filter(y=>y!==g);c.push(g),u.push({key:m,removed:x,kept:g}),console.log(` Removed ${x.length} duplicates for ${m}:`,{kept:{source:g.sourceFileName,confidence:g.extractionConfidence,documentDate:this.getDocumentDate(g,s)},removed:x.map(y=>({source:y.sourceFileName,confidence:y.extractionConfidence,documentDate:this.getDocumentDate(y,s)}))})}}),u.forEach(({key:m,removed:h,kept:g})=>{g.processingNotes||(g.processingNotes=[]),g.processingNotes.push(`Duplicate detection: Kept this record over ${h.length} duplicate(s) for ${m}`),g.processingNotes.push(`Removed sources: ${h.map(x=>x.sourceFileName).join(", ")}`)}),console.log(` Duplicate detection complete: ${a.length}  ${c.length} records (removed ${a.length-c.length} duplicates)`),c}generateDuplicateKeys(a,s){const i=[];if(s==="vehicle"){const c=a;c.vin&&c.vin.length>=10&&i.push(`VIN:${c.vin.toUpperCase()}`),c.registrationNumber&&c.registrationState&&i.push(`REG:${c.registrationState}:${c.registrationNumber}`),c.licensePlate&&c.registrationState&&i.push(`PLATE:${c.registrationState}:${c.licensePlate}`),c.policyNumber&&i.push(`POLICY:${c.policyNumber}`)}else{const c=a;if(c.cdlNumber&&c.cdlState&&i.push(`CDL:${c.cdlState}:${c.cdlNumber}`),c.medicalCertNumber&&i.push(`MED:${c.medicalCertNumber}`),c.employeeId&&i.push(`EMP:${c.employeeId}`),c.firstName&&c.lastName&&c.dateOfBirth){const u=`${c.firstName} ${c.lastName}`.toLowerCase();i.push(`NAME:${u}:${c.dateOfBirth}`)}}return i}selectBestRecord(a,s){console.log(` Selecting best record from ${a.length} duplicates`);const i=a.map(u=>({record:u,score:this.calculateRecordScore(u,s)}));i.sort((u,m)=>m.score-u.score);const c=i[0].record;return console.log(" Record scores:",i.map(u=>({source:u.record.sourceFileName,score:u.score,confidence:u.record.extractionConfidence}))),c}calculateRecordScore(a,s){let i=0;i+=(a.extractionConfidence||0)*100;const c=this.getDocumentDate(a,s);if(c){const h=(Date.now()-c.getTime())/864e5,g=Math.max(0,50-h/365*10);i+=g}const u=this.calculateCompletenessScore(a,s);i+=u;const m=this.calculateSourceReliabilityScore(a.sourceFileName);return i+=m,i}getDocumentDate(a,s){let i;if(s==="vehicle"){const u=a;i=u.registrationExpiry||u.insuranceExpiry}else{const u=a;i=u.cdlExpirationDate||u.medicalExpirationDate}if(!i)return null;const c=new Date(i);return isNaN(c.getTime())?null:c}calculateCompletenessScore(a,s){if(s==="vehicle"){const i=a,c=[i.vin,i.licensePlate,i.make,i.model,i.year];return c.filter(m=>m&&m.toString().length>0).length/c.length*30}else{const i=a,c=[i.firstName,i.lastName,i.cdlNumber,i.cdlExpirationDate];return c.filter(m=>m&&m.toString().length>0).length/c.length*30}}calculateSourceReliabilityScore(a){const s=a.toLowerCase();return s.includes("dmv")||s.includes("dot")||s.includes("official")?20:s.includes("insurance")||s.includes("policy")?15:s.includes("registration")||s.includes("reg")?10:5}async processDocumentsWithClaude(a,s){const i=Date.now(),c=a.length;try{s==null||s(10,"Initializing Claude Vision processor...");const u=Array.from(a);s==null||s(20,`Processing ${c} documents with Claude Vision...`);const m=await Ph.processDocuments(u);s==null||s(70,"Converting Claude results to TruckBo format...");const h=[],g=[];m.forEach((v,E)=>{var A,X;if(v.success&&v.data){const C=v.data,W=u[E].name;if(console.log(` Processing Claude result for ${W}:`,{documentType:C.documentType,vin:C.extractedData.vin,licensePlate:C.extractedData.licensePlate,confidence:C.confidence}),["registration","insurance","inspection"].includes(C.documentType)){const k={vin:C.extractedData.vin?C.extractedData.vin.replace(/\s+/g,"").toUpperCase():"",licensePlate:C.extractedData.licensePlate?C.extractedData.licensePlate.replace(/\s+/g,"").toUpperCase():"",make:C.extractedData.make||"",model:C.extractedData.model||"",year:parseInt(C.extractedData.year||"0")||0,registrationNumber:C.extractedData.registrationNumber||"",registrationState:C.extractedData.state||"",registrationExpiry:C.extractedData.expirationDate||"",policyNumber:C.extractedData.policyNumber||"",insuranceCarrier:C.extractedData.insuranceCompany||"",insuranceExpiry:C.extractedData.expirationDate||"",coverageAmount:parseFloat(C.extractedData.coverageAmount||"0")||0,sourceFileName:W,extractionConfidence:C.confidence,needsReview:C.requiresReview||!1,processingNotes:C.processingNotes||[],documentType:C.documentType,lastUpdated:new Date().toISOString()},Z=this.normalizeExtractedData(k);h.push(Z)}if(["medical_certificate","cdl_license"].includes(C.documentType)){const k={firstName:((A=C.extractedData.driverName)==null?void 0:A.split(" ")[0])||"",lastName:((X=C.extractedData.driverName)==null?void 0:X.split(" ").slice(1).join(" "))||"",cdlNumber:C.extractedData.licenseNumber||"",cdlState:C.extractedData.state||"",cdlClass:C.extractedData.licenseClass,cdlExpirationDate:C.extractedData.expirationDate||"",cdlEndorsements:C.extractedData.endorsements||[],medicalCertNumber:C.extractedData.medicalCertificateNumber||"",examinerName:C.extractedData.medicalExaminerName||"",medicalExpirationDate:C.extractedData.expirationDate||"",medicalRestrictions:C.extractedData.restrictions||[],sourceFileName:W,extractionConfidence:C.confidence,needsReview:C.requiresReview||!1,processingNotes:C.processingNotes||[],documentType:C.documentType};g.push(k)}}}),s==null||s(90,"Finalizing results...");const x={totalFiles:c,processedFiles:m.filter(v=>v.success).length,failedFiles:m.filter(v=>!v.success).length,vehiclesFound:h.length,driversFound:g.length,processingTime:Date.now()-i,claudeStats:Ph.getProcessingStats(m),averageConfidence:m.filter(v=>v.success&&v.data).reduce((v,E)=>{var A;return v+(((A=E.data)==null?void 0:A.confidence)||0)},0)/m.filter(v=>v.success).length,documentsRequiringReview:m.filter(v=>{var E;return v.success&&((E=v.data)==null?void 0:E.requiresReview)}).length};s==null||s(85,"Merging related documents...");const y=this.mergeVehicleData(h),w=g;s==null||s(90,"Detecting and removing remaining duplicates...");const D=this.detectAndRemoveDuplicates(y,"vehicle"),b=this.detectAndRemoveDuplicates(w,"driver");return x.mergeStats={originalVehicles:h.length,afterMerge:y.length,finalVehicles:D.length,documentsPerVehicle:h.length/(D.length||1)},x.duplicatesRemoved={vehicles:y.length-D.length,drivers:w.length-b.length},s==null||s(100,`Processing complete! Found ${D.length} vehicles and ${b.length} drivers`),{vehicleData:D,driverData:b,processingStats:x,claudeResults:m}}catch(u){throw console.error("Claude document processing error:",u),new Error(`Document processing failed: ${u instanceof Error?u.message:"Unknown error"}`)}}async processDocumentsHybrid(a,s){try{s==null||s(0,"Attempting Claude Vision processing...");const c=await this.processDocumentsWithClaude(a,(u,m)=>{s==null||s(u*.8,m)});if(c.vehicleData.length>0||c.driverData.length>0)return{vehicleData:c.vehicleData,driverData:c.driverData,processingStats:c.processingStats}}catch(c){console.warn("Claude processing failed, falling back to Tesseract:",c)}s==null||s(80,"Claude processing incomplete, using Tesseract OCR fallback...");const i=await this.processBulkDocuments(a);return{vehicleData:i.vehicleData,driverData:i.driverData,processingStats:{...i.summary||{},usedFallback:!0,fallbackReason:"Claude processing failed or returned no results"}}}normalizeExtractedData(a){console.log(` Normalizing data from ${a.sourceFileName}:`,{originalVin:a.vin,originalPlate:a.licensePlate});const s={...a,vin:a.vin?this.normalizeVin(a.vin):"",licensePlate:a.licensePlate?this.normalizeLicensePlate(a.licensePlate):""};return console.log(" Normalized result:",{normalizedVin:s.vin,normalizedPlate:s.licensePlate,vinChanged:a.vin!==s.vin,plateChanged:a.licensePlate!==s.licensePlate}),s}normalizeVin(a){if(!a)return"";console.log(` Normalizing VIN: "${a}"`);const s=a.replace(/[^A-Z0-9]/g,"").toUpperCase();if(console.log(`   Cleaned: "${s}" (${s.length} chars)`),s.length>=15&&s.length<=19){const i=s.replace(/O(?=\d)/g,"0").replace(new RegExp("(?<=\\d)O","g"),"0").replace(/I(?=\d)/g,"1").replace(new RegExp("(?<=\\d)I","g"),"1").replace(/S(?=\d)/g,"5").replace(new RegExp("(?<=\\d)S","g"),"5").replace(/G(?=\d)/g,"6").replace(new RegExp("(?<=\\d)G","g"),"6");if(console.log(`   OCR fixed: "${i}" (${i.length} chars)`),i.length===17)return console.log(` VIN normalized successfully: ${a} -> ${i}`),i}return console.log(` VIN normalization incomplete: ${a} -> ${s} (${s.length} chars)`),s}normalizeLicensePlate(a){if(!a)return"";const s=a.replace(/[^A-Z0-9]/g,"").toUpperCase();return console.log(` License plate normalized: "${a}" -> "${s}"`),s}}const Zt=new Qy,Rg=({isOpen:f,onClose:a,onDocumentsProcessed:s})=>{const[i,c]=K.useState("upload"),[u,m]=K.useState(null),[h,g]=K.useState(null),[x,y]=K.useState(!1),[w,D]=K.useState(0),[b,v]=K.useState(null),E=K.useRef(null),A=K.useRef(null),X=()=>{c("upload"),m(null),g(null),y(!1),D(0),v(null)},C=()=>{X(),a()},W=te=>{te&&te.length>0&&(m(te),v(null),console.log(` Selected ${te.length} files for processing`))},k=te=>{W(te.target.files)},Z=te=>{W(te.target.files)},le=async()=>{var te,Ce,ee,be,ae,de,V,M;if(!u){v("Please select files to process");return}y(!0),c("processing"),D(0);try{const j=setInterval(()=>{D(N=>Math.min(N+10,90))},500);console.log(` Starting Claude Vision processing for ${u.length} files`);const P=await Zt.processDocumentsWithClaude(u,(N,T)=>{D(Math.min(N,90)),console.log(` Progress: ${N}% - ${T}`)}),I={vehicleData:P.vehicleData,driverData:P.driverData,unprocessedFiles:P.claudeResults.filter(N=>!N.success).map((N,T)=>`File ${T+1}`),errors:P.claudeResults.filter(N=>!N.success).map((N,T)=>({fileName:`File ${T+1}`,error:N.error||"Unknown error"})),summary:{totalFiles:u.length,processed:P.processingStats.processedFiles,registrationDocs:((Ce=(te=P.processingStats.claudeStats)==null?void 0:te.documentTypes)==null?void 0:Ce.registration)||0,insuranceDocs:((be=(ee=P.processingStats.claudeStats)==null?void 0:ee.documentTypes)==null?void 0:be.insurance)||0,medicalCertificates:((de=(ae=P.processingStats.claudeStats)==null?void 0:ae.documentTypes)==null?void 0:de.medical_certificate)||0,cdlDocuments:((M=(V=P.processingStats.claudeStats)==null?void 0:V.documentTypes)==null?void 0:M.cdl_license)||0,duplicatesFound:u.length-P.vehicleData.length}};clearInterval(j),D(100),g(I),c("review"),console.log(` Processing complete: ${I.summary.processed} files processed`)}catch(j){v(j instanceof Error?j.message:"Processing failed"),c("upload")}finally{y(!1)}},q=()=>{h&&(s(h.vehicleData),c("complete"),setTimeout(()=>{C()},2e3))},se=te=>{switch(te.toLowerCase().split(".").pop()){case"pdf":return"";case"jpg":case"jpeg":case"png":return"";case"doc":case"docx":return"";default:return""}};return f?r.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-y-auto",children:[r.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6 rounded-t-2xl",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-black",children:" AI Document Processing"}),r.jsx("p",{className:"text-purple-100 mt-1",children:"Upload registration & insurance documents for automatic processing"})]}),r.jsx("button",{onClick:C,className:"w-10 h-10 bg-white/20 hover:bg-white/30 rounded-xl flex items-center justify-center transition-colors duration-200",children:r.jsx("span",{className:"text-xl",children:""})})]})}),r.jsxs("div",{className:"p-6",children:[b&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-red-500 text-xl mr-3",children:""}),r.jsx("span",{className:"text-red-700 font-medium",children:b})]})}),i==="upload"&&r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-blue-600 text-2xl",children:""})})}),r.jsxs("div",{className:"ml-4 flex-1",children:[r.jsx("h3",{className:"font-bold text-blue-800 mb-2",children:"AI-Powered Document Processing"}),r.jsx("p",{className:"text-blue-700 text-sm mb-3",children:"Our AI can automatically extract vehicle information from:"}),r.jsxs("ul",{className:"text-blue-700 text-sm space-y-1 mb-4",children:[r.jsx("li",{children:" Vehicle registration documents"}),r.jsx("li",{children:" Insurance certificates and policies"}),r.jsx("li",{children:" Title documents"}),r.jsx("li",{children:" PDF, JPG, PNG, and DOC files"})]}),r.jsx("div",{className:"bg-blue-100 rounded-lg p-3",children:r.jsx("p",{className:"text-blue-800 text-xs font-medium",children:' Pro Tip: Organize your files with clear names like "truck_123_registration.pdf" or "insurance_policy_2024.pdf"'})})]})]})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"border-2 border-dashed border-purple-300 rounded-xl p-8 text-center hover:border-purple-400 transition-colors duration-200",children:[r.jsx("input",{ref:A,type:"file",multiple:!0,webkitdirectory:"",onChange:k,className:"hidden",accept:".pdf,.jpg,.jpeg,.png,.tiff,.doc,.docx,.txt"}),r.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-2xl flex items-center justify-center text-white text-3xl font-bold mx-auto mb-4",children:""}),r.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Upload Entire Folder"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"Select a folder containing all your vehicle documents"}),r.jsx("button",{onClick:()=>{var te;return(te=A.current)==null?void 0:te.click()},className:"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 hover:scale-105 active:scale-95",children:" Select Folder"})]}),r.jsxs("div",{className:"border-2 border-dashed border-indigo-300 rounded-xl p-8 text-center hover:border-indigo-400 transition-colors duration-200",children:[r.jsx("input",{ref:E,type:"file",multiple:!0,onChange:Z,className:"hidden",accept:".pdf,.jpg,.jpeg,.png,.tiff,.doc,.docx,.txt"}),r.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl flex items-center justify-center text-white text-3xl font-bold mx-auto mb-4",children:""}),r.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Select Multiple Files"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"Choose individual documents from different locations"}),r.jsx("button",{onClick:()=>{var te;return(te=E.current)==null?void 0:te.click()},className:"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 hover:scale-105 active:scale-95",children:" Select Files"})]})]}),u&&r.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[r.jsxs("h4",{className:"font-bold text-gray-900 mb-4",children:["Selected Files (",u.length,")"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mb-6",children:[Array.from(u).slice(0,12).map((te,Ce)=>r.jsxs("div",{className:"flex items-center p-3 bg-white rounded-lg border",children:[r.jsx("span",{className:"text-2xl mr-3",children:se(te.name)}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:te.name}),r.jsxs("p",{className:"text-xs text-gray-500",children:[(te.size/1024).toFixed(1)," KB"]})]})]},Ce)),u.length>12&&r.jsx("div",{className:"flex items-center justify-center p-3 bg-gray-100 rounded-lg border-2 border-dashed",children:r.jsxs("span",{className:"text-gray-500 text-sm",children:["+",u.length-12," more files"]})})]}),r.jsx("button",{onClick:le,disabled:x,className:"w-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white px-8 py-4 rounded-2xl font-black text-lg shadow-xl shadow-purple-900/20 hover:shadow-2xl hover:shadow-purple-900/30 transition-all duration-300 hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:" Start AI Processing"})]})]}),i==="processing"&&r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"animate-spin text-6xl mb-6",children:""}),r.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"AI Processing Documents"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"Extracting vehicle information, registration dates, and insurance details..."}),r.jsxs("div",{className:"max-w-md mx-auto mb-6",children:[r.jsx("div",{className:"bg-gray-200 rounded-full h-3",children:r.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 h-3 rounded-full transition-all duration-500",style:{width:`${w}%`}})}),r.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[w,"% complete"]})]}),r.jsx("div",{className:"bg-blue-50 rounded-xl p-4 max-w-md mx-auto",children:r.jsx("p",{className:"text-blue-700 text-sm",children:" Using AI to identify VINs, license plates, expiry dates, and insurance details"})})]}),i==="review"&&h&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("span",{className:"text-green-500 text-2xl mr-3",children:""}),r.jsx("h3",{className:"text-xl font-bold text-green-800",children:"Processing Complete!"})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:h.summary.totalFiles}),r.jsx("div",{className:"text-sm text-green-700",children:"Files Uploaded"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:h.summary.processed}),r.jsx("div",{className:"text-sm text-blue-700",children:"Successfully Processed"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-purple-600",children:h.summary.registrationDocs}),r.jsx("div",{className:"text-sm text-purple-700",children:"Registration Docs"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:h.summary.insuranceDocs}),r.jsx("div",{className:"text-sm text-indigo-700",children:"Insurance Docs"})]})]})]}),r.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl",children:[r.jsxs("div",{className:"p-4 border-b border-gray-200",children:[r.jsx("h4",{className:"font-bold text-gray-900",children:"Extracted Vehicle Data"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Review and verify the AI-extracted information"})]}),r.jsx("div",{className:"max-h-96 overflow-y-auto",children:h.vehicleData.map((te,Ce)=>r.jsx("div",{className:`p-4 border-b border-gray-100 ${te.needsReview?"bg-yellow-50":"bg-white"}`,children:r.jsx("div",{className:"flex items-start justify-between",children:r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center mb-2",children:[r.jsx("span",{className:"text-lg mr-2",children:te.documentType==="registration"?"":""}),r.jsxs("h5",{className:"font-bold text-gray-900",children:[te.year," ",te.make," ",te.model||"Unknown Model"]}),te.needsReview&&r.jsx("span",{className:"ml-2 text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"Needs Review"})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-500",children:"VIN:"}),r.jsx("div",{className:"font-mono font-bold",children:te.vin||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-500",children:"License Plate:"}),r.jsx("div",{className:"font-bold",children:te.licensePlate||""})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-500",children:"Expiry Date:"}),r.jsx("div",{className:"font-bold",children:te.registrationExpiry||te.insuranceExpiry||""})]})]}),r.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Source: ",te.sourceFileName," | Confidence: ",Math.round(te.extractionConfidence*100),"%"]})]})})},Ce))})]}),(h.errors.length>0||h.unprocessedFiles.length>0)&&r.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4",children:[r.jsx("h4",{className:"font-bold text-amber-800 mb-2",children:"Attention Required"}),h.unprocessedFiles.length>0&&r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-sm text-amber-700 mb-1",children:"Unprocessed files:"}),r.jsx("ul",{className:"text-xs text-amber-600 list-disc list-inside",children:h.unprocessedFiles.map((te,Ce)=>r.jsx("li",{children:te},Ce))})]}),h.errors.length>0&&r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-amber-700 mb-1",children:"Processing errors:"}),r.jsx("ul",{className:"text-xs text-amber-600 list-disc list-inside",children:h.errors.map((te,Ce)=>r.jsxs("li",{children:[te.fileName,": ",te.error]},Ce))})]})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{onClick:()=>c("upload"),className:"flex-1 px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-xl font-bold transition-colors duration-200",children:" Process More Files"}),r.jsxs("button",{onClick:q,className:"flex-2 px-8 py-3 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white rounded-xl font-bold transition-all duration-200 hover:scale-105 active:scale-95",children:[" Add ",h.vehicleData.length," Vehicles to Fleet"]})]})]}),i==="complete"&&r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"text-6xl mb-4",children:""}),r.jsx("h3",{className:"text-2xl font-bold text-green-600 mb-2",children:"Documents Processed Successfully!"}),r.jsx("p",{className:"text-gray-600",children:"Vehicle data has been extracted and added to your fleet management system."}),r.jsx("div",{className:"mt-6",children:r.jsxs("div",{className:"inline-flex items-center text-green-600",children:[r.jsx("span",{className:"animate-spin mr-2",children:""}),"Closing automatically..."]})})]})]})]})}):null};class Jy{constructor(){ce(this,"STORAGE_KEY","truckbo_document_batches");ce(this,"listeners",[])}getProcessingState(){try{const a=localStorage.getItem(this.STORAGE_KEY);if(a)return JSON.parse(a)}catch(a){console.error("Error loading document processing state:",a)}return{batches:[],allExtractedData:[],reconciliationResult:null,totalDocumentsProcessed:0,lastProcessedAt:""}}saveProcessingState(a){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(a)),this.notifyListeners(a)}catch(s){console.error("Error saving document processing state:",s)}}async processBatch(a){console.log(` Processing new document batch: ${a.length} files`);const s=await Zt.processBulkDocuments(a),i={id:`batch_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date().toISOString(),totalFiles:a.length,processedFiles:s.summary.processed,registrationDocs:s.summary.registrationDocs,insuranceDocs:s.summary.insuranceDocs,extractedData:s.vehicleData,errors:s.errors},c=this.getProcessingState(),u={batches:[...c.batches,i],allExtractedData:[...c.allExtractedData,...i.extractedData],reconciliationResult:null,totalDocumentsProcessed:c.totalDocumentsProcessed+i.processedFiles,lastProcessedAt:i.timestamp};return u.reconciliationResult=this.reconcileVehicleData(u.allExtractedData),this.saveProcessingState(u),console.log(` Batch processed: ${i.processedFiles} documents, ${i.registrationDocs} registration, ${i.insuranceDocs} insurance`),i}reconcileVehicleData(a){console.log(` Reconciling vehicle data from ${a.length} extracted records`),a.forEach((y,w)=>{console.log(` Record ${w+1}: VIN=${y.vin}, Type=${y.documentType}, File=${y.sourceFileName}`),console.log(`   Registration Fields: ${y.registrationNumber?"":""} regNum, ${y.registrationExpiry?"":""} regExp`),console.log(`   Insurance Fields: ${y.insuranceCarrier?"":""} carrier, ${y.policyNumber?"":""} policy`)});const s={};a.forEach(y=>{const w=y.vin;w&&(s[w]||(s[w]={sources:[]}),y.documentType==="registration"?(console.log(` Assigning ${w} as REGISTRATION from ${y.sourceFileName}`),s[w].registration=y,s[w].sources.push(`Registration: ${y.sourceFileName}`)):y.documentType==="insurance"?(console.log(` Assigning ${w} as INSURANCE from ${y.sourceFileName}`),s[w].insurance=y,s[w].sources.push(`Insurance: ${y.sourceFileName}`)):console.log(` Unknown document type '${y.documentType}' for ${w} from ${y.sourceFileName}`))});const i=[],c=[],u=[],m=[];Object.entries(s).forEach(([y,w])=>{const D=!!w.registration,b=!!w.insurance,v=this.createMergedVehicleRecord(y,w.registration,w.insurance);w.sources.length>2&&m.push({vin:y,sources:w.sources}),D&&b?i.push(v):D?c.push(v):b&&u.push(v)});const h=i.length+c.length+u.length,g=h>0?Math.round(i.length/h*100):0,x={completeVehicles:i,registrationOnly:c,insuranceOnly:u,duplicates:m,summary:{totalVehicles:h,fullyDocumented:i.length,missingInsurance:c.length,missingRegistration:u.length,reconciliationScore:g}};return console.log(` Reconciliation complete: ${x.summary.fullyDocumented}/${x.summary.totalVehicles} vehicles fully documented (${g}%)`),x}createMergedVehicleRecord(a,s,i){console.log(` Merging vehicle record for VIN: ${a}`),console.log(`   Registration data available: ${s?"":""}`,s?{file:s.sourceFileName,regNum:s.registrationNumber,regExp:s.registrationExpiry,regState:s.registrationState}:"none"),console.log(`   Insurance data available: ${i?"":""}`,i?{file:i.sourceFileName,carrier:i.insuranceCarrier,policy:i.policyNumber,insExp:i.insuranceExpiry}:"none");const c=s||i,u=s?i:void 0,m={id:`vehicle_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,vin:a,make:c.make||(u==null?void 0:u.make)||"Unknown",model:c.model||(u==null?void 0:u.model)||"Unknown",year:c.year||(u==null?void 0:u.year)||new Date().getFullYear(),licensePlate:c.licensePlate||(u==null?void 0:u.licensePlate)||"Unknown",dotNumber:c.dotNumber||(u==null?void 0:u.dotNumber),truckNumber:c.truckNumber||(u==null?void 0:u.truckNumber)||"",status:"active",dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString(),registrationNumber:s==null?void 0:s.registrationNumber,registrationState:s==null?void 0:s.registrationState,registrationExpiry:s==null?void 0:s.registrationExpiry,registeredOwner:s==null?void 0:s.registeredOwner,insuranceCarrier:i==null?void 0:i.insuranceCarrier,policyNumber:i==null?void 0:i.policyNumber,insuranceExpiry:i==null?void 0:i.insuranceExpiry,coverageAmount:i==null?void 0:i.coverageAmount};return console.log(` Created merged record for ${a}:`,{regFields:{registrationNumber:m.registrationNumber,registrationExpiry:m.registrationExpiry,registrationState:m.registrationState},insFields:{insuranceCarrier:m.insuranceCarrier,policyNumber:m.policyNumber,insuranceExpiry:m.insuranceExpiry,coverageAmount:m.coverageAmount}}),m.insuranceExpiry==="12/31/2024"&&(console.log(` DUPLICATE INSURANCE DATE DETECTED for ${a}! All showing 12/31/2024`),console.log(`   Insurance source file: ${i==null?void 0:i.sourceFileName}`),console.log("   Insurance raw extracted data:",i)),m}async applyReconciliation(){const a=this.getProcessingState();if(!a.reconciliationResult)throw new Error("No reconciliation data available - process documents first");console.log(` Applying reconciliation: ${a.reconciliationResult.summary.totalVehicles} vehicles`);const i=[...a.reconciliationResult.completeVehicles,...a.reconciliationResult.registrationOnly,...a.reconciliationResult.insuranceOnly].map(u=>{const{id:m,dateAdded:h,lastUpdated:g,...x}=u;return x}),c=ze.addVehicles(i);return console.log(` Applied reconciliation: ${c.successful.length} successful, ${c.failed.length} failed`),c}clearProcessingData(){const a={batches:[],allExtractedData:[],reconciliationResult:null,totalDocumentsProcessed:0,lastProcessedAt:""};this.saveProcessingState(a),console.log(" Cleared all document processing data")}subscribe(a){return this.listeners.push(a),()=>{this.listeners=this.listeners.filter(s=>s!==a)}}notifyListeners(a){this.listeners.forEach(s=>{try{s(a)}catch(i){console.error("Error in multi-batch processor listener:",i)}})}}const It=new Jy,Wy=({isOpen:f,onClose:a,onDocumentsReconciled:s})=>{var te,Ce;const[i,c]=K.useState("overview"),[u,m]=K.useState(null),[h,g]=K.useState(null),[x,y]=K.useState(!1),[w,D]=K.useState(0),[b,v]=K.useState(null),E=K.useRef(null);K.useEffect(()=>{if(f){const ee=It.getProcessingState();g(ee),c(ee.batches.length===0?"upload":"overview")}},[f]),K.useEffect(()=>It.subscribe(be=>{g(be)}),[]);const A=()=>{c("overview"),m(null),y(!1),D(0),v(null)},X=()=>{A(),a()},C=ee=>{ee&&ee.length>0&&(m(ee),v(null),console.log(` Selected ${ee.length} files for processing`))},W=ee=>{C(ee.target.files)},k=async()=>{if(!u){v("Please select files to process");return}y(!0),c("processing"),D(0);try{const ee=setInterval(()=>{D(be=>Math.min(be+10,90))},300);console.log(` Starting batch processing for ${u.length} files`),await It.processBatch(u),clearInterval(ee),D(100),c("reconciliation"),console.log(" Batch processing complete")}catch(ee){v(ee instanceof Error?ee.message:"Batch processing failed"),c("upload")}finally{y(!1)}},Z=async()=>{if(!(h!=null&&h.reconciliationResult)){v("No reconciliation data available");return}y(!0);try{const ee=await It.applyReconciliation();console.log(` Applied reconciliation: ${ee.successful.length} vehicles added to fleet`),s(ee.successful.length),c("complete"),setTimeout(()=>{X()},3e3)}catch(ee){v(ee instanceof Error?ee.message:"Failed to apply reconciliation")}finally{y(!1)}},le=()=>{It.clearProcessingData(),c("upload")},q=ee=>{switch(ee.toLowerCase().split(".").pop()){case"pdf":return"";case"jpg":case"jpeg":case"png":return"";case"doc":case"docx":return"";case"txt":return"";default:return""}},se=ee=>new Date(ee).toLocaleString();return f?r.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-y-auto",children:[r.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6 rounded-t-2xl",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-black",children:" Multi-Batch Document Processing"}),r.jsx("p",{className:"text-purple-100 mt-1",children:"Upload registration and insurance documents separately, then reconcile data"})]}),r.jsx("button",{onClick:X,className:"w-10 h-10 bg-white/20 hover:bg-white/30 rounded-xl flex items-center justify-center transition-colors duration-200",children:r.jsx("span",{className:"text-xl",children:""})})]})}),r.jsxs("div",{className:"p-6",children:[b&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-red-500 text-xl mr-3",children:""}),r.jsx("span",{className:"text-red-700 font-medium",children:b})]})}),i==="overview"&&r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-blue-600 text-2xl",children:""})})}),r.jsxs("div",{className:"ml-4 flex-1",children:[r.jsx("h3",{className:"font-bold text-blue-800 mb-2",children:"Multi-Batch Processing Overview"}),r.jsx("p",{className:"text-blue-700 text-sm mb-3",children:"This advanced document processor allows you to upload documents in multiple batches and intelligently reconcile the data:"}),r.jsxs("ul",{className:"text-blue-700 text-sm space-y-1",children:[r.jsx("li",{children:" Upload registration documents in one batch"}),r.jsx("li",{children:" Upload insurance documents in another batch"}),r.jsx("li",{children:" Automatic data reconciliation by VIN"}),r.jsx("li",{children:" Complete compliance data merging"})]})]})]})}),h&&r.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl",children:[r.jsx("div",{className:"p-4 border-b border-gray-200",children:r.jsx("h4",{className:"font-bold text-gray-900",children:"Processing Status"})}),r.jsxs("div",{className:"p-4",children:[r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:h.batches.length}),r.jsx("div",{className:"text-sm text-blue-700",children:"Batches Processed"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:h.totalDocumentsProcessed}),r.jsx("div",{className:"text-sm text-green-700",children:"Total Documents"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-purple-600",children:((te=h.reconciliationResult)==null?void 0:te.summary.fullyDocumented)||0}),r.jsx("div",{className:"text-sm text-purple-700",children:"Complete Vehicles"})]}),r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:[((Ce=h.reconciliationResult)==null?void 0:Ce.summary.reconciliationScore)||0,"%"]}),r.jsx("div",{className:"text-sm text-indigo-700",children:"Data Completeness"})]})]}),h.batches.length>0&&r.jsxs("div",{className:"mb-4",children:[r.jsx("h5",{className:"font-semibold text-gray-800 mb-2",children:"Recent Batches:"}),r.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:h.batches.slice(-3).map(ee=>r.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-lg mr-3",children:""}),r.jsxs("div",{children:[r.jsxs("div",{className:"text-sm font-medium",children:[ee.registrationDocs," registration, ",ee.insuranceDocs," insurance"]}),r.jsx("div",{className:"text-xs text-gray-500",children:se(ee.timestamp)})]})]}),r.jsxs("div",{className:"text-sm text-gray-600",children:[ee.processedFiles,"/",ee.totalFiles," files"]})]},ee.id))})]})]})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{onClick:()=>c("upload"),className:"flex-1 px-6 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white rounded-xl font-bold transition-all duration-200 hover:scale-105 active:scale-95",children:" Upload More Documents"}),(h==null?void 0:h.reconciliationResult)&&r.jsx("button",{onClick:()=>c("reconciliation"),className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white rounded-xl font-bold transition-all duration-200 hover:scale-105 active:scale-95",children:" View Reconciliation"}),(h==null?void 0:h.batches)&&h.batches.length>0&&r.jsx("button",{onClick:le,className:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-xl font-bold transition-all duration-200",children:" Clear All"})]})]}),i==="upload"&&r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-green-600 text-2xl",children:""})})}),r.jsxs("div",{className:"ml-4 flex-1",children:[r.jsx("h3",{className:"font-bold text-green-800 mb-2",children:"Upload Document Batch"}),r.jsx("p",{className:"text-green-700 text-sm mb-3",children:"You can upload documents in separate batches (e.g., all registration documents first, then all insurance documents). The system will automatically reconcile the data by VIN."}),r.jsx("div",{className:"bg-green-100 rounded-lg p-3",children:r.jsx("p",{className:"text-green-800 text-xs font-medium",children:" Pro Tip: Upload one document type at a time for better organization and reconciliation"})})]})]})}),r.jsxs("div",{className:"border-2 border-dashed border-purple-300 rounded-xl p-8 text-center hover:border-purple-400 transition-colors duration-200",children:[r.jsx("input",{ref:E,type:"file",multiple:!0,onChange:W,className:"hidden",accept:".pdf,.jpg,.jpeg,.png,.tiff,.doc,.docx,.txt"}),r.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-2xl flex items-center justify-center text-white text-3xl font-bold mx-auto mb-4",children:""}),r.jsx("h5",{className:"text-lg font-semibold text-gray-900 mb-2",children:u?`Selected: ${u.length} files`:"Select Document Batch"}),r.jsx("p",{className:"text-gray-500 mb-4",children:u?"Click process to continue":"Choose registration documents, insurance documents, or mixed batch"}),r.jsx("button",{onClick:()=>{var ee;return(ee=E.current)==null?void 0:ee.click()},className:"bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 hover:scale-105 active:scale-95",children:u?" Change Files":" Browse Files"})]}),u&&r.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[r.jsxs("h4",{className:"font-bold text-gray-900 mb-4",children:["Selected Files (",u.length,")"]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mb-6 max-h-60 overflow-y-auto",children:Array.from(u).map((ee,be)=>r.jsxs("div",{className:"flex items-center p-3 bg-white rounded-lg border",children:[r.jsx("span",{className:"text-2xl mr-3",children:q(ee.name)}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:ee.name}),r.jsxs("p",{className:"text-xs text-gray-500",children:[(ee.size/1024).toFixed(1)," KB"]})]})]},be))}),r.jsx("button",{onClick:k,disabled:x,className:"w-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white px-8 py-4 rounded-2xl font-black text-lg shadow-xl shadow-purple-900/20 hover:shadow-2xl hover:shadow-purple-900/30 transition-all duration-300 hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:" Process Batch"})]})]}),i==="processing"&&r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"animate-spin text-6xl mb-6",children:""}),r.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Processing Document Batch"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"Extracting vehicle information and preparing for reconciliation..."}),r.jsxs("div",{className:"max-w-md mx-auto mb-6",children:[r.jsx("div",{className:"bg-gray-200 rounded-full h-3",children:r.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 h-3 rounded-full transition-all duration-500",style:{width:`${w}%`}})}),r.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[w,"% complete"]})]})]}),i==="reconciliation"&&(h==null?void 0:h.reconciliationResult)&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("span",{className:"text-green-500 text-2xl mr-3",children:""}),r.jsx("h3",{className:"text-xl font-bold text-green-800",children:"Data Reconciliation Complete!"})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:h.reconciliationResult.summary.totalVehicles}),r.jsx("div",{className:"text-sm text-green-700",children:"Total Vehicles"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:h.reconciliationResult.summary.fullyDocumented}),r.jsx("div",{className:"text-sm text-blue-700",children:"Complete Records"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-orange-600",children:h.reconciliationResult.summary.missingInsurance}),r.jsx("div",{className:"text-sm text-orange-700",children:"Missing Insurance"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:h.reconciliationResult.summary.missingRegistration}),r.jsx("div",{className:"text-sm text-red-700",children:"Missing Registration"})]})]}),r.jsxs("div",{className:"bg-white rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Data Completeness"}),r.jsxs("span",{className:"text-sm font-bold text-purple-600",children:[h.reconciliationResult.summary.reconciliationScore,"%"]})]}),r.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 h-2 rounded-full transition-all duration-500",style:{width:`${h.reconciliationResult.summary.reconciliationScore}%`}})})]})]}),r.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl",children:[r.jsx("div",{className:"p-4 border-b border-gray-200",children:r.jsx("h4",{className:"font-bold text-gray-900",children:"Reconciliation Breakdown"})}),r.jsxs("div",{className:"p-4 space-y-4 max-h-60 overflow-y-auto",children:[h.reconciliationResult.completeVehicles.length>0&&r.jsxs("div",{children:[r.jsxs("h5",{className:"font-semibold text-green-700 mb-2",children:[" Complete Records (",h.reconciliationResult.completeVehicles.length,")"]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:h.reconciliationResult.completeVehicles.slice(0,4).map((ee,be)=>r.jsxs("div",{className:"p-2 bg-green-50 rounded border-l-4 border-green-500",children:[r.jsx("div",{className:"text-sm font-medium",children:ee.truckNumber||`#${ee.vin.slice(-3)}`}),r.jsxs("div",{className:"text-xs text-gray-600",children:[ee.make," ",ee.model,"  ",ee.vin.slice(-6)]})]},be))}),h.reconciliationResult.completeVehicles.length>4&&r.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["... and ",h.reconciliationResult.completeVehicles.length-4," more"]})]}),h.reconciliationResult.registrationOnly.length>0&&r.jsxs("div",{children:[r.jsxs("h5",{className:"font-semibold text-orange-700 mb-2",children:[" Missing Insurance (",h.reconciliationResult.registrationOnly.length,")"]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:h.reconciliationResult.registrationOnly.slice(0,4).map((ee,be)=>r.jsxs("div",{className:"p-2 bg-orange-50 rounded border-l-4 border-orange-500",children:[r.jsx("div",{className:"text-sm font-medium",children:ee.truckNumber||`#${ee.vin.slice(-3)}`}),r.jsxs("div",{className:"text-xs text-gray-600",children:[ee.make," ",ee.model,"  ",ee.vin.slice(-6)]})]},be))})]}),h.reconciliationResult.insuranceOnly.length>0&&r.jsxs("div",{children:[r.jsxs("h5",{className:"font-semibold text-red-700 mb-2",children:[" Missing Registration (",h.reconciliationResult.insuranceOnly.length,")"]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:h.reconciliationResult.insuranceOnly.slice(0,4).map((ee,be)=>r.jsxs("div",{className:"p-2 bg-red-50 rounded border-l-4 border-red-500",children:[r.jsx("div",{className:"text-sm font-medium",children:ee.truckNumber||`#${ee.vin.slice(-3)}`}),r.jsxs("div",{className:"text-xs text-gray-600",children:[ee.make," ",ee.model,"  ",ee.vin.slice(-6)]})]},be))})]})]})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{onClick:()=>c("upload"),className:"flex-1 px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-xl font-bold transition-colors duration-200",children:" Upload More Documents"}),r.jsx("button",{onClick:Z,disabled:x,className:"flex-2 px-8 py-3 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white rounded-xl font-bold transition-all duration-200 hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:x?" Applying...":` Add ${h.reconciliationResult.summary.totalVehicles} Vehicles to Fleet`})]})]}),i==="complete"&&r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"text-6xl mb-4",children:""}),r.jsx("h3",{className:"text-2xl font-bold text-green-600 mb-2",children:"Fleet Data Reconciled Successfully!"}),r.jsx("p",{className:"text-gray-600",children:"All vehicles have been processed and added to your fleet with complete compliance data."}),r.jsx("div",{className:"mt-6",children:r.jsxs("div",{className:"inline-flex items-center text-green-600",children:[r.jsx("span",{className:"animate-spin mr-2",children:""}),"Closing automatically..."]})})]})]})]})}):null};class ev{constructor(){ce(this,"testSuites",new Map);ce(this,"isRunning",!1)}async generateTestDocument(a,s){let i="",c="";a==="registration"?(i=`
VEHICLE REGISTRATION DOCUMENT
=============================

VEHICLE IDENTIFICATION NUMBER (VIN): ${s.vin}
MAKE: ${s.make}
MODEL: ${s.model}
YEAR: ${s.year}
LICENSE PLATE: ${s.licensePlate}

REGISTRATION NUMBER: ${s.registrationNumber||"REG-"+s.vin.slice(-6)}
REGISTRATION STATE: ${s.registrationState||"TX"}
REGISTRATION EXPIRES: ${s.registrationExpiry||"12/31/2024"}
REGISTERED OWNER: SUNBELT TRUCKING LLC

TRUCK NUMBER: ${s.truckNumber}
DOT NUMBER: 12345678
      `.trim(),c=`test_${s.truckNumber}_registration.txt`):(i=`
COMMERCIAL VEHICLE INSURANCE CERTIFICATE
=======================================

VEHICLE IDENTIFICATION NUMBER: ${s.vin}
VEHICLE: ${s.year} ${s.make} ${s.model}
LICENSE PLATE: ${s.licensePlate}

INSURANCE CARRIER: ${s.insuranceCarrier||"Progressive Commercial"}
POLICY NUMBER: ${s.policyNumber||"POL-"+s.vin.slice(-6)}
EXPIRATION DATE: ${s.insuranceExpiry||"12/31/2024"}
LIABILITY COVERAGE: $${s.coverageAmount||1e6}

INSURED: SUNBELT TRUCKING LLC
TRUCK NUMBER: ${s.truckNumber}
      `.trim(),c=`test_${s.truckNumber}_insurance.txt`);const u=new Blob([i],{type:"text/plain"});return new File([u],c,{type:"text/plain"})}async generateTestDocumentSet(a){const s=[],i=[],c=[];for(let u=1;u<=a;u++){const m=String(u).padStart(3,"0"),g={vin:`1HGBH41JXMN${String(1e5+u).slice(-6)}`,make:"FREIGHTLINER",model:"CASCADIA",year:2022,licensePlate:`TX${String(1e3+u)}`,truckNumber:m,registrationNumber:`REG-TX-${m}-2024`,registrationExpiry:`${String(u%12+1).padStart(2,"0")}/15/2024`,registrationState:"TX",insuranceCarrier:["Progressive Commercial","State Farm Commercial","Nationwide Commercial"][u%3],policyNumber:`POL-${m}-${String(2024+u%2)}`,insuranceExpiry:`12/31/${2024+u%2}`,coverageAmount:u%2===0?1e6:2e6},x=await this.generateTestDocument("registration",g),y=await this.generateTestDocument("insurance",g);s.push(x),i.push(y),c.push(g)}return{registrationFiles:s,insuranceFiles:i,expectedData:c}}async testDocumentProcessingAccuracy(a,s){const i=[];for(let c=0;c<a.length;c++){const u=a[c],m=s[c],h=Date.now();try{const g=this.createFileList([u]),x=await Zt.processBulkDocuments(g),y=Date.now()-h;if(x.vehicleData.length===0){i.push({testId:`DOC-ACC-${c+1}`,passed:!1,executionTime:y,actualResult:null,expectedResult:m,errorMessage:"No vehicle data extracted"});continue}const w=x.vehicleData[0],D=this.calculateExtractionAccuracy(w,m);i.push({testId:`DOC-ACC-${c+1}`,passed:D>=.9,executionTime:y,actualResult:{extracted:w,accuracy:D},expectedResult:m,details:{accuracy:D,processingResult:x}})}catch(g){i.push({testId:`DOC-ACC-${c+1}`,passed:!1,executionTime:Date.now()-h,actualResult:null,expectedResult:m,errorMessage:g instanceof Error?g.message:String(g)})}}return i}async testMultiBatchProcessing(a,s,i){const c=Date.now();try{It.clearProcessingData();const u=this.createFileList(a);await It.processBatch(u);const m=this.createFileList(s);await It.processBatch(m);const g=It.getProcessingState().reconciliationResult;if(!g)throw new Error("No reconciliation result available");const x=Date.now()-c,y=g.summary.totalVehicles,w=g.summary.fullyDocumented,D=g.summary.reconciliationScore;return{testId:"MULTI-BATCH-001",passed:y===i.length&&D>=90,executionTime:x,actualResult:{totalVehicles:y,fullyDocumented:w,reconciliationScore:D,completeVehicles:g.completeVehicles.length,registrationOnly:g.registrationOnly.length,insuranceOnly:g.insuranceOnly.length},expectedResult:{totalVehicles:i.length,reconciliationScore:100,completeVehicles:i.length},details:g}}catch(u){return{testId:"MULTI-BATCH-001",passed:!1,executionTime:Date.now()-c,actualResult:null,expectedResult:{totalVehicles:i.length},errorMessage:u instanceof Error?u.message:String(u)}}}async testPerformance(a){var i,c;const s=Date.now();try{console.log(` Starting performance test with ${a} documents...`),It.clearProcessingData();const u=await this.generateTestDocumentSet(a),m=Date.now(),h=performance.memory?performance.memory.usedJSHeapSize:null;console.log(` Processing ${a} registration documents...`);const g=Date.now(),x=this.createFileList(u.registrationFiles);await It.processBatch(x);const y=Date.now()-g;console.log(` Processing ${a} insurance documents...`);const w=Date.now(),D=this.createFileList(u.insuranceFiles);await It.processBatch(D);const b=Date.now()-w;console.log(" Performing data reconciliation...");const v=Date.now(),E=It.getProcessingState(),A=Date.now()-v,X=Date.now()-m,C=Date.now()-s,W=performance.memory?performance.memory.usedJSHeapSize:null,k=h&&W?W-h:null,Z=a*2,le=X/Z,q=Z/(X/1e3),se={timePerDocumentMs:a<=25?1e3:a<=50?1500:2e3,maxMemoryMB:a<=25?100:a<=50?200:500},te=le<se.timePerDocumentMs&&(!k||k<se.maxMemoryMB*1024*1024);return{testId:`PERF-${a}`,passed:te,executionTime:C,actualResult:{totalDocuments:Z,totalProcessingTime:X,registrationProcessingTime:y,insuranceProcessingTime:b,reconciliationTime:A,timePerDocument:Math.round(le),documentsPerSecond:Math.round(q*100)/100,initialMemoryMB:h?Math.round(h/1024/1024):null,finalMemoryMB:W?Math.round(W/1024/1024):null,memoryIncreaseMB:k?Math.round(k/1024/1024):null,vehiclesReconciled:((i=E.reconciliationResult)==null?void 0:i.summary.totalVehicles)||0,reconciliationScore:((c=E.reconciliationResult)==null?void 0:c.summary.reconciliationScore)||0},expectedResult:{timePerDocument:`<${se.timePerDocumentMs}ms`,memoryIncrease:`<${se.maxMemoryMB}MB`,reconciliationScore:">90%"},details:{generationTime:m-s,breakdown:{registration:y,insurance:b,reconciliation:A},thresholds:se}}}catch(u){return{testId:`PERF-${a}`,passed:!1,executionTime:Date.now()-s,actualResult:null,expectedResult:{documentCount:a},errorMessage:u instanceof Error?u.message:String(u)}}}async testErrorHandling(){var s,i,c,u,m,h,g,x;const a=[];console.log(" Starting comprehensive error handling tests...");try{console.log(" Testing empty file handling...");const y=new File([""],"empty.txt",{type:"text/plain"}),w=this.createFileList([y]),D=await Zt.processBulkDocuments(w),b=D.errors.length>0||D.unprocessedFiles.length>0||D.vehicleData.length===0;a.push({testId:"ERROR-001-EMPTY",passed:b,executionTime:0,actualResult:{vehicleDataCount:D.vehicleData.length,errorsCount:D.errors.length,unprocessedCount:D.unprocessedFiles.length,summary:D.summary},expectedResult:"Should handle empty file gracefully with no vehicle data extracted",details:{processingResult:D}}),console.log(` Empty file test: ${b?" PASSED":" FAILED"}`)}catch(y){a.push({testId:"ERROR-001-EMPTY",passed:!0,executionTime:0,actualResult:{errorThrown:!0,message:y instanceof Error?y.message:String(y)},expectedResult:"Error handling for empty file"}),console.log(" Empty file test:  PASSED (error thrown, which is acceptable)")}try{console.log(" Testing file with no vehicle data...");const y="This is just random text with no vehicle information at all. Lorem ipsum dolor sit amet.",w=new File([y],"no_data.txt",{type:"text/plain"}),D=this.createFileList([w]),b=await Zt.processBulkDocuments(D),v=b.vehicleData.length===0||b.vehicleData.length>0&&b.vehicleData[0].needsReview===!0||b.unprocessedFiles.includes("no_data.txt");a.push({testId:"ERROR-002-NO-DATA",passed:v,executionTime:0,actualResult:{vehicleDataCount:b.vehicleData.length,needsReview:(s=b.vehicleData[0])==null?void 0:s.needsReview,extractionConfidence:(i=b.vehicleData[0])==null?void 0:i.extractionConfidence,unprocessedFiles:b.unprocessedFiles},expectedResult:"Should handle files with no vehicle data by not extracting data or flagging for review",details:{processingResult:b}}),console.log(` No vehicle data test: ${v?" PASSED":" FAILED"}`)}catch(y){a.push({testId:"ERROR-002-NO-DATA",passed:!1,executionTime:0,actualResult:null,expectedResult:"Should handle files with no vehicle data",errorMessage:y instanceof Error?y.message:String(y)}),console.log(" No vehicle data test:  FAILED (unexpected error)")}try{console.log(" Testing malformed VIN handling...");const y=`
VEHICLE REGISTRATION
VIN: INVALID_VIN_TOO_SHORT
MAKE: FORD
MODEL: F150
LICENSE PLATE: ABC123
REGISTRATION EXPIRES: 12/31/2024
      `,w=new File([y],"malformed_vin.txt",{type:"text/plain"}),D=this.createFileList([w]),b=await Zt.processBulkDocuments(D),v=b.vehicleData.length===0||b.vehicleData.length>0&&(!b.vehicleData[0].vin||b.vehicleData[0].needsReview===!0);a.push({testId:"ERROR-003-MALFORMED-VIN",passed:v,executionTime:0,actualResult:{vehicleDataCount:b.vehicleData.length,extractedVin:(c=b.vehicleData[0])==null?void 0:c.vin,needsReview:(u=b.vehicleData[0])==null?void 0:u.needsReview,extractionConfidence:(m=b.vehicleData[0])==null?void 0:m.extractionConfidence,processingNotes:(h=b.vehicleData[0])==null?void 0:h.processingNotes},expectedResult:"Should reject malformed VIN or flag for review",details:{processingResult:b}}),console.log(` Malformed VIN test: ${v?" PASSED":" FAILED"}`)}catch(y){a.push({testId:"ERROR-003-MALFORMED-VIN",passed:!1,executionTime:0,actualResult:null,expectedResult:"Should handle malformed VIN gracefully",errorMessage:y instanceof Error?y.message:String(y)}),console.log(" Malformed VIN test:  FAILED (unexpected error)")}try{console.log(" Testing invalid VIN format handling...");const y=`VEHICLE REGISTRATION
INVALID VIN: THISISNOTAVALIDVIN
MAKE: CHEVROLET
MODEL: SILVERADO`,w=new File([y],"invalid_vin.txt",{type:"text/plain"}),D=this.createFileList([w]),b=await Zt.processBulkDocuments(D),v=b.vehicleData.length===0||b.vehicleData.length>0&&(!b.vehicleData[0].vin||b.vehicleData[0].needsReview===!0);a.push({testId:"ERROR-004-INVALID-VIN",passed:v,executionTime:0,actualResult:{vehicleDataCount:b.vehicleData.length,extractedVin:(g=b.vehicleData[0])==null?void 0:g.vin,needsReview:(x=b.vehicleData[0])==null?void 0:x.needsReview},expectedResult:"Should flag invalid VIN for review"}),console.log(` Invalid VIN test: ${v?" PASSED":" FAILED"}`)}catch(y){a.push({testId:"ERROR-004-INVALID-VIN",passed:!1,executionTime:0,actualResult:null,expectedResult:"Should handle invalid VIN gracefully",errorMessage:y instanceof Error?y.message:String(y)}),console.log(" Invalid VIN test:  FAILED (unexpected error)")}try{console.log(" Testing unsupported file format handling...");const y=`VIN: 1HGBH41JXMN109186
MAKE: HONDA
MODEL: CIVIC`,w=new File([y],"test.xyz",{type:"application/unknown"}),D=this.createFileList([w]),b=await Zt.processBulkDocuments(D),v=b.vehicleData.length===0&&(b.unprocessedFiles.includes("test.xyz")||b.summary.totalFiles===0);a.push({testId:"ERROR-005-UNSUPPORTED-FORMAT",passed:v,executionTime:0,actualResult:{vehicleDataCount:b.vehicleData.length,unprocessedFiles:b.unprocessedFiles,totalFiles:b.summary.totalFiles},expectedResult:"Should skip unsupported file formats"}),console.log(` Unsupported format test: ${v?" PASSED":" FAILED"}`)}catch(y){a.push({testId:"ERROR-005-UNSUPPORTED-FORMAT",passed:!1,executionTime:0,actualResult:null,expectedResult:"Should handle unsupported formats gracefully",errorMessage:y instanceof Error?y.message:String(y)}),console.log(" Unsupported format test:  FAILED (unexpected error)")}try{console.log(" Testing error recovery with mixed file quality...");const y=`
VEHICLE REGISTRATION
VIN: 1HGBH41JXMN109186
MAKE: HONDA
MODEL: CIVIC
LICENSE PLATE: ABC123
REGISTRATION EXPIRES: 12/31/2024
      `,w="",D=`
INSURANCE CERTIFICATE
VIN: 1HGBH41JXMN109187
MAKE: TOYOTA
MODEL: CAMRY
POLICY NUMBER: POL-12345
EXPIRATION DATE: 06/30/2025
      `,b=new File([y],"good1.txt",{type:"text/plain"}),v=new File([w],"bad.txt",{type:"text/plain"}),E=new File([D],"good2.txt",{type:"text/plain"}),A=this.createFileList([b,v,E]),X=await Zt.processBulkDocuments(A),C=X.vehicleData.length>=2&&X.summary.processed>=2;a.push({testId:"ERROR-006-RECOVERY",passed:C,executionTime:0,actualResult:{vehicleDataCount:X.vehicleData.length,processed:X.summary.processed,errors:X.errors.length,unprocessed:X.unprocessedFiles.length},expectedResult:"Should continue processing good files after encountering bad ones"}),console.log(` Error recovery test: ${C?" PASSED":" FAILED"}`)}catch(y){a.push({testId:"ERROR-006-RECOVERY",passed:!1,executionTime:0,actualResult:null,expectedResult:"Should handle mixed file quality gracefully",errorMessage:y instanceof Error?y.message:String(y)}),console.log(" Error recovery test:  FAILED (unexpected error)")}return console.log(" Error handling tests completed."),a}calculateExtractionAccuracy(a,s){const i=["vin","make","model","year","licensePlate","truckNumber"];let c=0,u=0;for(const m of i)s[m]!==void 0&&(u++,a[m]===s[m]&&c++);if(a.documentType==="registration"){const m=["registrationNumber","registrationExpiry","registrationState"];for(const h of m)s[h]!==void 0&&(u++,a[h]===s[h]&&c++)}else if(a.documentType==="insurance"){const m=["insuranceCarrier","policyNumber","insuranceExpiry","coverageAmount"];for(const h of m)s[h]!==void 0&&(u++,a[h]===s[h]&&c++)}return u>0?c/u:0}createFileList(a){const s=new DataTransfer;return a.forEach(i=>s.items.add(i)),s.files}async testDocumentFormats(){var c,u,m;const a=[],s=[{format:"MM/DD/YYYY",date:"12/31/2024",expected:"12/31/2024"},{format:"DD/MM/YYYY",date:"31/12/2024",expected:"31/12/2024"},{format:"Month DD, YYYY",date:"December 31, 2024",expected:"December 31, 2024"},{format:"DD-MMM-YYYY",date:"31-Dec-2024",expected:"31-Dec-2024"}];for(const h of s)try{const g=`
VEHICLE REGISTRATION
VIN: 1HGBH41JXMN109186
REGISTRATION EXPIRES: ${h.date}
MAKE: FORD
MODEL: F150
        `,x=new File([g],`date_test_${h.format}.txt`,{type:"text/plain"}),y=this.createFileList([x]),w=await Zt.processBulkDocuments(y),D=w.vehicleData.length>0&&w.vehicleData[0].registrationExpiry!==void 0;a.push({testId:`FORMAT-DATE-${h.format}`,passed:D,executionTime:0,actualResult:(c=w.vehicleData[0])==null?void 0:c.registrationExpiry,expectedResult:h.expected,details:{format:h.format,extractedDate:(u=w.vehicleData[0])==null?void 0:u.registrationExpiry}})}catch(g){a.push({testId:`FORMAT-DATE-${h.format}`,passed:!1,executionTime:0,actualResult:null,expectedResult:h.expected,errorMessage:g instanceof Error?g.message:String(g)})}const i=["VIN: 1HGBH41JXMN109186","VEHICLE IDENTIFICATION NUMBER: 1HGBH41JXMN109186","V.I.N.: 1HGBH41JXMN109186","1HGBH41JXMN109186 (VIN)"];for(let h=0;h<i.length;h++)try{const g=`
VEHICLE REGISTRATION
${i[h]}
MAKE: FORD
MODEL: F150
        `,x=new File([g],`vin_test_${h}.txt`,{type:"text/plain"}),y=this.createFileList([x]),w=await Zt.processBulkDocuments(y),D=w.vehicleData.length>0&&w.vehicleData[0].vin==="1HGBH41JXMN109186";a.push({testId:`FORMAT-VIN-${h+1}`,passed:D,executionTime:0,actualResult:(m=w.vehicleData[0])==null?void 0:m.vin,expectedResult:"1HGBH41JXMN109186",details:{vinFormat:i[h]}})}catch(g){a.push({testId:`FORMAT-VIN-${h+1}`,passed:!1,executionTime:0,actualResult:null,expectedResult:"1HGBH41JXMN109186",errorMessage:g instanceof Error?g.message:String(g)})}return a}async runFullTestSuite(){console.log(" Starting comprehensive test suite..."),this.isRunning=!0;const a={name:"TruckBo Fleet Management - Full Test Suite",description:"Comprehensive testing of document processing and fleet management features",tests:[],results:[],summary:{total:0,passed:0,failed:0,successRate:0,totalExecutionTime:0}},s=Date.now();try{console.log(" Generating test documents...");const i=await this.generateTestDocumentSet(10);console.log(" Testing document processing accuracy...");const c=[...i.registrationFiles,...i.insuranceFiles],u=[...i.expectedData,...i.expectedData],m=await this.testDocumentProcessingAccuracy(c,u);a.results.push(...m),console.log(" Testing document format variations...");const h=await this.testDocumentFormats();a.results.push(...h),console.log(" Testing multi-batch processing...");const g=await this.testMultiBatchProcessing(i.registrationFiles,i.insuranceFiles,i.expectedData);a.results.push(g),console.log(" Testing performance with progressively larger document sets...");const x=[];console.log(" Testing small batch performance (25 documents)..."),x.push(await this.testPerformance(25)),console.log(" Testing medium batch performance (50 documents)..."),x.push(await this.testPerformance(50)),console.log(" Testing large batch performance (100 documents)..."),x.push(await this.testPerformance(100)),a.results.push(...x),console.log(" Testing error handling and recovery scenarios...");const y=await this.testErrorHandling();a.results.push(...y),a.summary.total=a.results.length,a.summary.passed=a.results.filter(w=>w.passed).length,a.summary.failed=a.summary.total-a.summary.passed,a.summary.successRate=a.summary.passed/a.summary.total*100,a.summary.totalExecutionTime=Date.now()-s,console.log(" Test suite completed!"),console.log(` Results: ${a.summary.passed}/${a.summary.total} passed (${a.summary.successRate.toFixed(1)}%)`)}catch(i){console.error(" Test suite failed:",i),a.results.push({testId:"SUITE-ERROR",passed:!1,executionTime:Date.now()-s,actualResult:null,expectedResult:"Complete test suite",errorMessage:i instanceof Error?i.message:String(i)})}return this.isRunning=!1,this.testSuites.set("full-suite",a),a}getTestResults(){return this.testSuites}isTestRunning(){return this.isRunning}}const tv=new ev,av=({isOpen:f,onClose:a})=>{const[s,i]=K.useState("idle"),[c,u]=K.useState(null),[m,h]=K.useState(""),[g,x]=K.useState(0),y=async()=>{i("running"),x(0),h("Initializing test suite...");try{const v=setInterval(()=>{x(A=>Math.min(A+2,90))},500),E=await tv.runFullTestSuite();clearInterval(v),x(100),u(E),i("completed"),h("Test suite completed")}catch(v){i("error"),h(`Test failed: ${v instanceof Error?v.message:String(v)}`)}},w=()=>{i("idle"),u(null),h(""),x(0)},D=v=>v.passed?"text-green-600":"text-red-600",b=v=>v.passed?"":"";return f?r.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-y-auto",children:[r.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6 rounded-t-2xl",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-black",children:" System Test Runner"}),r.jsx("p",{className:"text-blue-100 mt-1",children:"Comprehensive testing of document processing and fleet management"})]}),r.jsx("button",{onClick:a,className:"w-10 h-10 bg-white/20 hover:bg-white/30 rounded-xl flex items-center justify-center transition-colors duration-200",children:r.jsx("span",{className:"text-xl",children:""})})]})}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 mb-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Test Status"}),r.jsxs("div",{className:"flex gap-3",children:[s==="idle"&&r.jsx("button",{onClick:y,className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-xl font-bold transition-all duration-200 hover:scale-105 active:scale-95",children:" Run Test Suite"}),s==="completed"&&r.jsx("button",{onClick:w,className:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white rounded-xl font-bold transition-all duration-200",children:" Reset Tests"})]})]}),s==="running"&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin text-4xl mb-4",children:""}),r.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Running Comprehensive Tests"}),r.jsx("p",{className:"text-gray-600",children:m})]}),r.jsxs("div",{className:"max-w-md mx-auto",children:[r.jsx("div",{className:"bg-gray-200 rounded-full h-3",children:r.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 h-3 rounded-full transition-all duration-500",style:{width:`${g}%`}})}),r.jsxs("p",{className:"text-sm text-gray-600 mt-2 text-center",children:[g,"% complete"]})]})]}),s==="error"&&r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"text-6xl mb-4",children:""}),r.jsx("h4",{className:"text-xl font-bold text-red-600 mb-2",children:"Test Suite Failed"}),r.jsx("p",{className:"text-red-700",children:m})]}),s==="completed"&&c&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-6xl mb-4",children:c.summary.successRate>=90?"":c.summary.successRate>=70?"":""}),r.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-2",children:"Test Suite Complete"}),r.jsxs("p",{className:"text-gray-600",children:["Executed ",c.summary.total," tests in ",(c.summary.totalExecutionTime/1e3).toFixed(2)," seconds"]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"text-center p-4 bg-white rounded-lg border",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.summary.total}),r.jsx("div",{className:"text-sm text-blue-700",children:"Total Tests"})]}),r.jsxs("div",{className:"text-center p-4 bg-white rounded-lg border",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.summary.passed}),r.jsx("div",{className:"text-sm text-green-700",children:"Passed"})]}),r.jsxs("div",{className:"text-center p-4 bg-white rounded-lg border",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:c.summary.failed}),r.jsx("div",{className:"text-sm text-red-700",children:"Failed"})]}),r.jsxs("div",{className:"text-center p-4 bg-white rounded-lg border",children:[r.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[c.summary.successRate.toFixed(1),"%"]}),r.jsx("div",{className:"text-sm text-purple-700",children:"Success Rate"})]})]})]})]}),c&&c.results.length>0&&r.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl",children:[r.jsxs("div",{className:"p-4 border-b border-gray-200",children:[r.jsx("h4",{className:"font-bold text-gray-900",children:"Detailed Test Results"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Click on a test to view detailed information"})]}),r.jsx("div",{className:"max-h-96 overflow-y-auto",children:c.results.map((v,E)=>{var A,X;return r.jsxs("div",{className:"p-4 border-b border-gray-100 last:border-b-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-2xl mr-3",children:b(v)}),r.jsxs("div",{children:[r.jsx("h5",{className:`font-semibold ${D(v)}`,children:v.testId}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Execution time: ",v.executionTime,"ms"]})]})]}),r.jsx("div",{className:"text-right",children:v.passed?r.jsx("span",{className:"text-green-600 font-medium",children:"PASSED"}):r.jsx("span",{className:"text-red-600 font-medium",children:"FAILED"})})]}),v.errorMessage&&r.jsxs("div",{className:"mt-3 p-3 bg-red-50 rounded-lg",children:[r.jsx("p",{className:"text-sm text-red-700 font-medium",children:"Error:"}),r.jsx("p",{className:"text-sm text-red-600",children:v.errorMessage})]}),v.testId.startsWith("PERF-")&&v.actualResult&&r.jsxs("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:[r.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Performance Metrics:"}),r.jsxs("div",{className:"text-sm text-blue-600 space-y-2 mt-2",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{children:[" Documents: ",v.actualResult.totalDocuments]}),r.jsxs("div",{children:[" Time/Doc: ",v.actualResult.timePerDocument,"ms"]}),r.jsxs("div",{children:[" Docs/Sec: ",v.actualResult.documentsPerSecond]}),r.jsxs("div",{children:[" Reconciliation: ",v.actualResult.reconciliationScore,"%"]})]}),v.actualResult.memoryIncreaseMB&&r.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2 border-t border-blue-200",children:[r.jsxs("div",{children:[" Memory Used: ",v.actualResult.memoryIncreaseMB,"MB"]}),r.jsxs("div",{children:[" Vehicles: ",v.actualResult.vehiclesReconciled]})]}),((A=v.details)==null?void 0:A.breakdown)&&r.jsxs("div",{className:"pt-2 border-t border-blue-200",children:[r.jsx("p",{className:"text-xs text-blue-600 font-medium mb-1",children:"Processing Breakdown:"}),r.jsxs("div",{className:"grid grid-cols-3 gap-1 text-xs",children:[r.jsxs("div",{children:[" Reg: ",v.details.breakdown.registration,"ms"]}),r.jsxs("div",{children:[" Ins: ",v.details.breakdown.insurance,"ms"]}),r.jsxs("div",{children:[" Recon: ",v.details.breakdown.reconciliation,"ms"]})]})]})]})]}),v.testId.startsWith("DOC-ACC-")&&v.actualResult&&r.jsxs("div",{className:"mt-3 p-3 bg-green-50 rounded-lg",children:[r.jsx("p",{className:"text-sm text-green-700 font-medium",children:"Extraction Accuracy:"}),r.jsxs("div",{className:"text-sm text-green-600 mt-1",children:[(v.actualResult.accuracy*100).toFixed(1),"% field accuracy"]})]}),v.testId==="MULTI-BATCH-001"&&v.actualResult&&r.jsxs("div",{className:"mt-3 p-3 bg-purple-50 rounded-lg",children:[r.jsx("p",{className:"text-sm text-purple-700 font-medium",children:"Reconciliation Results:"}),r.jsxs("div",{className:"text-sm text-purple-600 grid grid-cols-2 gap-2 mt-1",children:[r.jsxs("div",{children:["Total Vehicles: ",v.actualResult.totalVehicles]}),r.jsxs("div",{children:["Complete Records: ",v.actualResult.fullyDocumented]}),r.jsxs("div",{children:["Reconciliation Score: ",v.actualResult.reconciliationScore,"%"]}),r.jsxs("div",{children:["Missing Data: ",v.actualResult.registrationOnly+v.actualResult.insuranceOnly]})]})]}),v.testId.startsWith("ERROR-")&&v.actualResult&&r.jsxs("div",{className:"mt-3 p-3 bg-orange-50 rounded-lg",children:[r.jsx("p",{className:"text-sm text-orange-700 font-medium",children:"Error Handling Results:"}),r.jsxs("div",{className:"text-sm text-orange-600 mt-1",children:[v.testId==="ERROR-001-EMPTY"&&r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{children:["Vehicle Data Extracted: ",v.actualResult.vehicleDataCount||0]}),r.jsxs("div",{children:["Errors Recorded: ",v.actualResult.errorsCount||0]}),r.jsxs("div",{children:["Files Skipped: ",v.actualResult.unprocessedCount||0]})]}),v.testId==="ERROR-002-NO-DATA"&&r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{children:["Vehicle Data Count: ",v.actualResult.vehicleDataCount||0]}),r.jsxs("div",{children:["Needs Review: ",v.actualResult.needsReview?"Yes":"No"]}),r.jsxs("div",{children:["Confidence: ",v.actualResult.extractionConfidence?(v.actualResult.extractionConfidence*100).toFixed(1)+"%":"N/A"]})]}),(v.testId==="ERROR-003-MALFORMED-VIN"||v.testId==="ERROR-004-INVALID-VIN")&&r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{children:["VIN Extracted: ",v.actualResult.extractedVin||"None"]}),r.jsxs("div",{children:["Flagged for Review: ",v.actualResult.needsReview?"Yes":"No"]}),r.jsxs("div",{children:["Confidence: ",v.actualResult.extractionConfidence?(v.actualResult.extractionConfidence*100).toFixed(1)+"%":"N/A"]})]}),v.testId==="ERROR-005-UNSUPPORTED-FORMAT"&&r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{children:["Vehicle Data: ",v.actualResult.vehicleDataCount||0]}),r.jsxs("div",{children:["Skipped Files: ",((X=v.actualResult.unprocessedFiles)==null?void 0:X.length)||0]}),r.jsxs("div",{children:["Total Processed: ",v.actualResult.totalFiles||0]})]}),v.testId==="ERROR-006-RECOVERY"&&r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{children:["Successfully Processed: ",v.actualResult.processed||0]}),r.jsxs("div",{children:["Vehicle Records: ",v.actualResult.vehicleDataCount||0]}),r.jsxs("div",{children:["Errors Encountered: ",v.actualResult.errors||0]}),r.jsxs("div",{children:["Files Skipped: ",v.actualResult.unprocessed||0]})]})]})]})]},E)})})]}),s==="idle"&&r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[r.jsx("h4",{className:"font-bold text-blue-800 mb-3",children:"Test Categories"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("h5",{className:"font-semibold text-blue-700 mb-2",children:" Document Processing"}),r.jsxs("ul",{className:"text-blue-600 space-y-1",children:[r.jsx("li",{children:" Single document accuracy"}),r.jsx("li",{children:" Multi-batch reconciliation"}),r.jsx("li",{children:" File format support"}),r.jsx("li",{children:" VIN and date extraction"})]})]}),r.jsxs("div",{children:[r.jsx("h5",{className:"font-semibold text-blue-700 mb-2",children:" Performance & Reliability"}),r.jsxs("ul",{className:"text-blue-600 space-y-1",children:[r.jsx("li",{children:" Large batch processing"}),r.jsx("li",{children:" Memory usage monitoring"}),r.jsx("li",{children:" Error handling & recovery"}),r.jsx("li",{children:" Malformed data detection"}),r.jsx("li",{children:" File format validation"})]})]})]}),r.jsx("div",{className:"mt-4 p-3 bg-blue-100 rounded-lg",children:r.jsxs("p",{className:"text-blue-800 text-sm",children:[r.jsx("span",{className:"font-semibold",children:" Tip:"})," Tests will generate synthetic documents with known data to validate extraction accuracy and system performance."]})})]})]})]})}):null},hl=({status:f})=>{const a=()=>{switch(f){case"compliant":return"bg-green-500";case"warning":return"bg-yellow-500";case"expired":return"bg-red-500";default:return"bg-gray-400"}};return r.jsx("div",{className:`w-2 h-2 rounded-full ${a()}`})},sv=({vehicle:f,compliance:a,onViewDetails:s,onScheduleService:i,onEditVehicle:c})=>{var h,g;const u=((h=f.truckNumber)==null?void 0:h.replace("Truck #",""))||((g=f.vin)==null?void 0:g.slice(-3))||"???",m=()=>{switch(f.status){case"active":return"text-green-600 bg-green-50";case"inactive":return"text-gray-600 bg-gray-50";default:return"text-gray-600 bg-gray-50"}};return r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg hover:border-gray-300 transition-colors duration-200 p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:["#",u]}),r.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${m()}`,children:f.status})]}),r.jsxs("div",{className:"text-xs text-gray-500",children:[a.overall.score,"%"]})]}),r.jsxs("div",{className:"mb-2",children:[r.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[f.year," ",f.make," ",f.model]}),r.jsxs("div",{className:"text-xs text-gray-500",children:[f.licensePlate,"  VIN: ...",f.vin.slice(-6)]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-1 mb-3",children:[r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(hl,{status:a.registration.status}),r.jsx("span",{className:"text-xs text-gray-600",children:"REG"})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(hl,{status:a.insurance.status}),r.jsx("span",{className:"text-xs text-gray-600",children:"INS"})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(hl,{status:a.dotInspection.status}),r.jsx("span",{className:"text-xs text-gray-600",children:"DOT"})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(hl,{status:a.ifta.status}),r.jsx("span",{className:"text-xs text-gray-600",children:"IFTA"})]})]}),r.jsxs("div",{className:"flex space-x-1",children:[r.jsx("button",{onClick:s,className:"flex-1 text-xs px-2 py-1 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded border border-blue-200 hover:border-blue-300 transition-colors duration-150",children:"View"}),r.jsx("button",{onClick:i,className:"flex-1 text-xs px-2 py-1 bg-gray-50 hover:bg-gray-100 text-gray-700 rounded border border-gray-200 hover:border-gray-300 transition-colors duration-150",children:"Service"}),r.jsx("button",{onClick:c,className:"text-xs px-2 py-1 bg-gray-50 hover:bg-gray-100 text-gray-700 rounded border border-gray-200 hover:border-gray-300 transition-colors duration-150",children:""})]})]})};function nv(){const[f,a]=K.useState([]),[s,i]=K.useState([]),[c,u]=K.useState(!0),[m,h]=K.useState(!1),[g,x]=K.useState("all");K.useEffect(()=>(y(),ze.subscribe(()=>{y()})),[]);const y=()=>{try{const C=ze.getDrivers();a(C);const W=w(C);i(W),u(!1),console.log(` Loaded ${C.length} drivers with ${W.length} alerts`)}catch(C){console.error("Error loading drivers:",C),u(!1)}},w=C=>{const W=[];return C.forEach(k=>{const Z=`${k.firstName} ${k.lastName}`;k.medicalCertificate.status==="expired"?W.push({driverId:k.id,driverName:Z,alertType:"medical_expired",daysUntilExpiry:k.medicalCertificate.daysUntilExpiry,expirationDate:k.medicalCertificate.expirationDate,priority:"critical"}):k.medicalCertificate.status==="expiring_soon"&&W.push({driverId:k.id,driverName:Z,alertType:"medical_expires_soon",daysUntilExpiry:k.medicalCertificate.daysUntilExpiry,expirationDate:k.medicalCertificate.expirationDate,priority:k.medicalCertificate.daysUntilExpiry<=7?"critical":"high"}),k.cdlInfo.status==="expired"?W.push({driverId:k.id,driverName:Z,alertType:"cdl_expired",daysUntilExpiry:k.cdlInfo.daysUntilExpiry,expirationDate:k.cdlInfo.expirationDate,priority:"critical"}):k.cdlInfo.status==="expiring_soon"&&W.push({driverId:k.id,driverName:Z,alertType:"cdl_expires_soon",daysUntilExpiry:k.cdlInfo.daysUntilExpiry,expirationDate:k.cdlInfo.expirationDate,priority:"high"})}),W.sort((k,Z)=>{const le={critical:0,high:1,medium:2};return le[k.priority]!==le[Z.priority]?le[k.priority]-le[Z.priority]:k.daysUntilExpiry-Z.daysUntilExpiry})},D=()=>{switch(g){case"active":return f.filter(C=>C.status==="active");case"expiring":return f.filter(C=>C.medicalCertificate.status==="expiring_soon"||C.cdlInfo.status==="expiring_soon");case"expired":return f.filter(C=>C.medicalCertificate.status==="expired"||C.cdlInfo.status==="expired");default:return f}},b=(C,W)=>{switch(C){case"valid":return r.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[" Valid (",W," days)"]});case"expiring_soon":return r.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[" Expires in ",W," days"]});case"expired":return r.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[" Expired (",Math.abs(W)," days ago)"]});case"invalid":return r.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:" Invalid"})}},v=C=>{switch(C){case"medical_expired":return" Medical Certificate EXPIRED";case"medical_expires_soon":return" Medical Certificate Expiring Soon";case"cdl_expired":return" CDL EXPIRED";case"cdl_expires_soon":return" CDL Expiring Soon"}},E=D(),A=s.filter(C=>C.priority==="critical").length,X=s.filter(C=>C.priority==="high").length;return c?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Loading drivers..."})]})}):r.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[r.jsx("div",{className:"mb-6",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Driver Management"}),r.jsx("p",{className:"text-gray-600 mt-1",children:"Track medical certificates, CDL renewals, and compliance"})]}),r.jsx("button",{onClick:()=>h(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium flex items-center gap-2",children:" Add Driver"})]})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[r.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:""})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Drivers"}),r.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:f.length})]})]})}),r.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center text-red-600",children:""})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Critical Alerts"}),r.jsx("p",{className:"text-2xl font-semibold text-red-600",children:A})]})]})}),r.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center text-yellow-600",children:""})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Expiring Soon"}),r.jsx("p",{className:"text-2xl font-semibold text-yellow-600",children:X})]})]})}),r.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center text-green-600",children:""})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Compliant"}),r.jsx("p",{className:"text-2xl font-semibold text-green-600",children:f.filter(C=>C.medicalCertificate.status==="valid"&&C.cdlInfo.status==="valid").length})]})]})})]}),s.length>0&&r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:" Active Alerts"}),r.jsxs("div",{className:"space-y-3",children:[s.slice(0,5).map((C,W)=>r.jsx("div",{className:`p-3 rounded-lg border-l-4 ${C.priority==="critical"?"bg-red-50 border-red-400":"bg-yellow-50 border-yellow-400"}`,children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-gray-900",children:v(C.alertType)}),r.jsxs("p",{className:"text-sm text-gray-600",children:[C.driverName," - Expires: ",C.expirationDate]})]}),r.jsx("div",{className:"text-right",children:r.jsx("p",{className:`text-sm font-medium ${C.priority==="critical"?"text-red-600":"text-yellow-600"}`,children:C.daysUntilExpiry<0?`${Math.abs(C.daysUntilExpiry)} days overdue`:`${C.daysUntilExpiry} days remaining`})})]})},W)),s.length>5&&r.jsxs("p",{className:"text-sm text-gray-500 text-center pt-2",children:["... and ",s.length-5," more alerts"]})]})]}),r.jsx("div",{className:"flex gap-2 mb-4",children:["all","active","expiring","expired"].map(C=>r.jsx("button",{onClick:()=>x(C),className:`px-3 py-1 rounded-lg text-sm font-medium capitalize ${g===C?"bg-blue-100 text-blue-700 border border-blue-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:C==="all"?"All Drivers":C},C))}),r.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Driver"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CDL Info"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Medical Certificate"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:E.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx("p",{className:"text-lg",children:" No drivers found"}),r.jsx("p",{className:"text-sm mt-1",children:g==="all"?"Add your first driver to get started":`No drivers match the "${g}" filter`})]})})}):E.map(C=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:r.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[C.firstName.charAt(0),C.lastName.charAt(0)]})})}),r.jsxs("div",{className:"ml-4",children:[r.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[C.firstName," ",C.lastName]}),r.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",C.employeeId]})]})]})}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsxs("div",{className:"text-sm text-gray-900",children:["Class ",C.cdlInfo.class,"  ",C.cdlInfo.cdlState]}),r.jsx("div",{className:"text-sm text-gray-500",children:C.cdlInfo.cdlNumber}),r.jsx("div",{className:"mt-1",children:b(C.cdlInfo.status,C.cdlInfo.daysUntilExpiry)})]}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsxs("div",{className:"text-sm text-gray-900",children:["Expires: ",C.medicalCertificate.expirationDate]}),r.jsx("div",{className:"text-sm text-gray-500",children:C.medicalCertificate.certificateNumber}),r.jsx("div",{className:"mt-1",children:b(C.medicalCertificate.status,C.medicalCertificate.daysUntilExpiry)})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${C.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:C.status})}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[r.jsx("button",{className:"text-blue-600 hover:text-blue-900 mr-3",children:"Edit"}),r.jsx("button",{className:"text-gray-600 hover:text-gray-900",children:"View"})]})]},C.id))})]})})}),m&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Add New Driver"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"Driver management modal will be implemented in the next step."}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Close"})})]})})]})}class rv{generateVehicleComplianceReport(a){const s=ze.getFleet(),i=new Date().toISOString(),c=[],u=[],m=[],h=[],g=[];s.forEach(y=>{let w=!0,D=!1;if(y.registrationExpiry){const b=new Date(y.registrationExpiry),v=new Date,E=Math.ceil((b.getTime()-v.getTime())/(1e3*60*60*24));E<0?(w=!1,h.push(`${y.truckNumber}: Registration expired ${Math.abs(E)} days ago`)):E<=30&&(D=!0,g.push(`${y.truckNumber}: Registration expires in ${E} days - schedule renewal`))}else w=!1,h.push(`${y.truckNumber}: Missing registration expiry date`);if(y.insuranceExpiry){const b=new Date(y.insuranceExpiry),v=new Date,E=Math.ceil((b.getTime()-v.getTime())/(1e3*60*60*24));E<0?(w=!1,h.push(`${y.truckNumber}: Insurance expired ${Math.abs(E)} days ago`)):E<=15&&(D=!0,g.push(`${y.truckNumber}: Insurance expires in ${E} days - renew immediately`))}else w=!1,h.push(`${y.truckNumber}: Missing insurance information`);y.vin||(w=!1,h.push(`${y.truckNumber}: Missing VIN`)),w?D?m.push(y):c.push(y):u.push(y)});const x={totalVehicles:s.length,compliantCount:c.length,nonCompliantCount:u.length,expiringCount:m.length,criticalIssues:h.slice(0,10),recommendations:g.slice(0,10)};return{id:`vehicle_compliance_${Date.now()}`,title:"Vehicle Compliance Report",type:"vehicle_compliance",generatedAt:i,generatedBy:"TruckBo System",dateRange:a||{from:new Date().toISOString().split("T")[0],to:new Date().toISOString().split("T")[0]},data:{compliantVehicles:c,nonCompliantVehicles:u,expiringVehicles:m,totalVehicles:s.length},summary:x,exportFormats:["PDF","Excel","CSV"]}}generateDriverComplianceReport(a){const s=ze.getDrivers(),i=new Date().toISOString(),c=[],u=[],m=[],h=[],g=[];s.forEach(y=>{let w=!0,D=!1;const b=`${y.firstName} ${y.lastName}`;y.medicalCertificate?y.medicalCertificate.status==="expired"?(w=!1,h.push(`${b}: Medical certificate expired ${Math.abs(y.medicalCertificate.daysUntilExpiry)} days ago`)):y.medicalCertificate.status==="expiring_soon"&&(D=!0,g.push(`${b}: Medical certificate expires in ${y.medicalCertificate.daysUntilExpiry} days`)):(w=!1,h.push(`${b}: Missing medical certificate`)),y.cdlInfo?y.cdlInfo.status==="expired"?(w=!1,h.push(`${b}: CDL expired ${Math.abs(y.cdlInfo.daysUntilExpiry)} days ago`)):y.cdlInfo.status==="expiring_soon"&&(D=!0,g.push(`${b}: CDL expires in ${y.cdlInfo.daysUntilExpiry} days`)):(w=!1,h.push(`${b}: Missing CDL information`)),y.employeeId||(w=!1,h.push(`${b}: Missing employee ID`)),w?D?m.push(y):c.push(y):u.push(y)});const x={totalDrivers:s.length,compliantCount:c.length,nonCompliantCount:u.length,expiringCount:m.length,criticalIssues:h.slice(0,10),recommendations:g.slice(0,10)};return{id:`driver_compliance_${Date.now()}`,title:"Driver Compliance Report",type:"driver_compliance",generatedAt:i,generatedBy:"TruckBo System",dateRange:a||{from:new Date().toISOString().split("T")[0],to:new Date().toISOString().split("T")[0]},data:{compliantDrivers:c,nonCompliantDrivers:u,expiringDrivers:m,totalDrivers:s.length},summary:x,exportFormats:["PDF","Excel","CSV"]}}generateExpirationSummaryReport(a=90){const s=ze.getFleet(),i=ze.getDrivers(),c=new Date().toISOString(),u=[];s.forEach(x=>{const y=new Date;if(x.registrationExpiry){const w=new Date(x.registrationExpiry),D=Math.ceil((w.getTime()-y.getTime())/(1e3*60*60*24));D<=a&&u.push({type:"vehicle",id:x.id,name:`${x.truckNumber} (${x.make} ${x.model})`,documentType:"registration",expirationDate:x.registrationExpiry,daysUntilExpiry:D,status:D<0?"expired":D<=30?"critical":"expires_soon",priority:D<0||D<=15?"critical":D<=30?"high":"medium"})}if(x.insuranceExpiry){const w=new Date(x.insuranceExpiry),D=Math.ceil((w.getTime()-y.getTime())/(1e3*60*60*24));D<=a&&u.push({type:"vehicle",id:x.id,name:`${x.truckNumber} (${x.make} ${x.model})`,documentType:"insurance",expirationDate:x.insuranceExpiry,daysUntilExpiry:D,status:D<0?"expired":D<=15?"critical":"expires_soon",priority:D<0||D<=7?"critical":D<=15?"high":"medium"})}}),i.forEach(x=>{const y=`${x.firstName} ${x.lastName}`;x.medicalCertificate&&x.medicalCertificate.daysUntilExpiry<=a&&u.push({type:"driver",id:x.id,name:y,documentType:"medical_certificate",expirationDate:x.medicalCertificate.expirationDate,daysUntilExpiry:x.medicalCertificate.daysUntilExpiry,status:x.medicalCertificate.status,priority:x.medicalCertificate.daysUntilExpiry<0?"critical":x.medicalCertificate.daysUntilExpiry<=30?"high":"medium"}),x.cdlInfo&&x.cdlInfo.daysUntilExpiry<=a&&u.push({type:"driver",id:x.id,name:y,documentType:"cdl",expirationDate:x.cdlInfo.expirationDate,daysUntilExpiry:x.cdlInfo.daysUntilExpiry,status:x.cdlInfo.status,priority:x.cdlInfo.daysUntilExpiry<0?"critical":x.cdlInfo.daysUntilExpiry<=60?"high":"medium"})}),u.sort((x,y)=>{const w={critical:0,high:1,medium:2};return w[x.priority]!==w[y.priority]?w[x.priority]-w[y.priority]:x.daysUntilExpiry-y.daysUntilExpiry});const m=u.filter(x=>x.priority==="critical"),h=u.filter(x=>x.priority==="high"),g={totalVehicles:s.length,totalDrivers:i.length,compliantCount:s.length+i.length-u.length,nonCompliantCount:m.length,expiringCount:u.length-m.length,criticalIssues:m.slice(0,10).map(x=>`${x.name}: ${x.documentType} ${x.status} (${Math.abs(x.daysUntilExpiry)} days)`),recommendations:h.slice(0,10).map(x=>`Schedule renewal for ${x.name}: ${x.documentType} expires in ${x.daysUntilExpiry} days`)};return{id:`expiration_summary_${Date.now()}`,title:`Expiration Summary Report (Next ${a} Days)`,type:"expiration_summary",generatedAt:c,generatedBy:"TruckBo System",dateRange:{from:new Date().toISOString().split("T")[0],to:new Date(Date.now()+a*24*60*60*1e3).toISOString().split("T")[0]},data:{alerts:u,daysAhead:a,criticalAlerts:m.length,highPriorityAlerts:h.length,totalAlerts:u.length},summary:g,exportFormats:["PDF","Excel","CSV"]}}generateFullAuditReport(){const a=this.generateVehicleComplianceReport(),s=this.generateDriverComplianceReport(),i=this.generateExpirationSummaryReport(90),c=this.calculateComplianceMetrics(),u=new Date().toISOString(),m=[...a.summary.criticalIssues,...s.summary.criticalIssues,...i.summary.criticalIssues],h=[...a.summary.recommendations,...s.summary.recommendations,...i.summary.recommendations],g={totalVehicles:a.summary.totalVehicles,totalDrivers:s.summary.totalDrivers,compliantCount:a.summary.compliantCount+s.summary.compliantCount,nonCompliantCount:a.summary.nonCompliantCount+s.summary.nonCompliantCount,expiringCount:a.summary.expiringCount+s.summary.expiringCount,criticalIssues:m.slice(0,15),recommendations:h.slice(0,15)};return{id:`full_audit_${Date.now()}`,title:"Comprehensive Fleet Compliance Audit",type:"full_audit",generatedAt:u,generatedBy:"TruckBo System",dateRange:{from:new Date().toISOString().split("T")[0],to:new Date(Date.now()+2160*60*60*1e3).toISOString().split("T")[0]},data:{vehicleCompliance:a.data,driverCompliance:s.data,expirationAlerts:i.data,metrics:c},summary:g,exportFormats:["PDF","Excel"]}}calculateComplianceMetrics(){const a=ze.getFleet(),s=ze.getDrivers();let i=0,c=0,u=0,m=0,h=0;const g={registration:{total:0,compliant:0,expiring:0,expired:0},insurance:{total:0,compliant:0,expiring:0,expired:0},medical_certificate:{total:0,compliant:0,expiring:0,expired:0},cdl:{total:0,compliant:0,expiring:0,expired:0}};a.forEach(v=>{if(v.registrationExpiry){g.registration.total++,c++;const E=new Date(v.registrationExpiry),A=Math.ceil((E.getTime()-Date.now())/(1e3*60*60*24));A<0?(g.registration.expired++,u++):A<=30?(g.registration.expiring++,h++,A<=15&&m++):(g.registration.compliant++,i++)}if(v.insuranceExpiry){g.insurance.total++,c++;const E=new Date(v.insuranceExpiry),A=Math.ceil((E.getTime()-Date.now())/(1e3*60*60*24));A<0?(g.insurance.expired++,u++):A<=15?(g.insurance.expiring++,h++,m++):(g.insurance.compliant++,i++)}}),s.forEach(v=>{v.medicalCertificate&&(g.medical_certificate.total++,c++,v.medicalCertificate.status==="expired"?(g.medical_certificate.expired++,u++):v.medicalCertificate.status==="expiring_soon"?(g.medical_certificate.expiring++,h++,v.medicalCertificate.daysUntilExpiry<=30&&m++):(g.medical_certificate.compliant++,i++)),v.cdlInfo&&(g.cdl.total++,c++,v.cdlInfo.status==="expired"?(g.cdl.expired++,u++):v.cdlInfo.status==="expiring_soon"?(g.cdl.expiring++,h++,v.cdlInfo.daysUntilExpiry<=60&&m++):(g.cdl.compliant++,i++))});const x=c>0?i/c*100:100,y=g.registration.total+g.insurance.total,w=g.registration.compliant+g.insurance.compliant,D=g.medical_certificate.total+g.cdl.total,b=g.medical_certificate.compliant+g.cdl.compliant;return{overallComplianceRate:Number(x.toFixed(1)),vehicleComplianceRate:y>0?Number((w/y*100).toFixed(1)):100,driverComplianceRate:D>0?Number((b/D*100).toFixed(1)):100,criticalAlerts:u,highPriorityAlerts:m,expiringSoon:h,totalDocuments:c,documentTypes:g}}async exportToPDF(a){try{const s=this.generatePDFContent(a),i=new Blob([s],{type:"text/html"}),c=URL.createObjectURL(i),u=document.createElement("a");u.href=c,u.download=`${a.title.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.html`,u.click(),URL.revokeObjectURL(c),De.showSuccess("Report exported successfully!")}catch(s){De.handleCriticalError(s,"PDF export")}}async exportToExcel(a){try{const s=this.generateCSVContent(a),i=new Blob([s],{type:"text/csv"}),c=URL.createObjectURL(i),u=document.createElement("a");u.href=c,u.download=`${a.title.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.csv`,u.click(),URL.revokeObjectURL(c),De.showSuccess("Report exported to CSV successfully!")}catch(s){De.handleCriticalError(s,"Excel export")}}generatePDFContent(a){return`
<!DOCTYPE html>
<html>
<head>
    <title>${a.title}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .header { text-align: center; margin-bottom: 30px; }
        .summary { background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; }
        .metrics { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 20px 0; }
        .metric { background: white; padding: 15px; border: 1px solid #dee2e6; border-radius: 4px; text-align: center; }
        .alerts { margin: 20px 0; }
        .alert { padding: 10px; margin: 5px 0; border-left: 4px solid #dc3545; background: #f8d7da; }
        .recommendation { padding: 10px; margin: 5px 0; border-left: 4px solid #ffc107; background: #fff3cd; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #dee2e6; padding: 8px; text-align: left; }
        th { background: #e9ecef; }
        .footer { margin-top: 30px; text-align: center; color: #666; font-size: 12px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>${a.title}</h1>
        <p>Generated: ${new Date(a.generatedAt).toLocaleString()}</p>
        <p>Report Period: ${a.dateRange.from} to ${a.dateRange.to}</p>
    </div>

    <div class="summary">
        <h2>Executive Summary</h2>
        <div class="metrics">
            <div class="metric">
                <h3>${a.summary.compliantCount}</h3>
                <p>Compliant</p>
            </div>
            <div class="metric">
                <h3>${a.summary.nonCompliantCount}</h3>
                <p>Non-Compliant</p>
            </div>
            <div class="metric">
                <h3>${a.summary.expiringCount}</h3>
                <p>Expiring Soon</p>
            </div>
        </div>
    </div>

    ${a.summary.criticalIssues.length>0?`
    <div class="alerts">
        <h2>Critical Issues</h2>
        ${a.summary.criticalIssues.map(s=>`<div class="alert">${s}</div>`).join("")}
    </div>
    `:""}

    ${a.summary.recommendations.length>0?`
    <div class="alerts">
        <h2>Recommendations</h2>
        ${a.summary.recommendations.map(s=>`<div class="recommendation">${s}</div>`).join("")}
    </div>
    `:""}

    <div class="footer">
        <p>Generated by TruckBo Pro Fleet Management System</p>
        <p>This report contains confidential information. Handle according to company policy.</p>
    </div>
</body>
</html>`}generateCSVContent(a){let s=`Report Title,${a.title}
`;return s+=`Generated At,${new Date(a.generatedAt).toLocaleString()}
`,s+=`Date Range,${a.dateRange.from} to ${a.dateRange.to}

`,s+=`Summary
`,s+=`Metric,Value
`,s+=`Compliant,${a.summary.compliantCount}
`,s+=`Non-Compliant,${a.summary.nonCompliantCount}
`,s+=`Expiring Soon,${a.summary.expiringCount}

`,a.summary.criticalIssues.length>0&&(s+=`Critical Issues
`,a.summary.criticalIssues.forEach(i=>{s+=`"${i}"
`}),s+=`
`),a.summary.recommendations.length>0&&(s+=`Recommendations
`,a.summary.recommendations.forEach(i=>{s+=`"${i}"
`})),s}scheduleAutomaticReports(a){setInterval(()=>{try{const i=this.generateExpirationSummaryReport(30);i.summary.criticalIssues.length>0&&De.showInfo(`Scheduled Report: ${i.summary.criticalIssues.length} critical compliance issues found`,1e4)}catch(i){console.error("Scheduled report generation failed:",i)}},{daily:864e5,weekly:6048e5,monthly:2592e6}[a]),De.showSuccess(`Automatic ${a} reports scheduled successfully!`)}}const ra=new rv;function iv(){const[f,a]=K.useState(null),[s,i]=K.useState([]),[c,u]=K.useState(null),[m,h]=K.useState(!1),[g,x]=K.useState("dashboard");K.useEffect(()=>{y()},[]);const y=async()=>{try{h(!0);const E=ra.calculateComplianceMetrics();a(E)}catch(E){De.handleCriticalError(E,"Loading compliance metrics")}finally{h(!1)}},w=async E=>{try{h(!0);let A;switch(E){case"vehicle":A=ra.generateVehicleComplianceReport();break;case"driver":A=ra.generateDriverComplianceReport();break;case"expiration":A=ra.generateExpirationSummaryReport(90);break;case"full_audit":A=ra.generateFullAuditReport();break;default:throw new Error("Invalid report type")}i(X=>[A,...X]),u(A),De.showSuccess(`${A.title} generated successfully!`)}catch(A){De.handleCriticalError(A,"Generating report")}finally{h(!1)}},D=async(E,A)=>{try{A==="pdf"?await ra.exportToPDF(E):await ra.exportToExcel(E)}catch(X){De.handleCriticalError(X,`Exporting report to ${A.toUpperCase()}`)}},b=E=>E>=95?"text-green-600":E>=85?"text-yellow-600":"text-red-600",v=E=>E>=95?"bg-green-50 border-green-200":E>=85?"bg-yellow-50 border-yellow-200":"bg-red-50 border-red-200";return m&&!f?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx(Mr,{message:"Loading compliance data..."})}):r.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Compliance Reporting"}),r.jsx("p",{className:"text-gray-600 mt-1",children:"Monitor fleet compliance and generate regulatory reports"})]}),r.jsx("div",{className:"border-b border-gray-200 mb-6",children:r.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"dashboard",label:"Dashboard",icon:""},{id:"reports",label:"Reports",icon:""},{id:"schedule",label:"Schedule",icon:""}].map(E=>r.jsxs("button",{onClick:()=>x(E.id),className:`py-2 px-1 border-b-2 font-medium text-sm ${g===E.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[r.jsx("span",{className:"mr-2",children:E.icon}),E.label]},E.id))})}),g==="dashboard"&&f&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[r.jsx("div",{className:`p-6 rounded-lg border ${v(f.overallComplianceRate)}`,children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:""})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Overall Compliance"}),r.jsxs("p",{className:`text-2xl font-semibold ${b(f.overallComplianceRate)}`,children:[f.overallComplianceRate,"%"]})]})]})}),r.jsx("div",{className:`p-6 rounded-lg border ${v(f.vehicleComplianceRate)}`,children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:""})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Vehicle Compliance"}),r.jsxs("p",{className:`text-2xl font-semibold ${b(f.vehicleComplianceRate)}`,children:[f.vehicleComplianceRate,"%"]})]})]})}),r.jsx("div",{className:`p-6 rounded-lg border ${v(f.driverComplianceRate)}`,children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:""})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Driver Compliance"}),r.jsxs("p",{className:`text-2xl font-semibold ${b(f.driverComplianceRate)}`,children:[f.driverComplianceRate,"%"]})]})]})}),r.jsx("div",{className:"p-6 bg-white rounded-lg border border-gray-200",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center text-red-600",children:""})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Critical Alerts"}),r.jsx("p",{className:"text-2xl font-semibold text-red-600",children:f.criticalAlerts})]})]})})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Document Compliance Breakdown"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.entries(f.documentTypes).map(([E,A])=>r.jsxs("div",{className:"border rounded-lg p-4",children:[r.jsx("h4",{className:"font-medium text-gray-900 capitalize mb-2",children:E.replace("_"," ")}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Total:"}),r.jsx("span",{className:"font-medium",children:A.total})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-green-600",children:"Compliant:"}),r.jsx("span",{className:"font-medium",children:A.compliant})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-yellow-600",children:"Expiring:"}),r.jsx("span",{className:"font-medium",children:A.expiring})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-red-600",children:"Expired:"}),r.jsx("span",{className:"font-medium",children:A.expired})]})]})]},E))})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs("button",{onClick:()=>w("expiration"),disabled:m,className:"flex items-center justify-center px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:[r.jsx("span",{className:"mr-2",children:""}),"Expiration Report"]}),r.jsxs("button",{onClick:()=>w("vehicle"),disabled:m,className:"flex items-center justify-center px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:[r.jsx("span",{className:"mr-2",children:""}),"Vehicle Report"]}),r.jsxs("button",{onClick:()=>w("driver"),disabled:m,className:"flex items-center justify-center px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:[r.jsx("span",{className:"mr-2",children:""}),"Driver Report"]}),r.jsxs("button",{onClick:()=>w("full_audit"),disabled:m,className:"flex items-center justify-center px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[r.jsx("span",{className:"mr-2",children:""}),"Full Audit"]})]})]})]}),g==="reports"&&r.jsxs("div",{className:"space-y-6",children:[m&&r.jsx("div",{className:"flex justify-center",children:r.jsx(Mr,{message:"Generating report..."})}),r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Generate New Report"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs("button",{onClick:()=>w("vehicle"),disabled:m,className:"p-4 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 text-left",children:[r.jsx("div",{className:"text-2xl mb-2",children:""}),r.jsx("h4",{className:"font-medium",children:"Vehicle Compliance"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Registration & insurance status"})]}),r.jsxs("button",{onClick:()=>w("driver"),disabled:m,className:"p-4 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 text-left",children:[r.jsx("div",{className:"text-2xl mb-2",children:""}),r.jsx("h4",{className:"font-medium",children:"Driver Compliance"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Medical certs & CDL status"})]}),r.jsxs("button",{onClick:()=>w("expiration"),disabled:m,className:"p-4 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 text-left",children:[r.jsx("div",{className:"text-2xl mb-2",children:""}),r.jsx("h4",{className:"font-medium",children:"Expiration Summary"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Upcoming renewals"})]}),r.jsxs("button",{onClick:()=>w("full_audit"),disabled:m,className:"p-4 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 disabled:opacity-50 text-left",children:[r.jsx("div",{className:"text-2xl mb-2",children:""}),r.jsx("h4",{className:"font-medium",children:"Full Audit"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Comprehensive report"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Generated Reports"})}),r.jsx("div",{className:"divide-y divide-gray-200",children:s.length===0?r.jsx("div",{className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"text-gray-500",children:[r.jsx("p",{className:"text-lg",children:" No reports generated yet"}),r.jsx("p",{className:"text-sm mt-1",children:"Generate your first compliance report above"})]})}):s.map(E=>r.jsx("div",{className:"px-6 py-4 hover:bg-gray-50",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-medium text-gray-900",children:E.title}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Generated: ",new Date(E.generatedAt).toLocaleString()]}),r.jsxs("div",{className:"flex items-center mt-2 space-x-4 text-xs text-gray-500",children:[r.jsxs("span",{children:["Compliant: ",E.summary.compliantCount]}),r.jsxs("span",{children:["Non-compliant: ",E.summary.nonCompliantCount]}),r.jsxs("span",{children:["Expiring: ",E.summary.expiringCount]})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("button",{onClick:()=>u(E),className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"View"}),r.jsx("button",{onClick:()=>D(E,"pdf"),className:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"Export PDF"}),r.jsx("button",{onClick:()=>D(E,"excel"),className:"px-3 py-1 text-sm bg-green-100 text-green-700 rounded hover:bg-green-200",children:"Export CSV"})]})]})},E.id))})]}),c&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-screen overflow-hidden",children:[r.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[r.jsx("h3",{className:"text-lg font-semibold",children:c.title}),r.jsx("button",{onClick:()=>u(null),className:"text-gray-400 hover:text-gray-600",children:""})]}),r.jsx("div",{className:"p-6 max-h-96 overflow-y-auto",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.summary.compliantCount}),r.jsx("div",{className:"text-sm text-gray-600",children:"Compliant"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:c.summary.nonCompliantCount}),r.jsx("div",{className:"text-sm text-gray-600",children:"Non-compliant"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:c.summary.expiringCount}),r.jsx("div",{className:"text-sm text-gray-600",children:"Expiring"})]})]}),c.summary.criticalIssues.length>0&&r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-red-800 mb-2",children:" Critical Issues"}),r.jsx("ul",{className:"space-y-1",children:c.summary.criticalIssues.map((E,A)=>r.jsx("li",{className:"text-sm text-red-700 bg-red-50 p-2 rounded",children:E},A))})]}),c.summary.recommendations.length>0&&r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:" Recommendations"}),r.jsx("ul",{className:"space-y-1",children:c.summary.recommendations.map((E,A)=>r.jsx("li",{className:"text-sm text-yellow-700 bg-yellow-50 p-2 rounded",children:E},A))})]})]})}),r.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end space-x-2",children:[r.jsx("button",{onClick:()=>D(c,"pdf"),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Export PDF"}),r.jsx("button",{onClick:()=>D(c,"excel"),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Export CSV"})]})]})})]}),g==="schedule"&&r.jsx("div",{className:"space-y-6",children:r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Schedule Automatic Reports"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"Set up regular compliance reports to stay on top of expiring documents."}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("button",{onClick:()=>ra.scheduleAutomaticReports("daily"),className:"p-4 border border-gray-300 rounded-lg hover:bg-gray-50 text-left",children:[r.jsx("div",{className:"text-2xl mb-2",children:""}),r.jsx("h4",{className:"font-medium",children:"Daily Reports"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Critical compliance alerts"})]}),r.jsxs("button",{onClick:()=>ra.scheduleAutomaticReports("weekly"),className:"p-4 border border-gray-300 rounded-lg hover:bg-gray-50 text-left",children:[r.jsx("div",{className:"text-2xl mb-2",children:""}),r.jsx("h4",{className:"font-medium",children:"Weekly Reports"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Comprehensive status updates"})]}),r.jsxs("button",{onClick:()=>ra.scheduleAutomaticReports("monthly"),className:"p-4 border border-gray-300 rounded-lg hover:bg-gray-50 text-left",children:[r.jsx("div",{className:"text-2xl mb-2",children:""}),r.jsx("h4",{className:"font-medium",children:"Monthly Reports"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Full audit and planning"})]})]})]})})]})}function Mt({label:f,value:a,onChange:s,validator:i,placeholder:c,required:u=!1,type:m="text",helpText:h}){const[g,x]=K.useState({isValid:!0,errors:[],warnings:[]}),[y,w]=K.useState(!1);K.useEffect(()=>{if(i&&y){const E=i(a);x(E)}},[a,i,y]);const D=()=>{if(w(!0),i){const E=i(a);x(E)}},b=()=>y?g.isValid?g.warnings.length>0?"border-yellow-500 focus:border-yellow-500":"border-green-500 focus:border-green-500":"border-red-500 focus:border-red-500":"border-gray-300 focus:border-blue-500",v=()=>y?g.isValid?g.warnings.length>0?"":"":"":null;return r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[f,u&&r.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:m,value:a,onChange:E=>s(E.target.value),onBlur:D,placeholder:c,className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-opacity-50 ${b()}`}),v()&&r.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:r.jsx("span",{className:"text-sm",children:v()})})]}),h&&!y&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:h}),y&&r.jsxs("div",{className:"mt-1",children:[g.errors.map((E,A)=>r.jsxs("p",{className:"text-xs text-red-600 flex items-center",children:[r.jsx("span",{className:"mr-1",children:""}),E.message]},A)),g.warnings.map((E,A)=>r.jsxs("p",{className:"text-xs text-yellow-600 flex items-center",children:[r.jsx("span",{className:"mr-1",children:""}),E.message,E.suggestion&&r.jsxs("span",{className:"ml-1 text-gray-500",children:["(",E.suggestion,")"]})]},A))]})]})}function gl({title:f,children:a,collapsible:s=!1,defaultCollapsed:i=!1}){const[c,u]=K.useState(i);return r.jsxs("div",{className:"mb-6",children:[r.jsxs("div",{className:`flex items-center justify-between p-4 bg-gray-50 rounded-t-lg border ${s?"cursor-pointer hover:bg-gray-100":""}`,onClick:s?()=>u(!c):void 0,children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:f}),s&&r.jsx("span",{className:"text-gray-500",children:c?"":""})]}),!c&&r.jsx("div",{className:"p-4 border border-t-0 rounded-b-lg bg-white",children:a})]})}function Ag(f,a){const[s,i]=K.useState(f),[c,u]=K.useState({isValid:!0,errors:[],warnings:[]}),[m,h]=K.useState({});return{data:s,validation:c,touched:m,updateField:(w,D)=>{const b={...s,[w]:D};i(b),h(E=>({...E,[w]:!0}));const v=a(b);u(v)},validateAll:()=>{const w=a(s);u(w);const b=Object.keys(s).reduce((v,E)=>(v[E]=!0,v),{});return h(b),w},reset:()=>{i(f),u({isValid:!0,errors:[],warnings:[]}),h({})},isValid:c.isValid}}function lv({onLoginSuccess:f,onSwitchToRegister:a}){const[s,i]=K.useState(!1),{data:c,updateField:u,validateAll:m,isValid:h}=Ag({email:"",password:""},x=>{const y={isValid:!!x.email,errors:[],warnings:[]},w={isValid:x.password.length>=1,errors:x.password.length<1?[{field:"password",message:"Password is required",value:x.password,severity:"error"}]:[],warnings:[]};return{isValid:y.isValid&&w.isValid,errors:[...y.errors,...w.errors],warnings:[...y.warnings,...w.warnings]}}),g=async x=>{if(x.preventDefault(),!!m().isValid){i(!0);try{await ot.login(c),f()}catch{}finally{i(!1)}}};return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 py-12 px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"max-w-md w-full space-y-8",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-r from-orange-500 to-red-600 rounded-xl flex items-center justify-center text-2xl font-bold text-white mb-4",children:"T"}),r.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Welcome to TruckBo Pro"}),r.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Fleet Compliance Management System"})]}),r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[r.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"Demo Accounts Available:"}),r.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Sunbelt Trucking:"})," admin@sunbelttrucking.com"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Lone Star Logistics:"})," admin@lonestarlogistics.com"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Password:"})," TruckBo2025!"]}),r.jsx("div",{className:"text-xs text-amber-600 mt-1",children:" Demo only - Use strong passwords in production"})]})]}),r.jsxs("form",{className:"mt-8 space-y-6",onSubmit:g,children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx(Mt,{label:"Email Address",type:"email",value:c.email,onChange:x=>u("email",x),validator:x=>({isValid:!!x,errors:[],warnings:[]}),placeholder:"admin@yourcompany.com",required:!0}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),r.jsx("input",{type:"password",value:c.password,onChange:x=>u("password",x.target.value),placeholder:"Enter your password",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),r.jsx("div",{children:r.jsx("button",{type:"submit",disabled:s||!h,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:s?r.jsx(Mr,{size:"sm",message:""}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:""}),"Sign In"]})})}),r.jsx("div",{className:"text-center",children:r.jsx("button",{type:"button",onClick:a,className:"text-sm text-blue-600 hover:text-blue-500",children:"New company? Register here"})})]})]})})}const cv=f=>{const s=/[A-Z]/.test(f),i=/[a-z]/.test(f),c=/\d/.test(f),u=/[!@#$%^&*(),.?":{}|<>]/.test(f);return f.length<12?{isValid:!1,message:"Password must be at least 12 characters long"}:s?i?c?u?{isValid:!0,message:"Password is strong"}:{isValid:!1,message:'Password must contain at least one special character (!@#$%^&*(),.?":{}|<>)'}:{isValid:!1,message:"Password must contain at least one number"}:{isValid:!1,message:"Password must contain at least one lowercase letter"}:{isValid:!1,message:"Password must contain at least one uppercase letter"}};function ov({onRegistrationSuccess:f,onSwitchToLogin:a}){const[s,i]=K.useState(!1),[c,u]=K.useState(1),m=3,{data:h,validation:g,updateField:x,validateAll:y}=Ag({companyName:"",contactEmail:"",contactPhone:"",dotNumber:"",mcNumber:"",street:"",city:"",state:"",zipCode:"",firstName:"",lastName:"",email:"",password:"",confirmPassword:"",plan:"professional"},b=>{const v=[],E=[];if(b.companyName||v.push({field:"companyName",message:"Company name is required",value:b.companyName,severity:"error"}),b.contactEmail&&!b.contactEmail.includes("@")&&v.push({field:"contactEmail",message:"Invalid email format",value:b.contactEmail,severity:"error"}),b.email&&!b.email.includes("@")&&v.push({field:"email",message:"Invalid email format",value:b.email,severity:"error"}),b.password){const A=cv(b.password);A.isValid||v.push({field:"password",message:A.message,value:b.password,severity:"error"})}return b.password&&b.confirmPassword&&b.password!==b.confirmPassword&&v.push({field:"confirmPassword",message:"Passwords do not match",value:b.confirmPassword,severity:"error"}),c>=1&&(b.companyName||v.push({field:"companyName",message:"Required",value:b.companyName,severity:"error"}),b.contactEmail||v.push({field:"contactEmail",message:"Required",value:b.contactEmail,severity:"error"}),b.contactPhone||v.push({field:"contactPhone",message:"Required",value:b.contactPhone,severity:"error"})),c>=2&&(b.street||v.push({field:"street",message:"Required",value:b.street,severity:"error"}),b.city||v.push({field:"city",message:"Required",value:b.city,severity:"error"}),b.state||v.push({field:"state",message:"Required",value:b.state,severity:"error"}),b.zipCode||v.push({field:"zipCode",message:"Required",value:b.zipCode,severity:"error"})),c>=3&&(b.firstName||v.push({field:"firstName",message:"Required",value:b.firstName,severity:"error"}),b.lastName||v.push({field:"lastName",message:"Required",value:b.lastName,severity:"error"}),b.email||v.push({field:"email",message:"Required",value:b.email,severity:"error"}),b.password||v.push({field:"password",message:"Required",value:b.password,severity:"error"})),{isValid:v.length===0,errors:v,warnings:E}}),w=async b=>{if(b.preventDefault(),c<m){u(c+1);return}if(y().isValid){i(!0);try{const E={companyName:h.companyName,contactEmail:h.contactEmail,contactPhone:h.contactPhone,dotNumber:h.dotNumber||void 0,mcNumber:h.mcNumber||void 0,address:{street:h.street,city:h.city,state:h.state,zipCode:h.zipCode},adminUser:{firstName:h.firstName,lastName:h.lastName,email:h.email,password:h.password},subscription:{plan:h.plan}};await ot.registerCompany(E),f()}catch{}finally{i(!1)}}},D=()=>g.errors.filter(v=>c===1?["companyName","contactEmail","contactPhone"].includes(v.field):c===2?["street","city","state","zipCode"].includes(v.field):c===3?["firstName","lastName","email","password","confirmPassword"].includes(v.field):!1).length===0;return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 py-12 px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"max-w-2xl w-full space-y-8",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-r from-orange-500 to-red-600 rounded-xl flex items-center justify-center text-2xl font-bold text-white mb-4",children:"T"}),r.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Register Your Fleet"}),r.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Get started with TruckBo Pro compliance management"})]}),r.jsx("div",{className:"flex items-center justify-center space-x-4 mb-8",children:[1,2,3].map(b=>r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${b<=c?"bg-blue-600 text-white":"bg-gray-200 text-gray-500"}`,children:b}),b<3&&r.jsx("div",{className:`w-12 h-1 ${b<c?"bg-blue-600":"bg-gray-200"}`})]},b))}),r.jsxs("form",{onSubmit:w,className:"space-y-6",children:[c===1&&r.jsx(gl,{title:"Company Information",children:r.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[r.jsx(Mt,{label:"Company Name",value:h.companyName,onChange:b=>x("companyName",b),placeholder:"Sunbelt Trucking LLC",required:!0}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(Mt,{label:"Contact Email",type:"email",value:h.contactEmail,onChange:b=>x("contactEmail",b),placeholder:"admin@yourcompany.com",required:!0}),r.jsx(Mt,{label:"Contact Phone",type:"tel",value:h.contactPhone,onChange:b=>x("contactPhone",b),placeholder:"214-555-0123",required:!0})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(Mt,{label:"DOT Number (Optional)",value:h.dotNumber,onChange:b=>x("dotNumber",b),placeholder:"12345678",helpText:"Federal DOT registration number"}),r.jsx(Mt,{label:"MC Number (Optional)",value:h.mcNumber,onChange:b=>x("mcNumber",b),placeholder:"MC-123456",helpText:"Motor Carrier authority number"})]})]})}),c===2&&r.jsx(gl,{title:"Company Address",children:r.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[r.jsx(Mt,{label:"Street Address",value:h.street,onChange:b=>x("street",b),placeholder:"123 Industrial Blvd",required:!0}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx(Mt,{label:"City",value:h.city,onChange:b=>x("city",b),placeholder:"Dallas",required:!0}),r.jsx(Mt,{label:"State",value:h.state,onChange:b=>x("state",b),placeholder:"TX",required:!0,helpText:"2-letter state code"}),r.jsx(Mt,{label:"ZIP Code",value:h.zipCode,onChange:b=>x("zipCode",b),placeholder:"75201",required:!0})]})]})}),c===3&&r.jsxs("div",{className:"space-y-6",children:[r.jsx(gl,{title:"Admin User Account",children:r.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(Mt,{label:"First Name",value:h.firstName,onChange:b=>x("firstName",b),placeholder:"Sarah",required:!0}),r.jsx(Mt,{label:"Last Name",value:h.lastName,onChange:b=>x("lastName",b),placeholder:"Johnson",required:!0})]}),r.jsx(Mt,{label:"Admin Email",type:"email",value:h.email,onChange:b=>x("email",b),placeholder:"sarah@yourcompany.com",required:!0,helpText:"This will be your login email"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),r.jsx("input",{type:"password",value:h.password,onChange:b=>x("password",b.target.value),placeholder:"Min 12 chars, uppercase, lowercase, number, special char",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),r.jsx("input",{type:"password",value:h.confirmPassword,onChange:b=>x("confirmPassword",b.target.value),placeholder:"Confirm your password",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]})]})}),r.jsx(gl,{title:"Subscription Plan",children:r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{id:"basic",name:"Basic",price:"$49/month",vehicles:"10 vehicles",drivers:"20 drivers"},{id:"professional",name:"Professional",price:"$99/month",vehicles:"50 vehicles",drivers:"100 drivers"},{id:"enterprise",name:"Enterprise",price:"$199/month",vehicles:"500 vehicles",drivers:"1000 drivers"}].map(b=>r.jsx("div",{className:`p-4 border rounded-lg cursor-pointer ${h.plan===b.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>x("plan",b.id),children:r.jsxs("div",{className:"text-center",children:[r.jsx("h3",{className:"font-medium",children:b.name}),r.jsx("p",{className:"text-2xl font-bold text-blue-600 my-2",children:b.price}),r.jsx("p",{className:"text-sm text-gray-600",children:b.vehicles}),r.jsx("p",{className:"text-sm text-gray-600",children:b.drivers}),r.jsx("p",{className:"text-xs text-green-600 mt-2",children:"30-day free trial"})]})},b.id))})})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("div",{children:c>1&&r.jsx("button",{type:"button",onClick:()=>u(c-1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:" Back"})}),r.jsxs("div",{className:"flex space-x-4",children:[r.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 text-blue-600 hover:text-blue-500",children:"Already have an account?"}),r.jsx("button",{type:"submit",disabled:s||!D(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:s?r.jsx(Mr,{size:"sm",message:""}):c<m?"Next ":"Create Company"})]})]})]})]})})}function uv({children:f}){const[a,s]=K.useState(!1),[i,c]=K.useState(!1),[u,m]=K.useState(!0);return K.useEffect(()=>((async()=>{try{await ot.initializeDemo(),s(ot.isAuthenticated())}catch(x){console.error("Failed to initialize authentication:",x)}finally{m(!1)}})(),ot.subscribeToSession(x=>{s(!!x)})),[]),u?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(Mr,{message:"Loading TruckBo Pro..."})}):a?r.jsx(r.Fragment,{children:f}):i?r.jsx(ov,{onRegistrationSuccess:()=>s(!0),onSwitchToLogin:()=>c(!1)}):r.jsx(lv,{onLoginSuccess:()=>s(!0),onSwitchToRegister:()=>c(!0)})}class dv{constructor(){ce(this,"NHTSA_VIN_API","https://vpic.nhtsa.dot.gov/api/vehicles");ce(this,"FMCSA_API_BASE","https://mobile.fmcsa.dot.gov/qc/services/carriers");ce(this,"IFTA_API_BASE","https://api.iftach.org/v1");ce(this,"FMCSA_API_KEY",window.REACT_APP_FMCSA_API_KEY||"demo-key");ce(this,"IFTA_API_KEY",window.REACT_APP_IFTA_API_KEY||"demo-key")}async decodeVIN(a){try{const s=await fetch(`${this.NHTSA_VIN_API}/DecodeVin/${a}?format=json`);if(!s.ok)throw new Error(`NHTSA API error: ${s.status}`);const c=(await s.json()).Results||[],u=m=>{const h=c.find(g=>g.Variable===m);return(h==null?void 0:h.Value)||""};return{Make:u("Make"),Model:u("Model"),ModelYear:u("Model Year"),VehicleType:u("Vehicle Type"),FuelTypePrimary:u("Fuel Type - Primary"),GVWR:u("Gross Vehicle Weight Rating From"),VehicleClass:u("Vehicle Class"),Results:c}}catch(s){return console.error("VIN decode error:",s),null}}async getCarrierInfo(a){try{const s=await fetch(`${this.FMCSA_API_BASE}/${a}?webKey=${this.FMCSA_API_KEY}`);if(!s.ok)throw new Error(`FMCSA API error: ${s.status}`);const i=await s.json();return{dotNumber:i.dotNumber||a,legalName:i.legalName||"",dbaName:i.dbaName||"",carrierOperation:i.carrierOperation||"",hm:i.hm||"",pc:i.pc||"",safetyRating:i.safetyRating||"",safetyRatingDate:i.safetyRatingDate||"",reviewDate:i.reviewDate||"",outOfServiceDate:i.outOfServiceDate||""}}catch(s){return console.error("FMCSA API error:",s),this.getMockCarrierInfo(a)}}async getIFTAFilingData(a,s,i){try{const c=await fetch(`${this.IFTA_API_BASE}/filings/${a}/${i}/${s}`,{headers:{Authorization:`Bearer ${this.IFTA_API_KEY}`,"Content-Type":"application/json"}});if(!c.ok)throw new Error(`IFTA API error: ${c.status}`);return await c.json()}catch(c){return console.error("IFTA API error:",c),this.getMockIFTAData(s,i)}}async getDOTInspectionHistory(a){try{return this.getMockInspectionData(a)}catch(s){return console.error("DOT inspection API error:",s),[]}}async getRegistrationStatus(a,s){try{return this.getMockRegistrationData(a,s)}catch(i){return console.error("Registration API error:",i),null}}async getInsuranceStatus(a,s){try{return this.getMockInsuranceData(a)}catch(i){return console.error("Insurance API error:",i),null}}async getEmissionsStatus(a){try{return this.getMockEmissionsData(a)}catch(s){return console.error("Emissions API error:",s),null}}getMockCarrierInfo(a){return{dotNumber:a,legalName:"Demo Trucking Company LLC",dbaName:"Demo Trucking",carrierOperation:"Interstate",hm:"No",pc:"Yes",safetyRating:"Satisfactory",safetyRatingDate:"2024-06-15",reviewDate:"2024-06-15",outOfServiceDate:""}}getMockIFTAData(a,s){const i=this.calculateIFTADueDate(a,s);return{quarter:a,year:s,dueDate:i,jurisdictions:[{code:"CA",miles:2500,gallons:625,taxRate:.47,taxDue:293.75},{code:"NV",miles:1200,gallons:300,taxRate:.52,taxDue:156},{code:"AZ",miles:800,gallons:200,taxRate:.47,taxDue:94}],totalTaxDue:543.75,filingStatus:new Date(i)<new Date?"overdue":"pending"}}getMockInspectionData(a){return[{inspectionDate:"2024-06-15",inspectionType:"Annual DOT Inspection",inspectionLevel:"Level I",violations:[{code:"393.9",description:"Inoperative brake lamps",severity:"minor"}],outOfService:!1,nextInspectionDue:"2025-06-15"}]}getMockRegistrationData(a,s){return{isValid:!0,expiryDate:"2025-03-31",registrationNumber:`CA${a.slice(-6)}`}}getMockInsuranceData(a){return{isActive:!0,expiryDate:"2024-12-31",coverageAmount:1e6,provider:"Commercial Insurance Co."}}getMockEmissionsData(a){return{isCompliant:!0,lastTestDate:"2024-01-15",nextTestDue:"2025-01-15",emissionStandard:"EPA 2010"}}calculateIFTADueDate(a,s){return{Q1:`${s}-04-30`,Q2:`${s}-07-31`,Q3:`${s}-10-31`,Q4:`${s+1}-01-31`}[a]||`${s}-12-31`}async getComprehensiveComplianceData(a,s){try{const[i,c,u,m,h,g]=await Promise.allSettled([this.decodeVIN(a),s?this.getCarrierInfo(s):Promise.resolve(null),this.getDOTInspectionHistory(a),this.getRegistrationStatus(a,"CA"),this.getInsuranceStatus(a),this.getEmissionsStatus(a)]);return{vin:a,vehicleData:i.status==="fulfilled"?i.value:null,carrierData:c.status==="fulfilled"?c.value:null,inspections:u.status==="fulfilled"?u.value:[],registration:m.status==="fulfilled"?m.value:null,insurance:h.status==="fulfilled"?h.value:null,emissions:g.status==="fulfilled"?g.value:null,lastUpdated:new Date().toISOString()}}catch(i){throw console.error("Comprehensive compliance check error:",i),i}}}const fv=new dv;class mv{constructor(){ce(this,"cache",new Map);ce(this,"rateLimits",new Map);ce(this,"defaultRetryConfig",{maxRetries:3,delayMs:1e3,backoffMultiplier:2});ce(this,"API_RATE_LIMITS",{nhtsa:{requests:5,windowMs:1e3},fmcsa:{requests:10,windowMs:6e4},ifta:{requests:30,windowMs:6e4},default:{requests:20,windowMs:6e4}});ce(this,"CACHE_TTL",{vinDecoding:1440*60*1e3,carrierInfo:3600*1e3,inspectionHistory:1800*1e3,registrationStatus:3600*1e3,insuranceStatus:1800*1e3,emissionsStatus:3600*1e3,iftaData:900*1e3,default:3600*1e3})}async executeApiCall(a,s,i={}){const{cacheType:c="default",rateLimitKey:u="default",retryConfig:m={},skipCache:h=!1}=i;if(!h){const y=this.getFromCache(a);if(y)return console.log(`Cache hit for: ${a}`),y}await this.enforceRateLimit(u);const g={...this.defaultRetryConfig,...m},x=await this.executeWithRetry(s,g);return!h&&x&&this.setCache(a,x,this.CACHE_TTL[c]||this.CACHE_TTL.default),x}getFromCache(a){const s=this.cache.get(a);return s?Date.now()-s.timestamp>s.ttl?(this.cache.delete(a),null):s.data:null}setCache(a,s,i){this.cache.set(a,{data:s,timestamp:Date.now(),ttl:i}),this.cache.size>1e3&&this.cleanupCache()}cleanupCache(){const a=Date.now();for(const[s,i]of this.cache.entries())a-i.timestamp>i.ttl&&this.cache.delete(s)}async enforceRateLimit(a){const s=this.API_RATE_LIMITS[a]||this.API_RATE_LIMITS.default;if(!s)return;const i=Date.now();let c=this.rateLimits.get(a);if((!c||i-c.windowStart>s.windowMs)&&(c={requests:s.requests,windowMs:s.windowMs,currentCount:0,windowStart:i},this.rateLimits.set(a,c)),c.currentCount>=c.requests){const u=c.windowMs-(i-c.windowStart);console.log(`Rate limit reached for ${a}, waiting ${u}ms`),await this.sleep(u),c.currentCount=0,c.windowStart=Date.now()}c.currentCount++}async executeWithRetry(a,s){let i,c=s.delayMs;for(let u=0;u<=s.maxRetries;u++)try{const m=await a();return u>0&&console.log(`API call succeeded on attempt ${u+1}`),m}catch(m){if(i=m instanceof Error?m:new Error(String(m)),u===s.maxRetries)throw console.error(`API call failed after ${s.maxRetries+1} attempts:`,i),i;if(!this.isRetryableError(i))throw console.error("Non-retryable error:",i),i;console.warn(`API call failed (attempt ${u+1}), retrying in ${c}ms:`,i.message),await this.sleep(c),c*=s.backoffMultiplier}throw i}isRetryableError(a){const s=a.message.toLowerCase();return s.includes("network")||s.includes("timeout")||s.includes("connection")||s.includes("500")||s.includes("502")||s.includes("503")||s.includes("504")||s.includes("429")?!0:!(s.includes("400")||s.includes("401")||s.includes("403")||s.includes("404"))}sleep(a){return new Promise(s=>setTimeout(s,a))}clearCache(){this.cache.clear(),console.log("API cache cleared")}clearCachePattern(a){const s=new RegExp(a);for(const i of this.cache.keys())s.test(i)&&this.cache.delete(i);console.log(`Cache cleared for pattern: ${a}`)}getCacheStats(){const a=this.cache.size;let s=0;for(const[i,c]of this.cache.entries())s+=i.length*2,s+=JSON.stringify(c.data).length*2,s+=24;return{totalEntries:a,hitRate:0,memoryUsage:Math.round(s/1024)}}getRateLimitStatus(){const a={},s=Date.now();for(const[i,c]of this.rateLimits.entries()){const u=c.windowMs-(s-c.windowStart);a[i]={remaining:Math.max(0,c.requests-c.currentCount),resetTime:u>0?u:0,windowMs:c.windowMs}}return a}async refreshCache(a,s,i="default"){return this.cache.delete(a),this.executeApiCall(a,s,{cacheType:i,skipCache:!1})}}const Ja=new mv;class hv{constructor(){ce(this,"SAFER_QUERY_URL","http://www.safersys.org/query.asp");ce(this,"SAFER_SNAPSHOT_URL","https://safer.fmcsa.dot.gov/CompanySnapshot.aspx");ce(this,"lastRequestTime",0);ce(this,"MIN_REQUEST_INTERVAL",2e3)}async searchByDOTNumber(a){try{if(!a||a.trim()==="")return{success:!1,error:"DOT number is required",source:"safer_web_scrape"};const s=a.replace(/\D/g,"");if(s.length<1)return{success:!1,error:"Invalid DOT number format",source:"safer_web_scrape"};await this.respectRateLimit(),console.log(` Searching SAFER database for DOT: ${s} (original: ${a})`);let i=await this.queryEndpoint(s);return i.success||(i=await this.companySnapshot(s)),i}catch(s){return console.error("SAFER scraping error:",s),{success:!1,error:`Failed to fetch data from SAFER: ${s instanceof Error&&s instanceof Error?s.message:String(s)}`,source:"safer_web_scrape"}}}async queryEndpoint(a){try{const s=new URLSearchParams({query_type:"queryCarrierSnapshot",query_param:"USDOT",query_string:a,query_name:""});console.log(` Querying safersys.org for DOT: ${a}`);const i=await fetch(this.SAFER_QUERY_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","Accept-Language":"en-US,en;q=0.5","Accept-Encoding":"gzip, deflate"},body:s});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const c=await i.text(),u=this.parseQueryResponse(c,a);return u?{success:!0,data:u,source:"safer_web_scrape"}:{success:!1,error:"No data found for this DOT number",source:"safer_web_scrape"}}catch(s){return console.error("Query endpoint error:",s),{success:!1,error:s instanceof Error?s.message:String(s),source:"safer_web_scrape"}}}async companySnapshot(a){try{const s=`${this.SAFER_SNAPSHOT_URL}?query_type=queryCarrierSnapshot&query_param=USDOT&query_string=${a}`,i=await fetch(s,{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"}});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const c=await i.text(),u=this.parseSnapshotResponse(c,a);return u?{success:!0,data:u,source:"safer_web_scrape"}:{success:!1,error:"No data found in company snapshot",source:"safer_web_scrape"}}catch(s){return console.error("Company snapshot error:",s),{success:!1,error:s instanceof Error?s.message:String(s),source:"safer_web_scrape"}}}parseQueryResponse(a,s){var i,c;try{if(a.toLowerCase().includes("no records")||a.toLowerCase().includes("no data found")||a.toLowerCase().includes("not found"))return console.log(` No SAFER records found for DOT: ${s}`),null;const m=new DOMParser().parseFromString(a,"text/html");let h={dotNumber:s,lastUpdated:new Date().toISOString(),operatingStatus:"Unknown"};const g=m.querySelectorAll("table");for(const x of g){const y=x.querySelectorAll("tr");for(const w of y){const D=w.querySelectorAll("td, th");for(let b=0;b<D.length-1;b++){const v=D[b],E=D[b+1],A=((i=v.textContent)==null?void 0:i.trim().toLowerCase())||"",X=((c=E.textContent)==null?void 0:c.trim())||"";!X||X===""||X==="-"||(A.includes("legal name")||A.includes("entity name")?h.legalName=X:A.includes("dba name")||A.includes("operating")&&A.includes("name")?h.dbaName=X:A.includes("physical address")?h.physicalAddress=this.cleanAddress(X):A.includes("mailing address")?h.mailingAddress=this.cleanAddress(X):A.includes("phone")?h.phone=X:A.includes("safety rating")?h.safetyRating=X:A.includes("operating status")||A.includes("carrier operation")?h.operatingStatus=X:A.includes("drivers")&&!A.includes("out")?h.numberOfDrivers=this.parseNumber(X):A.includes("power units")||A.includes("trucks")?h.numberOfPowerUnits=this.parseNumber(X):A.includes("carrier operation")&&(h.carrierOperationType=X))}}}return h.legalName&&h.physicalAddress?h:null}catch(u){return console.error("HTML parsing error:",u),null}}parseSnapshotResponse(a,s){var i;try{const u=new DOMParser().parseFromString(a,"text/html");if(a.toLowerCase().includes("no data found")||a.toLowerCase().includes("no records found"))return null;let m={dotNumber:s,lastUpdated:new Date().toISOString()};const h=((i=u.body)==null?void 0:i.textContent)||a,g={legalName:/Legal Name[:\s]+([^\n\r]+)/i,dbaName:/DBA Name[:\s]+([^\n\r]+)/i,phone:/Phone[:\s]+([\d\-\(\)\s]+)/i,safetyRating:/Safety Rating[:\s]+([^\n\r]+)/i,operatingStatus:/Operating Status[:\s]+([^\n\r]+)/i};for(const[x,y]of Object.entries(g)){const w=h.match(y);w&&w[1]&&(m[x]=w[1].trim())}return m.legalName||(m.legalName="Unknown Carrier"),m.physicalAddress||(m.physicalAddress="Address Not Available"),m.operatingStatus||(m.operatingStatus="Unknown"),m}catch(c){return console.error("Snapshot parsing error:",c),null}}async respectRateLimit(){const s=Date.now()-this.lastRequestTime;if(s<this.MIN_REQUEST_INTERVAL){const i=this.MIN_REQUEST_INTERVAL-s;console.log(`Rate limiting: waiting ${i}ms`),await new Promise(c=>setTimeout(c,i))}this.lastRequestTime=Date.now()}async batchSearch(a){const s=[];console.log(`Starting batch search for ${a.length} DOT numbers`);for(let i=0;i<a.length;i++){const c=a[i];console.log(`Processing ${i+1}/${a.length}: DOT ${c}`);const u=await this.searchByDOTNumber(c);s.push(u),i<a.length-1&&await new Promise(m=>setTimeout(m,1e3))}return console.log(`Batch search completed: ${s.filter(i=>i.success).length} successful`),s}cleanAddress(a){return a.replace(/\s+/g," ").trim()}parseNumber(a){const s=a.match(/\d+/);return s?parseInt(s[0],10):0}async checkSaferAvailability(){try{return(await fetch(this.SAFER_QUERY_URL,{method:"HEAD"})).ok}catch(a){return console.error("SAFER availability check failed:",a),!1}}}const gv=new hv;class xv{constructor(){ce(this,"CARB_TRUCRS_API","https://ww2.arb.ca.gov/applications/trucrs-reporting/api");ce(this,"CARB_PERP_API","https://ww2.arb.ca.gov/applications/perp/api");ce(this,"FMCSA_SAFER_API","https://mobile.fmcsa.dot.gov/qc/services");ce(this,"CA_DMV_API","https://www.dmv.ca.gov/portal/vehicle-industry-services/api");ce(this,"VERISK_API","https://api.verisk.com/vehicle-data/v1");ce(this,"STATE_DMV_APIS",{CA:"https://www.dmv.ca.gov/portal/api",TX:"https://www.txdmv.gov/api",NY:"https://dmv.ny.gov/api",FL:"https://www.flhsmv.gov/api"});ce(this,"CARB_API_KEY",window.REACT_APP_CARB_API_KEY||"demo-key");ce(this,"FMCSA_API_KEY",window.REACT_APP_FMCSA_API_KEY||"demo-key");ce(this,"VERISK_API_KEY",window.REACT_APP_VERISK_API_KEY||"demo-key")}async getCARBEmissionsData(a){var s;try{const i=await Ja.executeApiCall(`carb-trucrs-${a}`,async()=>{const u=await fetch(`${this.CARB_TRUCRS_API}/vehicle/${a}`,{headers:{Authorization:`Bearer ${this.CARB_API_KEY}`,"Content-Type":"application/json"}});if(!u.ok)throw new Error(`CARB TRUCRS API error: ${u.status}`);return u.json()},{cacheType:"emissionsStatus",rateLimitKey:"default"}),c=await Ja.executeApiCall(`carb-perp-${a}`,async()=>{const u=await fetch(`${this.CARB_PERP_API}/vehicle/${a}/status`,{headers:{Authorization:`Bearer ${this.CARB_API_KEY}`,"Content-Type":"application/json"}});if(!u.ok)throw new Error(`CARB PERP API error: ${u.status}`);return u.json()},{cacheType:"emissionsStatus",rateLimitKey:"default"});return{vin:a,emissionsStandard:i.emissionsStandard||"EPA 2010",lastInspectionDate:((s=i.lastInspection)==null?void 0:s.date)||"",nextInspectionDue:i.nextInspectionDue||"",complianceStatus:i.complianceStatus||"pending",violations:i.violations||[],perpStatus:c?{enrolled:c.enrolled||!1,testDate:c.lastTestDate,result:c.lastTestResult}:void 0}}catch(i){return console.error("CARB API error:",i),null}}async getEnhancedFMCSAData(a){try{if(!a||a.trim()==="")return console.warn(" No DOT number provided. FMCSA data requires a DOT number to identify the carrier."),console.log(" DOT numbers identify the company that operates the vehicle. Add the carrier's DOT number to get compliance data."),null;if(this.FMCSA_API_KEY&&this.FMCSA_API_KEY!=="demo-key")return console.log(` Using official FMCSA API for DOT: ${a}`),await this.getOfficialFMCSAData(a);console.log(` Attempting SAFER web scraping for DOT: ${a}`);const s=await gv.searchByDOTNumber(a);return s.success&&s.data?(console.log(` SAFER scraping successful: ${s.data.legalName}`),{dotNumber:a,legalName:s.data.legalName||"Unknown Carrier",dbaName:s.data.dbaName||"",safetyRating:s.data.safetyRating||"Not Rated",safetyRatingDate:s.data.safetyRatingDate||"",smsData:{unsafeDriving:0,hoursOfService:0,driverFitness:0,controlledSubstances:0,vehicleMaintenance:0,hazmatCompliance:0,crashIndicator:0},insuranceData:{hasRequiredInsurance:s.data.insuranceRequired==="Yes",insuranceCarrier:"Available via SAFER",policyNumber:s.data.insuranceOnFile||"",effectiveDate:"",expirationDate:"",coverageAmount:0},inspectionHistory:[]}):(console.warn(` SAFER scraping failed: ${s.error||"No data found"}`),console.log(" To get reliable DOT data, obtain an FMCSA API key and set REACT_APP_FMCSA_API_KEY"),null)}catch(s){return console.error("Enhanced FMCSA API error:",s),null}}async getOfficialFMCSAData(a){const s=await Ja.executeApiCall(`fmcsa-carrier-${a}`,async()=>{const m=await fetch(`${this.FMCSA_SAFER_API}/carriers/${a}?webKey=${this.FMCSA_API_KEY}`);if(!m.ok)throw new Error(`FMCSA Carrier API error: ${m.status}`);return m.json()},{cacheType:"carrierInfo",rateLimitKey:"fmcsa"}),i=await Ja.executeApiCall(`fmcsa-sms-${a}`,async()=>{const m=await fetch(`${this.FMCSA_SAFER_API}/carriers/${a}/sms?webKey=${this.FMCSA_API_KEY}`);if(!m.ok)throw new Error(`FMCSA SMS API error: ${m.status}`);return m.json()},{cacheType:"carrierInfo",rateLimitKey:"fmcsa"}),c=await Ja.executeApiCall(`fmcsa-insurance-${a}`,async()=>{const m=await fetch(`${this.FMCSA_SAFER_API}/carriers/${a}/insurance?webKey=${this.FMCSA_API_KEY}`);if(!m.ok)throw new Error(`FMCSA Insurance API error: ${m.status}`);return m.json()},{cacheType:"insuranceStatus",rateLimitKey:"fmcsa"}),u=await Ja.executeApiCall(`fmcsa-inspections-${a}`,async()=>{const m=await fetch(`${this.FMCSA_SAFER_API}/carriers/${a}/inspections?webKey=${this.FMCSA_API_KEY}`);if(!m.ok)throw new Error(`FMCSA Inspection API error: ${m.status}`);return m.json()},{cacheType:"inspectionHistory",rateLimitKey:"fmcsa"});return{dotNumber:a,legalName:s.legalName||"",dbaName:s.dbaName||"",safetyRating:s.safetyRating||"",safetyRatingDate:s.safetyRatingDate||"",smsData:{unsafeDriving:i.unsafeDriving||0,hoursOfService:i.hoursOfService||0,driverFitness:i.driverFitness||0,controlledSubstances:i.controlledSubstances||0,vehicleMaintenance:i.vehicleMaintenance||0,hazmatCompliance:i.hazmatCompliance||0,crashIndicator:i.crashIndicator||0},insuranceData:{hasRequiredInsurance:c.hasRequiredInsurance||!1,insuranceCarrier:c.carrier||"",policyNumber:c.policyNumber||"",effectiveDate:c.effectiveDate||"",expirationDate:c.expirationDate||"",coverageAmount:c.coverageAmount||0},inspectionHistory:u.inspections||[]}}async getStateRegistrationData(a,s){var i,c,u;try{const m=this.getStateApiKey(s);if(!m||m==="demo-key")return console.warn(` No ${s} DMV API key available. Registration data for VIN ${a} will show as blanks.`),console.log(` To get real registration data, obtain a ${s} DMV API key and set REACT_APP_${s}_DMV_API_KEY`),null;const h=this.STATE_DMV_APIS[s];if(!h)return console.warn(` No API endpoint configured for state: ${s}`),null;console.log(` Using official ${s} DMV API for VIN: ${a}`);const g=await Ja.executeApiCall(`state-registration-${s}-${a}`,async()=>{const x=await fetch(`${h}/vehicle/registration/${a}`,{headers:{Authorization:`Bearer ${m}`,"Content-Type":"application/json"}});if(!x.ok)throw new Error(`${s} DMV API error: ${x.status}`);return x.json()},{cacheType:"registrationStatus",rateLimitKey:"default"});return{state:s,isValid:g.isValid||!1,registrationNumber:g.registrationNumber||"",expirationDate:g.expirationDate||"",vehicleType:g.vehicleType||"",weightClass:g.weightClass||"",fees:{registrationFee:((i=g.fees)==null?void 0:i.registrationFee)||0,weightFee:((c=g.fees)==null?void 0:c.weightFee)||0,totalFee:((u=g.fees)==null?void 0:u.totalFee)||0},restrictions:g.restrictions||[]}}catch(m){return console.error(`${s} DMV API error:`,m),null}}async getInsuranceVerification(a){try{const[s,i]=await Promise.allSettled([this.checkDMVInsurance(a),this.checkVeriskInsurance(a)]);return s.status==="fulfilled"&&s.value?s.value:i.status==="fulfilled"&&i.value?i.value:(console.warn(` No insurance verification APIs available for VIN: ${a}`),console.log(" To get real insurance data, obtain API keys for DMV or Verisk and configure them"),null)}catch(s){return console.error("Insurance verification error:",s),null}}async getDOTInspectionRecords(a,s){try{const i=[];if(s){const m=await this.getFMCSAInspections(s);i.push(...m)}const c=await this.getStateInspections(a);return i.push(...c),this.deduplicateInspections(i).sort((m,h)=>new Date(h.date).getTime()-new Date(m.date).getTime())}catch(i){return console.error("DOT inspection records error:",i),[]}}async getUnifiedComplianceData(a,s){try{console.log(`Starting unified compliance check for VIN: ${a}, DOT: ${s}`);const[i,c,u,m,h,g]=await Promise.allSettled([fv.decodeVIN(a),this.getCARBEmissionsData(a),s?this.getEnhancedFMCSAData(s):Promise.resolve(null),this.getStateRegistrationData(a,"CA"),this.getInsuranceVerification(a),this.getDOTInspectionRecords(a,s)]);return{vin:a,dotNumber:s,vehicleData:i.status==="fulfilled"?i.value:null,carbData:c.status==="fulfilled"?c.value:null,fmcsaData:u.status==="fulfilled"?u.value:null,registrationData:m.status==="fulfilled"?m.value:null,insuranceData:h.status==="fulfilled"?h.value:null,inspectionRecords:g.status==="fulfilled"?g.value:[],complianceScore:this.calculateComplianceScore({carbData:c.status==="fulfilled"?c.value:null,fmcsaData:u.status==="fulfilled"?u.value:null,registrationData:m.status==="fulfilled"?m.value:null,insuranceData:h.status==="fulfilled"?h.value:null}),lastUpdated:new Date().toISOString()}}catch(i){throw console.error("Unified compliance check error:",i),i}}async checkDMVInsurance(a){const s=await fetch(`${this.CA_DMV_API}/insurance/verify/${a}`,{headers:{Authorization:`Bearer ${this.getStateApiKey("CA")}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error(`DMV Insurance API error: ${s.status}`);const i=await s.json();return{isActive:i.isActive||!1,carrier:i.carrier||"",policyNumber:i.policyNumber||"",effectiveDate:i.effectiveDate||"",expirationDate:i.expirationDate||"",coverageTypes:i.coverageTypes||{liability:0,cargo:0},verificationSource:"dmv"}}async checkVeriskInsurance(a){const s=await fetch(`${this.VERISK_API}/insurance/verify`,{method:"POST",headers:{Authorization:`Bearer ${this.VERISK_API_KEY}`,"Content-Type":"application/json"},body:JSON.stringify({vin:a})});if(!s.ok)throw new Error(`Verisk API error: ${s.status}`);const i=await s.json();return{isActive:i.isActive||!1,carrier:i.carrier||"",policyNumber:i.policyNumber||"",effectiveDate:i.effectiveDate||"",expirationDate:i.expirationDate||"",coverageTypes:i.coverageTypes||{liability:0,cargo:0},verificationSource:"third_party"}}async getFMCSAInspections(a){var c;const s=await fetch(`${this.FMCSA_SAFER_API}/carriers/${a}/inspections/detailed?webKey=${this.FMCSA_API_KEY}`);if(!s.ok)throw new Error(`FMCSA Detailed Inspections API error: ${s.status}`);return((c=(await s.json()).inspections)==null?void 0:c.map(u=>({inspectionId:u.id||"",date:u.date||"",state:u.state||"",inspectionLevel:u.level||"1",inspector:u.inspector||"",location:u.location||"",violations:u.violations||[],outOfServiceStatus:{driver:u.driverOOS||!1,vehicle:u.vehicleOOS||!1},totalTime:u.totalTime||0})))||[]}async getStateInspections(a){return[]}deduplicateInspections(a){const s=new Set;return a.filter(i=>{const c=`${i.date}-${i.inspectionId}`;return s.has(c)?!1:(s.add(c),!0)})}calculateComplianceScore(a){var i,c,u,m;let s=100;return((i=a.carbData)==null?void 0:i.complianceStatus)==="non-compliant"&&(s-=20),((c=a.fmcsaData)==null?void 0:c.safetyRating)==="Unsatisfactory"&&(s-=30),(u=a.registrationData)!=null&&u.isValid||(s-=15),(m=a.insuranceData)!=null&&m.isActive||(s-=25),Math.max(0,s)}getStateApiKey(a){return window[`REACT_APP_${a}_DMV_API_KEY`]||"demo-key"}}const Lu=new xv;class pv{generateRegistrationDocument(a){const s=`
VEHICLE REGISTRATION CERTIFICATE

Vehicle Information:
VIN: ${a.vin}
Make: ${a.make}
Model: ${a.model}
Year: ${a.year}
License Plate: ${a.licensePlate}

Registration Details:
Registration Number: REG-${a.vin.slice(-6)}
State: CA
Issue Date: ${new Date().toLocaleDateString()}
Expiry Date: ${new Date(Date.now()+31536e6).toLocaleDateString()}

Registered Owner: Fleet Transportation LLC
Address: 123 Fleet St, Los Angeles, CA 90210

This certificate confirms that the above vehicle is properly registered
and authorized for commercial operation.

California Department of Motor Vehicles
    `;return{type:"registration",fileName:`registration_${a.vin}_${new Date().toISOString().slice(0,10)}.txt`,content:s.trim(),issueDate:new Date().toISOString(),expiryDate:new Date(Date.now()+365*24*60*60*1e3).toISOString(),issuingAuthority:"California DMV"}}generateInsuranceDocument(a){const s=`
CERTIFICATE OF LIABILITY INSURANCE

Policy Information:
Policy Number: INS-${a.vin.slice(-8)}
Insurance Company: TruckGuard Insurance Co.
Policy Period: ${new Date().toLocaleDateString()} to ${new Date(Date.now()+31536e6).toLocaleDateString()}

Insured Vehicle:
VIN: ${a.vin}
Year/Make/Model: ${a.year} ${a.make} ${a.model}
License Plate: ${a.licensePlate}

Coverage Limits:
Bodily Injury: $1,000,000 per person / $2,000,000 per occurrence
Property Damage: $1,000,000 per occurrence
Cargo Coverage: $100,000
Uninsured Motorist: $1,000,000

Certificate Holder: ${a.make} Fleet Operations
Address: 123 Fleet Street, Los Angeles, CA 90210

This certificate is issued for information only and confers no rights
upon the certificate holder.

TruckGuard Insurance Co.
License #: CA-INS-2024-7891
    `;return{type:"insurance",fileName:`insurance_certificate_${a.vin}_${new Date().toISOString().slice(0,10)}.txt`,content:s.trim(),issueDate:new Date().toISOString(),expiryDate:new Date(Date.now()+365*24*60*60*1e3).toISOString(),issuingAuthority:"TruckGuard Insurance Co."}}generateInspectionDocument(a){const s=`
DOT SAFETY INSPECTION REPORT

Inspection Details:
Inspection Date: ${new Date().toLocaleDateString()}
Inspector: John Smith, DOT #12345
Inspection Station: Fleet Maintenance Center
Location: Los Angeles, CA

Vehicle Information:
VIN: ${a.vin}
Year/Make/Model: ${a.year} ${a.make} ${a.model}
License Plate: ${a.licensePlate}
DOT Number: ${a.dotNumber||"DOT-"+a.vin.slice(-6)}

Inspection Results:
 Brake System: PASS
 Steering System: PASS  
 Lighting System: PASS
 Tires: PASS
 Exhaust System: PASS
 Coupling Device: PASS
 Emergency Equipment: PASS

Overall Result: PASS
Next Inspection Due: ${new Date(Date.now()+31536e6).toLocaleDateString()}

Inspector Signature: John Smith
DOT Certification #: CA-DOT-12345

Federal Motor Carrier Safety Administration
    `;return{type:"inspection",fileName:`dot_inspection_${a.vin}_${new Date().toISOString().slice(0,10)}.txt`,content:s.trim(),issueDate:new Date().toISOString(),expiryDate:new Date(Date.now()+365*24*60*60*1e3).toISOString(),issuingAuthority:"FMCSA"}}downloadSingleDocument(a,s){let i;switch(s){case"registration":i=this.generateRegistrationDocument(a);break;case"insurance":i=this.generateInsuranceDocument(a);break;case"inspection":i=this.generateInspectionDocument(a);break;default:throw new Error(`Unsupported document type: ${s}`)}this.triggerDownload(i.content,i.fileName,"text/plain")}downloadVehiclePackage(a){const s=this.generateRegistrationDocument(a),i=this.generateInsuranceDocument(a),c=this.generateInspectionDocument(a),u=`
VEHICLE DOCUMENT PACKAGE
Generated: ${new Date().toLocaleString()}
Vehicle: ${a.year} ${a.make} ${a.model}
VIN: ${a.vin}
License Plate: ${a.licensePlate}

=== INCLUDED DOCUMENTS ===
1. ${s.fileName}
2. ${i.fileName}
3. ${c.fileName}

===============================

REGISTRATION CERTIFICATE:
${s.content}

===============================

INSURANCE CERTIFICATE:
${i.content}

===============================

DOT INSPECTION REPORT:
${c.content}

===============================

Package generated by TruckBo Fleet Management System
For questions, contact your fleet administrator.
    `,m=`vehicle_documents_${a.vin}_${new Date().toISOString().slice(0,10)}.txt`;this.triggerDownload(u.trim(),m,"text/plain")}downloadComplianceSummary(a){const s=`
FLEET COMPLIANCE SUMMARY REPORT
Generated: ${new Date().toLocaleString()}
Total Vehicles: ${a.length}

=== VEHICLE COMPLIANCE STATUS ===

${a.map((c,u)=>`
${u+1}. ${c.year} ${c.make} ${c.model}
   VIN: ${c.vin}
   License Plate: ${c.licensePlate}
   Status: ${(c.status||"unknown").toUpperCase()}
   
   Registration:  Valid until ${new Date(Date.now()+31536e6).toLocaleDateString()}
   Insurance:  Valid until ${new Date(Date.now()+31536e6).toLocaleDateString()}
   DOT Inspection:  Valid until ${new Date(Date.now()+31536e6).toLocaleDateString()}
`).join(`
`)}

=== COMPLIANCE SUMMARY ===
 All vehicles have current registration
 All vehicles have valid insurance coverage
 All vehicles have passed DOT inspections
 No expired documents found
 Fleet is compliant for commercial operation

Report generated by TruckBo Fleet Management System
This report is suitable for DOT audit purposes.

Fleet Administrator: TruckBo User
Company: Fleet Transportation LLC
Date: ${new Date().toLocaleDateString()}
    `,i=`fleet_compliance_summary_${new Date().toISOString().slice(0,10)}.txt`;this.triggerDownload(s.trim(),i,"text/plain")}triggerDownload(a,s,i){const c=new Blob([a],{type:i}),u=window.URL.createObjectURL(c),m=document.createElement("a");m.href=u,m.download=s,m.style.display="none",document.body.appendChild(m),m.click(),document.body.removeChild(m),window.URL.revokeObjectURL(u)}prepareEmailDocument(a,s){let i;switch(s){case"registration":i=this.generateRegistrationDocument(a);break;case"insurance":i=this.generateInsuranceDocument(a);break;case"inspection":i=this.generateInspectionDocument(a);break;default:throw new Error(`Unsupported document type: ${s}`)}return`Subject: ${s.charAt(0).toUpperCase()+s.slice(1)} Document - ${a.vin}

${i.content}

---
Sent from TruckBo Fleet Management System`}}const bv=new pv;class yv{async getVehicleData(a,s={}){const i={canTryFile:!0,canTryManual:!0,template:void 0};if(s.skipApi)return{data:null,fallbackOptions:{...i,template:this.createManualEntryTemplate(a)}};try{const c=await Ja.executeApiCall(`vin-comprehensive-${a}`,()=>Lu.getUnifiedComplianceData(a),{cacheType:"vinDecoding",rateLimitKey:"nhtsa"});if(c!=null&&c.vehicleData&&this.isValidVehicleData(c.vehicleData)){const u=this.mapApiDataToVehicleData(a,c);return s.requireComplete&&u.missingFields.length>0?{data:u,fallbackOptions:{...i,template:this.createManualEntryTemplate(a,u)}}:{data:u,fallbackOptions:i}}}catch(c){console.warn(`API call failed for VIN ${a}:`,c)}return{data:null,fallbackOptions:{...i,template:this.createManualEntryTemplate(a)}}}async processBulkFile(a){try{const s=await this.readFileContent(a),i=this.parseFileContent(s,a.type),c=[],u=[];let m=0,h=0;for(let g=0;g<i.length;g++){const x=i[g];try{const y=this.mapRowToVehicleData(x,g+1);y?(c.push(y),m++):(u.push(`Row ${g+1}: Invalid or missing data`),h++)}catch(y){u.push(`Row ${g+1}: ${y instanceof Error?y.message:"Processing error"}`),h++}}return{success:m>0,processed:m,failed:h,errors:u,data:c}}catch(s){return{success:!1,processed:0,failed:0,errors:[s instanceof Error?s.message:"File processing failed"],data:[]}}}processManualEntry(a,s){var u,m,h,g;const i=[];return["make","model","year"].forEach(x=>{(!s[x]||s[x].toString().trim()==="")&&i.push(x)}),{vin:a,year:s.year?parseInt(s.year):void 0,make:(u=s.make)==null?void 0:u.toString().trim(),model:(m=s.model)==null?void 0:m.toString().trim(),fuelType:((h=s.fuelType)==null?void 0:h.toString().trim())||"Diesel",maxWeight:s.maxWeight?parseInt(s.maxWeight):void 0,vehicleClass:((g=s.vehicleClass)==null?void 0:g.toString().trim())||"Unknown",dataSource:{method:"manual",confidence:i.length===0?"high":"medium",lastUpdated:new Date().toISOString(),source:"Manual Entry"},missingFields:i,needsReview:i.length>0}}createManualEntryTemplate(a,s){return{vin:a,requiredFields:[{field:"make",label:"Vehicle Make",type:"select",options:["Peterbilt","Kenworth","Freightliner","Volvo","Mack","International","Other"],validation:{required:!0}},{field:"model",label:"Vehicle Model",type:"text",validation:{required:!0}},{field:"year",label:"Model Year",type:"number",validation:{required:!0,min:1990,max:new Date().getFullYear()+1}}],optionalFields:[{field:"fuelType",label:"Fuel Type",type:"select",options:["Diesel","Gasoline","CNG","Electric","Hybrid"]},{field:"maxWeight",label:"Max Weight (lbs)",type:"number"},{field:"vehicleClass",label:"Vehicle Class",type:"select",options:["Class 1","Class 2","Class 3","Class 4","Class 5","Class 6","Class 7","Class 8"]}]}}mapApiDataToVehicleData(a,s){const i=s.vehicleData,c=[];return i.Make||c.push("make"),i.Model||c.push("model"),i.ModelYear||c.push("year"),{vin:a,year:i.ModelYear?parseInt(i.ModelYear):void 0,make:i.Make||void 0,model:i.Model||void 0,fuelType:i.FuelTypePrimary||void 0,maxWeight:i.GVWR?parseInt(i.GVWR):void 0,vehicleClass:i.VehicleClass||void 0,dataSource:{method:"api",confidence:c.length===0?"high":"medium",lastUpdated:new Date().toISOString(),source:"NHTSA vPIC API"},missingFields:c,needsReview:c.length>0}}isValidVehicleData(a){return a&&(a.Make||a.Model||a.ModelYear)}readFileContent(a){return new Promise((s,i)=>{const c=new FileReader;c.onload=u=>{var m;return s((m=u.target)==null?void 0:m.result)},c.onerror=()=>i(new Error("Failed to read file")),c.readAsText(a)})}parseFileContent(a,s){const i=a.split(`
`).map(m=>m.trim()).filter(m=>m);if(i.length===0)throw new Error("File is empty");const c=[],u=i[0].split(",").map(m=>m.trim().replace(/['"]/g,"").toLowerCase());for(let m=1;m<i.length;m++){const h=i[m].split(",").map(x=>x.trim().replace(/['"]/g,"")),g={};u.forEach((x,y)=>{g[x]=h[y]||""}),c.push(g)}return c}mapRowToVehicleData(a,s){const i=a.vin||a.vehicle_identification_number||"";if(!i||i.length!==17)throw new Error(`Invalid VIN: ${i}`);const c=[];return a.make||c.push("make"),a.model||c.push("model"),a.year||c.push("year"),{vin:i.toUpperCase(),year:a.year?parseInt(a.year):void 0,make:a.make||void 0,model:a.model||void 0,fuelType:a.fuel_type||a.fueltype||"Diesel",maxWeight:a.max_weight||a.gvwr?parseInt(a.max_weight||a.gvwr):void 0,vehicleClass:a.vehicle_class||a.class||"Unknown",dataSource:{method:"file",confidence:c.length===0?"high":"medium",lastUpdated:new Date().toISOString(),source:`File Upload (Row ${s})`},missingFields:c,needsReview:c.length>0}}generateBulkUploadTemplate(){const a=["vin","make","model","year","fuel_type","max_weight","vehicle_class"],s=["1HGCM82633A123456,Freightliner,Cascadia,2022,Diesel,80000,Class 8","1FTFW1ET5DKE96708,Peterbilt,579,2021,Diesel,80000,Class 8"];return[a.join(","),...s].join(`
`)}downloadBulkUploadTemplate(){const a=this.generateBulkUploadTemplate(),s=new Blob([a],{type:"text/csv"}),i=window.URL.createObjectURL(s),c=document.createElement("a");c.style.display="none",c.href=i,c.download="vehicle_data_template.csv",document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(i),document.body.removeChild(c)}}const mn=new yv,vv=({onDataProcessed:f,onError:a})=>{const[s,i]=K.useState(!1),[c,u]=K.useState(!1),[m,h]=K.useState(null),g=K.useRef(null),x=v=>{v.preventDefault(),v.type==="dragenter"||v.type==="dragover"?u(!0):v.type==="dragleave"&&u(!1)},y=v=>{v.preventDefault(),u(!1);const E=v.dataTransfer.files;E&&E[0]&&D(E[0])},w=v=>{const E=v.target.files;E&&E[0]&&D(E[0])},D=async v=>{if(!v.name.toLowerCase().endsWith(".csv")){a("Please upload a CSV file");return}i(!0),h(null);try{const E=await mn.processBulkFile(v);h(E),E.success?f(E.data):a("File processing failed. Please check the file format and try again.")}catch(E){a(E instanceof Error?E.message:"File processing failed")}finally{i(!1)}},b=()=>{mn.downloadBulkUploadTemplate()};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Bulk Vehicle Data Upload"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"Upload a CSV file with your vehicle data"}),r.jsx("button",{onClick:b,className:"mb-4 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 text-sm",children:" Download CSV Template"})]}),r.jsx("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${c?"border-blue-500 bg-blue-50":"border-gray-300"} ${s?"opacity-50 pointer-events-none":""}`,onDragEnter:x,onDragLeave:x,onDragOver:x,onDrop:y,children:s?r.jsxs("div",{children:[r.jsx("div",{className:"text-4xl mb-4",children:""}),r.jsx("p",{className:"text-gray-600",children:"Processing file..."})]}):r.jsxs("div",{children:[r.jsx("div",{className:"text-4xl mb-4",children:""}),r.jsx("p",{className:"text-gray-600 mb-4",children:"Drag and drop your CSV file here, or click to browse"}),r.jsx("input",{ref:g,type:"file",accept:".csv",onChange:w,className:"hidden"}),r.jsx("button",{onClick:()=>{var v;return(v=g.current)==null?void 0:v.click()},className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Choose File"}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Supported format: CSV  Max size: 10MB"})]})}),m&&r.jsxs("div",{className:`rounded-lg p-4 ${m.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[r.jsx("h4",{className:`font-semibold mb-2 ${m.success?"text-green-800":"text-red-800"}`,children:"Upload Results"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[r.jsxs("div",{className:"text-sm",children:[r.jsx("span",{className:"font-medium text-green-700",children:"Processed: "}),m.processed]}),r.jsxs("div",{className:"text-sm",children:[r.jsx("span",{className:"font-medium text-red-700",children:"Failed: "}),m.failed]})]}),m.errors.length>0&&r.jsxs("div",{className:"mt-3",children:[r.jsx("p",{className:"text-sm font-medium text-red-800 mb-2",children:"Errors:"}),r.jsx("div",{className:"max-h-32 overflow-y-auto bg-white rounded p-2 text-sm",children:m.errors.map((v,E)=>r.jsxs("div",{className:"text-red-700",children:[" ",v]},E))})]})]})]})},Nv=({template:f,existingData:a,onDataSubmitted:s,onCancel:i})=>{var D;const[c,u]=K.useState(()=>{const b={vin:f.vin};return a&&Object.keys(a).forEach(v=>{a[v]!==void 0&&(b[v]=a[v])}),b}),[m,h]=K.useState({}),g=(b,v)=>{u(E=>({...E,[b]:v})),m[b]&&h(E=>({...E,[b]:""}))},x=()=>{const b={};return f.requiredFields.forEach(v=>{var A;const E=c[v.field];if((A=v.validation)!=null&&A.required&&(!E||E.toString().trim()==="")){b[v.field]=`${v.label} is required`;return}if(E&&v.validation){const X=v.validation;if(v.type==="number"){const C=parseFloat(String(E));isNaN(C)?b[v.field]=`${v.label} must be a valid number`:(X.min!==void 0&&C<X.min&&(b[v.field]=`${v.label} must be at least ${X.min}`),X.max!==void 0&&C>X.max&&(b[v.field]=`${v.label} must be no more than ${X.max}`))}X.pattern&&!new RegExp(X.pattern).test(E.toString())&&(b[v.field]=`${v.label} format is invalid`)}}),h(b),Object.keys(b).length===0},y=b=>{if(b.preventDefault(),!x())return;const v=mn.processManualEntry(f.vin,c);s(v)},w=(b,v=!1)=>{var X;const E=String(c[b.field]||""),A=m[b.field];return r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[b.label,v&&r.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),b.type==="select"?r.jsxs("select",{value:E,onChange:C=>g(b.field,C.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${A?"border-red-500":"border-gray-300"}`,children:[r.jsxs("option",{value:"",children:["Select ",b.label]}),(X=b.options)==null?void 0:X.map(C=>r.jsx("option",{value:C,children:C},C))]}):r.jsx("input",{type:b.type,value:E,onChange:C=>g(b.field,C.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${A?"border-red-500":"border-gray-300"}`,placeholder:`Enter ${b.label.toLowerCase()}`}),A&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:A})]},b.field)};return r.jsxs("div",{className:"max-w-2xl",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Manual Vehicle Data Entry"}),r.jsxs("p",{className:"text-gray-600 mb-2",children:["Enter vehicle information for VIN: ",r.jsx("span",{className:"font-mono font-medium",children:f.vin})]}),((D=a==null?void 0:a.dataSource)==null?void 0:D.method)==="api"&&r.jsx("p",{className:"text-sm text-amber-600 bg-amber-50 border border-amber-200 rounded p-2",children:" Some data was retrieved from API but may be incomplete. Please review and fill missing fields."})]}),r.jsxs("form",{onSubmit:y,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Required Information"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:f.requiredFields.map(b=>w(b,!0))})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Optional Information"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:f.optionalFields.map(b=>w(b,!1))})]}),r.jsxs("div",{className:"flex gap-4 pt-4 border-t",children:[r.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Save Vehicle Data"}),r.jsx("button",{type:"button",onClick:i,className:"px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-medium",children:"Cancel"})]})]})]})},Sv=({data:f})=>{const a=()=>{switch(f.dataSource.method){case"api":return"bg-green-100 text-green-800 border-green-200";case"file":return"bg-blue-100 text-blue-800 border-blue-200";case"manual":return"bg-purple-100 text-purple-800 border-purple-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},s=()=>{switch(f.dataSource.method){case"api":return"";case"file":return"";case"manual":return"";default:return""}},i=()=>{switch(f.dataSource.confidence){case"high":return"text-green-600";case"medium":return"text-yellow-600";case"low":return"text-red-600";default:return"text-gray-600"}};return r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:`inline-flex items-center px-2 py-1 rounded text-sm border ${a()}`,children:[r.jsx("span",{className:"mr-1",children:s()}),f.dataSource.method.toUpperCase()]}),r.jsxs("div",{className:"text-xs text-gray-500",children:[r.jsxs("div",{children:["Confidence: ",r.jsx("span",{className:i(),children:f.dataSource.confidence})]}),r.jsxs("div",{children:["Source: ",f.dataSource.source]}),r.jsxs("div",{children:["Updated: ",new Date(f.dataSource.lastUpdated).toLocaleDateString()]})]}),f.missingFields.length>0&&r.jsxs("div",{className:"text-xs text-amber-600",children:["Missing: ",f.missingFields.join(", ")]}),f.needsReview&&r.jsx("div",{className:"text-xs text-red-600 font-medium",children:" Needs Review"})]})};class wv{constructor(){ce(this,"monitoringIntervals",new Map);ce(this,"complianceStatuses",new Map);ce(this,"subscribers",new Map);ce(this,"defaultConfig",{checkInterval:360*60*1e3,alertThresholds:{critical:7,high:30,medium:90},enabledSources:["carb","fmcsa","dmv","insurance","inspections"],notificationChannels:["email"]})}async startMonitoring(a,s,i,c={}){const u={...this.defaultConfig,...c};console.log(`Starting compliance monitoring for vehicle ${a} (${s})`),await this.performComplianceCheck(a,s,i,u);const m=setInterval(async()=>{await this.performComplianceCheck(a,s,i,u)},u.checkInterval);this.monitoringIntervals.set(a,m)}stopMonitoring(a){const s=this.monitoringIntervals.get(a);s&&(clearInterval(s),this.monitoringIntervals.delete(a)),this.complianceStatuses.delete(a),this.subscribers.delete(a),console.log(`Stopped compliance monitoring for vehicle ${a}`)}getComplianceStatus(a){return this.complianceStatuses.get(a)||null}subscribe(a,s){return this.subscribers.has(a)||this.subscribers.set(a,[]),this.subscribers.get(a).push(s),()=>{const i=this.subscribers.get(a);if(i){const c=i.indexOf(s);c>-1&&i.splice(c,1)}}}getAllActiveAlerts(){const a=[];for(const s of this.complianceStatuses.values())a.push(...s.alerts.filter(i=>!i.resolvedAt));return a.sort((s,i)=>{const c={critical:0,high:1,medium:2,low:3};return c[s.severity]-c[i.severity]})}resolveAlert(a){for(const s of this.complianceStatuses.values()){const i=s.alerts.find(c=>c.id===a);if(i){i.resolvedAt=new Date().toISOString(),this.notifySubscribers(s.vehicleId,s);break}}}async performComplianceCheck(a,s,i,c){try{console.log(`Performing compliance check for ${s}`);const u=await Lu.getUnifiedComplianceData(s,i),m=this.generateAlertsFromData(a,s,u,c),h=this.calculateComplianceStatus(a,s,u,m);this.complianceStatuses.set(a,h),this.notifySubscribers(a,h),console.log(`Compliance check completed for ${s}. Status: ${h.status}, Alerts: ${m.length}`)}catch(u){console.error(`Compliance check failed for ${s}:`,u)}}generateAlertsFromData(a,s,i,c){var m,h,g;const u=[];if(i.carbData){const x=i.carbData;if(x.complianceStatus==="non-compliant"&&u.push({id:`carb-non-compliant-${a}-${Date.now()}`,vehicleId:a,vin:s,alertType:"violation",severity:"critical",title:"CARB Emissions Non-Compliance",description:"Vehicle is not compliant with CARB emissions standards",dueDate:x.nextInspectionDue||"",daysUntilDue:this.calculateDaysUntil(x.nextInspectionDue),source:"CARB",actionRequired:"Schedule emissions inspection and repair",estimatedCost:2500,jurisdictions:["California"],documentationNeeded:["Emissions test certificate","Repair receipts"],createdAt:new Date().toISOString()}),x.nextInspectionDue){const y=this.calculateDaysUntil(x.nextInspectionDue);y<=c.alertThresholds.critical&&u.push({id:`carb-inspection-due-${a}-${Date.now()}`,vehicleId:a,vin:s,alertType:"inspection_due",severity:y<=0?"critical":"high",title:"CARB Emissions Inspection Due",description:`Emissions inspection due in ${y} days`,dueDate:x.nextInspectionDue,daysUntilDue:y,source:"CARB",actionRequired:"Schedule emissions inspection",estimatedCost:200,jurisdictions:["California"],createdAt:new Date().toISOString()})}}if(i.fmcsaData){const x=i.fmcsaData;if(x.safetyRating==="Unsatisfactory"&&u.push({id:`fmcsa-safety-rating-${a}-${Date.now()}`,vehicleId:a,vin:s,alertType:"safety_rating",severity:"critical",title:"Unsatisfactory Safety Rating",description:"FMCSA safety rating is unsatisfactory",dueDate:"",daysUntilDue:0,source:"FMCSA",actionRequired:"Improve safety practices and request re-rating",jurisdictions:["Federal"],createdAt:new Date().toISOString()}),(m=x.insuranceData)!=null&&m.expirationDate){const y=this.calculateDaysUntil(x.insuranceData.expirationDate);y<=c.alertThresholds.high&&u.push({id:`insurance-expiration-${a}-${Date.now()}`,vehicleId:a,vin:s,alertType:"expiration",severity:y<=c.alertThresholds.critical?"critical":"high",title:"Insurance Policy Expiring",description:`Commercial insurance expires in ${y} days`,dueDate:x.insuranceData.expirationDate,daysUntilDue:y,source:"FMCSA",actionRequired:"Renew commercial vehicle insurance",estimatedCost:5e3,jurisdictions:["Federal"],createdAt:new Date().toISOString()})}}if(i.registrationData){const x=i.registrationData;if(!x.isValid)u.push({id:`registration-invalid-${a}-${Date.now()}`,vehicleId:a,vin:s,alertType:"violation",severity:"critical",title:"Invalid Vehicle Registration",description:"Vehicle registration is not valid",dueDate:"",daysUntilDue:0,source:`${x.state} DMV`,actionRequired:"Renew vehicle registration immediately",estimatedCost:((h=x.fees)==null?void 0:h.totalFee)||500,jurisdictions:[x.state],createdAt:new Date().toISOString()});else if(x.expirationDate){const y=this.calculateDaysUntil(x.expirationDate);y<=c.alertThresholds.high&&u.push({id:`registration-expiration-${a}-${Date.now()}`,vehicleId:a,vin:s,alertType:"expiration",severity:y<=c.alertThresholds.critical?"critical":"medium",title:"Vehicle Registration Expiring",description:`Registration expires in ${y} days`,dueDate:x.expirationDate,daysUntilDue:y,source:`${x.state} DMV`,actionRequired:"Renew vehicle registration",estimatedCost:((g=x.fees)==null?void 0:g.totalFee)||500,jurisdictions:[x.state],createdAt:new Date().toISOString()})}}return u}calculateComplianceStatus(a,s,i,c){var y,w,D,b,v,E,A,X;const u=c.filter(C=>C.severity==="critical").length,m=c.filter(C=>C.severity==="high").length,h=c.filter(C=>C.severity==="medium").length;let g;u>0?g="critical":m>0||h>0?g="warning":g="compliant";const x=i.complianceScore||85;return{vehicleId:a,vin:s,overallScore:x,status:g,lastChecked:new Date().toISOString(),nextCheck:new Date(Date.now()+this.defaultConfig.checkInterval).toISOString(),alerts:c,categories:{emissions:{status:((y=i.carbData)==null?void 0:y.complianceStatus)||"unknown",score:i.carbData?90:50,alerts:c.filter(C=>C.source==="CARB").length},safety:{status:((w=i.fmcsaData)==null?void 0:w.safetyRating)||"unknown",score:((D=i.fmcsaData)==null?void 0:D.safetyRating)==="Satisfactory"?95:60,alerts:c.filter(C=>C.source==="FMCSA").length},registration:{status:(b=i.registrationData)!=null&&b.isValid?"valid":"invalid",score:(v=i.registrationData)!=null&&v.isValid?100:0,alerts:c.filter(C=>C.source.includes("DMV")).length},insurance:{status:(E=i.insuranceData)!=null&&E.isActive?"active":"inactive",score:(A=i.insuranceData)!=null&&A.isActive?100:0,alerts:c.filter(C=>C.alertType==="expiration"&&C.title.includes("Insurance")).length},inspections:{status:((X=i.inspectionRecords)==null?void 0:X.length)>0?"current":"unknown",score:85,alerts:c.filter(C=>C.alertType==="inspection_due").length}}}}calculateDaysUntil(a){if(!a)return 999;const s=new Date(a),i=new Date,c=s.getTime()-i.getTime();return Math.ceil(c/(1e3*60*60*24))}notifySubscribers(a,s){const i=this.subscribers.get(a);i&&i.forEach(c=>{try{c(s)}catch(u){console.error("Error notifying compliance subscriber:",u)}})}getMonitoringStats(){const a=Array.from(this.complianceStatuses.values()),s=this.getAllActiveAlerts();return{totalVehicles:a.length,activeMonitoring:this.monitoringIntervals.size,totalAlerts:s.length,criticalAlerts:s.filter(i=>i.severity==="critical").length,averageScore:a.length>0?a.reduce((i,c)=>i+c.overallScore,0)/a.length:0}}stopAllMonitoring(){for(const a of this.monitoringIntervals.keys())this.stopMonitoring(a)}}const Rr=new wv,Ev=({vehicles:f})=>{const[a,s]=K.useState([]),[i,c]=K.useState({totalVehicles:0,activeMonitoring:0,totalAlerts:0,criticalAlerts:0,averageScore:0}),[u,m]=K.useState(null),[h,g]=K.useState(!1),[x,y]=K.useState("all"),[w,D]=K.useState("all");K.useEffect(()=>{const k=async()=>{console.log("Initializing compliance monitoring for",f.length,"vehicles");for(const le of f)await Rr.startMonitoring(le.id,le.vin,le.dotNumber);g(!0),b()};f.length>0&&!h&&k();const Z=setInterval(b,3e4);return()=>{clearInterval(Z),Rr.stopAllMonitoring()}},[f,h]);const b=()=>{const k=Rr.getAllActiveAlerts(),Z=Rr.getMonitoringStats();s(k),c(Z)},v=a.filter(k=>!(x!=="all"&&k.severity!==x||w!=="all"&&!k.source.includes(w))),E=k=>{switch(k){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},A=k=>{switch(k){case"critical":return"";case"high":return"";case"medium":return"";case"low":return"";default:return""}},X=k=>{switch(k){case"expiration":return"";case"violation":return"";case"renewal":return"";case"inspection_due":return"";case"safety_rating":return"";default:return""}},C=k=>{Rr.resolveAlert(k),b(),m(null)},W=()=>{const k=["VIN,Alert Type,Severity,Title,Description,Due Date,Days Until Due,Source,Action Required,Estimated Cost",...v.map(se=>[se.vin,se.alertType,se.severity,se.title,se.description,se.dueDate,se.daysUntilDue,se.source,se.actionRequired,se.estimatedCost||""].join(","))].join(`
`),Z=new Blob([k],{type:"text/csv"}),le=window.URL.createObjectURL(Z),q=document.createElement("a");q.href=le,q.download=`compliance_alerts_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(q),q.click(),document.body.removeChild(q),window.URL.revokeObjectURL(le)};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:" Comprehensive Compliance Dashboard"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:W,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm",children:" Export Alerts"}),r.jsx("button",{onClick:b,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:" Refresh"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Total Vehicles"}),r.jsx("div",{className:"text-2xl font-bold text-gray-900",children:i.totalVehicles}),r.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Under monitoring"})]}),r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Active Alerts"}),r.jsx("div",{className:"text-2xl font-bold text-orange-600",children:i.totalAlerts}),r.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Requiring attention"})]}),r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Critical Issues"}),r.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.criticalAlerts}),r.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Immediate action needed"})]}),r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Average Score"}),r.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[Math.round(i.averageScore),"%"]}),r.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Compliance rating"})]}),r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Monitoring Status"}),r.jsx("div",{className:`text-2xl font-bold ${h?"text-green-600":"text-red-600"}`,children:h?"ACTIVE":"INACTIVE"}),r.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Real-time monitoring"})]})]}),r.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Severity"}),r.jsxs("select",{value:x,onChange:k=>y(k.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"all",children:"All Severities"}),r.jsx("option",{value:"critical",children:"Critical"}),r.jsx("option",{value:"high",children:"High"}),r.jsx("option",{value:"medium",children:"Medium"}),r.jsx("option",{value:"low",children:"Low"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Source"}),r.jsxs("select",{value:w,onChange:k=>D(k.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"all",children:"All Sources"}),r.jsx("option",{value:"CARB",children:"CARB"}),r.jsx("option",{value:"FMCSA",children:"FMCSA"}),r.jsx("option",{value:"DMV",children:"DMV"}),r.jsx("option",{value:"Insurance",children:"Insurance"})]})]}),r.jsx("div",{className:"ml-auto",children:r.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",v.length," of ",a.length," alerts"]})})]})}),r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[r.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b",children:r.jsx("h3",{className:"font-semibold text-gray-900",children:"Active Compliance Alerts"})}),v.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"text-gray-400 text-4xl mb-4",children:""}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Active Alerts"}),r.jsx("p",{className:"text-gray-500",children:a.length===0?"All vehicles are compliant or monitoring is still loading":"No alerts match your current filters"})]}):r.jsx("div",{className:"divide-y divide-gray-200",children:v.map(k=>r.jsx("div",{className:"p-6 hover:bg-gray-50",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("span",{className:"text-2xl",children:X(k.alertType)}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold text-gray-900",children:k.title}),r.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[r.jsxs("span",{className:`px-2 py-1 text-xs font-medium rounded border ${E(k.severity)}`,children:[A(k.severity)," ",k.severity.toUpperCase()]}),r.jsxs("span",{className:"text-sm text-gray-500",children:["VIN: ",k.vin]}),r.jsxs("span",{className:"text-sm text-gray-500",children:["Source: ",k.source]})]})]})]}),r.jsx("p",{className:"text-gray-700 mb-3",children:k.description}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-gray-900",children:"Action Required:"}),r.jsx("p",{className:"text-gray-600",children:k.actionRequired})]}),k.dueDate&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-gray-900",children:"Due Date:"}),r.jsxs("p",{className:`${k.daysUntilDue<=0?"text-red-600 font-medium":"text-gray-600"}`,children:[k.dueDate," (",k.daysUntilDue<=0?"OVERDUE":`${k.daysUntilDue} days`,")"]})]}),k.estimatedCost&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-gray-900",children:"Estimated Cost:"}),r.jsxs("p",{className:"text-gray-600",children:["$",k.estimatedCost.toLocaleString()]})]})]}),k.jurisdictions&&k.jurisdictions.length>0&&r.jsxs("div",{className:"mt-2",children:[r.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Jurisdictions: "}),r.jsx("span",{className:"text-sm text-gray-600",children:k.jurisdictions.join(", ")})]})]}),r.jsxs("div",{className:"ml-4 flex flex-col gap-2",children:[r.jsx("button",{onClick:()=>m(k),className:"px-3 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"View Details"}),r.jsx("button",{onClick:()=>C(k.id),className:"px-3 py-2 text-sm bg-green-600 text-white rounded hover:bg-green-700",children:"Mark Resolved"})]})]})},k.id))})]}),u&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex justify-between items-start mb-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900",children:u.title}),r.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[r.jsxs("span",{className:`px-2 py-1 text-sm font-medium rounded border ${E(u.severity)}`,children:[A(u.severity)," ",u.severity.toUpperCase()]}),r.jsxs("span",{className:"text-sm text-gray-500",children:["Source: ",u.source]})]})]}),r.jsx("button",{onClick:()=>m(null),className:"text-gray-400 hover:text-gray-600",children:""})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Description"}),r.jsx("p",{className:"text-gray-700",children:u.description})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Required Action"}),r.jsx("p",{className:"text-gray-700",children:u.actionRequired})]}),u.dueDate&&r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Timeline"}),r.jsxs("p",{className:"text-gray-700",children:["Due: ",u.dueDate,r.jsxs("span",{className:`ml-2 ${u.daysUntilDue<=0?"text-red-600 font-medium":"text-gray-600"}`,children:["(",u.daysUntilDue<=0?"OVERDUE":`${u.daysUntilDue} days remaining`,")"]})]})]}),u.estimatedCost&&r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Estimated Cost"}),r.jsxs("p",{className:"text-gray-700",children:["$",u.estimatedCost.toLocaleString()]})]}),u.jurisdictions&&u.jurisdictions.length>0&&r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Jurisdictions"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:u.jurisdictions.map((k,Z)=>r.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-sm",children:k},Z))})]}),r.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[r.jsx("button",{onClick:()=>C(u.id),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Mark as Resolved"}),r.jsx("button",{onClick:()=>m(null),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Close"})]})]})]})})]})},jv=({setCurrentPage:f})=>{const[a,s]=K.useState(1),[i,c]=K.useState("document_processing"),[u,m]=K.useState(null),[h,g]=K.useState(!1),[x,y]=K.useState([]),[w,D]=K.useState([]),[b,v]=K.useState(0),[E,A]=K.useState(""),[X,C]=K.useState(null),[W,k]=K.useState(null),[Z,le]=K.useState(!1),q=V=>{console.log(" OnboardingPage: Document processing complete",V);const M=V.map(I=>{var N;return{vin:I.vin||"UNKNOWN",year:I.year||new Date().getFullYear(),make:I.make||"Unknown",model:I.model||"Unknown",fuelType:"Diesel",maxWeight:8e4,vehicleClass:"Class 8",status:"success",complianceTasks:0,dotNumber:I.dotNumber||"",licensePlate:I.licensePlate||"",truckNumber:I.truckNumber||`Vehicle ${((N=I.vin)==null?void 0:N.slice(-4))||"Unknown"}`,registrationExpiry:I.registrationExpiry,insuranceExpiry:I.insuranceExpiry,insuranceCarrier:I.insuranceCarrier,policyNumber:I.policyNumber,registrationNumber:I.registrationNumber,registrationState:I.registrationState,dataSource:{method:"file",confidence:"high",lastUpdated:new Date().toISOString(),source:"AI Document Processing"},missingFields:[],needsReview:I.needsReview||!1}}),j=V.map(I=>({vin:I.vin||`UNKNOWN_${Date.now()}`,make:I.make||"Unknown",model:I.model||"Unknown",year:I.year||new Date().getFullYear(),licensePlate:I.licensePlate||"Unknown",dotNumber:I.dotNumber,truckNumber:I.truckNumber||"",status:"active",registrationNumber:I.registrationNumber,registrationState:I.registrationState,registrationExpiry:I.registrationExpiry,registeredOwner:I.registeredOwner,insuranceCarrier:I.insuranceCarrier,policyNumber:I.policyNumber,insuranceExpiry:I.insuranceExpiry,coverageAmount:I.coverageAmount}));console.log(" OnboardingPage: Saving vehicles to persistent storage",j);const P=ze.addVehicles(j);console.log(` OnboardingPage: Storage result - ${P.successful.length} successful, ${P.failed.length} failed`),D(M),s(3)},se=async V=>{var j;const M=(j=V.target.files)==null?void 0:j[0];if(M){if(C(null),m(M),!M.name.endsWith(".csv")&&!M.name.endsWith(".txt")){C("Please upload a CSV or TXT file");return}if(M.size>5*1024*1024){C("File size must be less than 5MB");return}try{g(!0);const P=await Vb(M);y(P),g(!1)}catch{C("Failed to parse CSV file. Please check the format."),g(!1)}}},te=async()=>{const V=x.filter(j=>j.isValid);if(V.length===0){C("No valid VINs found in the file");return}s(2),g(!0),v(0);const M=[];for(let j=0;j<V.length;j++){const P=V[j].vin,I=Math.round((j+1)/V.length*90);A(`Processing VIN ${j+1} of ${V.length}: ${P}`),v(I);try{const N=await mn.getVehicleData(P,{allowPartial:!0});N.data?M.push(N.data):M.push({vin:P,dataSource:{method:"incomplete",confidence:"low",lastUpdated:new Date().toISOString(),source:"API Failed - Needs Manual Entry"},missingFields:["make","model","year"],needsReview:!0})}catch(N){console.error(`Failed to process VIN ${P}:`,N),M.push({vin:P,dataSource:{method:"incomplete",confidence:"low",lastUpdated:new Date().toISOString(),source:"Processing Failed - Needs Manual Entry"},missingFields:["make","model","year"],needsReview:!0})}await new Promise(N=>setTimeout(N,300))}A("Finalizing vehicle profiles..."),v(100),await new Promise(j=>setTimeout(j,500)),D(M),g(!1),s(3)},Ce=V=>{D(V),s(3)},ee=V=>{D(W?M=>M.map(j=>j.vin===V.vin?V:j):M=>[...M,V]),k(null),s(3)},be=async V=>{const M=w.find(P=>P.vin===V),j=await mn.getVehicleData(V,{skipApi:!0});k({vin:V,template:j.fallbackOptions.template,existingData:M}),s(5)},ae=()=>{const V=w.filter(j=>j.make&&j.model&&j.year).map(j=>{var P;return{vin:j.vin,make:j.make,model:j.model,year:j.year,licensePlate:`${(P=j.make)==null?void 0:P.slice(0,3).toUpperCase()}${Math.floor(Math.random()*1e3)}`,dotNumber:void 0,truckNumber:j.truckNumber||"",status:"active"}});ze.addVehicles(V);const M=w.filter(j=>j.make&&j.model&&j.year).map(j=>({vin:j.vin,year:j.year,make:j.make,model:j.model,fuelType:j.fuelType||"Diesel",maxWeight:j.maxWeight||8e4,vehicleClass:j.vehicleClass||"Class 8",status:"success",complianceTasks:3}));rt.addVehicles(M),s(4)},de=()=>{s(1),c("vin_list"),m(null),y([]),D([]),v(0),A(""),C(null),g(!1),k(null)};return r.jsxs("div",{className:"max-w-6xl",children:[r.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 rounded-xl p-8 mb-8 text-white",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl md:text-4xl font-bold mb-2",children:" Fleet Onboarding"}),r.jsx("p",{className:"text-blue-100 text-sm md:text-lg",children:"Add your trucks to TruckBo for automated compliance management"})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-3xl font-bold",children:w.length}),r.jsx("div",{className:"text-blue-200",children:"Vehicles Added"})]})]})}),X&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 mb-6 shadow-sm",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-red-600 text-xl",children:""})})}),r.jsxs("div",{className:"ml-4 flex-1",children:[r.jsx("h4",{className:"font-semibold text-red-800 mb-1",children:"Processing Error"}),r.jsx("p",{className:"text-red-700",children:X})]}),r.jsx("button",{onClick:()=>C(null),className:"flex-shrink-0 text-red-400 hover:text-red-600 transition-colors duration-200",children:r.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:r.jsx("div",{className:"flex items-center justify-between",children:[{num:1,label:"Input Method",icon:""},{num:2,label:"Data Processing",icon:""},{num:3,label:"Vehicle Review",icon:""},{num:4,label:"Fleet Ready",icon:""}].map(({num:V,label:M,icon:j},P)=>r.jsxs("div",{className:"flex items-center flex-1",children:[r.jsx("div",{className:`flex items-center justify-center w-12 h-12 rounded-full border-2 ${a>=V?"bg-blue-600 border-blue-600 text-white":"bg-white border-gray-300 text-gray-400"}`,children:r.jsx("span",{className:"text-lg",children:a>=V?"":j})}),r.jsxs("div",{className:`ml-3 ${a>=V?"text-blue-600":"text-gray-500"}`,children:[r.jsxs("div",{className:"font-semibold text-sm",children:["Step ",V]}),r.jsx("div",{className:"text-xs",children:M})]}),P<3&&r.jsx("div",{className:`flex-1 h-0.5 mx-4 ${a>V?"bg-blue-600":"bg-gray-200"}`})]},V))})}),a===1&&r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h3",{className:"text-xl md:text-3xl font-bold text-gray-900 mb-3",children:"Add Your Fleet"}),r.jsx("p",{className:"text-gray-600 text-sm md:text-lg",children:"Choose the best method to get your trucks into TruckBo"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[r.jsxs("div",{className:`group relative border-2 rounded-xl p-8 cursor-pointer transition-all duration-300 ${i==="document_processing"?"border-purple-500 bg-gradient-to-br from-purple-50 to-indigo-50 shadow-lg scale-105":"border-gray-200 hover:border-purple-300 hover:shadow-md hover:scale-102"}`,onClick:()=>c("document_processing"),children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-xl flex items-center justify-center text-white text-3xl font-bold mb-4 mx-auto group-hover:scale-110 transition-transform duration-300",children:""}),r.jsxs("div",{className:"flex items-center justify-center mb-2",children:[r.jsx("h4",{className:"font-bold text-xl text-gray-900",children:"AI Document Processing"}),r.jsx("span",{className:"ml-2 text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded-full font-medium",children:" RECOMMENDED"})]}),r.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Upload registration and insurance documents. Our AI extracts all vehicle information and tracks compliance expiry dates automatically."}),r.jsx("div",{className:"mt-6 text-sm text-purple-600 font-medium",children:" Complete automation    Compliance tracking    Document analysis"})]}),i==="document_processing"&&r.jsx("div",{className:"absolute top-4 right-4 w-6 h-6 bg-purple-600 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),r.jsxs("div",{className:`group relative border-2 rounded-xl p-8 cursor-pointer transition-all duration-300 ${i==="vin_list"?"border-blue-500 bg-gradient-to-br from-blue-50 to-indigo-50 shadow-lg scale-105":"border-gray-200 hover:border-blue-300 hover:shadow-md hover:scale-102"}`,onClick:()=>c("vin_list"),children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center text-white text-2xl font-bold mb-4 mx-auto group-hover:scale-110 transition-transform duration-300",children:"VIN"}),r.jsx("h4",{className:"font-bold text-xl mb-3 text-gray-900",children:"VIN List Processing"}),r.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Upload VINs and we'll automatically fetch truck specifications and compliance requirements from government databases."}),r.jsx("div",{className:"mt-6 text-sm text-blue-600 font-medium",children:" Automatic data lookup    API-powered    Fast processing"})]}),i==="vin_list"&&r.jsx("div",{className:"absolute top-4 right-4 w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),r.jsxs("div",{className:`group relative border-2 rounded-xl p-8 cursor-pointer transition-all duration-300 ${i==="bulk_upload"?"border-green-500 bg-gradient-to-br from-green-50 to-emerald-50 shadow-lg scale-105":"border-gray-200 hover:border-green-300 hover:shadow-md hover:scale-102"}`,onClick:()=>c("bulk_upload"),children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center text-white text-2xl font-bold mb-4 mx-auto group-hover:scale-110 transition-transform duration-300",children:"CSV"}),r.jsx("h4",{className:"font-bold text-xl mb-3 text-gray-900",children:"Complete Fleet Upload"}),r.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Upload a pre-filled spreadsheet with all your truck details including make, model, year, and compliance information."}),r.jsx("div",{className:"mt-6 text-sm text-green-600 font-medium",children:" Bulk processing    Pre-filled data    Quick setup"})]}),i==="bulk_upload"&&r.jsx("div",{className:"absolute top-4 right-4 w-6 h-6 bg-green-600 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),r.jsxs("div",{className:`group relative border-2 rounded-xl p-8 cursor-pointer transition-all duration-300 ${i==="individual"?"border-purple-500 bg-gradient-to-br from-purple-50 to-violet-50 shadow-lg scale-105":"border-gray-200 hover:border-purple-300 hover:shadow-md hover:scale-102"}`,onClick:()=>c("individual"),children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-purple-500 to-violet-600 rounded-xl flex items-center justify-center text-white text-2xl mb-4 mx-auto group-hover:scale-110 transition-transform duration-300",children:""}),r.jsx("h4",{className:"font-bold text-xl mb-3 text-gray-900",children:"One-by-One Entry"}),r.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Add trucks individually with guided forms. Perfect for smaller fleets or when you want full control over each entry."}),r.jsx("div",{className:"mt-6 text-sm text-purple-600 font-medium",children:" Step-by-step    Guided process    Full control"})]}),i==="individual"&&r.jsx("div",{className:"absolute top-4 right-4 w-6 h-6 bg-purple-600 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})]}),i==="document_processing"&&r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-8 border border-purple-200",children:[r.jsxs("div",{className:"flex items-center mb-6",children:[r.jsx("div",{className:"w-12 h-12 bg-purple-600 rounded-lg flex items-center justify-center text-white font-bold text-xl mr-4",children:""}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-xl font-bold text-gray-900",children:"AI Document Processing"}),r.jsx("p",{className:"text-purple-700",children:"Upload registration and insurance documents for complete automated setup"})]})]}),r.jsx("div",{className:"text-center",children:r.jsxs("button",{onClick:()=>le(!0),className:"px-8 py-4 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white rounded-xl font-black text-lg shadow-xl shadow-purple-900/20 hover:shadow-2xl hover:shadow-purple-900/30 transition-all duration-300 hover:scale-105 active:scale-95 border-2 border-purple-400",children:[" Start AI Document Processing",r.jsx("div",{className:"text-xs font-normal text-purple-100 mt-1",children:" Upload folders or individual files"})]})}),r.jsx("div",{className:"mt-6 bg-white/50 backdrop-blur-sm rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center text-sm text-purple-700",children:[r.jsx("span",{className:"text-purple-500 mr-2",children:""}),r.jsx("span",{children:"Our AI will extract VINs, license plates, expiry dates, and insurance details automatically from your documents"})]})})]}),i==="vin_list"&&r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-8 border border-blue-200",children:[r.jsxs("div",{className:"flex items-center mb-6",children:[r.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold text-xl mr-4",children:""}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-xl font-bold text-gray-900",children:"VIN List Upload"}),r.jsx("p",{className:"text-blue-700",children:"We'll automatically fetch truck data from government databases"})]})]}),r.jsxs("div",{className:"border-2 border-dashed border-blue-300 rounded-xl p-10 text-center mb-6 bg-white/50 backdrop-blur-sm hover:bg-white/70 transition-colors duration-300",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center text-white text-3xl font-bold mx-auto mb-4",children:""}),r.jsx("h5",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Drop your VIN file here"}),r.jsx("p",{className:"text-gray-600",children:"or click to browse your files"})]}),r.jsx("input",{type:"file",accept:".csv,.txt",onChange:se,className:"w-full h-full opacity-0 absolute inset-0 cursor-pointer",disabled:h}),r.jsx("div",{className:"space-y-2",children:r.jsxs("div",{className:"flex items-center justify-center space-x-6 text-sm text-gray-500",children:[r.jsxs("span",{className:"flex items-center",children:[r.jsx("svg",{className:"w-4 h-4 mr-1 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"CSV & TXT files"]}),r.jsxs("span",{className:"flex items-center",children:[r.jsx("svg",{className:"w-4 h-4 mr-1 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Max 5MB"]}),r.jsxs("span",{className:"flex items-center",children:[r.jsx("svg",{className:"w-4 h-4 mr-1 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"VINs in first column"]})]})})]}),r.jsxs("div",{className:"flex items-center justify-between bg-white rounded-lg p-4 border border-blue-200",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"text-blue-600 mr-3",children:""}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-gray-900",children:"Need a template?"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Download our VIN template to get started"})]})]}),r.jsxs("button",{onClick:Ub,className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-6 py-3 rounded-xl font-bold text-sm transition-all duration-300 flex items-center shadow-lg shadow-blue-900/20 hover:shadow-xl hover:shadow-blue-900/30 hover:scale-105 active:scale-95",children:[r.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Download Template"]})]})]}),u&&x.length>0&&r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 mt-6",children:[r.jsxs("div",{className:"flex items-center mb-6",children:[r.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:r.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-xl font-bold text-gray-900",children:"File Analysis Complete"}),r.jsx("p",{className:"text-gray-600",children:"Your VIN file has been processed and validated"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[r.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-6 border border-blue-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-blue-700 mb-1",children:"Total VINs"}),r.jsx("div",{className:"text-3xl font-bold text-blue-900",children:x.length})]}),r.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center text-white text-xl",children:""})]})}),r.jsx("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-6 border border-green-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-green-700 mb-1",children:"Valid VINs"}),r.jsx("div",{className:"text-3xl font-bold text-green-900",children:x.filter(V=>V.isValid).length})]}),r.jsx("div",{className:"w-12 h-12 bg-green-600 rounded-lg flex items-center justify-center text-white text-xl",children:""})]})}),r.jsx("div",{className:"bg-gradient-to-br from-red-50 to-red-100 rounded-xl p-6 border border-red-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-red-700 mb-1",children:"Invalid VINs"}),r.jsx("div",{className:"text-3xl font-bold text-red-900",children:x.filter(V=>!V.isValid).length})]}),r.jsx("div",{className:"w-12 h-12 bg-red-600 rounded-lg flex items-center justify-center text-white text-xl",children:""})]})})]}),r.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[r.jsxs("h5",{className:"font-bold text-gray-900 mb-4 flex items-center",children:[r.jsx("span",{className:"mr-2",children:""}),"VIN Preview (showing first 5)"]}),r.jsxs("div",{className:"space-y-3",children:[x.slice(0,5).map((V,M)=>r.jsxs("div",{className:"flex items-center justify-between bg-white rounded-lg p-4 border border-gray-200",children:[r.jsx("div",{className:"flex items-center",children:r.jsx("div",{className:"font-mono text-lg font-semibold text-gray-900 mr-4",children:V.vin})}),r.jsx("div",{className:`flex items-center px-3 py-1 rounded-full text-sm font-medium ${V.isValid?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"}`,children:V.isValid?r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Valid VIN"]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Invalid VIN"]})})]},M)),x.length>5&&r.jsxs("div",{className:"text-center text-gray-500 text-sm py-2 bg-gray-100 rounded-lg",children:["... and ",x.length-5," more VINs"]})]})]})]}),x.filter(V=>V.isValid).length>0&&r.jsxs("div",{className:"mt-8 text-center",children:[r.jsxs("button",{onClick:te,className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-12 py-4 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300 flex items-center mx-auto",children:[r.jsx("svg",{className:"w-6 h-6 mr-3",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Process ",x.filter(V=>V.isValid).length," Valid VINs"]}),r.jsx("p",{className:"text-gray-500 text-sm mt-3",children:"We'll automatically fetch truck data and generate compliance profiles"})]}),i==="bulk_upload"&&r.jsx("div",{children:r.jsx(vv,{onDataProcessed:Ce,onError:C})}),i==="individual"&&r.jsxs("div",{children:[r.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Add Individual Vehicle"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"Enter a VIN to start adding a vehicle with API assistance."}),r.jsxs("div",{className:"max-w-md",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vehicle Identification Number (VIN)"}),r.jsx("div",{className:"flex gap-2",children:r.jsx("input",{type:"text",placeholder:"Enter 17-character VIN",maxLength:17,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onKeyUp:async V=>{const M=V.target.value.toUpperCase();if(M.length===17&&Gh(M)){const j=await mn.getVehicleData(M);k({vin:M,template:j.fallbackOptions.template,existingData:j.data||void 0}),s(5)}}})}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"VIN will be validated and we'll try to fetch vehicle data automatically"})]})]})]}),a===2&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-2xl font-semibold mb-4",children:"Processing VIN Data"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"Decoding vehicle information and generating compliance data..."}),r.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-6",children:[r.jsxs("div",{className:"mb-4",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("span",{className:"text-yellow-800 font-medium",children:E}),r.jsxs("span",{className:"text-yellow-700 text-sm",children:[b,"%"]})]}),r.jsx("div",{className:"w-full bg-yellow-100 rounded-full h-3",children:r.jsx("div",{className:"bg-yellow-600 h-3 rounded-full transition-all duration-500",style:{width:`${b}%`}})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[r.jsxs("div",{className:`flex items-center ${b>=60?"text-green-700":"text-yellow-700"}`,children:[r.jsx("span",{className:"mr-2",children:b>=60?"":""}),"VIN Decoding"]}),r.jsxs("div",{className:`flex items-center ${b>=80?"text-green-700":b>=60?"text-yellow-700":"text-gray-500"}`,children:[r.jsx("span",{className:"mr-2",children:b>=80?"":b>=60?"":""}),"Compliance Generation"]}),r.jsxs("div",{className:`flex items-center ${b>=100?"text-green-700":b>=80?"text-yellow-700":"text-gray-500"}`,children:[r.jsx("span",{className:"mr-2",children:b>=100?"":b>=80?"":""}),"Profile Creation"]})]})]}),!h&&b===100&&r.jsx("button",{onClick:()=>s(3),className:"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium",children:"View Results "})]}),a===3&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-2xl font-semibold mb-4",children:"Review Vehicle Data"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"Review your vehicles and complete any missing information."}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[r.jsx("div",{className:"font-semibold text-blue-800",children:"Total Vehicles"}),r.jsx("div",{className:"text-2xl text-blue-600",children:w.length})]}),r.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[r.jsx("div",{className:"font-semibold text-green-800",children:"Complete"}),r.jsx("div",{className:"text-2xl text-green-600",children:w.filter(V=>V.make&&V.model&&V.year).length})]}),r.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[r.jsx("div",{className:"font-semibold text-yellow-800",children:"Need Review"}),r.jsx("div",{className:"text-2xl text-yellow-600",children:w.filter(V=>V.needsReview).length})]}),r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[r.jsx("div",{className:"font-semibold text-red-800",children:"Incomplete"}),r.jsx("div",{className:"text-2xl text-red-600",children:w.filter(V=>!V.make||!V.model||!V.year).length})]})]}),r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden mb-6",children:[r.jsx("div",{className:"px-6 py-4 bg-gray-50",children:r.jsx("h4",{className:"font-semibold",children:"Vehicle Details"})}),r.jsx("div",{className:"max-h-96 overflow-y-auto",children:w.map((V,M)=>r.jsx("div",{className:`p-4 ${V.needsReview?"border-l-4 border-l-yellow-500":!V.make||!V.model||!V.year?"border-l-4 border-l-red-500":"border-l-4 border-l-green-500"}`,children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h5",{className:"font-medium text-lg",children:V.year&&V.make&&V.model?`${V.year} ${V.make} ${V.model}`:"Incomplete Vehicle Data"}),r.jsxs("p",{className:"text-sm text-gray-600 font-mono mb-2",children:["VIN: ",V.vin]}),(V.fuelType||V.vehicleClass||V.maxWeight)&&r.jsxs("div",{className:"flex flex-wrap gap-2 mb-2 text-sm",children:[V.vehicleClass&&r.jsx("span",{className:"bg-gray-100 px-2 py-1 rounded",children:V.vehicleClass}),V.fuelType&&r.jsx("span",{className:"bg-blue-100 px-2 py-1 rounded",children:V.fuelType}),V.maxWeight&&r.jsxs("span",{className:"bg-yellow-100 px-2 py-1 rounded",children:[V.maxWeight.toLocaleString()," lbs"]})]}),r.jsx(Sv,{data:V})]}),r.jsxs("div",{className:"text-right ml-4",children:[(!V.make||!V.model||!V.year||V.needsReview)&&r.jsx("button",{onClick:()=>be(V.vin),className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-xl text-sm font-bold mb-2 transition-all duration-300 shadow-lg shadow-blue-900/20 hover:shadow-xl hover:shadow-blue-900/30 hover:scale-105 active:scale-95",children:!V.make||!V.model||!V.year?" Complete Data":" Review & Edit"}),r.jsx("div",{className:"text-xs text-gray-500",children:V.missingFields.length>0&&r.jsxs("div",{className:"text-amber-600 font-medium",children:["Missing: ",V.missingFields.join(", ")]})})]})]})},M))})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("button",{onClick:ae,className:"bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-lg font-medium text-lg",disabled:w.filter(V=>V.make&&V.model&&V.year).length===0,children:["Complete Onboarding & Add ",w.filter(V=>V.make&&V.model&&V.year).length," Vehicles "]}),w.filter(V=>!V.make||!V.model||!V.year).length>0&&r.jsxs("div",{className:"text-sm text-gray-600 flex items-center",children:[" ",w.filter(V=>!V.make||!V.model||!V.year).length," vehicles need completion"]})]})]}),a===5&&W&&r.jsx("div",{children:r.jsx(Nv,{template:W.template,existingData:W.existingData,onDataSubmitted:ee,onCancel:()=>{k(null),s(3)}})}),a===4&&r.jsxs("div",{children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("div",{className:"text-6xl mb-4",children:""}),r.jsx("h3",{className:"text-3xl font-bold text-green-600 mb-2",children:"Onboarding Complete!"}),r.jsx("p",{className:"text-gray-600 text-lg",children:"Your fleet has been successfully processed and integrated into the system."})]}),r.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 mb-8",children:[r.jsx("h4",{className:"font-semibold text-green-800 mb-4",children:" Integration Summary:"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-green-700",children:[r.jsxs("div",{children:[" ",w.filter(V=>V.make&&V.model&&V.year).length," vehicles added to Fleet Management"]}),r.jsxs("div",{children:[" ",w.filter(V=>V.make&&V.model&&V.year).length*3," compliance tasks generated"]}),r.jsx("div",{children:" Vehicle profiles created with real API data where available"}),r.jsx("div",{children:" Dashboard updated with comprehensive fleet data"})]})]}),r.jsxs("div",{className:"flex flex-wrap gap-4 justify-center",children:[r.jsx("button",{onClick:()=>f("fleet"),className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-8 py-4 rounded-2xl font-black text-lg shadow-xl shadow-blue-900/20 hover:shadow-2xl hover:shadow-blue-900/30 transition-all duration-300 hover:scale-105 active:scale-95",children:" View Fleet Management"}),r.jsx("button",{onClick:()=>f("compliance"),className:"bg-gradient-to-r from-purple-600 to-violet-600 hover:from-purple-700 hover:to-violet-700 text-white px-8 py-4 rounded-2xl font-black text-lg shadow-xl shadow-purple-900/20 hover:shadow-2xl hover:shadow-purple-900/30 transition-all duration-300 hover:scale-105 active:scale-95",children:" View Compliance Tasks"}),r.jsx("button",{onClick:de,className:"bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-700 hover:to-green-700 text-white px-8 py-4 rounded-2xl font-black text-lg shadow-xl shadow-emerald-900/20 hover:shadow-2xl hover:shadow-emerald-900/30 transition-all duration-300 hover:scale-105 active:scale-95",children:" Start New Onboarding"})]})]}),r.jsx(Rg,{isOpen:Z,onClose:()=>le(!1),onDocumentsProcessed:q})]})},Dv=()=>{const[f,a]=K.useState([]),[s,i]=K.useState(""),[c,u]=K.useState("all"),[m,h]=K.useState("table"),[g,x]=K.useState(!1),[y,w]=K.useState(!1),[D,b]=K.useState(!1),[v,E]=K.useState(!1),[A,X]=K.useState(!1),C=()=>{const j=ze.getFleet(),I=rt.getAllVehicles().map(z=>({id:z.id,vin:z.vin,make:z.make,model:z.model,year:z.year,licensePlate:z.licensePlate,dotNumber:z.dotNumber,truckNumber:`Truck #${z.vin.slice(-3)}`,status:z.status,dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()})),T=[...j,...I].filter((z,B,J)=>B===J.findIndex(re=>re.vin===z.vin));a(T)};K.useEffect(()=>{C();const j=rt.subscribe(()=>{C()}),P=ze.subscribe(()=>{console.log(" FleetPage: Persistent storage updated, reloading vehicles..."),C()});return()=>{j(),P()}},[]);const W=j=>{C()},k=j=>{C()},Z=j=>{console.log(" Processing extracted document data:",j);const P=j.map(N=>({vin:N.vin||`UNKNOWN_${Date.now()}`,make:N.make||"Unknown",model:N.model||"Unknown",year:N.year||new Date().getFullYear(),licensePlate:N.licensePlate||"Unknown",dotNumber:N.dotNumber,truckNumber:N.truckNumber||"",status:"active"}));console.log(" Converting to vehicle records:",P);const I=ze.addVehicles(P);console.log(` Storage result: ${I.successful.length} successful, ${I.failed.length} failed`),I.successful.length>0?(console.log(" Successfully added vehicles, reloading fleet view..."),C()):console.error(" No vehicles were successfully added:",I.failed)},le=j=>{console.log(` Multi-batch reconciliation complete: ${j} vehicles added`),C()},q=async j=>{var P,I,N,T,z,B,J,re,ne,Re,ge,ue,xe,_e,Qe;try{console.log(` Fetching real compliance data for VIN: ${j.vin}, DOT: ${j.dotNumber}`);const ye=await Lu.getUnifiedComplianceData(j.vin,j.dotNumber);console.log(" Real API data received:",ye);const et={dotInspection:{status:se(ye.fmcsaData),daysUntilExpiry:ee(((P=ye.fmcsaData)==null?void 0:P.safetyRatingDate)||""),lastInspectionDate:((I=ye.fmcsaData)==null?void 0:I.safetyRatingDate)||"",inspectionType:"DOT Safety Rating",safetyRating:((N=ye.fmcsaData)==null?void 0:N.safetyRating)||"Unknown",violations:((T=ye.inspectionRecords)==null?void 0:T.length)||0},registration:{status:te(ye.registrationData),daysUntilExpiry:ee(((z=ye.registrationData)==null?void 0:z.expirationDate)||""),registrationState:((B=ye.registrationData)==null?void 0:B.state)||"Unknown",registrationNumber:((J=ye.registrationData)==null?void 0:J.registrationNumber)||j.licensePlate,isValid:((re=ye.registrationData)==null?void 0:re.isValid)||!1},insurance:{status:Ce(ye.insuranceData),daysUntilExpiry:ee(((ne=ye.insuranceData)==null?void 0:ne.expirationDate)||""),carrier:((Re=ye.insuranceData)==null?void 0:Re.carrier)||"Unknown",policyNumber:((ge=ye.insuranceData)==null?void 0:ge.policyNumber)||"",isActive:((ue=ye.insuranceData)==null?void 0:ue.isActive)||!1,coverageAmount:((_e=(xe=ye.insuranceData)==null?void 0:xe.coverageTypes)==null?void 0:_e.liability)||0},ifta:{status:"compliant",daysUntilExpiry:90,quarterDue:be(),jurisdiction:((Qe=ye.registrationData)==null?void 0:Qe.state)||"CA"},apiMetadata:{lastUpdated:new Date().toISOString(),dataSource:"real_api",complianceScore:ye.complianceScore||0,vin:ye.vin}};return ze.updateVehicle(j.id,{complianceData:et,lastUpdated:new Date().toISOString()}),C(),et}catch(ye){return console.error(" Failed to fetch real compliance data:",ye),{dotInspection:{status:"warning",daysUntilExpiry:null,lastInspectionDate:"",inspectionType:"No Data Available",safetyRating:"No Data",violations:null,error:"API unavailable"},registration:{status:"warning",daysUntilExpiry:null,registrationState:"No Data",registrationNumber:"No Data",isValid:null,error:"API unavailable"},insurance:{status:"warning",daysUntilExpiry:null,carrier:"No Data Available",policyNumber:"No Data",isActive:null,coverageAmount:null,error:"API unavailable"},ifta:{status:"warning",daysUntilExpiry:null,quarterDue:"No Data",jurisdiction:"No Data",error:"API unavailable"},apiMetadata:{lastUpdated:new Date().toISOString(),dataSource:"api_error",error:ye instanceof Error?ye.message:String(ye)}}}},se=j=>j?j.safetyRating==="Satisfactory"?"compliant":j.safetyRating==="Conditional"?"warning":j.safetyRating==="Unsatisfactory"?"expired":"warning":"warning",te=j=>{if(!j)return"warning";if(j.isValid){const P=ee(j.expirationDate||"");return P<0?"expired":P<30?"warning":"compliant"}return"expired"},Ce=j=>{if(!j)return"warning";if(j.isActive){const P=ee(j.expirationDate||"");return P<0?"expired":P<30?"warning":"compliant"}return"expired"},ee=j=>{if(!j)return 365;const P=new Date(j),I=new Date,N=P.getTime()-I.getTime();return Math.ceil(N/(1e3*60*60*24))},be=()=>{const j=new Date,P=Math.floor((j.getMonth()+3)/3),I=P===4?1:P+1,N=P===4?j.getFullYear()+1:j.getFullYear();return`Q${I} ${N}`},ae=j=>{var I,N,T;if(console.log(` Getting compliance data for vehicle ${j.truckNumber||j.vin}:`,{id:j.id,registrationExpiry:j.registrationExpiry,insuranceExpiry:j.insuranceExpiry,registrationNumber:j.registrationNumber,insuranceCarrier:j.insuranceCarrier,policyNumber:j.policyNumber,hasComplianceData:!!j.complianceData}),j.complianceData)return console.log(` Using stored compliance data for ${j.truckNumber}`),{...j.complianceData,isRealData:((I=j.complianceData.apiMetadata)==null?void 0:I.dataSource)==="real_api",dataSource:((N=j.complianceData.apiMetadata)==null?void 0:N.dataSource)||"unknown",lastUpdated:(T=j.complianceData.apiMetadata)==null?void 0:T.lastUpdated};const P=j.registrationExpiry||j.insuranceCarrier||j.policyNumber;if(console.log(` Document data check for ${j.truckNumber}: hasDocumentData=${P}`),P){console.log(` Using extracted document data for ${j.truckNumber}`),console.log(`   Registration: expiry=${j.registrationExpiry}, number=${j.registrationNumber}`),console.log(`   Insurance: carrier=${j.insuranceCarrier}, expiry=${j.insuranceExpiry}`);const z=ne=>{if(!ne)return null;try{const Re=new Date(ne.replace(/(\d{1,2})\/(\d{1,2})\/(\d{4})/,"$3-$1-$2")),ge=new Date,ue=Re.getTime()-ge.getTime();return Math.ceil(ue/(1e3*60*60*24))}catch{return null}},B=ne=>ne===null?"warning":ne<0?"critical":ne<30?"warning":"compliant",J=z(j.registrationExpiry),re=z(j.insuranceExpiry);return{dotInspection:{status:"warning",daysUntilExpiry:null,lastInspectionDate:"",inspectionType:"Not Synced",safetyRating:"",violations:null},registration:{status:B(J),daysUntilExpiry:J,registrationState:j.registrationState||"",registrationNumber:j.registrationNumber||"",isValid:J!==null&&J>0},insurance:{status:B(re),daysUntilExpiry:re,carrier:j.insuranceCarrier||"",policyNumber:j.policyNumber||"",isActive:re!==null&&re>0,coverageAmount:j.coverageAmount||null},ifta:{status:"warning",daysUntilExpiry:null,quarterDue:"",jurisdiction:j.registrationState||""},isRealData:!1,dataSource:"document_processing",lastUpdated:j.lastUpdated}}return console.log(` No document or compliance data found for ${j.truckNumber}, using blank placeholders`),{dotInspection:{status:"warning",daysUntilExpiry:null,lastInspectionDate:"",inspectionType:"Not Synced",safetyRating:"",violations:null},registration:{status:"warning",daysUntilExpiry:null,registrationState:"",registrationNumber:"",isValid:null},insurance:{status:"warning",daysUntilExpiry:null,carrier:"",policyNumber:"",isActive:null,coverageAmount:null},ifta:{status:"warning",daysUntilExpiry:null,quarterDue:"",jurisdiction:""},isRealData:!1,dataSource:"not_synced",lastUpdated:null}},de=f.filter(j=>{var N,T,z;const P=s===""||j.vin.toLowerCase().includes(s.toLowerCase())||j.make.toLowerCase().includes(s.toLowerCase())||j.model.toLowerCase().includes(s.toLowerCase())||j.licensePlate.toLowerCase().includes(s.toLowerCase())||((N=j.truckNumber)==null?void 0:N.toLowerCase().includes(s.toLowerCase()))||s.match(/^\d+$/)&&((T=j.truckNumber)==null?void 0:T.includes(`#${s.padStart(3,"0")}`))||s.startsWith("#")&&((z=j.truckNumber)==null?void 0:z.toLowerCase().includes(s.toLowerCase())),I=c==="all"||j.status===c;return P&&I}),V={total:f.length,active:f.filter(j=>j.status==="active").length,inactive:f.filter(j=>j.status==="inactive").length,complianceWarnings:Math.floor(f.length*.1),complianceExpired:Math.floor(f.length*.05)},M=j=>{const P=ae(j),I=[P.registration,P.insurance,P.dotInspection,P.ifta],N=I.filter(re=>re.status==="compliant").length,T=I.filter(re=>re.status==="warning").length,z=I.filter(re=>re.status==="expired").length,B=(N*100+T*70+z*0)/I.length,J=B>=90?"compliant":B>=50?"warning":"expired";return{vehicle:{id:j.id,vin:j.vin,make:j.make,model:j.model,year:j.year,licensePlate:j.licensePlate,truckNumber:j.truckNumber,status:j.status,dotNumber:j.dotNumber,dateAdded:j.dateAdded},compliance:{registration:P.registration,insurance:P.insurance,dotInspection:P.dotInspection,ifta:P.ifta,overall:{score:Math.round(B),status:J}}}};return r.jsxs("div",{className:"max-w-7xl",children:[r.jsx("div",{className:"bg-gradient-to-r from-slate-800 to-slate-900 rounded-xl p-8 mb-8 text-white",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-2xl md:text-4xl font-bold mb-2 flex items-center",children:[r.jsx("span",{className:"mr-3",children:""}),"Fleet Management"]}),r.jsx("p",{className:"text-slate-300 text-lg",children:"Monitor and manage your truck fleet operations"})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-3xl font-bold",children:V.total}),r.jsx("div",{className:"text-slate-300",children:"Total Trucks"})]})]})}),r.jsxs("div",{className:"flex items-center gap-4 mb-4 text-sm",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-gray-600",children:"Total:"}),r.jsx("span",{className:"font-semibold",children:V.total})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),r.jsx("span",{className:"text-gray-600",children:"Active:"}),r.jsx("span",{className:"font-semibold",children:V.active})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),r.jsx("span",{className:"text-gray-600",children:"Parked:"}),r.jsx("span",{className:"font-semibold",children:V.inactive})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),r.jsx("span",{className:"text-gray-600",children:"Issues:"}),r.jsx("span",{className:"font-semibold",children:V.complianceWarnings+V.complianceExpired})]})]}),r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"flex-1",children:r.jsx("input",{type:"text",placeholder:"Search vehicles...",value:s,onChange:j=>i(j.target.value),className:"w-full px-3 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})}),r.jsxs("select",{value:c,onChange:j=>u(j.target.value),className:"px-3 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"all",children:"All Status"}),r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"inactive",children:"Inactive"})]}),r.jsxs("div",{className:"flex bg-gray-100 rounded overflow-hidden",children:[r.jsx("button",{onClick:()=>h("cards"),className:`px-3 py-1.5 text-xs font-medium transition-colors ${m==="cards"?"bg-blue-500 text-white":"text-gray-600 hover:text-gray-800 hover:bg-gray-200"}`,children:"Cards"}),r.jsx("button",{onClick:()=>h("table"),className:`px-3 py-1.5 text-xs font-medium transition-colors ${m==="table"?"bg-blue-500 text-white":"text-gray-600 hover:text-gray-800 hover:bg-gray-200"}`,children:"Table"})]})]}),r.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[r.jsx("button",{onClick:()=>x(!0),className:"px-3 py-1.5 text-sm bg-blue-500 hover:bg-blue-600 text-white rounded transition-colors",children:"+ Add Vehicle"}),r.jsx("button",{onClick:()=>w(!0),className:"px-3 py-1.5 text-sm bg-gray-500 hover:bg-gray-600 text-white rounded transition-colors",children:"Bulk Upload"}),r.jsx("button",{onClick:()=>b(!0),className:"px-3 py-1.5 text-sm bg-green-500 hover:bg-green-600 text-white rounded transition-colors",children:"Upload Documents"}),r.jsx("button",{onClick:()=>E(!0),className:"px-3 py-1.5 text-sm bg-purple-500 hover:bg-purple-600 text-white rounded transition-colors",children:"Multi-Batch"}),r.jsx("button",{onClick:()=>X(!0),className:"px-3 py-1.5 text-sm bg-yellow-500 hover:bg-yellow-600 text-white rounded transition-colors",children:"Test Runner"})]}),r.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[r.jsx("button",{onClick:()=>bv.downloadComplianceSummary(f),className:"px-3 py-1.5 text-sm bg-gray-500 hover:bg-gray-600 text-white rounded transition-colors",title:"Download fleet compliance report",children:"Download Report"}),r.jsx("button",{onClick:async()=>{console.log(" Starting bulk compliance sync...");for(const j of f)await q(j),await new Promise(P=>setTimeout(P,500));console.log(" Bulk compliance sync completed!")},className:"px-3 py-1.5 text-sm bg-gray-500 hover:bg-gray-600 text-white rounded transition-colors",title:"Sync compliance data",children:"Sync All"}),r.jsx("button",{onClick:()=>{window.confirm("Clear all fleet data? This cannot be undone.")&&(ze.clearFleet(),C())},className:"px-3 py-1.5 text-sm bg-red-500 hover:bg-red-600 text-white rounded transition-colors",title:"Clear all fleet data",children:"Clear Fleet"})]}),m==="cards"?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-3",children:de.map(j=>{const P=M(j);return r.jsx(sv,{vehicle:P.vehicle,compliance:P.compliance,onViewDetails:()=>{console.log("View details for vehicle:",j.id)},onScheduleService:()=>{console.log("Schedule service for vehicle:",j.id)},onEditVehicle:()=>{console.log("Edit vehicle:",j.id)}},j.id)})}):r.jsx("div",{className:"bg-white border border-gray-200 rounded",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50 border-b",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 uppercase",children:"Truck"}),r.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 uppercase",children:"Vehicle"}),r.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 uppercase",children:"VIN"}),r.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 uppercase",children:"License"}),r.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 uppercase",children:"Status"}),r.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 uppercase",children:"DOT"}),r.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 uppercase",children:"Registration"}),r.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 uppercase",children:"Insurance"}),r.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 uppercase",children:"IFTA"}),r.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 uppercase",children:"Actions"})]})}),r.jsx("tbody",{children:de.map(j=>{var I;const P=ae(j);return r.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[r.jsx("td",{className:"px-3 py-3 text-center text-sm",children:j.truckNumber?j.truckNumber.replace("Truck #","#"):`#${((I=j.vin)==null?void 0:I.slice(-3))||"???"}`}),r.jsxs("td",{className:"px-3 py-3 text-center text-sm",children:[j.year," ",j.make," ",j.model]}),r.jsx("td",{className:"px-3 py-3 text-center text-sm font-mono",children:j.vin.slice(-8)}),r.jsx("td",{className:"px-3 py-3 text-center text-sm",children:j.licensePlate}),r.jsx("td",{className:"px-3 py-3 text-center text-sm",children:r.jsx("span",{className:`px-2 py-1 rounded text-xs ${j.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:j.status})}),r.jsx("td",{className:"px-3 py-3 text-center text-sm",children:P.dotInspection.daysUntilExpiry!==null?`${P.dotInspection.daysUntilExpiry}d`:""}),r.jsx("td",{className:"px-3 py-3 text-center text-sm",children:P.registration.daysUntilExpiry!==null?`${P.registration.daysUntilExpiry}d`:""}),r.jsx("td",{className:"px-3 py-3 text-center text-sm",children:P.insurance.daysUntilExpiry!==null?`${P.insurance.daysUntilExpiry}d`:""}),r.jsx("td",{className:"px-3 py-3 text-center text-sm",children:P.ifta.daysUntilExpiry!==null?`${P.ifta.daysUntilExpiry}d`:""}),r.jsx("td",{className:"px-3 py-3 text-center text-sm",children:r.jsxs("div",{className:"flex justify-center space-x-1",children:[r.jsx("button",{className:"px-2 py-1 text-xs bg-blue-500 hover:bg-blue-600 text-white rounded",children:"View"}),r.jsx("button",{className:"px-2 py-1 text-xs bg-gray-500 hover:bg-gray-600 text-white rounded",children:"Edit"})]})})]},j.id)})})]})}),de.length===0&&r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No vehicles found"}),r.jsx("p",{className:"text-gray-500",children:s||c!=="all"?"Try adjusting your search or filters":"Get started by adding vehicles individually or use bulk upload for multiple vehicles"})]}),r.jsx(Lb,{isOpen:g,onClose:()=>x(!1),onVehicleAdded:W}),r.jsx(kb,{isOpen:y,onClose:()=>w(!1),onVehiclesAdded:k}),r.jsx(Rg,{isOpen:D,onClose:()=>b(!1),onDocumentsProcessed:Z}),r.jsx(Wy,{isOpen:v,onClose:()=>E(!1),onDocumentsReconciled:le}),r.jsx(av,{isOpen:A,onClose:()=>X(!1)})]})},Rv=()=>{const[f,a]=K.useState([]),[s,i]=K.useState(null),[c,u]=K.useState("all"),[m,h]=K.useState("all"),[g,x]=K.useState("");K.useEffect(()=>(a(rt.getAllComplianceTasks()),rt.subscribe(()=>{a(rt.getAllComplianceTasks())})),[]);const y=f.filter(A=>{const X=g===""||A.title.toLowerCase().includes(g.toLowerCase())||A.vehicleVin.toLowerCase().includes(g.toLowerCase())||A.vehicleName.toLowerCase().includes(g.toLowerCase()),C=c==="all"||A.status===c,W=m==="all"||A.priority===m;return X&&C&&W}),w=rt.getComplianceStats(),D=A=>{switch(A){case"critical":return"bg-gradient-to-r from-red-100 to-rose-100 text-red-800 border border-red-300 shadow-sm";case"high":return"bg-gradient-to-r from-orange-100 to-amber-100 text-orange-800 border border-orange-300 shadow-sm";case"medium":return"bg-gradient-to-r from-yellow-100 to-amber-100 text-yellow-800 border border-yellow-300 shadow-sm";case"low":return"bg-gradient-to-r from-slate-100 to-gray-100 text-slate-700 border border-slate-300 shadow-sm";default:return"bg-gradient-to-r from-slate-100 to-gray-100 text-slate-700 border border-slate-300 shadow-sm"}},b=A=>{switch(A){case"pending":return"bg-gradient-to-r from-blue-100 to-indigo-100 text-blue-800 border border-blue-300 shadow-sm";case"in_progress":return"bg-gradient-to-r from-purple-100 to-violet-100 text-purple-800 border border-purple-300 shadow-sm";case"completed":return"bg-gradient-to-r from-emerald-100 to-green-100 text-emerald-800 border border-emerald-300 shadow-sm";case"overdue":return"bg-gradient-to-r from-red-100 to-rose-100 text-red-800 border border-red-300 shadow-sm";default:return"bg-gradient-to-r from-slate-100 to-gray-100 text-slate-700 border border-slate-300 shadow-sm"}},v=A=>A<0?"text-red-600":A<=7?"text-orange-600":A<=30?"text-yellow-600":"text-gray-600",E=(A,X)=>{rt.updateTaskStatus(A,X)};return r.jsxs("div",{className:"max-w-7xl",children:[r.jsx("h2",{className:"text-3xl font-bold mb-6",children:" Compliance Dashboard"}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-7 gap-4 mb-8",children:[r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[r.jsx("div",{className:"font-semibold text-blue-800",children:"Total Tasks"}),r.jsx("div",{className:"text-3xl text-blue-600",children:w.total})]}),r.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[r.jsx("div",{className:"font-semibold text-gray-800",children:"Pending"}),r.jsx("div",{className:"text-3xl text-gray-600",children:w.pending})]}),r.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[r.jsx("div",{className:"font-semibold text-purple-800",children:"In Progress"}),r.jsx("div",{className:"text-3xl text-purple-600",children:w.inProgress})]}),r.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[r.jsx("div",{className:"font-semibold text-green-800",children:"Completed"}),r.jsx("div",{className:"text-3xl text-green-600",children:w.completed})]}),r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[r.jsx("div",{className:"font-semibold text-red-800",children:"Overdue"}),r.jsx("div",{className:"text-3xl text-red-600",children:w.overdue})]}),r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[r.jsx("div",{className:"font-semibold text-red-800",children:"Critical"}),r.jsx("div",{className:"text-3xl text-red-600",children:w.critical})]}),r.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[r.jsx("div",{className:"font-semibold text-orange-800",children:"High Priority"}),r.jsx("div",{className:"text-3xl text-orange-600",children:w.high})]})]}),r.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[r.jsx("div",{className:"flex-1",children:r.jsx("input",{type:"text",placeholder:"Search tasks by title, vehicle, or VIN...",value:g,onChange:A=>x(A.target.value),className:`w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\r
focus:border-blue-500`})}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("select",{value:c,onChange:A=>u(A.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"all",children:"All Status"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"in_progress",children:"In Progress"}),r.jsx("option",{value:"completed",children:"Completed"}),r.jsx("option",{value:"overdue",children:"Overdue"})]}),r.jsxs("select",{value:m,onChange:A=>h(A.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"all",children:"All Priority"}),r.jsx("option",{value:"critical",children:"Critical"}),r.jsx("option",{value:"high",children:"High"}),r.jsx("option",{value:"medium",children:"Medium"}),r.jsx("option",{value:"low",children:"Low"})]}),r.jsx("button",{className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-blue-900/20 hover:shadow-xl hover:shadow-blue-900/30 transition-all duration-300 hover:scale-105 active:scale-95",children:" Add Task"})]})]}),r.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:y.map(A=>r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[r.jsx("div",{className:"flex justify-between items-start mb-4",children:r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${D(A.priority)}`,children:A.priority.toUpperCase()}),r.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${b(A.status)}`,children:A.status.replace("_"," ").toUpperCase()})]}),r.jsx("h3",{className:"font-semibold text-lg text-gray-900 mb-2",children:A.title}),r.jsx("p",{className:"text-sm text-gray-600 mb-3",children:A.description}),r.jsxs("div",{className:"text-sm text-gray-500 space-y-1",children:[r.jsxs("div",{children:[" ",A.vehicleName]}),r.jsxs("div",{className:"font-mono",children:["VIN: ",A.vehicleVin.slice(-8)]}),r.jsxs("div",{children:[" ",A.category]}),r.jsxs("div",{children:[" ",A.assignedTo]}),A.estimatedCost&&r.jsxs("div",{children:[" $",A.estimatedCost.toLocaleString()]})]})]})}),r.jsxs("div",{className:"pt-4",children:[r.jsxs("div",{className:"flex justify-between items-center mb-3",children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Due Date"}),r.jsx("span",{className:`text-sm font-medium ${v(A.daysUntilDue)}`,children:A.daysUntilDue<0?`${Math.abs(A.daysUntilDue)} days overdue`:`${A.daysUntilDue} days remaining`})]}),r.jsxs("div",{className:"flex gap-2",children:[A.status==="pending"&&r.jsx("button",{onClick:()=>E(A.id,"in_progress"),className:"flex-1 px-3 py-2 text-xs bg-purple-600 text-white rounded hover:bg-purple-700",children:"Start"}),A.status==="in_progress"&&r.jsx("button",{onClick:()=>E(A.id,"completed"),className:"flex-1 px-3 py-2 text-xs bg-green-600 text-white rounded hover:bg-green-700",children:"Complete"}),r.jsx("button",{onClick:()=>i(A),className:"flex-1 px-3 py-2 text-xs bg-gray-600 text-white rounded hover:bg-gray-700",children:"View Details"})]})]})]},A.id))}),y.length===0&&r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No compliance tasks found"}),r.jsx("p",{className:"text-gray-500",children:g||c!=="all"||m!=="all"?"Try adjusting your search or filters":"Compliance tasks will appear here as vehicles are added to your fleet"})]}),s&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex justify-between items-start mb-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900",children:s.title}),r.jsx("p",{className:"text-gray-600",children:s.vehicleName})]}),r.jsx("button",{onClick:()=>i(null),className:"text-gray-400 hover:text-gray-600",children:""})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Description"}),r.jsx("p",{className:"text-gray-700",children:s.description})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Priority"}),r.jsx("span",{className:`px-2 py-1 text-sm rounded ${D(s.priority)}`,children:s.priority.toUpperCase()})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Status"}),r.jsx("span",{className:`px-2 py-1 text-sm rounded ${b(s.status)}`,children:s.status.replace("_"," ").toUpperCase()})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Due Date"}),r.jsx("p",{className:"text-gray-700",children:s.dueDate})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Assigned To"}),r.jsx("p",{className:"text-gray-700",children:s.assignedTo})]})]}),s.estimatedCost&&r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Estimated Cost"}),r.jsxs("p",{className:"text-gray-700",children:["$",s.estimatedCost.toLocaleString()]})]}),s.requiredDocuments&&s.requiredDocuments.length>0&&r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Required Documents"}),r.jsx("ul",{className:"text-gray-700 space-y-1",children:s.requiredDocuments.map((A,X)=>r.jsxs("li",{className:"flex items-center",children:[r.jsx("span",{className:"mr-2",children:""}),A]},X))})]}),s.filingUrl&&r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Filing URL"}),r.jsx("a",{href:s.filingUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:s.filingUrl})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[s.status==="pending"&&r.jsx("button",{onClick:()=>{E(s.id,"in_progress"),i(null)},className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700",children:"Start Task"}),s.status==="in_progress"&&r.jsx("button",{onClick:()=>{E(s.id,"completed"),i(null)},className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Mark Complete"}),r.jsx("button",{onClick:()=>i(null),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Close"})]})]})]})})]})},Av=({setCurrentPage:f})=>{const[a,s]=K.useState(()=>{const m=ze.getFleet(),h=rt.getFleetStats();return{total:m.length+h.total,active:m.filter(g=>g.status==="active").length+h.active,inactive:m.filter(g=>g.status==="inactive").length+h.inactive,complianceExpired:h.complianceExpired}}),[i,c]=K.useState(rt.getComplianceStats()),u=()=>{const m=ze.getFleet(),h=rt.getFleetStats();s({total:m.length+h.total,active:m.filter(g=>g.status==="active").length+h.active,inactive:m.filter(g=>g.status==="inactive").length+h.inactive,complianceExpired:h.complianceExpired}),c(rt.getComplianceStats())};return K.useEffect(()=>{const m=rt.subscribe(u);return u(),m},[]),r.jsxs("div",{className:"space-y-8",children:[r.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-sm border border-gray-200",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Fleet Dashboard"}),r.jsx("p",{className:"text-gray-600",children:"Overview of your fleet operations"})]}),r.jsx("div",{className:"text-4xl",children:""})]}),r.jsxs("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[r.jsx("div",{className:"text-2xl font-bold text-gray-900",children:a.total}),r.jsx("div",{className:"text-sm text-gray-600",children:"Total Vehicles"})]}),r.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[r.jsx("div",{className:"text-2xl font-bold text-green-700",children:a.active}),r.jsx("div",{className:"text-sm text-gray-600",children:"Active"})]}),r.jsxs("div",{className:"bg-amber-50 rounded-lg p-4",children:[r.jsx("div",{className:"text-2xl font-bold text-amber-700",children:i.pending}),r.jsx("div",{className:"text-sm text-gray-600",children:"Alerts"})]}),r.jsxs("div",{className:"bg-emerald-50 rounded-lg p-4",children:[r.jsx("div",{className:"text-2xl font-bold text-emerald-700",children:"--"}),r.jsx("div",{className:"text-sm text-gray-600",children:"Compliance"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-sm border border-gray-200",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Compliance Status"}),r.jsx("div",{className:"flex items-center justify-center mb-6",children:r.jsxs("div",{className:"relative w-32 h-32",children:[r.jsxs("svg",{className:"w-32 h-32 transform -rotate-90",viewBox:"0 0 100 100",children:[r.jsx("circle",{cx:"50",cy:"50",r:"35",stroke:"#e5e7eb",strokeWidth:"8",fill:"none"}),r.jsx("circle",{cx:"50",cy:"50",r:"35",stroke:"#10b981",strokeWidth:"8",fill:"none",strokeDasharray:"0 220",strokeLinecap:"round"})]}),r.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[r.jsx("span",{className:"text-3xl font-bold text-gray-500",children:"--"}),r.jsx("span",{className:"text-sm text-gray-600",children:"No Data"})]})]})}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"text-gray-700",children:"DOT Compliance"}),r.jsx("span",{className:"font-semibold text-gray-500",children:"--"})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"text-gray-700",children:"Insurance"}),r.jsx("span",{className:"font-semibold text-gray-500",children:"--"})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"text-gray-700",children:"Inspections"}),r.jsx("span",{className:"font-semibold text-gray-500",children:"--"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-sm border border-gray-200",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Quick Actions"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("button",{onClick:()=>f("onboarding"),className:"flex items-center p-4 bg-blue-50 rounded-lg border border-blue-200 hover:bg-blue-100 transition-colors",children:[r.jsx("span",{className:"text-2xl mr-3",children:""}),r.jsxs("div",{className:"text-left",children:[r.jsx("div",{className:"font-semibold text-gray-900",children:"Add Vehicles"}),r.jsx("div",{className:"text-sm text-gray-600",children:"Upload or add manually"})]})]}),r.jsxs("button",{onClick:()=>f("fleet"),className:"flex items-center p-4 bg-green-50 rounded-lg border border-green-200 hover:bg-green-100 transition-colors",children:[r.jsx("span",{className:"text-2xl mr-3",children:""}),r.jsxs("div",{className:"text-left",children:[r.jsx("div",{className:"font-semibold text-gray-900",children:"Manage Fleet"}),r.jsx("div",{className:"text-sm text-gray-600",children:"View all vehicles"})]})]}),r.jsxs("button",{onClick:()=>f("comprehensive-compliance"),className:"flex items-center p-4 bg-purple-50 rounded-lg border border-purple-200 hover:bg-purple-100 transition-colors",children:[r.jsx("span",{className:"text-2xl mr-3",children:""}),r.jsxs("div",{className:"text-left",children:[r.jsx("div",{className:"font-semibold text-gray-900",children:"Compliance"}),r.jsx("div",{className:"text-sm text-gray-600",children:"Monitor alerts"})]})]})]})]})]})};function Cv(){var i,c,u,m,h,g,x,y,w;const[f,a]=K.useState("dashboard"),s=[{id:"dashboard",label:"Dashboard",icon:""},{id:"onboarding",label:"Fleet Onboarding",icon:""},{id:"fleet",label:"Fleet Management",icon:""},{id:"drivers",label:"Driver Management",icon:""},{id:"compliance",label:"Compliance",icon:""},{id:"comprehensive-compliance",label:"Real-time Compliance",icon:""},{id:"reports",label:"Reports",icon:""}];return r.jsxs("div",{className:"flex min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[r.jsxs("div",{className:"w-72 bg-gradient-to-b from-slate-800 to-slate-900 text-white shadow-2xl",children:[r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-orange-500 to-red-600 rounded-xl flex items-center justify-center text-xl font-bold",children:""}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-bold text-white",children:"TruckBo Pro"}),r.jsx("p",{className:"text-slate-300 text-sm",children:"Fleet Management"})]})]}),ot.getCurrentUser()&&r.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-3 mt-4",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[r.jsxs("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-xs font-bold",children:[(c=(i=ot.getCurrentUser())==null?void 0:i.firstName)==null?void 0:c[0],(m=(u=ot.getCurrentUser())==null?void 0:u.lastName)==null?void 0:m[0]]}),r.jsxs("div",{children:[r.jsxs("p",{className:"text-white text-sm font-medium",children:[(h=ot.getCurrentUser())==null?void 0:h.firstName," ",(g=ot.getCurrentUser())==null?void 0:g.lastName]}),r.jsx("p",{className:"text-slate-300 text-xs",children:(x=ot.getCurrentUser())==null?void 0:x.role})]})]}),r.jsx("div",{className:"text-slate-300 text-xs mb-2",children:(y=ot.getCurrentCompany())==null?void 0:y.name}),r.jsx("button",{onClick:()=>ot.logout(),className:"w-full text-center px-3 py-2 text-xs bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Logout"})]}),r.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-3 mt-4",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"text-slate-300 text-sm",children:"Total Fleet"}),r.jsx("span",{className:"text-white font-bold text-lg",children:ze.getFleet().length+rt.getFleetStats().total})]}),r.jsxs("div",{className:"flex justify-between items-center mt-1",children:[r.jsx("span",{className:"text-slate-300 text-sm",children:"Compliance Score"}),r.jsx("span",{className:"text-gray-400 font-bold",children:"--"})]}),r.jsxs("div",{className:"flex justify-between items-center mt-1",children:[r.jsx("span",{className:"text-slate-300 text-xs",children:ze.getFleet().length>0?"Live Fleet Data":"No Data"}),r.jsx("span",{className:"text-blue-400 text-xs",children:ze.getFleet().length>0?" Active":" Empty"})]})]})]}),r.jsx("nav",{className:"p-4 space-y-2",children:s.map(D=>r.jsxs("button",{onClick:()=>a(D.id),className:`w-full text-left px-4 py-4 rounded-xl flex items-center space-x-4 transition-all duration-200 group ${f===D.id?"bg-gradient-to-r from-blue-600 to-blue-700 shadow-lg transform scale-105":"hover:bg-slate-700/50 hover:transform hover:translate-x-1"}`,children:[r.jsx("span",{className:`text-2xl transition-transform duration-200 ${f===D.id?"transform scale-110":"group-hover:scale-110"}`,children:D.icon}),r.jsxs("div",{children:[r.jsx("span",{className:`font-medium ${f===D.id?"text-white":"text-slate-200"}`,children:D.label}),f===D.id&&r.jsx("div",{className:"w-2 h-2 bg-white rounded-full mt-1"})]})]},D.id))}),r.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:[r.jsxs("div",{className:"flex items-center space-x-2 text-sm text-slate-400",children:[r.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),r.jsx("span",{children:"System Online"})]}),r.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Last sync: ",new Date().toLocaleTimeString()]})]})]}),r.jsxs("div",{className:"flex-1 flex flex-col min-h-screen",children:[r.jsx("header",{className:"bg-white/80 backdrop-blur-lg px-8 py-4 shadow-sm",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:((w=s.find(D=>D.id===f))==null?void 0:w.label)||"Dashboard"}),r.jsxs("p",{className:"text-slate-600 text-sm mt-1",children:[f==="dashboard"&&"Fleet overview and key metrics",f==="onboarding"&&"Add new vehicles to your fleet",f==="fleet"&&"Manage your fleet vehicles",f==="drivers"&&"Track medical certificates and CDL renewals",f==="compliance"&&"Track compliance tasks and deadlines",f==="comprehensive-compliance"&&"Real-time compliance monitoring",f==="reports"&&"Generate compliance reports and analytics"]})]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"hidden md:flex items-center space-x-6 text-sm",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-green-600 font-bold text-lg",children:rt.getFleetStats().active}),r.jsx("div",{className:"text-slate-500",children:"Active"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-yellow-600 font-bold text-lg",children:rt.getComplianceStats().pending}),r.jsx("div",{className:"text-slate-500",children:"Pending"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-red-600 font-bold text-lg",children:rt.getComplianceStats().overdue}),r.jsx("div",{className:"text-slate-500",children:"Overdue"})]})]}),r.jsx("button",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-2 rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 font-medium",children:f==="onboarding"?"+ Add Vehicles":f==="fleet"?"+ New Vehicle":f==="compliance"?"+ New Task":"+ Quick Action"})]})]})}),r.jsx("main",{className:"flex-1 p-8 overflow-auto",children:r.jsxs("div",{className:"max-w-7xl mx-auto",children:[f==="dashboard"&&r.jsx(Av,{setCurrentPage:a}),f==="onboarding"&&r.jsx(jv,{setCurrentPage:a}),f==="fleet"&&r.jsx(Dv,{}),f==="drivers"&&r.jsx(nv,{}),f==="reports"&&r.jsx(iv,{}),f==="compliance"&&r.jsx(Rv,{}),f==="comprehensive-compliance"&&r.jsx(Ev,{vehicles:rt.getAllVehicles().map(D=>({id:D.id,vin:D.vin,make:D.make,model:D.model,year:D.year,dotNumber:D.dotNumber}))}),f==="reports"&&r.jsxs("div",{className:"text-center py-16",children:[r.jsx("div",{className:"w-24 h-24 bg-gradient-to-r from-blue-100 to-blue-200 rounded-full flex items-center justify-center mx-auto mb-6",children:r.jsx("span",{className:"text-4xl",children:""})}),r.jsx("h2",{className:"text-3xl font-bold text-slate-800 mb-4",children:"Advanced Reports"}),r.jsx("p",{className:"text-slate-600 text-lg max-w-md mx-auto",children:"Comprehensive fleet analytics and reporting tools are coming soon to help you make data-driven decisions."}),r.jsx("button",{className:"mt-6 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-8 py-4 rounded-2xl font-black text-lg shadow-xl shadow-blue-900/20 hover:shadow-2xl hover:shadow-blue-900/30 transition-all duration-300 hover:scale-105 active:scale-95",children:" Request Early Access"})]})]})})]})]})}function Tv(){return r.jsxs(ny,{children:[r.jsx(uv,{children:r.jsx(Cv,{})}),r.jsx(sy,{})]})}cb.createRoot(document.getElementById("root")).render(r.jsx(zh.StrictMode,{children:r.jsx(Tv,{})}));
//# sourceMappingURL=index-Dv3NBIqq.js.map
